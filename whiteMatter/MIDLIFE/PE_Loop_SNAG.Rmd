---
title: "Loop position error"
author: "Daniela Cossio"
date: "5/28/2023"
output:
   html_document: 
     toc: yes
     toc_float: yes
     toc_depth: 6
     theme: flatly
     code_folding: hide
editor_options: 
  chunk_output_type: inline
---

```{r adding libraries, echo=FALSE, message=FALSE, results='hide'}
library(ggplot2)
#(plyr)
library(tidyverse)
# library(dplyr)
# library(tidyr)
library(stringr)
library(kableExtra)
# library(data.table)
# library(network)
# library(tidygraph)
# library(ggraph)
# library(igraph)
# library(networkD3)
# library(CINNA)
# library(umap)
# library(plotly)
#library(factoextra)
#library(lsr)
library(car)
library(ggpubr)
#library(entropy)
#library(ds4psy)
# library(pROC)
#library(devtools)
#library(BRRR)
library(stats)
#library(afex)
library(knitr)
library(janitor)
# library(car)
# library(ggiraph)
library(ggiraphExtra)
# library(moonBook)
library(nationalparkcolors)


npc_everglades <- park_palette("Everglades")
npc_channel <- park_palette("ChannelIslands")
npc_saguaro <- park_palette("Saguaro")

knitr::opts_chunk$set(warning=FALSE, message=FALSE, echo = FALSE,
                      fig.align = "center")


Rad3_work_dir <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/rad3/"
Avg_work_dir <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average"

rows2grab <- c("Tract Name", "number of tracts","mean length(mm)","diameter(mm)", "volume(mm^3)")

loop_subInfo <- read.csv("/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/loop_subinfo.csv") %>% select("subject_id", "sex", "age_scan_years", "repo_status","loop_pe_rad1_m","loop_pe_rad2_m","loop_pe_rad3_m","loop_pe_avg_m")

for (row in 1:nrow(loop_subInfo)) {
  if (loop_subInfo[row,2] == 0) {
  loop_subInfo[row,2] <- "female"
} else {
     loop_subInfo[row,2] <- "male"
}
}
```

```{r Functions, echo=FALSE, message=FALSE, results='hide'}

VarStats <- function(Data) {
  
  # Purpose of this function is to clean the data and then have it output the table i want
  
  # Data is the dataframe we want to clean up 
  
  # Cleaning  up the dataframe into a new df 
  df <- Data %>% 
      remove_empty("cols") %>% 
        filter(V1 %in% rows2grab) %>% 
          t() %>% 
            `colnames<-`(rows2grab) %>% 
                `[`(-c(1),) %>% 
                    as.data.frame()
  
  
  return(
  knitr::kable(df, row.names=F) %>% 
  kable_styling(bootstrap_options = c("striped", "hover", "condensed")) %>% 
  scroll_box(width = "800px", height = "200px"))
  
}





PrepforPlotting <- function(Data,Metric,Sex,LoopVar) {
  # Purpose of this function is to clean the data without me having to copy and paste everything later. 
  
  # Data = raw unclean dataframe we want to clean up 
  # Metric will be either MD or QA
  # sex is either male or female
  # Loop Var is either loop_pe_rad3_m or loop_pe_avg_m
  
  # Let's read in our data frame 
  
  # grab  ROIcolumn names 
  colNames <- Data  %>% remove_empty("cols") %>%
  filter(V1 == "Tract Name") %>% t() %>% `[`(-1) 
  
  
  # Let's grab our sub info 
  if (LoopVar ==  "loop_pe_rad3_m"){
    subinfo <- loop_subInfo  %>% select(c("sex", "age_scan_years", LoopVar)) %>% na.omit()
  }
  else{
     subinfo <- loop_subInfo %>% select(c("sex", "age_scan_years", LoopVar))
  }

    
  # Let's grab our values 
  if (Metric == "MD"){
    Values <- Data %>% remove_empty("cols") %>% 
     filter(str_detect(V1, c("mean_md"))) %>%
   `colnames<-`(c("Subjects",colNames)) 
  }
  else{
    Values <- Data %>%
     remove_empty("cols") %>%
      filter(str_detect(V1, c("mean_qa"))) %>% 
      filter(!str_detect(V1, c("mean_qa_post_norm"))) %>% 
  `colnames<-`(c("Subjects",colNames)) 
  }
  
  # now let's put this together 
  ConvToNum <-  apply(Values[,2:length(Values)],2, as.numeric)
  Values[,2:length(Values)] <- ConvToNum
  
  cleanedDF <- cbind(subinfo,Values) %>% filter(sex== Sex)
  
  return (cleanedDF)
}

  
SexDiffDF <- function(maleDF,femaleDF){

  maleROIS <- colnames(maleDF)
  femaleROIS <- colnames(femaleDF)
  ROIS <- intersect(maleROIS,femaleROIS)
  
  main_df <- maleDF %>% select(ROIS)
  tempdf <- femaleDF %>% select(ROIS) 
  main_df <-rbind(main_df,tempdf)

  return(main_df)
  
}




```



```{css, echo=FALSE}
h1, h2 {
  text-align: center;
  color: darkblue;
  font-weight: bold;
}
```

# Overview 
This is the analysis of white matter dsi studio connectometry for Loop clousre position error <br>  


# <span style="color: darkblue;">Methods </span> 

**Participants** 

  * Total number of scans = 120 (males and females)  
  
  * Total scans used in analysis= 118  
  * Excluded subs 329 and 372 from analyses due to bad behavior data and Subject 347 failed quality 
  control check in DSI
   * Several subjects removed because they did not have rad3 score  
<br>

**Subject numbers for Loop closure task**

  * Rad 3  
    * **All subjects**: 38
    * **Men**:  14
    * **Women**:  24
    * **Stage**:
      * **Pre**: 10
      * **Peri**:  7
      * **Post**:   7

  * Average
    * **All subjects**:  42
    * **Men**: 17
    * **Women**: 25
    * **Stage**:
      * **Pre**:  11
      * **Peri**:  7 
      * **Post**: 7  
     
**Scan parameters** 

  * Locations from UCSB and UCI
<br>

**QSIprep** 

  * Version used: 0.16.0RC3

  * The following parameters were used
    * dwi_denoise_window **5** 
    * hmc_model **3dSHORE** 
    * hmc-transform **Rigid** 
    * shoreline_iters **2**
<br>
**DSI Studio**

  * Version and tags used via singularity container: **chen-2022-07-31**
  
  * **Parameters** 
    * T-threshold = 2.5
    * Length = 25
    * Permutation = 4,000
    * pruning 4
    * non normalized QA
  
**Connectronomy analysis methods write up **
<br>

A diffusion spectrum imaging scheme was used, and a total of 128 diffusion sampling were acquired.The maximum b-value was 4990 s/mm². The in-plane resolution was 1.8 mm. The slice thickness was 1.8 mm. The accuracy of b-table orientation was examined by comparing fiber orientations with those of a population-averaged template (Yeh et al. Neuroimage, 2018). The b-table was flipped by. The diffusion data were reconstructed in the MNI space using q-space diffeomorphic reconstruction (Yeh et al., Neuroimage, 58(1):91-9, 2011) to obtain the spin distribution function (Yeh et al., IEEE TMI, ;29(9):1626-35, 2010).  A diffusion sampling length ratio of 1.25 was used. The output resolution in diffeomorphic reconstruction was 1.8 mm isotropic. The tensor metrics were calculated using DWI with b-value lower than 1750 s/mm². The quantitative anisotropy was extracted as the local connectome fingerprint (LCF, Yeh et al. PLoS Comput Biol 12(11): e1005203) and used in the connectometry analysis.</p>

Diffusion MRI connectometry (Yeh et al. NeuroImage 125 (2016): 162-171) was used to derive the correlational tractography that has QA, MD, AD, and RD correlated with Loop Position Error. A nonparametric Spearman partial correlation was used to derive the correlation, and the effect of sex, age_scan_years, and repo_status was removed using a multiple regression model. The total number of subjects varied on analysis (See Analyses and Final sample sizes above). A T-score threshold of 2.5 was assigned and tracked using a deterministic fiber tracking algorithm (Yeh et al. PLoS ONE 8(11): e80713, 2013) to obtain correlational tractography. A seeding region was placed at whole brain (39,49,29) .
<br>

 The tracks were filtered by topology-informed pruning (Yeh et al. Neurotherapeutics, 16(1), 52-58, 2019) with 4 iteration(s). A length threshold of 25 voxel distance was used to select tracks. To estimate the false discovery rate, a total of 4000 randomized permutations were applied to the group label to obtain the null distribution of the track length.</p>

<br><br><br>

<!-- # ROIs {.tabset .tabset-dropdown} -->

<!-- ## Corpus Callosum -->

<!-- ## Cerebellum -->

<!-- ## Fasciculus -->

<!-- ## Cingulum  -->

<!-- <br><br><br><br><br><br><br><br> -->

<!-- # FDR Explained -->

<!-- <br><br><br><br><br><br><br><br> -->

# Behavior

```{r calculating behavior stats}

avg_PE_1m <- mean(loop_subInfo$loop_pe_rad1_m, na.rm = TRUE)
avg_PE_2m <- mean(loop_subInfo$loop_pe_rad2_m, na.rm = TRUE)
avg_PE_3m <- mean(loop_subInfo$loop_pe_rad3_m, na.rm = TRUE)
avg_PE_averagem <- mean(loop_subInfo$loop_pe_avg_m, na.rm = TRUE)  


# Sex differences
male_PE <- loop_subInfo %>% filter(sex == "male") 
fem_PE <- loop_subInfo %>% filter(sex == "female")

# lets do a normality test  on our variables
#male

norm_male_rad3 <- shapiro.test(male_PE$loop_pe_rad3_m) # Normal
norm_male_avg <- shapiro.test(male_PE$loop_pe_avg_m) # Normal 

#female
norm_female_rad3 <- shapiro.test(fem_PE$loop_pe_rad3_m) # Normal
norm_female_avg <- shapiro.test(fem_PE$loop_pe_avg_m) #Normal

# sex differences between male and female rad3

sexdiff_Rad3 <- t.test(male_PE$loop_pe_rad3_m, fem_PE$loop_pe_rad3_m) # no significant sex diff

sexdiff_Avg <- t.test(male_PE$loop_pe_avg_m, fem_PE$loop_pe_avg_m) # no signifncat difference
```
Position error is the straight line distance between the start location and the participants end location. Participants were tested on three different sizes of circles: Radius 1m, 2m, and 3m. For white matter analysis we used the data from radius 3 and an average of performance on all three circle sizes.  The average position error on the 1m circle is **`r avg_PE_1m`**. The average position error on the 2m circle is **`r avg_PE_2m`**. The average position error on the 3m circle is **`r avg_PE_3m`**. The  average position error across all sizes is **`r avg_PE_averagem`**.

There are no significant differences in performance between men and women on the rad3 loop (t test, **p= `r sexdiff_Rad3[3]`**) or on the avergage of all circles ( **p = `r sexdiff_Avg[3]`**)

<br><br><br><br>


# Results
## <span style="color: PaleVioletRed;"> Loop Position Error Rad3 </span>  {.tabset .tabset-dropdown}
```{r,reading all QA rad3 CSVs, echo=FALSE}
Rad3_QA_all_pos <- read.delim(paste0(working_dir,'/rad3/PE/QA/allSubs/QA_loopRad3_all_pos.csv'), header=FALSE, sep="\t")
Rad3_QA_all_neg <-read.delim(paste0(working_dir,'/rad3/PE/QA/allSubs/QA_loopRad3_all_neg.csv'), header=FALSE, sep="\t")

Rad3_QA_male_pos <- read.delim(paste0(working_dir,'/rad3/PE/QA/male/QA_loopRad3_male_pos.csv'), header=FALSE, sep="\t")

Rad3_QA_female_pos <-



```  

### QA {.tabset}
#### All subjects
<span style="color: hotpink;"> Positive Correlations (FDR = 0.077333)  </span>  
```{r, QA_peRad3_all_neg, echo=FALSE}
 %>% VarStats()
```  

<br><br> 

<span class="text-center" style="color: Teal;"> Negative Correlations (FDR = 0.001964) </span>
```{r,QA_peRad3_all_pos,  echo=FALSE}
 %>% VarStats()
```

<br><br> 

<span class="text-center" style="color: Magenta;"> Figures </span>

![Slice overlay image displaying ROIs with tracts that had QA positively correlated with loop position error rad3](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/rad3/PE/QA/allSubs/loop_qa_pos_ax.png)

<br>

![Slice overlay image displaying ROIs with tracts that had QA negatively correlated with loop position error rad3](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/rad3/PE/QA/allSubs/loop_qa_neg_cor.png)

<br>

![Glass Brain displaying tracts that had QA positively and negatively correlated with loop position error rad3](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/rad3/PE/QA/allSubs/loop_pe_rad3_m.t2.length25.pos_neg.jpg)

<br><br><br><br>

#### Men
<span style="color: hotpink;"> Positive Correlations (FDR= 0.074986) </span>
```{r, QA_peRad3_male_pos,echo=FALSE}
 %>% VarStats()
```

<br><br>

<span class="text-center" style="color: Teal;"> Negative Correlations (FDR = 0.316832) </span>

Not significant

<br><br><br>

<span class="text-center" style="color: Magenta;"> Figures </span>
<br>
![Slice overlay image displaying ROIs with tracts that had QA positively correlated with loop position error rad3 in men](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/rad3/PE/QA/male/loop_qa_pos_cor.png)

<br>

![Glass Brain displaying tracts that had QA positively correlated with loop position error rad3 in men](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/rad3/PE/QA/male/loop_pe_rad3_m.t2.length25.pos_corr.jpg)

<br><br><br><br>

#### Women
<span style="color: hotpink;"> Positive Correlations (FDR = 0.076923)  </span>
```{r, QA_peRad3_female_pos,echo=FALSE}
read.delim(paste0(working_dir,'/rad3/PE/QA/female/QA_loopRad3_female_pos.csv'), header=FALSE, sep="\t") %>% VarStats()
```

<br><br> 

<span class="text-center" style="color: Teal;"> Negative Correlations (FDR = 0.000559)</span>
```{r, QA_peRad3_female_neg,echo=FALSE}
read.delim(paste0(working_dir,'/rad3/PE/QA/female/QA_loopRad3_female_neg.csv'), header=FALSE, sep="\t") %>% VarStats()
```

<br><br> 

<span class="text-center" style="color: Magenta;"> Figures </span>

<br>

![Slice overlay image displaying ROIs with tracts that had QA positively correlated with loop position error rad3 in women](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/rad3/PE/QA/female/loop_qa_pos_cor.png)

<br>

![Slice overlay image displaying ROIs with tracts that had QA negatively correlated with loop position error rad3 in women](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/rad3/PE/QA/female/loop_qa_neg_cor.png)

<br>

![Glass Brain displaying tracts that had QA positively and negatively correlated with loop position error rad3 in women](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/rad3/PE/QA/female/loop_pe_rad3_m.t2.length25.pos_neg.jpg)

<br><br><br><br>


#### pre
<span style="color: hotpink;"> Positive Correlations (FDR = 0.035113)  </span>
```{r, QA_peRad3_pre_pos,echo=FALSE}
read.delim(paste0(working_dir,'/rad3/PE/QA/pre/QA_pre_pos.csv'),header=FALSE, sep="\t") %>% VarStats()
```
<br><br> 

<span class="text-center" style="color: Teal;"> Negative Correlations  (FDR = 0.009547) </span>
```{r, QA_peRad3_pre_neg ,echo=FALSE}
read.delim(paste0(working_dir,'/rad3/PE/QA/pre/QA_pre_neg.csv'),header=FALSE, sep="\t") %>% VarStats()
```
<br><br> 

<span class="text-center" style="color: Magenta;"> Figures </span>
<br>

![Slice overlay image displaying ROIs with tracts that had QA positively correlated with loop position error rad3 in pre-menopausal women](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/rad3/PE/QA/pre/loop_qa_pos_cor.png)

<br>

![Slice overlay image displaying ROIs with tracts that had QA negatively correlated with loop position error rad3 in pre-menopausal women](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/rad3/PE/QA/pre/loop_qa_neg_cor.png)

<br>

![Glass Brain displaying tracts that had QA positively and negatively correlated with loop position error rad3 in pre-menopausal women](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/rad3/PE/QA/pre/loop_pe_rad3_m.t2.length25.pos_neg.jpg)

<br><br><br><br>

#### peri
<span style="color: hotpink;"> Positive Correlations (FDR = 0.331167)  </span>

No Significant Findings

<br><br> 

<span class="text-center" style="color: Teal;"> Negative Correlations (FDR = 0.097716)</span>
```{r,QA_peRad3_peri_neg, echo=FALSE}
read.csv(paste0(working_dir,'/rad3/PE/QA/peri/QA_peri_neg.csv'), header=FALSE) %>% VarStats()
```
<br><br> 


<span class="text-center" style="color: Magenta;"> Figures </span>
<br>

![Slice overlay image displaying ROIs with tracts that had QA negatively correlated with loop position error rad3 in peri-menopausal women](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/rad3/PE/QA/peri/looop_qa_neg_cor.png)

<br>

![Glass Brain displaying tracts that had QA positively and negatively correlated with loop position error rad3 in peri-menopausal women](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/rad3/PE/QA/peri/loop_pe_rad3_m.t2.length25.neg_corr.jpg)

<br><br><br><br>

#### post

  * No significant results
  
<br><br><br><br><br><br><br><br>

#### Peri + Post
<span style="color: hotpink;"> Positive Correlations (FDR = 0.058838) </span>
```{r, QA_peRad3_peripost_pos ,echo=FALSE}
read.csv(paste0(working_dir,'/rad3/PE/QA/peripost/QA_peri+post_pos.csv'), header=FALSE) %>% VarStats()
```

<br><br> 

<span class="text-center" style="color: Teal;"> Negative Correlations (FDR = 0.103819)</span>
```{r,QA_peRad3_peripost_neg, echo=FALSE}
read.csv(paste0(working_dir,'/rad3/PE/QA/peripost/QA_peri+post_neg.csv'), header=FALSE) %>% VarStats()
```

<br><br> 

<span class="text-center" style="color: Magenta;"> Figures </span>
<br>

![Slice overlay image displaying ROIs with tracts that had QA positively correlated with loop position error rad3 in peri and post-menopausal women](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/rad3/PE/QA/peripost/loop_qa_pos_cor.png)

<br>

![Slice overlay image displaying ROIs with tracts that had QA negatively correlated with loop position error rad3 in peri and post-menopausal women](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/rad3/PE/QA/peripost/loop_qa_neg_cor.png)

<br>

![Glass Brain displaying tracts that had QA positively and negatively correlated with loop position error rad3 in peri and post-menopausal women](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/rad3/PE/QA/peripost/loop_pe_rad3_m.t2.length25.pos_neg.jpg)

<br><br><br><br>


#### Summary of results
- QA Tractography using all subjects and controlling for age and sex reveled positive and negative correlations.   

- QA Tractography when looking at men only revealed tracts with positive correlations only. Higher QA scores were associated with higher PE scores. One way to think about this is that poor performers are showing stronger connectivity in regions that are not supporting path integration and this altered recruitment of regions may be associated with worse performance.   

- QA Tractography when looking at women only revealed tracts with negative correlations and positive. Cerebellum was the only tract that was positively correlated with PE score. suggesting that recruitment of PE may be associated with lower path integration performance. NEgative correlations suggest that stronger integrity and connectivity of these regions correlated to lower PE scores and therefore better path integration performance.  

- pre menopausal women displayed both positive and negative tracts suggesting that recruitment of certain regions are differentially associated with performance in path integration  

- Peri menopausal women displayed negative correlations with tracts in the corpus callosum, cerebellum, and several fasciculus tracts.   

-  No significant correlations in post menopausal women  

- Peri- post showed positive and negative tracts in several overlapping regions which may be due to low sample size.

<br><br><br><br>

#### Plots 

```{r, Comparing Male positive vs Female Neg QA tracts}


# prepping the data 
fem_csv <- read.delim(paste0(working_dir,'/rad3/PE/QA/female/QA_loopRad3_female_pos.csv'), header=FALSE, sep="\t") %>% PrepforPlotting(Metric = "QA",Sex = "female",LoopVar = "loop_pe_rad3_m")

male_csv <- read.delim(paste0(working_dir,'/rad3/PE/QA/male/QA_loopRad3_male_pos.csv'), header=FALSE, sep="\t") %>% PrepforPlotting(Metric = "QA",Sex = "male",LoopVar = "loop_pe_rad3_m") 

scatterdf <- SexDiffDF(male_csv,fem_csv)

# Let's get out figures

figpath <-"/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/rad3/PE/QA/SCatterplots/"
ROIcols <- colnames(scatterdf[,5:length(scatterdf)])

# positive ROIS
for (ROI in ROIcols) {
  print(ROI)
  y <-
    scatterdf %>% ggplot(aes(x = .data[[ROI]], y = loop_pe_rad3_m)) +
    geom_point(aes(color = sex), size = 4) +
    stat_smooth(aes(color = sex, group = sex), method = "lm") +
    scale_color_manual(values = c(npc_saguaro[2], npc_saguaro[4]),
                       name = "Position Error Rad3") +
    labs(x = paste(ROI),
         y = "Position Error ") +
    stat_cor(method = "spearman", aes(
      color = sex,
      label = paste(..r.label..,..rr.label.., ..p.label.., sep = "~`,`~")
    )) +
    theme(
      legend.position = "right",
      axis.text.x = element_text(size = 15),
      axis.text.y = element_text(size = 15),
      panel.background = element_blank(),
      axis.line = element_line(colour = "black"),
      #legend.key.size = unit(2, 'cm'),
      legend.title = element_text(size = 10),
      legend.text = element_text(size = 10))
      #plot.margin = margin(3, 2, 3, 2, "cm")) +
    xlim(min(scatterdf[ROI]), max(scatterdf[ROI])) 
# <!--      annotate("text", label = "FDR= 0.000576", x = 1.8 , y = 3, color="#E45A5A", size=7) + 
# <!--      annotate("text", label = "FDR= 0.022854", x = 1.8 , y = 2.8, color="#80792B", size=7)
  
   pdf(file = paste0(figpath,ROI,"QA_Rad3_PE.pdf"),width=10, height=8)
   print(y)
   dev.off()
}  
  
```

### MD {.tabset}
#### All subjects
<span style="color: hotpink;"> Positive Correlations (FDR = 1.000000) </span>

No significant results

<br><br> 

<span class="text-center" style="color: Teal;"> Negative Correlations (FDR = 0.000616)</span>
```{r, MD_peRad3_all_neg,echo=FALSE}
read.delim(paste0(working_dir,'/rad3/PE/MD/allSubs/MD_loopRad3_all_neg.csv'), header=FALSE, sep="\t") %>% VarStats()
```

<br><br> 

<span class="text-center" style="color: Magenta;"> Figures </span>
<br>

![Slice overlay image displaying ROIs with tracts that had MD negatively correlated with loop position error rad3](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/rad3/PE/MD/allSubs/loop_md_neg_cor.png)

<br>

![Glass Brain displaying tracts that had MD negatively correlated with loop position error rad3](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/rad3/PE/MD/allSubs/loop_pe_rad3_m.t2.length25.neg_corr.jpg)

<br><br><br><br>

#### Men
<span style="color: hotpink;"> Positive Correlations (FDR = 0.058621) </span>
```{r,MD_peRad3_male_pos, layout="l-body-outset",echo=FALSE}
read.delim(paste0(working_dir,'/rad3/PE/MD/male/MD_loopRad3_male_pos.csv'), header=FALSE, sep="\t") %>% VarStats()
```

<br><br> 

<span class="text-center" style="color: Teal;"> Negative Correlations (FDR = 1.000000)</span>

No significant results

<br><br> 

<span class="text-center" style="color: Magenta;"> Figures </span>
<br>

![Slice overlay image displaying ROIs with tracts that had MD positively correlated with loop position error rad3 in peri and post-menopausal women](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/rad3/PE/QA/peripost/loop_qa_pos_cor.png)

<br>

![Glass Brain displaying tracts that had MD positively correlated with loop position error rad3 in men](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/rad3/PE/MD/male/loop_pe_rad3_m.t2.length25.pos_corr.jpg)

<br><br><br><br>

#### Women
<span style="color: hotpink;"> Positive Correlations(FDR = 1.000000)  </span>

No Significant Results

<br><br> 

<span class="text-center" style="color: Teal;"> Negative Correlations (FDR = 0.000443)</span>
```{r, MD_peRad3_female_neg, echo=FALSE}
read.delim(paste0(working_dir,'/rad3/PE/MD/female/MD_loopRad3_female_neg.csv'), header=FALSE, sep="\t") %>% VarStats()
```

<br><br> 

<span class="text-center" style="color: Magenta;"> Figures </span>
<br>

![Slice overlay image displaying ROIs with tracts that had MD negatively correlated with loop position error rad3 in women](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/rad3/PE/MD/female/loop_md_neg_cor.png)

<br><br> 

![Glass Brain displaying tracts that had MD positively and negatively correlated with loop position error rad3 in women](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/rad3/PE/MD/female/loop_pe_rad3_m.t2.length25.neg_corr.jpg)

<br><br><br><br>

#### pre
<span style="color: hotpink;"> Positive Correlations (FDR = 1.000000) </span>

No Significant Results

<br><br> 

<span class="text-center" style="color: Teal;"> Negative Correlations (FDR = 0.044429)</span>
```{r,MD_peRad3_pre_neg, echo=FALSE}
read.delim(paste0(working_dir,'/rad3/PE/MD/pre/MD_pre_neg.csv'), header=FALSE, sep="\t") %>% VarStats()
```

<br><br> 

<span class="text-center" style="color: Magenta;"> Figures </span>
<br>

![Slice overlay image displaying ROIs with tracts that had MD negatively correlated with loop position error rad3 in pre-menopausal women](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/rad3/PE/MD/pre/loop_md_neg_cor.png)

<br>
![Glass Brain displaying tracts that had MD positively and negatively correlated with loop position error rad3 in pre-menopausal  women](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/rad3/PE/MD/pre/loop_pe_rad3_m.t2.length25.neg_corr.jpg)

<br><br><br><br>

#### peri
<span style="color: hotpink;"> Positive Correlations(FDR = 1.000000)  </span>

No Significant Results

<br><br> 

<span class="text-center" style="color: Teal;"> Negative Correlations (FDR = 0.017058)</span>
```{r, MD_peRad3_peri_neg,echo=FALSE}
read.delim(paste0(working_dir,'/rad3/PE/MD/peri/MD_peri_neg.csv'), header=FALSE, sep="\t") %>% VarStats()
```

<br><br> 

<span class="text-center" style="color: Magenta;"> Figures </span>
<br>

![Slice overlay image displaying ROIs with tracts that had MD negatively correlated with loop position error rad3 in peri-menopausal women](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/rad3/PE/MD/peri/loop_md_neg_ax.png)

<br><br> 

![Glass Brain displaying tracts that had MD positively and negatively correlated with loop position error rad3 in peri-menopausal  women](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/rad3/PE/MD/peri/loop_pe_rad3_m.t2.length25.neg_corr.jpg)

<br><br><br><br>

#### post
<span style="color: hotpink;"> Positive Correlations (FDR = 1.000000) </span>

No Significant Results

<br><br> 

<span class="text-center" style="color: Teal;"> Negative Correlations (FDR = 0.064410)</span>
```{r,MD_peRad3_post_neg, echo=FALSE}
read.delim(paste0(working_dir,'/rad3/PE/MD/post/MD_post_neg.csv'), header=FALSE, sep="\t") %>% VarStats()
```

<br><br> 

<span class="text-center" style="color: Magenta;"> Figures </span>
<br>

![Slice overlay image displaying ROIs with tracts that had MD negatively correlated with loop position error rad3 in post-menopausal women](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/rad3/PE/MD/post/loop_md_neg_cor.png)

<br>

![Glass Brain displaying tracts that had MD positively and negatively correlated with loop position error rad3 in post-menopausal  women](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/rad3/PE/MD/post/loop_pe_rad3_m.t2.length25.neg_corr.jpg)

<br><br><br><br>

#### Peri + Post
<span style="color: hotpink;"> Positive Correlations (FDR = 1.000000)  </span>

No Significant Results

<br><br> 

<span class="text-center" style="color: Teal;"> Negative Correlations (FDR = 0.161324)</span>
```{r,MD_peRad3_peripost_neg, echo=FALSE}
read.delim(paste0(working_dir,'/rad3/PE/MD/peripost/MD_peri+post_neg.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% VarStats()
```

<br><br> 

<span class="text-center" style="color: Magenta;"> Figures </span>
<br>

![Slice overlay image displaying ROIs with tracts that had MD negatively correlated with loop position error rad3 in peri and post-menopausal women](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/rad3/PE/MD/peripost/loop_md_neg_ax.png)

<br>

![Glass Brain displaying tracts that had MD positively and negatively correlated with loop position error rad3 in peri and post-menopausal  women](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/rad3/PE/MD/peripost/loop_pe_rad3_m.t2.length25.neg_corr.jpg)

<br><br><br><br>

#### Summary of results

- MD Tractography of all subjects, regressing age and sex, revealed tracts negatively correlated with PE score in the fornix and thalamic radiation. This suggests that subjects with lower PE score displayed increased diffusivity in these regions. Perhaps we see this because they scored so low due to having lower connectivity in these regions.

- MD Tractography of men only, regressing age , revealed tracts positively correlated with PE score. lower MD in fornix, and thalamic radiation was associated with lower PE score and therefore better performance. 

- MD Tractography of women only, regressing age , revealed tracts negatively correlated with PE score. lower MD in fornix, and thalamic radiation was associated with higher PE score. 

-  MD Tractography of pre, peri, post adn combined peri post menopausal women only, regressing age , revealed tracts negatively correlated with PE score. lower MD in fornix, and thalamic radiation was associated with higher PE score.  


<br><br><br><br><br><br> 



#### Plots 

```{r, Comparing Male positive vs Female Neg QA tracts}

# prepping the data 
fem_csv <- read.delim(paste0(working_dir,'/rad3/PE/MD/female/MD_loopRad3_female_neg.csv'), header=FALSE, sep="\t") %>% PrepforPlotting(Metric = "MD",Sex = "female",LoopVar = "loop_pe_rad3_m")

male_csv <- read.delim(paste0(working_dir,'/rad3/PE/MD/male/MD_loopRad3_male_pos.csv'), header=FALSE, sep="\t") %>% PrepforPlotting(Metric = "MD",Sex = "male",LoopVar = "loop_pe_rad3_m") 

scatterdf <- SexDiffDF(male_csv,fem_csv)

# Let's get out figures

figpath <-"/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/rad3/PE/MD/SCatterplots/"
ROIcols <- colnames(scatterdf[,5:length(scatterdf)])

# positive ROIS
for (ROI in ROIcols) {
  print(ROI)
  y <-
    scatterdf %>% ggplot(aes(x = .data[[ROI]], y = loop_pe_rad3_m)) +
    geom_point(aes(color = sex), size = 4) +
    stat_smooth(aes(color = sex, group = sex), method = "lm") +
    scale_color_manual(values = c(npc_saguaro[2], npc_saguaro[4]),
                       name = "Position Error Rad3") +
    labs(x = paste(ROI),
         y = "Position Error ") +
    stat_cor(method = "spearman", aes(
      color = sex,
      label = paste(..r.label..,..rr.label.., ..p.label.., sep = "~`,`~")
    )) +
    theme(
      legend.position = "right",
      axis.text.x = element_text(size = 15),
      axis.text.y = element_text(size = 15),
      panel.background = element_blank(),
      axis.line = element_line(colour = "black"),
      #legend.key.size = unit(2, 'cm'),
      legend.title = element_text(size = 10),
      legend.text = element_text(size = 10))
      #plot.margin = margin(3, 2, 3, 2, "cm")) +
    xlim(min(scatterdf[ROI]), max(scatterdf[ROI])) 
# <!--      annotate("text", label = "FDR= 0.000576", x = 1.8 , y = 3, color="#E45A5A", size=7) + 
# <!--      annotate("text", label = "FDR= 0.022854", x = 1.8 , y = 2.8, color="#80792B", size=7)
  
   pdf(file = paste0(figpath,ROI,"MD_Rad3_PE.pdf"),width=10, height=8)
   print(y)
   dev.off()
}  
  
```

### AD {.tabset}
```{r AD Loop position errord3  variables , echo=FALSE, results='hide',message=FALSE}
# ALL SUBS
AD_peRad3_all_pos <- read.delim(paste0(working_dir,'/rad3/PE/AD/allSubs/AD_loopRad3_all_pos.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()%>% na.omit()

AD_peRad3_all_neg <- read.delim(paste0(working_dir,'/rad3/PE/AD/allSubs/AD_loopRad3_all_neg.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame() %>% na.omit()

# MEN
AD_peRad3_male_pos <- read.delim(paste0(working_dir,'/rad3/PE/AD/male/AD_loopRad3_male_pos.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame() %>% na.omit()

AD_peRad3_male_neg <- read.delim(paste0(working_dir,'/rad3/PE/AD/male/AD_loopRad3_male_neg.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame() %>% na.omit()

# WOMEN

AD_peRad3_female_neg <- read.delim(paste0(working_dir,'/rad3/PE/AD/female/AD_loopRad3_female_neg.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame() %>% na.omit()

# PRE
AD_peRad3_pre_neg <- read.delim(paste0(working_dir,'/rad3/PE/AD/pre/AD_pre_neg.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame() %>% na.omit()

# PERI
AD_peRad3_peri_neg <- read.delim(paste0(working_dir,'/rad3/PE/AD/peri/AD_peri_neg.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame() %>% na.omit()

#POST
AD_peRad3_post_neg <- read.delim(paste0(working_dir,'/rad3/PE/AD/post/AD_post_neg.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame() %>% na.omit()

# Peri + POST
AD_peRad3_peripost_neg <- read.delim(paste0(working_dir,'/rad3/PE/AD/peripost/AD_peri+post_neg.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame() %>% na.omit()

```

#### All subjects
<span style="color: hotpink;"> Positive Correlations (FDR = 0.010526) </span>
```{r, echo=FALSE}
knitr::kable(AD_peRad3_all_pos, row.names=F)%>% 
  kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% 
  scroll_box(width = "800px", height = "100px")
```
<br><br> 

<span class="text-center" style="color: Teal;"> Negative Correlations (FDR = 0.000260)</span>
```{r, echo=FALSE}
knitr::kable(AD_peRad3_all_neg, row.names=F)%>% 
  kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% 
  scroll_box(width = "800px", height = "200px")
```
<br><br> 

<span class="text-center" style="color: Magenta;"> Figures </span>
<br>

![Slice overlay image displaying ROIs with tracts that had AD positively correlated with loop position error rad3](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/rad3/PE/QA/allSubs/loop_qa_pos_ax.png)

<br>

![Slice overlay image displaying ROIs with tracts that had AD negatively correlated with loop position error rad3](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/rad3/PE/AD/allSubs/loop_ad_pos_ax.png)

<br>

![Glass Brain displaying tracts that had AD positively and negatively correlated with loop position error rad3](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/rad3/PE/AD/allSubs/loop_pe_rad3_m.t2.length25.pos_neg.jpg)

<br><br><br><br>

#### Men
<span style="color: hotpink;"> Positive Correlations (FDR = 0.064215)  </span>
```{r, echo=FALSE}
knitr::kable(AD_peRad3_male_pos, row.names=F)%>% 
  kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% 
  scroll_box(width = "800px", height = "200px")
```
<br><br> 

<span class="text-center" style="color: Teal;"> Negative Correlations (FDR = 0.111111) </span>
```{r, echo=FALSE}
knitr::kable(AD_peRad3_male_neg, row.names=F)%>% 
  kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% 
  scroll_box(width = "800px", height = "100px")
```
<br><br> 

<span class="text-center" style="color: Magenta;"> Figures </span>
<br>

![Slice overlay image displaying ROIs with tracts that had AD positively correlated with loop position error rad3 in men](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/rad3/PE/AD/male/loop_ad_pos_ax.png)

<br>

![Slice overlay image displaying ROIs with tracts that had AD negatively correlated with loop position error rad3 in men](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/rad3/PE/AD/male/loop_ad_neg_sag.png)

<br>

![Glass Brain displaying tracts that had AD positively and negatively correlated with loop position error rad3 in men](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/rad3/PE/AD/male/loop_pe_rad3_m.t2.length25.pos_neg.jpg)


<br><br><br><br>

#### Women
<span style="color: hotpink;"> Positive Correlations (FDR = 1.000000) </span>

No significant Results

<br><br> 

<span class="text-center" style="color: Teal;"> Negative Correlations (FDR = 0.000332)</span>
```{r, echo=FALSE}
knitr::kable(AD_peRad3_female_neg, row.names=F)%>% 
  kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% 
  scroll_box(width = "800px", height = "200px")
```

<br><br> 

<span class="text-center" style="color: Magenta;"> Figures </span>
<br>

![Slice overlay image displaying ROIs with tracts that had AD negatively correlated with loop position error rad3 in women](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/rad3/PE/AD/female/loop_ad_neg_cor.png)

<br>

![Glass Brain displaying tracts that had AD negatively correlated with loop position error rad3 in women](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/rad3/PE/AD/female/loop_pe_rad3_m.t2.length25.neg_corr.jpg)

<br><br><br><br>

#### pre
<span style="color: hotpink;"> Positive Correlations (FDR = 1.000000)  </span>

No significant results

<br><br> 

<span class="text-center" style="color: Teal;"> Negative Correlations (FDR = 0.047725) </span>
```{r, echo=FALSE}
knitr::kable(AD_peRad3_pre_neg, row.names=F)%>% 
  kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% 
  scroll_box(width = "800px", height = "200px")
```

<br><br> 

<span class="text-center" style="color: Magenta;"> Figures </span>
<br>

![Slice overlay image displaying ROIs with tracts that had AD negatively correlated with loop position error rad3 pre-menopausal women](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/rad3/PE/AD/pre/loop_ad_neg_cor.png)

<br>

![Glass Brain displaying tracts that had AD negatively correlated with loop position error rad3 in pre-menopausal women](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/rad3/PE/AD/pre/loop_pe_rad3_m.t2.length25.neg_corr.jpg)

<br><br><br><br>

#### peri
<span style="color: hotpink;"> Positive Correlations (FDR = 1.000000) </span>

No significant results

<br><br> 

<span class="text-center" style="color: Teal;"> Negative Correlations (FDR = 0.008203) </span>
```{r, echo=FALSE}
knitr::kable(AD_peRad3_peri_neg, row.names=F)%>% 
  kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% 
  scroll_box(width = "800px", height = "200px")
```

<br><br> 

<span class="text-center" style="color: Magenta;"> Figures </span>
<br>

![Slice overlay image displaying ROIs with tracts that had AD negatively correlated with loop position error rad3 peri-menopausal women](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/rad3/PE/AD/peri/loop_ad_neg_corr.png)

<br>

![Glass Brain displaying tracts that had AD negatively correlated with loop position error rad3 in peri-menopausal women](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/rad3/PE/AD/peri/loop_pe_rad3_m.t2.length25.neg_corr.jpg)

<br><br><br><br>

#### post
<span style="color: hotpink;"> Positive Correlations (FDR = 1.000000) </span>

No significant results

<br><br> 

<span class="text-center" style="color: Teal;"> Negative Correlations (FDR = 0.059079) </span>
```{r, echo=FALSE}
knitr::kable(AD_peRad3_post_neg, row.names=F)%>% 
  kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% 
  scroll_box(width = "800px", height = "200px")
```

<br><br> 

<span class="text-center" style="color: Magenta;"> Figures </span>
<br>

![Slice overlay image displaying ROIs with tracts that had AD negatively correlated with loop position error rad3 post-menopausal women](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/rad3/PE/AD/post/loop_ad_neg_cor.png)

<br>

![Glass Brain displaying tracts that had AD negatively correlated with loop position error rad3 in post-menopausal women](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/rad3/PE/AD/post/loop_pe_rad3_m.t2.length25.neg_corr.jpg)

<br><br><br><br>

#### Peri + Post
<span style="color: hotpink;"> Positive Correlations (FDR = 0.652842)  </span>

No significant results

<br><br> 

<span class="text-center" style="color: Teal;"> Negative Correlations (FDR = 0.063222)</span>
```{r, echo=FALSE}
knitr::kable(AD_peRad3_peripost_neg, row.names=F)%>% 
  kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% 
  scroll_box(width = "800px", height = "200px")
```

<br><br> 

<span class="text-center" style="color: Magenta;"> Figures </span>
<br>

![Slice overlay image displaying ROIs with tracts that had AD negatively correlated with loop position error rad3 peri and post-menopausal women](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/rad3/PE/AD/peripost/loop_ad_neg_ax.png)

<br>

![Glass Brain displaying tracts that had AD negatively correlated with loop position error rad3 in peri and post-menopausal women](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/rad3/PE/AD/peripost/loop_pe_rad3_m.t2.length25.neg_corr.jpg)

<br><br><br><br>

#### Summary of results

- AD tractography of all subs showed negative and positive correlations. The majority here were negative suggesting that lower AD is associated with increased PE score. 

-AD tractography of men only showed positive and negative scores. only one region was negative and the rest of the ROIs were positive. Positive correlations suggest that lower AD is associated with lower PE score.  It may be that poor performers are recruiting these regions that are showing increased wide spread diffusivity or lower connectivity.

-AD tractography of wmen only showed negative correlations. Negative correlations suggest that lower AD is associated with higher PE scores and worse performance.  It amy be that women who have better path integration show strong recruitment of these areas.


<br><br><br><br><br><br><br><br><br> 

### RD {.tabset}
```{r RD Loop position errord3  variables , echo=FALSE, results='hide',message=FALSE}
# ALL SUBS

RD_peRad3_all_neg <- read.delim(paste0(working_dir,'/rad3/PE/RD/allSubs/RD_loopRad3_all_neg.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame() %>% na.omit()

# MEN
RD_peRad3_male_pos <- read.delim(paste0(working_dir,'/rad3/PE/RD/male/RD_loopRad3_male_pos.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame() %>% na.omit()

# WOMEN
RD_peRad3_female_neg <- read.delim(paste0(working_dir,'/rad3/PE/RD/female/RD_loopRad3_female_neg.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame() %>% na.omit()

# PRE
RD_peRad3_pre_pos <- read.delim(paste0(working_dir,'/rad3/PE/RD/pre/RD_pre_pos.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame() %>% na.omit()

RD_peRad3_pre_neg <- read.delim(paste0(working_dir,'/rad3/PE/RD/pre/RD_pre_neg.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame() %>% na.omit()

# PERI
RD_peRad3_peri_neg <- read.delim(paste0(working_dir,'/rad3/PE/RD/peri/RD_peri_neg.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame() %>% na.omit()

#POST
RD_peRad3_post_neg <- read.delim(paste0(working_dir,'/rad3/PE/RD/post/RD_post_neg.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame() %>% na.omit()

# Peri + POST

RD_peRad3_peripost_neg <- read.delim(paste0(working_dir,'/rad3/PE/RD/peripost/RD_peri+post_neg.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame() %>% na.omit()
```

#### All subjects
<span style="color: hotpink;"> Positive Correlations (FDR = 0.625000) </span>

No significant correlations

<br><br> 

<span class="text-center" style="color: Teal;"> Negative Correlations (FDR = 0.000639)</span>
```{r, echo=FALSE}
knitr::kable(RD_peRad3_all_neg, row.names=F)%>% 
  kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% 
  scroll_box(width = "800px", height = "200px")
```

<br><br> 

<span class="text-center" style="color: Magenta;"> Figures </span>
<br>

 ![Slice overlay image displaying ROIs with tracts that had RD negatively correlated with loop position error rad3](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/rad3/PE/RD/allSubs/loop_rd_neg_cor.png)
 
 <br>

![Glass Brain displaying tracts that had RD negatively correlated with loop position error rad3](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/rad3/PE/RD/allSubs/loop_pe_rad3_m.t2.length25.neg_corr.jpg)

<br><br><br><br>

#### Men
<span style="color: hotpink;"> Positive Correlations (FDR = 0.057317) </span>
```{r, echo=FALSE}
knitr::kable(RD_peRad3_male_pos, row.names=F)%>% 
  kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% 
  scroll_box(width = "800px", height = "200px")
```

<br><br> 

<span class="text-center" style="color: Teal;"> Negative Correlations Not significant (1.000000)</span>

No significant results

<br><br> 

<span class="text-center" style="color: Magenta;"> Figures </span>
<br> 

![Slice overlay image displaying ROIs with tracts that had RD positively correlated with loop position error rad3 in men](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/rad3/PE/RD/male/loop_rd_pos_cor.png)

<br>

![Glass Brain displaying tracts that had RD positively correlated with loop position error rad3 in men](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/rad3/PE/RD/male/loop_pe_rad3_m.t2.length25.pos_corr.jpg)

<br><br><br><br>

#### Women
<span style="color: hotpink;"> Positive Correlations (FDR = 1.000000) </span>

No significant results

<br><br> 

<span class="text-center" style="color: Teal;"> Negative Correlations (FDR = 0.002117)</span>
```{r, echo=FALSE}
knitr::kable(RD_peRad3_female_neg, row.names=F)%>% 
  kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% 
  scroll_box(width = "800px", height = "200px")
```

<br><br> 

<span class="text-center" style="color: Magenta;"> Figures </span>
<br> 

![Slice overlay image displaying ROIs with tracts that had RD negatively correlated with loop position error rad3](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/rad3/PE/RD/female/loop_rd_neg_cor.png)
<br>

![Glass Brain displaying tracts that had RD positively correlated with loop position error rad3](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/rad3/PE/RD/allSubs/loop_pe_rad3_m.t2.length25.neg_corr.jpg)

<br><br><br><br>

#### pre
<span style="color: hotpink;"> Positive Correlations (FDR = 1.000000) </span>

No significant correlations

<br><br> 

<span class="text-center" style="color: Teal;"> Negative Correlations (FDR = 0.033719)</span>
```{r, echo=FALSE}
knitr::kable(RD_peRad3_pre_neg, row.names=F)%>% 
  kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% 
  scroll_box(width = "800px", height = "200px")
```

<br><br> 

<span class="text-center" style="color: Magenta;"> Figures </span>
<br> 

![Slice overlay image displaying ROIs with tracts that had RD negatively correlated with loop position error rad3 in peri menopausal women](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/rad3/PE/RD/pre/loop_rd_neg_cor.png)

<br>

![Glass Brain displaying tracts that had RD negatively correlated with loop position error rad3](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/rad3/PE/RD/pre/loop_pe_rad3_m.t2.length25.neg_corr.jpg)

<br><br><br><br> 

#### peri
<span style="color: hotpink;"> Positive Correlations (FDR = 1.000000) </span>

No significant results

<br><br> 

<span class="text-center" style="color: Teal;"> Negative Correlations (FDR = 0.016568)</span>
```{r, echo=FALSE}
knitr::kable(RD_peRad3_peri_neg, row.names=F)%>% 
  kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% 
  scroll_box(width = "800px", height = "200px")
```

<br><br> 

<span class="text-center" style="color: Magenta;"> Figures </span>
<br> 

![Slice overlay image displaying ROIs with tracts that had RD negatively correlated with loop position error rad3 in peri menopausal women](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/rad3/PE/RD/peri/loop_rd_neg_cor.png)

<br>

![Glass Brain displaying tracts that had RD negatively correlated with loop position error rad3 in peri menopausal women](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/rad3/PE/RD/peri/loop_pe_rad3_m.t2.length25.neg_corr.jpg)

<br><br><br><br>

#### post
<span style="color: hotpink;"> Positive Correlations (FDR = 1.000000)</span>

No significant results

<br><br> 

<span class="text-center" style="color: Teal;"> Negative Correlations (FDR = .065219))</span>
```{r, echo=FALSE}
knitr::kable(RD_peRad3_all_neg, row.names=F)%>% 
  kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% 
  scroll_box(width = "800px", height = "200px")
```

<br><br>

<span class="text-center" style="color: Magenta;"> Figures </span>
<br> 

![Slice overlay image displaying ROIs with tracts that had RD negatively correlated with loop position error rad3 in post menopausal women](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/rad3/PE/RD/post/loop_rd_neg_cor.png)

<br>

![Glass Brain displaying tracts that had RD negatively correlated with loop position error rad3 in post menopausal women](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/rad3/PE/RD/post/loop_pe_rad3_m.t2.length25.neg_corr.jpg)

<br><br><br><br>


#### Peri + Post
<span style="color: hotpink;"> Positive Correlations (FDR = 1.000000)  </span>

Not significant

<br><br> 

<span class="text-center" style="color: Teal;"> Negative Correlations (FDR = 0.157199)</span>
```{r, echo=FALSE}
knitr::kable(RD_peRad3_peripost_neg, row.names=F)%>% 
  kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% 
  scroll_box(width = "800px", height = "200px")
```

<br><br> 

<span class="text-center" style="color: Magenta;"> Figures </span>
<br> 

![Slice overlay image displaying ROIs with tracts that had RD positively correlated with loop position error rad3 in peri and post menopausal women](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/rad3/PE/RD/peripost/loop_rd_pos_cor.png)

<br>

![Slice overlay image displaying ROIs with tracts that had RD negatively correlated with loop position error rad3 in peri and post menopausal women](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/rad3/PE/RD/peripost/loop_rd_neg_cor.png)

<br>

![Glass Brain displaying tracts that had RD positively and negatively correlated with loop position error rad3 in peripost menopausal women](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/rad3/PE/RD/peripost/loop_pe_rad3_m.t2.length25.pos_neg.jpg)


<br><br><br><br>


#### Summary of results

- RD tractography of all subs showed negative correlations. Suggesting that higher RD is associated with decreased PE score.  Better performers have increased RD in fornix, perhaps they are not using these regions to complete the task. part of the reson they may have done so poorly is because they attempted to rely on fornix and there's less connectivity there.

-AD tractography of men only showed positive and negative scores. only one region was negative and the rest of the ROIs were positive. Positive correlations suggest that lower AD is associated with lower PE score.  It may be that poor performers are recruiting these regions that are showing increased wide spread diffusivity or lower connectivity.

-AD tractography of wmen only showed negative correlations. Negative correlations suggest that lower AD is associated with higher PE scores and worse performance.  It amy be that women who have better path integration show strong recruitment of these areas.


Tracts with RD displayed negative correlations with PE. In men, this was opposite with men displaying positive correlations. Women, and those in the peri and post stages  displayed negative correlations. Those in the pre and peri+post group displayed positive and negative correlations.

<br><br><br><br><br><br> 

### Overall Summary 

Loop task is more dependent on egocentric regions which may be why we see that better performers are those that have better QA in regions not in parietal lobe. 

Men's performance suggest that those with lower PE scores are relying on stronger connectivity in fornix regions and less in cerebellum and corpus callosum. 

While women may be relying on regions such as corpus callosum, cingulum, fasciculus over fornix to perform better.




## <span style="color: PaleVioletRed;"> Loop Position Error Average </span>  {.tabset .tabset-dropdown}
### QA {.tabset}
#### All subjects
<span style="color: hotpink;"> Positive Correlations (FDR = 0.000547)  </span>  
```{r, QA_peAvg_all_pos, echo=FALSE}
read.delim(paste0(working_dir,'/average/PE/QA/allSubs/QA_loopAvgPE_allsubs_pos.csv'), header = FALSE, sep = "\t") %>% VarStats()
```  

<br><br> 

<span class="text-center" style="color: Teal;"> Negative Correlations (FDR = 0.015697) </span>
```{r, QA_peAvg_all_neg, echo=FALSE}
read.delim(paste0(working_dir,'/average/PE/QA/allSubs/QA_loopAvgPE_allsubs_neg.csv'), header = FALSE, sep = "\t") %>% VarStats()

```

<br><br> 

<span class="text-center" style="color: Magenta;"> Figures </span>

![Slice overlay image displaying ROIs with tracts that had QA positively correlated with loop position error average](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/QA/allSubs/loop_avg_PE_qa_all_pos_ax.png)

<br>

![Slice overlay image displaying ROIs with tracts that had QA negatively correlated with loop position error average](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/QA/allSubs/loop_avg_PE_qa_all_neg_ax.png)

<br>

![Glass Brain displaying tracts that had QA positively and negatively correlated with loop position error average](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/QA/allSubs/loop_pe_avg_m.t2.length25.pos_neg.jpg)

<br><br><br><br><br><br>

#### Men

<span style="color: hotpink;"> Positive Correlations (FDR = 0.154305)  </span>  
```{r,QA_peAvg_male_pos,  echo=FALSE}

read.delim(paste0(working_dir,'/average/PE/QA/male/QA_loopAvgPE_male_pos.csv'), header = FALSE, sep = "\t") %>% VarStats()
```  

<br><br> 

<span class="text-center" style="color: Teal;"> Negative Correlations (FDR = 0.036522) </span>
```{r,  QA_loopAvgPE_male_neg, echo=FALSE}
read.delim(paste0(working_dir,'/average/PE/QA/male/QA_loopAvgPE_male_neg.csv'), header = FALSE, sep = "\t") %>% VarStats()

```

<br><br> 

<span class="text-center" style="color: Magenta;"> Figures </span>

![Slice overlay image displaying ROIs with tracts that had QA positively correlated with loop position error average](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/QA/male/loop_avg_PE_qa_male_pos_ax.png)

<br>

![Slice overlay image displaying ROIs with tracts that had QA negatively correlated with loop position error average](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/QA/male/loop_avg_PE_qa_male_neg_ax.png)

<br>

![Glass Brain displaying tracts that had QA positively and negatively correlated with loop position error average](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/QA/male/loop_pe_avg_m.t2.length25.pos_neg.jpg)

<br><br><br><br><br><br>

#### Women

<span style="color: hotpink;"> Positive Correlations (FDR = 0.008475)  </span>  
```{r, QA_peAvg_female_pos, echo=FALSE}
read.delim(
    paste0(working_dir,'/average/PE/QA/female/QA_loopAvgPE_fem_pos.csv'), header = FALSE, sep = "\t") %>% VarStats()
```  

<br><br> 

<span class="text-center" style="color: Teal;"> Negative Correlations (FDR = 0.000699) </span>
```{r, QA_peAvg_female_neg ,echo=FALSE}
read.delim(
    paste0(working_dir,'/average/PE/QA/female/QA_loopAvgPE_neg_pos.csv'), header = FALSE, sep = "\t") %>% VarStats()
```

<br><br> 

<span class="text-center" style="color: Magenta;"> Figures </span>

![Slice overlay image displaying ROIs with tracts that had QA positively correlated with loop position error average](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/QA/female/loop_avg_PE_qa_fem_pos_ax.png)

<br>

![Slice overlay image displaying ROIs with tracts that had QA negatively correlated with loop position error average](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/QA/female/loop_avg_PE_qa_fem_neg_ax.png)

<br>

![Glass Brain displaying tracts that had QA positively and negatively correlated with loop position error average](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/QA/female/loop_avg_PE_qa_fem_pos_ax.png)
<br><br><br><br><br><br>

#### pre

<span style="color: hotpink;"> Positive Correlations (FDR = 0.041934)  </span>  
```{r, QA_peAvg_pre_pos, echo=FALSE}

read.delim(
    paste0(working_dir,'/average/PE/QA/pre/QA_looPAvgPE_pre_pos.csv'), header = FALSE, sep = "\t") %>% VarStats()
```  

<br><br> 

<span class="text-center" style="color: Teal;"> Negative Correlations (FDR = 0.007904) </span>
```{r, QA_peAvg_pre_neg, echo=FALSE}
read.delim(
    paste0(working_dir,'/average/PE/QA/pre/QA_looPAvgPE_pre_neg.csv'), header = FALSE, sep = "\t") %>% VarStats()
```

<br><br> 

<span class="text-center" style="color: Magenta;"> Figures </span>

![Slice overlay image displaying ROIs with tracts that had QA positively correlated with loop position error average](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/QA/pre/loop_avg_PE_qa_pre_pos_ax.png)

<br>

![Slice overlay image displaying ROIs with tracts that had QA negatively correlated with loop position error average](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/QA/pre/loop_avg_PE_qa_pre_neg_ax.png)

<br>

![Glass Brain displaying tracts that had QA positively and negatively correlated with loop position error average](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/QA/pre/loop_pe_avg_m.t2.length25.pos_neg.jpg)

<br><br><br><br><br><br>

#### peri

<span style="color: hotpink;"> Positive Correlations (FDR = 0.649718)  </span>  

<br><br> 

<span class="text-center" style="color: Teal;"> Negative Correlations (FDR = 0.020944) </span>
```{r, QA_peAvg_peri_neg, echo=FALSE}
read.delim(paste0(working_dir,'/average/PE/QA/peri/QA_LoopAvgPE_peri_neg.csv'), header = FALSE, sep = "\t") %>% VarStats()

```

<br><br> 

<span class="text-center" style="color: Magenta;"> Figures </span>
<br>

![Slice overlay image displaying ROIs with tracts that had QA negatively correlated with loop position error average](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/QA/peri/loop_avg_PE_qa_peri_neg_ax.png)

<br>

![Glass Brain displaying tracts that had QA positively and negatively correlated with loop position error average](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/QA/peri/loop_pe_avg_m.t2.length25.neg_corr.jpg)


<br><br><br><br><br><br>

#### post

<span style="color: hotpink;"> Positive Correlations (FDR = 1.000000)  </span>  

<br><br> 

<span class="text-center" style="color: Teal;"> Negative Correlations (FDR = 0.140042) </span>
```{r, QA_peAvg_post_neg, echo=FALSE}
read.delim(
    paste0(working_dir,'/average/PE/QA/post/QA_loopAvgPE_post_neg.csv'), header = FALSE, sep = "\t") %>% VarStats()
```

<br><br> 

<span class="text-center" style="color: Magenta;"> Figures </span>
<br>

![Slice overlay image displaying ROIs with tracts that had QA negatively correlated with loop position error average](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/QA/post/loop_avg_PE_qa_post_neg_cor.png)

<br>

![Glass Brain displaying tracts that had QA positively and negatively correlated with loop position error average](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/QA/post/loop_pe_avg_m.t2.length25.pos_neg.jpg)

<br><br><br><br><br><br>

#### Peri  and Post

<span style="color: hotpink;"> Positive Correlations (FDR = 0.000776)  </span>  

```{r,QA_peAvg_peripost_pos, echo=FALSE}
read.delim(
    paste0(working_dir,'/average/PE/QA/peri_post/QA_loopAvgPE_peripost_pos.csv'),     header = FALSE, sep = "\t") %>% VarStats()
```

<br><br> 

<span class="text-center" style="color: Teal;"> Negative Correlations (FDR = 0.000529) </span>
```{r, QA_peAvg_peripost_neg , echo=FALSE}
read.delim(
    paste0(working_dir,'/average/PE/QA/peri_post/QA_loopAvgPE_peripost_neg.csv'), header = FALSE, sep = "\t") %>% VarStats()
```

<br><br> 

<span class="text-center" style="color: Magenta;"> Figures </span>

<!-- ![Slice overlay image displaying ROIs with tracts that had QA positively correlated with loop position error average]() -->

<br>

![Slice overlay image displaying ROIs with tracts that had QA negatively correlated with loop position error average](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/QA/peri_post/loop_pe_avg_m.t2.length25.pos_neg.jpg)

<br>

![Glass Brain displaying tracts that had QA positively and negatively correlated with loop position error average](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/QA/peri_post/loop_pe_avg_m.t2.length25.pos_neg.jpg)
<br><br><br><br><br><br>

#### Summary 
####Plots
```{r, Comparing QA Male Neg and Female Negative position error}

# prepping the data 
fem_csv <- read.delim(
    paste0(working_dir,'/average/PE/QA/female/QA_loopAvgPE_neg_pos.csv'), header = FALSE, sep = "\t") %>% PrepforPlotting(Metric = "QA",Sex ="female",LoopVar = "loop_pe_avg_m")

male_csv <- read.delim(paste0(working_dir,'/average/PE/QA/male/QA_loopAvgPE_male_neg.csv'), header = FALSE, sep = "\t")  %>% PrepforPlotting(Metric = "QA",Sex = "male",LoopVar = "loop_pe_avg_m") 

scatterdf <- SexDiffDF(male_csv,fem_csv)

# Let's get out figures

figpath <-"/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/QA/scatterplots/"
ROIcols <- colnames(scatterdf[5])

# positive ROIS
  y <-
    scatterdf %>% ggplot(aes(x = Corpus_Callosum_Tapetum, y = loop_pe_avg_m)) +
    geom_point(aes(color = sex), size = 4) +
    stat_smooth(aes(color = sex, group = sex), method = "lm") +
    scale_color_manual(values = c(npc_saguaro[2], npc_saguaro[4]),
                       name = "Position Error Average") +
    labs(x = paste(ROIcols),
         y = "Position Error ") +
    stat_cor(method = "spearman", aes(
      color = sex,
      label = paste(..r.label..,..rr.label.., ..p.label.., sep = "~`,`~")
    )) +
    theme(
      legend.position = "right",
      axis.text.x = element_text(size = 15),
      axis.text.y = element_text(size = 15),
      panel.background = element_blank(),
      axis.line = element_line(colour = "black"),
      #legend.key.size = unit(2, 'cm'),
      legend.title = element_text(size = 10),
      legend.text = element_text(size = 10))
      #plot.margin = margin(3, 2, 3, 2, "cm")) +
    xlim(min(scatterdf$Corpus_Callosum_Tapetum), max(scatterdf$Corpus_Callosum_Tapetum)) 
# <!--      annotate("text", label = "FDR= 0.000576", x = 1.8 , y = 3, color="#E45A5A", size=7) + 
# <!--      annotate("text", label = "FDR= 0.022854", x = 1.8 , y = 2.8, color="#80792B", size=7)
  
   pdf(file = paste0(figpath,ROI,"QA_Avg_PE.pdf"),width=10, height=8)
   print(y)
   dev.off()
  
```
<br><br><br><br>

### MD {.tabset}
#### All subjects
<span style="color: hotpink;"> Positive Correlations (FDR = 0.997701)  </span>  

<br><br> 

<span class="text-center" style="color: Teal;"> Negative Correlations (FDR = 0.019688	) </span>
```{r, MD_peAvg_all_neg,echo=FALSE}
read.delim(paste0(working_dir,'/average/PE/MD/allSubs/avg_MD_pe_all_neg.csv'), header = FALSE, sep = "\t") %>% VarStats()
```

<br><br> 

<span class="text-center" style="color: Magenta;"> Figures </span>

![Slice overlay image displaying ROIs with tracts that had QA negatively correlated with loop position error average](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/MD/allSubs/loop_avg_PE_md_all_neg_ax.png)

<br>

![Glass Brain displaying tracts that had QA positively and negatively correlated with loop position error average](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/MD/allSubs/loop_pe_avg_m.t2.length25.neg_corr.jpg)

<br><br><br><br><br><br>

#### Men

<span style="color: hotpink;"> Positive Correlations (FDR = 0.022854	)  </span>  
```{r, MD_peAvg_male_pos,echo=FALSE}
read.delim(
    paste0(working_dir,'/average/PE/MD/male/avg_MD_pe_male_pos.csv'), header = FALSE, sep = "\t") %>% VarStats()
```

<br><br> 

<span class="text-center" style="color: Teal;"> Negative Correlations (FDR = 0.247381) </span>

No significant tracts

<br><br> 

<span class="text-center" style="color: Magenta;"> Figures </span>

![Slice overlay image displaying ROIs with tracts that had QA positively correlated with loop position error average](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/MD/male/loop_avg_PE_md_male_pos_ax.png)

<br>

![Glass Brain displaying tracts that had QA positively and negatively correlated with loop position error average](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/MD/male/loop_pe_avg_m.t2.length25.pos_corr.jpg)

<br><br><br><br><br><br>

#### Women
<span style="color: hotpink;"> Positive Correlations (FDR = 0.125000)  </span>  

no significant tracts

<br><br> 

<span class="text-center" style="color: Teal;"> Negative Correlations (FDR = 0.000576	) </span>

```{r, MD_peAvg_female_neg, echo=FALSE}
 read.delim(
    paste0(working_dir,'/average/PE/MD/female/avg_MD_pe_fem_neg.csv'), header = FALSE, sep = "\t") %>% VarStats()
```
<br><br> 

<span class="text-center" style="color: Magenta;"> Figures </span>
<br>

![Slice overlay image displaying ROIs with tracts that had QA negatively correlated with loop position error average](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/MD/female/loop_avg_PE_md_fem_neg_ax.png)

<br>

![Glass Brain displaying tracts that had QA positively and negatively correlated with loop position error average](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/MD/female/loop_pe_avg_m.t2.length25.neg_corr.jpg)
<br><br><br><br><br><br>

#### pre
<span style="color: hotpink;"> Positive Correlations (FDR = 1.0000)  </span>  

no significant tracts

<br><br> 

<span class="text-center" style="color: Teal;"> Negative Correlations (FDR = 0.033976) </span>

```{r,MD_peAvg_pre_neg, echo=FALSE}
read.delim(
    paste0(working_dir,'/average/PE/MD/pre/avg_MD_pe_pre_neg.csv'), header = FALSE, sep = "\t") %>% VarStats()
```
<br><br> 

<span class="text-center" style="color: Magenta;"> Figures </span>
<br>

![Slice overlay image displaying ROIs with tracts that had MD negatively correlated with loop position error average](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/MD/pre/loop_avg_PE_pre_neg_ax.png)

<br>

![Glass Brain displaying tracts that had MD positively and negatively correlated with loop position error average](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/MD/pre/loop_pe_avg_m.t2.length25.neg_corr.jpg)

<br><br><br><br><br><br>

#### peri
<span style="color: hotpink;"> Positive Correlations (FDR = 1.0000)  </span>  

no significant tracts

<br><br> 

<span class="text-center" style="color: Teal;"> Negative Correlations (FDR = 0.016885) </span>

```{r,MD_peAvg_peri_neg, echo=FALSE}
read.delim(
    paste0(working_dir,'/average/PE/MD/peri/avg_MD_pe_peri_neg.csv'), header = FALSE, sep = "\t") %>% VarStats()

```
<br><br> 

<span class="text-center" style="color: Magenta;"> Figures </span>
<br>

![Slice overlay image displaying ROIs with tracts that had MD negatively correlated with loop position error average](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/MD/peri/loop_avg_PE_md_peri_neg_ax.png)

<br>

![Glass Brain displaying tracts that had MD positively and negatively correlated with loop position error average](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/MD/peri/loop_pe_avg_m.t2.length25.neg_corr.jpg)

<br><br><br><br><br><br>

#### post
<span style="color: hotpink;"> Positive Correlations (FDR = 1.0000)  </span>  

no significant tracts

<br><br> 

<span class="text-center" style="color: Teal;"> Negative Correlations (FDR = 0.081145) </span>

```{r,MD_peAvg_post_neg, echo=FALSE}
read.delim(
    paste0(working_dir,'/average/PE/MD/post/avg_MD_pe_post_neg.csv'), header = FALSE, sep = "\t") %>% VarStats()
```
<br><br> 

<span class="text-center" style="color: Magenta;"> Figures </span>
<br>

![Slice overlay image displaying ROIs with tracts that had MD negatively correlated with loop position error average](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/MD/post/loop_avg_PE_md_post_neg_ax.png)

<br>

![Glass Brain displaying tracts that had MD positively and negatively correlated with loop position error average](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/MD/post/loop_pe_avg_m.t2.length25.neg_corr.jpg)

<br><br><br><br><br><br>

#### PEri  Post

<span style="color: hotpink;"> Positive Correlations (FDR = 0.411765)  </span>  

no significant tracts

<br><br> 

<span class="text-center" style="color: Teal;"> Negative Correlations (FDR = 0.050080) </span>

```{r,MD_peAvg_peripost_neg , echo=FALSE}
read.delim(
    paste0(working_dir,'/average/PE/MD/peri_post/avg_MD_pe_peri+post_neg.csv'), header = FALSE, sep = "\t") %>% VarStats()
```
<br><br> 

<span class="text-center" style="color: Magenta;"> Figures </span>
<br>

![Slice overlay image displaying ROIs with tracts that had MD negatively correlated with loop position error average](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/MD/peri_post/loop_avg_PE-md_peri+post_neg_ax.png)

<br>

![Glass Brain displaying tracts that had MD positively and negatively correlated with loop position error average](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/MD/peri_post/loop_pe_avg_m.t2.length25.pos_neg.jpg)

<br><br><br><br><br><br>

#### Summary 

<br><br><br>

#### Scatter Plots

Men and women have the following tracts in common for MD
- Fornix L
- Fornix R
- Thalamic Radiation Superior L

For men there is a positive association and for women there is a negative association
```{r, Comparing MD Average Male pos and Female Negative}

# prepping the data 
fem_csv <- read.delim(
    paste0(working_dir,'/average/PE/MD/female/avg_MD_pe_fem_neg.csv'), header = FALSE, sep = "\t") %>% PrepforPlotting(Metric = "MD",Sex ="female",LoopVar = "loop_pe_avg_m")

male_csv <- read.delim(paste0(working_dir,'/average/PE/MD/male/avg_MD_pe_male_pos.csv'), header = FALSE, sep = "\t")  %>% PrepforPlotting(Metric = "MD",Sex = "male",LoopVar = "loop_pe_avg_m") 

scatterdf <- SexDiffDF(male_csv,fem_csv)

# Let's get out figures

figpath <-"/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/MD/scatterplots/"
ROIcols <- colnames(scatterdf[,5:length(scatterdf)])

# positive ROIS
  for (ROI in ROIcols) {
  print(ROI)
  y <-
    scatterdf %>% ggplot(aes(x = .data[[ROI]], y = loop_pe_avg_m)) +
    geom_point(aes(color = sex), size = 4) +
    stat_smooth(aes(color = sex, group = sex), method = "lm") +
    scale_color_manual(values = c(npc_saguaro[2], npc_saguaro[4]),
                       name = "Position Error Average") +
    labs(x = paste(ROI),
         y = "Position Error ") +
    stat_cor(method = "spearman", aes(
      color = sex,
      label = paste(..r.label..,..rr.label.., ..p.label.., sep = "~`,`~")
    )) +
    theme(
      legend.position = "right",
      axis.text.x = element_text(size = 15),
      axis.text.y = element_text(size = 15),
      panel.background = element_blank(),
      axis.line = element_line(colour = "black"),
      #legend.key.size = unit(2, 'cm'),
      legend.title = element_text(size = 10),
      legend.text = element_text(size = 10))
      #plot.margin = margin(3, 2, 3, 2, "cm")) +
    xlim(min(scatterdf[ROI]), max(scatterdf[ROI])) 
# <!--      annotate("text", label = "FDR= 0.000576", x = 1.8 , y = 3, color="#E45A5A", size=7) + 
# <!--      annotate("text", label = "FDR= 0.022854", x = 1.8 , y = 2.8, color="#80792B", size=7)
  
   pdf(file = paste0(figpath,ROI,"MD_Average_PE.pdf"),width=10, height=8)
   print(y)
   dev.off()
}  
```


### AD {.tabset}

```{r AD PE Average variables , echo=FALSE, results='hide',message=FALSE}

## all subs ####

AD_peAvg_all_neg <-
  read.delim(
    paste0(working_dir,'/average/PE/AD/allSubs/avg_AD_pe_all_neg.csv'), header = FALSE, sep = "\t") %>% 
      remove_empty("cols") %>% 
        filter(V1 %in% rows2grab) %>% 
          t() %>% 
            `colnames<-`(rows2grab) %>% 
                `[`(-c(1),) %>% 
                    as.data.frame()

AD_peAvg_all_pos <-
  read.delim(
    paste0(working_dir,'/average/PE/AD/allSubs/avg_AD_pe_all_pos.csv' ),header = FALSE,sep = "\t") %>% 
    remove_empty("cols")  %>% 
      filter(V1 %in% rows2grab) %>%
        t() %>% 
          `colnames<-`(rows2grab) %>% 
              as.data.frame() %>% 
                `[`(-c(1),) 


### Males ####
AD_peAvg_male_neg <-
  read.delim(
    paste0(working_dir,'/average/PE/AD/male/avg_AD_pe_male_neg.csv'),
    header = FALSE, sep = "\t") %>% 
      remove_empty("cols") %>%  
        filter(V1 %in% rows2grab) %>% 
          t() %>% 
            `colnames<-`(rows2grab) %>% 
              `[`(-c(1),) %>% 
                as.data.frame()

AD_peAvg_male_pos <-
  read.delim(
    paste0(working_dir,'/average/PE/AD/male/avg_AD_pe_male_pos.csv'),
    header = FALSE,sep = "\t") %>% 
      remove_empty("cols") %>%  
        filter(V1 %in% rows2grab) %>% 
          t() %>% 
            `colnames<-`(rows2grab) %>% 
              `[`(-c(1),) %>% 
                as.data.frame()
### Females#####

AD_peAvg_female_neg <-
  read.delim(
    paste0(working_dir,'/average/PE/AD/female/avg_AD_pe_fem_neg.csv'),
    header = FALSE,sep = "\t") %>% 
      remove_empty("cols") %>%  
        filter(V1 %in% rows2grab) %>% 
          t() %>% 
            `colnames<-`(rows2grab) %>% 
              `[`(-c(1),) %>% 
                as.data.frame()

AD_peAvg_female_pos <-
  read.delim(
    paste0(working_dir,'/average/PE/AD/female/avg_AD_pe_fem_pos.csv'),
    header = FALSE,sep = "\t") %>% 
      remove_empty("cols") %>%  
        filter(V1 %in% rows2grab) %>% 
          t() %>% 
            `colnames<-`(rows2grab)%>% 
                as.data.frame() %>% 
                  `[`(-c(1),) 


###PRE ####

AD_peAvg_pre_neg <-
  read.delim(
    paste0(working_dir,'/average/PE/AD/pre/avg_AD_pe_pre_neg.csv'),
    header = FALSE,sep = "\t") %>% 
      remove_empty("cols") %>%  
        filter(V1 %in% rows2grab) %>% 
          t() %>% 
            `colnames<-`(rows2grab) %>% 
              `[`(-c(1),) %>% 
                as.data.frame()


### PERI ####
AD_peAvg_peri_neg <-
  read.delim(
    paste0(working_dir,'/average/PE/AD/peri/avg_AD_pe_peri_neg.csv'),
    header = FALSE,sep = "\t") %>% 
      remove_empty("cols") %>%  
        filter(V1 %in% rows2grab) %>% 
          t() %>% 
            `colnames<-`(rows2grab) %>% 
              `[`(-c(1),) %>% 
                as.data.frame()

### POST ####

AD_peAvg_post_neg <-
  read.delim(
    paste0(working_dir,'/average/PE/AD/post/avg_AD_pe_post_neg.csv'),
    header = FALSE,sep = "\t") %>% 
      remove_empty("cols") %>%  
        filter(V1 %in% rows2grab) %>% 
          t() %>% 
            `colnames<-`(rows2grab) %>% 
              `[`(-c(1),) %>% 
                as.data.frame()

### PERI and POST ####

AD_peAvg_peripost_neg <-
  read.delim(
    paste0(working_dir,'/average/PE/AD/peri_post/avg_AD_pe_peri+post_neg.csv' ),
    header = FALSE,sep = "\t") %>% 
      remove_empty("cols") %>%  
        filter(V1 %in% rows2grab) %>% 
          t() %>% 
            `colnames<-`(rows2grab) %>% 
              `[`(-c(1),) %>% 
                as.data.frame()


```

#### All subjects

<span style="color: hotpink;"> Positive Correlations (FDR = 0.122995)  </span>  
```{r, echo=FALSE}
knitr::kable(AD_peAvg_all_pos, row.names=F) %>% 
  kable_styling(bootstrap_options = c("striped", "hover", "condensed")) %>% 
  scroll_box(width = "800px", height = "200px")
```  

<br><br> 

<span class="text-center" style="color: Teal;"> Negative Correlations (FDR = 0.016199) </span>
```{r, echo=FALSE}
knitr::kable(AD_peAvg_all_neg, row.names=F)%>% 
  kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% 
  scroll_box(width = "800px", height = "200px")
```

<br><br> 

<span class="text-center" style="color: Magenta;"> Figures </span>

![Slice overlay image displaying ROIs with tracts that had AD positively correlated with loop position error average](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/AD/allSubs/loop_avg_PE_rd_all_pos_ax.png)

<br>

![Slice overlay image displaying ROIs with tracts that had AD negatively correlated with loop position error average](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/AD/allSubs/loop_avg_PE_rd_all_neg_ax.png)

<br>

![Glass Brain displaying tracts that had AD positively and negatively correlated with loop position error average](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/AD/allSubs/loop_pe_avg_m.t2.length25.pos_neg.jpg)



<br><br><br><br><br><br>

#### Men

<span style="color: hotpink;"> Positive Correlations (FDR = 0.022862)  </span>  
```{r, echo=FALSE}
knitr::kable(AD_peAvg_male_pos, row.names=F) %>% 
  kable_styling(bootstrap_options = c("striped", "hover", "condensed")) %>% 
  scroll_box(width = "800px", height = "200px")
```  

<br><br> 

<span class="text-center" style="color: Teal;"> Negative Correlations (FDR = 0.019520) </span>
```{r, echo=FALSE}
knitr::kable(AD_peAvg_male_neg, row.names=F)%>% 
  kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% 
  scroll_box(width = "800px", height = "200px")
```

<br><br> 

<span class="text-center" style="color: Magenta;"> Figures </span>

![Slice overlay image displaying ROIs with tracts that had AD positively correlated with loop position error average](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/AD/male/loop_avg_PE_ad_male_pos_cor.png)

<br>

![Slice overlay image displaying ROIs with tracts that had AD negatively correlated with loop position error average](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/AD/male/loop_avg_PE_ad_male_neg_ax.png)

<br>

![Glass Brain displaying tracts that had AD positively and negatively correlated with loop position error average](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/AD/male/loop_pe_avg_m.t2.length25.pos_neg.jpg)


<br><br><br><br><br><br>

#### Women
<span style="color: hotpink;"> Positive Correlations (FDR = 0.037037)  </span>  
```{r, echo=FALSE}
knitr::kable(AD_peAvg_female_pos, row.names=F) %>% 
  kable_styling(bootstrap_options = c("striped", "hover", "condensed")) %>% 
  scroll_box(width = "800px", height = "200px")
```  

<br><br> 

<span class="text-center" style="color: Teal;"> Negative Correlations (FDR = 0.000098) </span>
```{r, echo=FALSE}
knitr::kable(AD_peAvg_female_neg, row.names=F)%>% 
  kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% 
  scroll_box(width = "800px", height = "200px")
```

<br><br> 

<span class="text-center" style="color: Magenta;"> Figures </span>

![Slice overlay image displaying ROIs with tracts that had AD positively correlated with loop position error average](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/AD/female/loop_avg_PE_ad_female_pos_ax.png)

<br>

![Slice overlay image displaying ROIs with tracts that had AD negatively correlated with loop position error average](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/AD/female/loop_avg_PE_ad_female_neg_ax.png)

<br>

![Glass Brain displaying tracts that had AD positively and negatively correlated with loop position error average](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/AD/female/loop_pe_avg_m.t2.length25.pos_neg.jpg)

<br><br><br><br><br><br>

#### pre
<span style="color: hotpink;"> Positive Correlations (FDR = 1.000000)  </span>  
<br><br> 

<span class="text-center" style="color: Teal;"> Negative Correlations (FDR = 0.026400) </span>
```{r, echo=FALSE}
knitr::kable(AD_peAvg_pre_neg, row.names=F)%>% 
  kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% 
  scroll_box(width = "800px", height = "200px")
```

<br><br> 

<span class="text-center" style="color: Magenta;"> Figures </span>

![Slice overlay image displaying ROIs with tracts that had AD negatively correlated with loop position error average](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/AD/pre/loop_avg_PE_ad_pre_neg_cor.png)

<br>

![Glass Brain displaying tracts that had AD positively and negatively correlated with loop position error average](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/AD/pre/loop_pe_avg_m.t2.length25.neg_corr.jpg)

<br><br><br><br><br><br>

#### peri
<span style="color: hotpink;"> Positive Correlations (FDR = 1.000000)  </span>  

<br><br> 

<span class="text-center" style="color: Teal;"> Negative Correlations (FDR = 0.006482) </span>
```{r, echo=FALSE}
knitr::kable(AD_peAvg_peri_neg, row.names=F)%>% 
  kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% 
  scroll_box(width = "800px", height = "200px")
```

<br><br> 

<span class="text-center" style="color: Magenta;"> Figures </span>

![Slice overlay image displaying ROIs with tracts that had AD negatively correlated with loop position error average](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/AD/peri/loop_avg_PE_ad_peri_neg_ax.png)

<br>

![Glass Brain displaying tracts that had AD positively and negatively correlated with loop position error average](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/AD/peri/loop_pe_avg_m.t2.length25.neg_corr.jpg)

<br><br><br><br><br><br>

#### post

<span style="color: hotpink;"> Positive Correlations (FDR = 1.000000)  </span>  

<br><br> 

<span class="text-center" style="color: Teal;"> Negative Correlations (FDR = 0.031666) </span>
```{r, echo=FALSE}
knitr::kable(AD_peAvg_post_neg, row.names=F)%>% 
  kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% 
  scroll_box(width = "800px", height = "200px")
```

<br><br> 

<span class="text-center" style="color: Magenta;"> Figures </span>

![Slice overlay image displaying ROIs with tracts that had AD negatively correlated with loop position error average](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/AD/post/loop_avg_PE_ad_post_neg_ax.png)

<br>

![Glass Brain displaying tracts that had AD positively and negatively correlated with loop position error average](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/AD/post/loop_pe_avg_m.t2.length25.neg_corr.jpg)

<br><br><br><br><br><br>

#### Peri and  Post
<span style="color: hotpink;"> Positive Correlations (FDR = 0.477235)  </span>  


<br><br> 

<span class="text-center" style="color: Teal;"> Negative Correlations (FDR = 0.075829) </span>
```{r, echo=FALSE}
knitr::kable(AD_peAvg_peripost_neg, row.names=F)%>% 
  kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% 
  scroll_box(width = "800px", height = "200px")
```

<br><br> 

<span class="text-center" style="color: Magenta;"> Figures </span>

![Slice overlay image displaying ROIs with tracts that had AD negatively correlated with loop position error average](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/AD/peri_post/loop_avg_PE_ad_peri+post_neg_ax.png)

<br>

![Glass Brain displaying tracts that had AD positively and negatively correlated with loop position error average](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/AD/peri_post/loop_pe_avg_m.t2.length25.pos_neg.jpg)

<br><br><br><br><br><br>

#### Summary 
<br><br><br><br><br><br>

### RD {.tabset}
```{r RD PE Average variables , echo=FALSE, results='hide',message=FALSE}

## all subs ####

RD_peAvg_all_neg <-
  read.delim(
    paste0(working_dir,'/average/PE/RD/allSubs/avg_RD_pe_all_neg.csv'), header = FALSE, sep = "\t") %>% 
      remove_empty("cols") %>% 
        filter(V1 %in% rows2grab) %>% 
          t() %>% 
            `colnames<-`(rows2grab) %>% 
                `[`(-c(1),) %>% 
                    as.data.frame()

### Males ####
RD_peAvg_male_pos <-
  read.delim(
    paste0(working_dir,'/average/PE/RD/male/avg_RD_pe_male_pos.csv'),
    header = FALSE, sep = "\t") %>% 
      remove_empty("cols") %>%  
        filter(V1 %in% rows2grab) %>% 
          t() %>% 
            `colnames<-`(rows2grab) %>% 
              `[`(-c(1),) %>% 
                as.data.frame()

RD_peAvg_male_neg <-
  read.delim(
    paste0(working_dir,'/average/PE/RD/male/avg_RD_pe_male_neg.csv'),
    header = FALSE,sep = "\t") %>% 
      remove_empty("cols") %>%  
        filter(V1 %in% rows2grab) %>% 
          t() %>% 
            `colnames<-`(rows2grab) %>% 
              `[`(-c(1),) %>% 
                as.data.frame()
### Females#####

RD_peAvg_female_neg <-
  read.delim(
    paste0(working_dir,'/average/PE/RD/female/avg_RD_pe_fem_neg.csv'),
    header = FALSE,sep = "\t") %>% 
      remove_empty("cols") %>%  
        filter(V1 %in% rows2grab) %>% 
          t() %>% 
            `colnames<-`(rows2grab) %>% 
              `[`(-c(1),) %>% 
                as.data.frame()


###PRE ####

RD_peAvg_pre_neg <-
  read.delim(
    paste0(working_dir,'/average/PE/RD/pre/avg_RD_pe_pre_neg.csv'),
    header = FALSE,sep = "\t") %>% 
      remove_empty("cols") %>%  
        filter(V1 %in% rows2grab) %>% 
          t() %>% 
            `colnames<-`(rows2grab) %>% 
              `[`(-c(1),) %>% 
                as.data.frame()


### PERI ####
RD_peAvg_peri_neg <-
  read.delim(
    paste0(working_dir,'/average/PE/RD/peri/avg_RD_pe_peri_neg.csv'),
    header = FALSE,sep = "\t") %>% 
      remove_empty("cols") %>%  
        filter(V1 %in% rows2grab) %>% 
          t() %>% 
            `colnames<-`(rows2grab) %>% 
              `[`(-c(1),) %>% 
                as.data.frame()

### POST ####

RD_peAvg_post_neg <-
  read.delim(
    paste0(working_dir,'/average/PE/RD/post/avg_RD_pe_post_neg.csv'),
    header = FALSE,sep = "\t") %>% 
      remove_empty("cols") %>%  
        filter(V1 %in% rows2grab) %>% 
          t() %>% 
            `colnames<-`(rows2grab) %>% 
              `[`(-c(1),) %>% 
                as.data.frame()

### PERI and POST ####

RD_peAvg_peripost_neg <-
  read.delim(
    paste0(working_dir,'/average/PE/RD/peri_post/avg_RD_pe_peri+post_neg.csv' ),
    header = FALSE,sep = "\t") %>% 
      remove_empty("cols") %>%  
        filter(V1 %in% rows2grab) %>% 
          t() %>% 
            `colnames<-`(rows2grab) %>% 
              `[`(-c(1),) %>% 
                as.data.frame()


```

#### All subjects
<span style="color: hotpink;"> Positive Correlations (FDR = 0.909414)  </span>  
 Not significant 

<br><br> 

<span class="text-center" style="color: Teal;"> Negative Correlations (FDR = 0.035990 ) </span>
```{r, echo=FALSE}
knitr::kable(RD_peAvg_all_neg, row.names=F)%>% 
  kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% 
  scroll_box(width = "800px", height = "200px")
```

<br><br> 

<span class="text-center" style="color: Magenta;"> Figures </span>

![Slice overlay image displaying ROIs with tracts that had AD negatively correlated with loop position error average](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/RD/allSubs/loop_PE_avg_rd_all_neg_ax.png)

<br>

![Glass Brain displaying tracts that had AD positively and negatively correlated with loop position error average](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/RD/allSubs/loop_pe_avg_m.t2.length25.pos_neg.jpg)

<br><br><br><br><br><br>

#### Men
<span style="color: hotpink;"> Positive Correlations (FDR = 0.012641 )  </span>  
```{r, echo=FALSE}
knitr::kable(RD_peAvg_male_pos, row.names=F)%>% 
  kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% 
  scroll_box(width = "800px", height = "200px")
```

<br><br> 

<span class="text-center" style="color: Teal;"> Negative Correlations (FDR = 0.062762 ) </span>
```{r, echo=FALSE}
knitr::kable(RD_peAvg_male_neg, row.names=F)%>% 
  kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% 
  scroll_box(width = "800px", height = "200px")
```

<br><br> 

<span class="text-center" style="color: Magenta;"> Figures </span>

![Slice overlay image displaying ROIs with tracts that had AD positively correlated with loop position error average](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/RD/male/loop_PE_avg_rd_male_pos_ax.png)

<br>

![Slice overlay image displaying ROIs with tracts that had AD negatively correlated with loop position error average](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/RD/male/loop_PE_avg_rd_male_neg_ax.png)

<br>

![Glass Brain displaying tracts that had AD positively and negatively correlated with loop position error average](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/RD/male/loop_pe_avg_m.t2.length25.pos_neg.jpg)

<br><br><br><br><br><br>

#### Women
<span style="color: hotpink;"> Positive Correlations (FDR =0.125000 )  </span>

 Not significant 

<br><br> 

<span class="text-center" style="color: Teal;"> Negative Correlations (FDR = 0.001068 ) </span>
```{r, echo=FALSE}
knitr::kable(RD_peAvg_female_neg, row.names=F)%>% 
  kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% 
  scroll_box(width = "800px", height = "200px")
```

<br><br> 

<span class="text-center" style="color: Magenta;"> Figures </span>

![Slice overlay image displaying ROIs with tracts that had AD negatively correlated with loop position error average](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/RD/female/loop_PE_avg_rd_fem_neg_ax.png)

<br>

![Glass Brain displaying tracts that had AD positively and negatively correlated with loop position error average](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/RD/female/loop_pe_avg_m.t2.length25.pos_neg.jpg)

<br><br><br><br><br><br>

#### pre
<span style="color: hotpink;"> Positive Correlations (FDR = 1.000000 )  </span>  

 Not significant 

<br><br> 

<span class="text-center" style="color: Teal;"> Negative Correlations (FDR = 0.039982 ) </span>
```{r, echo=FALSE}
knitr::kable(RD_peAvg_pre_neg, row.names=F)%>% 
  kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% 
  scroll_box(width = "800px", height = "200px")
```

<br><br> 

<span class="text-center" style="color: Magenta;"> Figures </span>

![Slice overlay image displaying ROIs with tracts that had AD negatively correlated with loop position error average](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/RD/pre/loop_PE_avg_rd_pre_neg_ax.png)

<br>

![Glass Brain displaying tracts that had AD positively and negatively correlated with loop position error average](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/RD/pre/loop_pe_avg_m.t2.length25.pos_neg.jpg)

<br><br><br><br><br><br>

#### peri
<span style="color: hotpink;"> Positive Correlations (FDR =1.000000 )  </span>  
 Not significant 

<br><br> 

<span class="text-center" style="color: Teal;"> Negative Correlations (FDR =0.016583 ) </span>
```{r, echo=FALSE}
knitr::kable(RD_peAvg_peri_neg, row.names=F)%>% 
  kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% 
  scroll_box(width = "800px", height = "200px")
```

<br><br> 

<span class="text-center" style="color: Magenta;"> Figures </span>

![Slice overlay image displaying ROIs with tracts that had AD negatively correlated with loop position error average](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/RD/peri/loop_PE_avg_rd_peri_neg_ax.png)

<br>

![Glass Brain displaying tracts that had AD positively and negatively correlated with loop position error average](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/RD/peri/loop_pe_avg_m.t2.length25.pos_neg.jpg)

<br><br><br><br><br><br>

#### post

<span style="color: hotpink;"> Positive Correlations (FDR =1.000000 )  </span>  

 Not significant 

<br><br> 

<span class="text-center" style="color: Teal;"> Negative Correlations (FDR =0.048898 ) </span>
```{r, echo=FALSE}
knitr::kable(RD_peAvg_post_neg, row.names=F)%>% 
  kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% 
  scroll_box(width = "800px", height = "200px")
```

<br><br> 

<span class="text-center" style="color: Magenta;"> Figures </span>

![Slice overlay image displaying ROIs with tracts that had AD negatively correlated with loop position error average](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/RD/post/loop_PE_avg_rd_post_ax.png)

<br>

![Glass Brain displaying tracts that had AD positively and negatively correlated with loop position error average](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/RD/post/loop_pe_avg_m.t2.length25.pos_neg.jpg)

<br><br><br><br><br><br>

#### PEri  Post
<span style="color: hotpink;"> Positive Correlations (FDR =0.312843 )  </span>  

Not significant 

<br><br> 

<span class="text-center" style="color: Teal;"> Negative Correlations (FDR =0.089524 ) </span>
```{r, echo=FALSE}
knitr::kable(RD_peAvg_peripost_neg, row.names=F)%>% 
  kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% 
  scroll_box(width = "800px", height = "200px")
```

<br><br> 

<span class="text-center" style="color: Magenta;"> Figures </span>

![Slice overlay image displaying ROIs with tracts that had AD negatively correlated with loop position error average](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/RD/peri_post/loop_avg_PE_rd_peri+post_neg_ax.png)

<br>

![Glass Brain displaying tracts that had AD positively and negatively correlated with loop position error average](/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/RD/peri_post/loop_pe_avg_m.t2.length25.pos_neg.jpg)

<br><br><br><br><br><br>

<!---------------------------------------Loop Degree error--------------------------------  -->

#### Summary 

<br><br><br><br><br><br>