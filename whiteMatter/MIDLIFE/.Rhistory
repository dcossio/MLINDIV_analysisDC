avg_DT_1m <- mean(loop_subInfo$loop_de_rad1_degree, na.rm = TRUE)
avg_DT_2m <- mean(loop_subInfo$loop_de_rad2_degree, na.rm = TRUE)
avg_DT_3m <- mean(loop_subInfo$loop_de_rad3_degree, na.rm = TRUE)
avg_DT_averagem <- mean(loop_subInfo$loop_de_avg_degree, na.rm = TRUE)
# Sex differences
male_DT <- loop_subInfo %>% filter(sex == "male")
avg_DT_3m_male <- mean(male_DT$loop_de_rad3_degree, na.rm = TRUE)
avg_DT_averagem_male <- mean(male_DT$loop_de_avg_degree, na.rm = TRUE)
fem_DT <- loop_subInfo %>% filter(sex == "female")
avg_DT_3m_female <-mean(fem_DT$loop_de_rad3_degree, na.rm = TRUE)
avg_DT_averagem_female <- mean(fem_DT$loop_de_avg_degree, na.rm = TRUE)
# lets do a normality test  on our variables
#male
norm_male_rad3 <- shapiro.test(male_DT$loop_de_rad3_degree) # Not Normal
norm_male_avg <- shapiro.test(male_DT$loop_de_avg_degree) # Normal
#female
norm_female_rad3 <- shapiro.test(fem_DT$loop_de_rad3_degree) # Normal
norm_female_avg <- shapiro.test(fem_DT$loop_de_avg_degree) #Normal
# sex differences between male and female rad3
# since male is not normal we'll used a wilksonsns
sexdiff_Rad3 <- wilcox.test(male_DT$loop_de_rad3_degree, fem_DT$loop_de_rad3_degree) #  significant sex diff
sexdiff_Avg <- t.test(male_DT$loop_de_avg_degree, fem_DT$loop_de_avg_degree) #  signifncat difference
avg_DT_1m <- mean(loop_subInfo$loop_de_rad1_degree, na.rm = TRUE)
avg_DT_2m <- mean(loop_subInfo$loop_de_rad2_degree, na.rm = TRUE)
avg_DT_3m <- mean(loop_subInfo$loop_de_rad3_degree, na.rm = TRUE)
avg_DT_averagem <- mean(loop_subInfo$loop_de_avg_degree, na.rm = TRUE)
male_DT <- loop_subInfo %>% filter(sex == "male")
avg_DT_3m_male <- mean(male_DT$loop_de_rad3_degree, na.rm = TRUE)
avg_DT_averagem_male <- mean(male_DT$loop_de_avg_degree, na.rm = TRUE)
fem_DT <- loop_subInfo %>% filter(sex == "female")
avg_DT_3m_female <-mean(fem_DT$loop_de_rad3_degree, na.rm = TRUE)
avg_DT_averagem_female <- mean(fem_DT$loop_de_avg_degree, na.rm = TRUE)
# lets do a normality test  on our variables
norm_male_rad3 <- shapiro.test(male_DT$loop_de_rad3_degree) # Not Normal
View(loop_subInfo)
library(ggplot2)
#(plyr)
library(tidyverse)
# library(dplyr)
# library(tidyr)
library(stringr)
library(kableExtra)
# library(data.table)
# library(network)
# library(tidygraph)
# library(ggraph)
# library(igraph)
# library(networkD3)
# library(CINNA)
# library(umap)
# library(plotly)
#library(factoextra)
#library(lsr)
library(car)
library(ggpubr)
#library(entropy)
#library(ds4psy)
# library(pROC)
#library(devtools)
#library(BRRR)
library(stats)
#library(afex)
library(knitr)
library(janitor)
# library(car)
# library(ggiraph)
library(ggiraphExtra)
# library(moonBook)
library(nationalparkcolors)
npc_everglades <- park_palette("Everglades")
npc_channel <- park_palette("ChannelIslands")
npc_saguaro <- park_palette("Saguaro")
knitr::opts_chunk$set(warning=FALSE, message=FALSE, echo = FALSE,
fig.align = "center")
working_dir <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop"
rows2grab <- c("Tract Name", "number of tracts","mean length(mm)","diameter(mm)", "volume(mm^3)")
loop_subInfo <- read.csv("/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/loop_subinfo.csv") %>% select("subject_id", "sex", "age_scan_years", "repo_status","loop_pe_rad1_m","loop_pe_rad2_m","loop_pe_rad3_m","loop_pe_avg_m")
for (row in 1:nrow(loop_subInfo)) {
if (loop_subInfo[row,2] == 0) {
loop_subInfo[row,2] <- "female"
} else {
loop_subInfo[row,2] <- "male"
}
}
View(loop_subInfo)
avg_DT_1m <- mean(loop_subInfo$loop_de_rad1_degree, na.rm = TRUE)
avg_DT_2m <- mean(loop_subInfo$loop_de_rad2_degree, na.rm = TRUE)
avg_DT_3m <- mean(loop_subInfo$loop_de_rad3_degree, na.rm = TRUE)
avg_DT_averagem <- mean(loop_subInfo$loop_de_avg_degree, na.rm = TRUE)
# Sex differences
male_DT <- loop_subInfo %>% filter(sex == "male")
avg_DT_3m_male <- mean(male_DT$loop_de_rad3_degree, na.rm = TRUE)
avg_DT_averagem_male <- mean(male_DT$loop_de_avg_degree, na.rm = TRUE)
fem_DT <- loop_subInfo %>% filter(sex == "female")
avg_DT_3m_female <-mean(fem_DT$loop_de_rad3_degree, na.rm = TRUE)
avg_DT_averagem_female <- mean(fem_DT$loop_de_avg_degree, na.rm = TRUE)
# lets do a normality test  on our variables
#male
norm_male_rad3 <- shapiro.test(male_DT$loop_de_rad3_degree) # Not Normal
View(male_DT)
library(ggplot2)
#(plyr)
library(tidyverse)
# library(dplyr)
# library(tidyr)
library(stringr)
library(kableExtra)
# library(data.table)
# library(network)
# library(tidygraph)
# library(ggraph)
# library(igraph)
# library(networkD3)
# library(CINNA)
# library(umap)
# library(plotly)
#library(factoextra)
#library(lsr)
# library(car)
library(ggpubr)
#library(entropy)
#library(ds4psy)
# library(pROC)
#library(devtools)
#library(BRRR)
#library(stats)
#library(afex)
library(knitr)
library(janitor)
# library(car)
# library(ggiraph)
# library(ggiraphExtra)
# library(moonBook)
library(nationalparkcolors)
npc_everglades <- park_palette("Everglades")
npc_channel <- park_palette("ChannelIslands")
npc_saguaro <- park_palette("Saguaro")
knitr::opts_chunk$set(warning=FALSE, message=FALSE, echo = FALSE,
fig.align = "center")
working_dir <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/"
rows2grab <- c("Tract Name", "number of tracts","mean length(mm)","diameter(mm)", "volume(mm^3)")
loop_subInfo <- read.csv("/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/loop_subinfo.csv") %>% select(c("subject_id","sex", "age_scan_years","repo_status", "loop_de_rad1_degree","loop_de_rad2_degree", "loop_de_rad3_degree","loop_de_avg_degree"))
for (row in 1:nrow(loop_subInfo)) {
if (loop_subInfo[row,2] == 0) {
loop_subInfo[row,2] <- "female"
} else {
loop_subInfo[row,2] <- "male"
}
}
View(loop_subInfo)
avg_DT_1m <- mean(loop_subInfo$loop_de_rad1_degree, na.rm = TRUE)
avg_DT_2m <- mean(loop_subInfo$loop_de_rad2_degree, na.rm = TRUE)
avg_DT_3m <- mean(loop_subInfo$loop_de_rad3_degree, na.rm = TRUE)
avg_DT_averagem <- mean(loop_subInfo$loop_de_avg_degree, na.rm = TRUE)
# Sex differences
male_DT <- loop_subInfo %>% filter(sex == "male")
avg_DT_3m_male <- mean(male_DT$loop_de_rad3_degree, na.rm = TRUE)
avg_DT_averagem_male <- mean(male_DT$loop_de_avg_degree, na.rm = TRUE)
fem_DT <- loop_subInfo %>% filter(sex == "female")
avg_DT_3m_female <-mean(fem_DT$loop_de_rad3_degree, na.rm = TRUE)
avg_DT_averagem_female <- mean(fem_DT$loop_de_avg_degree, na.rm = TRUE)
# lets do a normality test  on our variables
#male
norm_male_rad3 <- shapiro.test(male_DT$loop_de_rad3_degree) # Not Normal
norm_male_avg <- shapiro.test(male_DT$loop_de_avg_degree) # Normal
#female
norm_female_rad3 <- shapiro.test(fem_DT$loop_de_rad3_degree) # Normal
norm_female_avg <- shapiro.test(fem_DT$loop_de_avg_degree) #Normal
# sex differences between male and female rad3
# since male is not normal we'll used a wilksonsns
sexdiff_Rad3 <- wilcox.test(male_DT$loop_de_rad3_degree, fem_DT$loop_de_rad3_degree) #  significant sex diff
sexdiff_Avg <- t.test(male_DT$loop_de_avg_degree, fem_DT$loop_de_avg_degree) #  signifncat difference
View(loop_subInfo)
View(fem_DT)
View(fem_DT)
avg_DT_3m_pre <- fem_DT %>% filter(repo_status == 1) %>% select(loop_de_rad3_degree) %>%  mean(na.rm = TRUE)
avg_DT_3m_pre
avg_DT_3m_pre <- fem_DT %>% filter(repo_status == 1) %>% select(loop_de_rad3_degree) %>%  mean(., na.rm = TRUE)
avg_DT_3m_pre <- fem_DT %>% filter(repo_status == 1) %>% select(loop_de_rad3_degree)
View(avg_DT_3m_pre)
avg_DT_3m_pre <- fem_DT %>% filter(repo_status == 1) %>% select(loop_de_rad3_degree) %>% mean()
avg_DT_3m_pre <- fem_DT %>% filter(repo_status == 1) %>% select(loop_de_rad3_degree) %>% mean(na.rm = TRUE)
avg_DT_3m_pre <- fem_DT %>% filter(repo_status == 1) %>% select(loop_de_rad3_degree) %>%  na.omit()
View(avg_DT_3m_pre)
avg_DT_3m_pre <- fem_DT %>% filter(repo_status == 1) %>% select(loop_de_rad3_degree) %>%  na.omit() %>%  mean()
avg_DT_3m_pre <- fem_DT %>% filter(repo_status == 1) %>% select(loop_de_rad3_degree) %>%  na.omit() %>%  mean(loop_de_rad3_degree)
avg_DT_3m_pre <- fem_DT %>% filter(repo_status == 1) %>%  na.omit() %>% mean(select(loop_de_rad3_degree))
avg_DT_3m_pre <- fem_DT %>% filter(repo_status == 1) %>%  na.omit()
mean(avg_DT_3m_pre$loop_de_rad3_degree)
avg_DT_3m_pre <- fem_DT %>% filter(repo_status == 1) %>%  na.omit() %>% colMeans(na.rm = TRUE)
avg_DT_3m_pre <- fem_DT %>% filter(repo_status == 1) %>%  na.omit() %>%  as.numeric()
avg_DT_3m_pre <- fem_DT %>% filter(repo_status == 1) %>%  na.omit()
class(avg_DT_3m_pre)
class(avg_DT_3m_pre$loop_de_avg_degree)
class(avg_DT_3m_pre$loop_de_rad3_degree)
avg_DT_3m_pre <- fem_DT %>% filter(repo_status == 1) %>%  na.omit() %>% mean(.$loop_de_rad3_degree)
avg_DT_3m_pre <- fem_DT %>% filter(repo_status == 1) %>%  na.omit() %>% mean(.$loop_de_rad3_degree, na.rm = TRUE)
avg_DT_3m_pre <- fem_DT %>% filter(repo_status == 1) %>%  na.omit() %>% mean(.$`loop_de_rad3_degree`, na.rm = TRUE)
avg_DT_3m_pre <- fem_DT %>% filter(repo_status == 1) %>%  na.omit() %>% mean(c("loop_de_rad3_degree"))
avg_DT_3m_pre <- fem_DT %>% filter(repo_status == 1) %>%  na.omit() %>% summarise(mean())
avg_DT_3m_pre <- fem_DT %>% filter(repo_status == 1) %>%  na.omit() %>% summarise(mean(.$loop_de_rad3_degree))
View(avg_DT_3m_pre)
avg_DT_3m_pre <- fem_DT %>% filter(repo_status == 1) %>%  na.omit() %>% summarise(mean(.$loop_de_rad3_degree))
avg_DT_3m_peri <- fem_DT %>% filter(repo_status == 2) %>%  na.omit() %>% summarise(mean(.$loop_de_rad3_degree))
avg_DT_3m_post <- fem_DT %>% filter(repo_status == 3) %>%  na.omit() %>% summarise(mean(.$loop_de_rad3_degree))
View(avg_DT_3m_peri)
View(avg_DT_3m_post)
View(avg_DT_3m_pre)
avg_DT_avg_pre <- fem_DT %>% filter(repo_status == 1) %>%  na.omit() %>% summarise(mean(.$loop_de_avg_degree))
avg_DT_avg_peri <- fem_DT %>% filter(repo_status == 2) %>%  na.omit() %>% summarise(mean(.$loop_de_avg_degree))
avg_DT_avg_post <- fem_DT %>% filter(repo_status == 3) %>%  na.omit() %>% summarise(mean(.$loop_de_avg_degree))
View(avg_DT_3m_peri)
View(avg_DT_avg_peri)
View(avg_DT_avg_pre)
View(avg_DT_avg_post)
library(ggplot2)
#(plyr)
library(tidyverse)
# library(dplyr)
# library(tidyr)
library(stringr)
library(kableExtra)
# library(data.table)
# library(network)
# library(tidygraph)
# library(ggraph)
# library(igraph)
# library(networkD3)
# library(CINNA)
# library(umap)
# library(plotly)
#library(factoextra)
#library(lsr)
# library(car)
library(ggpubr)
#library(entropy)
#library(ds4psy)
# library(pROC)
#library(devtools)
#library(BRRR)
#library(stats)
#library(afex)
library(knitr)
library(janitor)
# library(car)
# library(ggiraph)
# library(ggiraphExtra)
# library(moonBook)
knitr::opts_chunk$set(warning=FALSE, message=FALSE, echo = FALSE,
fig.align = "center")
working_dir <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/"
rows2grab <- c("Tract Name", "number of tracts","mean length(mm)","diameter(mm)", "volume(mm^3)")
subinfo <- read.csv("/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/loop_subinfo.csv")
View(subinfo)
colnames(subinfo)
library(ggplot2)
#(plyr)
library(tidyverse)
# library(dplyr)
# library(tidyr)
library(stringr)
library(kableExtra)
# library(data.table)
# library(network)
# library(tidygraph)
# library(ggraph)
# library(igraph)
# library(networkD3)
# library(CINNA)
# library(umap)
# library(plotly)
#library(factoextra)
#library(lsr)
# library(car)
library(ggpubr)
#library(entropy)
#library(ds4psy)
# library(pROC)
#library(devtools)
#library(BRRR)
#library(stats)
#library(afex)
library(knitr)
library(janitor)
# library(car)
# library(ggiraph)
# library(ggiraphExtra)
# library(moonBook)
knitr::opts_chunk$set(warning=FALSE, message=FALSE, echo = FALSE,
fig.align = "center")
working_dir <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/"
rows2grab <- c("Tract Name", "number of tracts","mean length(mm)","diameter(mm)", "volume(mm^3)")
subinfo <- read.csv("/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/loop_subinfo.csv") %>% select(c("subject_id","sex", "age_scan_years","repo_status", "loop_ae_rad1_degree","loop_ae_rad2_degree", "loop_ae_rad3_degree","loop_ae_avg_degree"))
for (row in 1:nrow(subinfo)) {
if (subinfo[row,2] == 0) {
subinfo[row,2] <- "female"
} else {
subinfo[row,2] <- "male"
}
}
avg_AE_1m <- mean(loop_subInfo$loop_ae_rad1_degree, na.rm = TRUE)
avg_AE_1m <- mean(sub_info$loop_ae_rad1_degree, na.rm = TRUE)
avg_AE_1m <- mean(subinfo$loop_ae_rad1_degree, na.rm = TRUE)
avg_AE_2m <- mean(subinfo$loop_ae_rad2_degree, na.rm = TRUE)
avg_AE_3m <- mean(subinfo$loop_ae_rad3_degree, na.rm = TRUE)
avg_AE_averagem <- mean(subinfo$loop_ae_avg_degree, na.rm = TRUE)
# Sex differences
male_AE <- subinfo %>% filter(sex == "male")
avg_AE_3m_male <- mean(male_AE$loop_ae_rad3_degree, na.rm = TRUE)
avg_AE_averagem_male <- mean(male_AE$loop_ae_avg_degree, na.rm = TRUE)
fem_AE <- subinfo %>% filter(sex == "female")
avg_AE_3m_female <-mean(fem_AE$loop_ae_rad3_degree, na.rm = TRUE)
avg_AE_averagem_female <- mean(fem_AE$loop_ae_avg_degree, na.rm = TRUE)
# average for our menopause  rad3
avg_AE_3m_pre <- fem_AE %>% filter(repo_status == 1) %>%  na.omit() %>% summarise(mean(.$loop_ae_rad3_degree))
avg_AE_3m_peri <- fem_AE %>% filter(repo_status == 2) %>%  na.omit() %>% summarise(mean(.$loop_ae_rad3_degree))
avg_AE_3m_post <- fem_AE %>% filter(repo_status == 3) %>%  na.omit() %>% summarise(mean(.$loop_ae_rad3_degree))
# average for our menopause
avg_AE_avg_pre <- fem_AE %>% filter(repo_status == 1) %>%  na.omit() %>% summarise(mean(.$loop_ae_avg_degree))
avg_AE_avg_peri <- fem_AE %>% filter(repo_status == 2) %>%  na.omit() %>% summarise(mean(.$loop_ae_avg_degree))
avg_AE_avg_post <- fem_AE %>% filter(repo_status == 3) %>%  na.omit() %>% summarise(mean(.$loop_ae_avg_degree))
# lets do a normality test  on our variables
#male
norm_male_rad3 <- shapiro.test(male_AE$loop_ae_rad3_degree) # Not Normal
norm_male_avg <- shapiro.test(male_AE$loop_ae_avg_degree) # Normal
#female
norm_female_rad3 <- shapiro.test(fem_AE$loop_ae_rad3_degree) # Normal
norm_female_avg <- shapiro.test(fem_AE$loop_ae_avg_degree) #Normal
# sex differences between male and female rad3
# since male is not normal we'll used a wilksonsns
sexdiff_Rad3 <- wilcox.test(male_AE$loop_ae_rad3_degree, fem_AE$loop_ae_rad3_degree) #  significant sex diff
sexdiff_Avg <- t.test(male_AE$loop_ae_avg_degree, fem_AE$loop_ae_avg_degree) #  signifncat difference
norm_male_rad3
norm_male_avg
norm_female_rad3
norm_female_avg
View(avg_AE_3m_pre)
View(avg_AE_3m_post)
View(avg_AE_3m_pre)
View(avg_AE_3m_post)
View(avg_AE_3m_peri)
View(avg_AE_avg_pre)
View(avg_AE_avg_post)
View(avg_AE_avg_peri)
sexdiff_Rad3 <- t.test(male_AE$loop_ae_rad3_degree, fem_AE$loop_ae_rad3_degree) #  significant sex diff
sexdiff_Avg <- wilcox.test(male_AE$loop_ae_avg_degree, fem_AE$loop_ae_avg_degree)
sexdiff_Rad3
sexdiff_Avg
# Men positive and women negative LEts just plot them all
QA_aeRad3_male_pos_cols <-  c("Subjects", as.character(QA_aeRad3_male_pos[,1]))
library(ggplot2)
#(plyr)
library(tidyverse)
# library(dplyr)
# library(tidyr)
library(stringr)
library(kableExtra)
# library(data.table)
# library(network)
# library(tidygraph)
# library(ggraph)
# library(igraph)
# library(networkD3)
# library(CINNA)
# library(umap)
# library(plotly)
#library(factoextra)
#library(lsr)
library(car)
library(ggpubr)
#library(entropy)
#library(ds4psy)
# library(pROC)
#library(devtools)
#library(BRRR)
library(stats)
#library(afex)
library(knitr)
library(janitor)
# library(car)
# library(ggiraph)
library(ggiraphExtra)
# library(moonBook)
library(nationalparkcolors)
npc_everglades <- park_palette("Everglades")
npc_channel <- park_palette("ChannelIslands")
npc_saguaro <- park_palette("Saguaro")
knitr::opts_chunk$set(warning=FALSE, message=FALSE, echo = FALSE,
fig.align = "center")
working_dir <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop"
rows2grab <- c("Tract Name", "number of tracts","mean length(mm)","diameter(mm)", "volume(mm^3)")
loop_subInfo <- read.csv("/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/loop_subinfo.csv") %>% select("subject_id", "sex", "age_scan_years", "repo_status","loop_pe_rad1_m","loop_pe_rad2_m","loop_pe_rad3_m","loop_pe_avg_m")
for (row in 1:nrow(loop_subInfo)) {
if (loop_subInfo[row,2] == 0) {
loop_subInfo[row,2] <- "female"
} else {
loop_subInfo[row,2] <- "male"
}
}
avg_PE_1m <- mean(loop_subInfo$loop_pe_rad1_m, na.rm = TRUE)
avg_PE_2m <- mean(loop_subInfo$loop_pe_rad2_m, na.rm = TRUE)
avg_PE_3m <- mean(loop_subInfo$loop_pe_rad3_m, na.rm = TRUE)
avg_PE_averagem <- mean(loop_subInfo$loop_pe_avg_m, na.rm = TRUE)
# Sex differences
male_PE <- loop_subInfo %>% filter(sex == "male")
fem_PE <- loop_subInfo %>% filter(sex == "female")
# lets do a normality test  on our variables
#male
norm_male_rad3 <- shapiro.test(male_PE$loop_pe_rad3_m) # Normal
norm_male_avg <- shapiro.test(male_PE$loop_pe_avg_m) # Normal
#female
norm_female_rad3 <- shapiro.test(fem_PE$loop_pe_rad3_m) # Normal
norm_female_avg <- shapiro.test(fem_PE$loop_pe_avg_m) #Normal
# sex differences between male and female rad3
sexdiff_Rad3 <- t.test(male_PE$loop_pe_rad3_m, fem_PE$loop_pe_rad3_m) # no significant sex diff
sexdiff_Avg <- t.test(male_PE$loop_pe_avg_m, fem_PE$loop_pe_avg_m) # no signifncat difference
library(ggplot2)
#(plyr)
library(tidyverse)
# library(dplyr)
# library(tidyr)
library(stringr)
library(kableExtra)
# library(data.table)
# library(network)
# library(tidygraph)
# library(ggraph)
# library(igraph)
# library(networkD3)
# library(CINNA)
# library(umap)
# library(plotly)
#library(factoextra)
#library(lsr)
# library(car)
library(ggpubr)
#library(entropy)
#library(ds4psy)
# library(pROC)
#library(devtools)
#library(BRRR)
#library(stats)
#library(afex)
library(knitr)
library(janitor)
# library(car)
# library(ggiraph)
# library(ggiraphExtra)
# library(moonBook)
library(nationalparkcolors)
npc_everglades <- park_palette("Everglades")
npc_channel <- park_palette("ChannelIslands")
npc_saguaro <- park_palette("Saguaro")
knitr::opts_chunk$set(warning=FALSE, message=FALSE, echo = FALSE,
fig.align = "center")
working_dir <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/"
rows2grab <- c("Tract Name", "number of tracts","mean length(mm)","diameter(mm)", "volume(mm^3)")
loop_subInfo <- read.csv("/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/loop_subinfo.csv") %>% select(c("subject_id","sex", "age_scan_years","repo_status", "loop_de_rad1_degree","loop_de_rad2_degree", "loop_de_rad3_degree","loop_de_avg_degree"))
for (row in 1:nrow(loop_subInfo)) {
if (loop_subInfo[row,2] == 0) {
loop_subInfo[row,2] <- "female"
} else {
loop_subInfo[row,2] <- "male"
}
}
avg_DT_1m <- mean(loop_subInfo$loop_de_rad1_degree, na.rm = TRUE)
avg_DT_2m <- mean(loop_subInfo$loop_de_rad2_degree, na.rm = TRUE)
avg_DT_3m <- mean(loop_subInfo$loop_de_rad3_degree, na.rm = TRUE)
avg_DT_averagem <- mean(loop_subInfo$loop_de_avg_degree, na.rm = TRUE)
# Sex differences
male_DT <- loop_subInfo %>% filter(sex == "male")
avg_DT_3m_male <- mean(male_DT$loop_de_rad3_degree, na.rm = TRUE)
avg_DT_averagem_male <- mean(male_DT$loop_de_avg_degree, na.rm = TRUE)
fem_DT <- loop_subInfo %>% filter(sex == "female")
avg_DT_3m_female <-mean(fem_DT$loop_de_rad3_degree, na.rm = TRUE)
avg_DT_averagem_female <- mean(fem_DT$loop_de_avg_degree, na.rm = TRUE)
# average for our menopause  rad3
avg_DT_3m_pre <- fem_DT %>% filter(repo_status == 1) %>%  na.omit() %>% summarise(mean(.$loop_de_rad3_degree))
avg_DT_3m_peri <- fem_DT %>% filter(repo_status == 2) %>%  na.omit() %>% summarise(mean(.$loop_de_rad3_degree))
avg_DT_3m_post <- fem_DT %>% filter(repo_status == 3) %>%  na.omit() %>% summarise(mean(.$loop_de_rad3_degree))
# average for our menopause
avg_DT_avg_pre <- fem_DT %>% filter(repo_status == 1) %>%  na.omit() %>% summarise(mean(.$loop_de_avg_degree))
avg_DT_avg_peri <- fem_DT %>% filter(repo_status == 2) %>%  na.omit() %>% summarise(mean(.$loop_de_avg_degree))
avg_DT_avg_post <- fem_DT %>% filter(repo_status == 3) %>%  na.omit() %>% summarise(mean(.$loop_de_avg_degree))
# lets do a normality test  on our variables
#male
norm_male_rad3 <- shapiro.test(male_DT$loop_de_rad3_degree) # Not Normal
norm_male_avg <- shapiro.test(male_DT$loop_de_avg_degree) # Normal
#female
norm_female_rad3 <- shapiro.test(fem_DT$loop_de_rad3_degree) # Normal
norm_female_avg <- shapiro.test(fem_DT$loop_de_avg_degree) #Normal
# sex differences between male and female rad3
# since male is not normal we'll used a wilksonsns
sexdiff_Rad3 <- wilcox.test(male_DT$loop_de_rad3_degree, fem_DT$loop_de_rad3_degree) #  significant sex diff
sexdiff_Avg <- t.test(male_DT$loop_de_avg_degree, fem_DT$loop_de_avg_degree) #  signifncat difference
### ALL SUBS ####
QA_deAvg_all_pos <- read.delim(paste0(working_dir,'/loop/average/DE/QA/allSubs/QA_loopAvgDE_allsubs_pos.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame() %>% na.omit()
QA_deAvg_all_neg <- read.delim(paste0(working_dir,'/loop/average/DE/QA/allSubs/QA_loopAvgDE_allsubs_neg.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame() %>% na.omit()
# MEN ####
QA_deAvg_male_neg <- read.delim(paste0(working_dir,'/loop/average/DE/QA/male/QA_loopAvgDE_male_neg.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame() %>% na.omit()
# WOMEN ####
QA_deAvg_female_pos <- read.delim(paste0(working_dir,'/loop/average/DE/QA/female/QA_loopAvgDE_fem_pos.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame() %>% na.omit()
QA_deAvg_female_neg <- read.delim(paste0(working_dir,'/loop/average/DE/QA/female/QA_loopAvgDE_fem_neg.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame() %>% na.omit()
# PRE ####
QA_deAvg_pre_pos <- read.delim(paste0(working_dir,'/loop/average/DE/QA/pre/QA_loopAvgDE_pre_pos.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame() %>% na.omit()
QA_deAvg_pre_neg <- read.delim(paste0(working_dir,'/loop/average/DE/QA/pre/QA_loopAvgDE_pre_neg.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame() %>% na.omit()
# PERI ####
QA_deAvg_peri_neg <- read.delim(paste0(working_dir,'/loop/average/DE/QA/peri/QA_loopAvgDE_peri_neg.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame() %>% na.omit()
#POST ####
# Peri + POST ####
QA_deAvg_peripost_neg <- read.delim(paste0(working_dir,'/loop/average/DE/QA/peri_post/QA_loopAvgDE_peripost_neg.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame() %>% na.omit()
QA_deAvg_peripost_pos <- read.delim(paste0(working_dir,'/loop/average/DE/QA/peri_post/QA_loopAvgDE_peripost_pos.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame() %>% na.omit()
