setdiff(QA_peAvg_female_neg_gathercols,QA_peAvg_male_neg_gathercols)
qa_sex_diff <- setdiff(QA_peAvg_male_neg_gathercols,QA_peAvg_female_neg_gathercols) %>% cbind(. ,setdiff(QA_peAvg_female_neg_gathercols,QA_peAvg_male_neg_gathercols))
qa_sex_diff <- setdiff(QA_peAvg_male_neg_gathercols,QA_peAvg_female_neg_gathercols) %>% cbind(setdiff(QA_peAvg_female_neg_gathercols,QA_peAvg_male_neg_gathercols))
QA_df <- QA_peAvg_male_neg_values[, !names(QA_peAvg_male_neg_values) %in% names(qa_sex_diff)]
names(QA_df)
QA_neg_df <- A_peAvg_male_neg_values[, names(QA_peAvg_male_neg_values) %in% names(QA_peAvg_female_neg_values)]
QA_neg_df <- QA_peAvg_male_neg_values[, names(QA_peAvg_male_neg_values) %in% names(QA_peAvg_female_neg_values)]
names(QA_neg_df)
QA_peAvg_female_neg_values[, !names(QA_peAvg_female_pos_values) %in% qa_sex_diff]
QA_df <- rbind(QA_df,QA_peAvg_female_neg_values[, !names(QA_peAvg_female_pos_values) %in% qa_sex_diff])
length(A_peAvg_female_neg_values[, !names(QA_peAvg_female_pos_values) %in% qa_sex_diff])
length(QA_peAvg_female_neg_values[, !names(QA_peAvg_female_pos_values) %in% qa_sex_diff])
length(QA_df)
View(QA_df)
QA_peAvg_female_neg_values[, names(QA_peAvg_female_neg_values) %in% QA_peAvg_male_neg_values]
s <- QA_peAvg_female_neg_values[, names(QA_peAvg_female_neg_values) %in% QA_peAvg_male_neg_values]
s
names(QA_peAvg_female_neg_values)
QA_peAvg_female_neg_values[, names(QA_peAvg_female_neg_values) %in% names(QA_peAvg_male_neg_values)
])
QA_peAvg_female_neg_values[, names(QA_peAvg_female_neg_values) %in% names(QA_peAvg_male_neg_values)]
names(QA_peAvg_female_neg_values[, names(QA_peAvg_female_neg_values) %in% names(QA_peAvg_male_neg_values)])
QA_df
QA_neg_df <- QA_peAvg_male_neg_values[, names(QA_peAvg_male_neg_values) %in% names(QA_peAvg_female_neg_values)] %>% rbind(QA_peAvg_female_neg_values[, names(QA_peAvg_female_neg_values) %in% names(QA_peAvg_male_neg_values)])
View(QA_neg_df)
names(QA_neg_df)
ggplot(QA_neg_df, aes(x=sex, y="Corpus_Callosum_Tapetum", group=sex)) +
geom_boxplot(outlier.shape = NA,width =0.5,fill= c("#CF92BF", "#D1E7E6")) +
geom_jitter(color="black",size=0.8,alpha=0.9,width = 0.2) +
#scale_y_binned(n.breaks=10, nice.breaks = TRUE) +
stat_boxplot(geom = "errorbar",
width = 0.15) +
labs(x= "Sex", y= " QA", title =paste0(ROI) ) +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
ggplot(QA_neg_df, aes(x=sex, y=.data$Corpus_Callosum_Tapetum, group=sex)) +
geom_boxplot(outlier.shape = NA,width =0.5,fill= c("#CF92BF", "#D1E7E6")) +
geom_jitter(color="black",size=0.8,alpha=0.9,width = 0.2) +
#scale_y_binned(n.breaks=10, nice.breaks = TRUE) +
stat_boxplot(geom = "errorbar",
width = 0.15) +
labs(x= "Sex", y= " QA", title =Corpus_Callosum_Tapetum ) +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
ggplot(QA_neg_df, aes(x=sex, y=.data$Corpus_Callosum_Tapetum, group=sex)) +
geom_boxplot(outlier.shape = NA,width =0.5,fill= c("#CF92BF", "#D1E7E6")) +
geom_jitter(color="black",size=0.8,alpha=0.9,width = 0.2) +
#scale_y_binned(n.breaks=10, nice.breaks = TRUE) +
stat_boxplot(geom = "errorbar",
width = 0.15) +
labs(x= "Sex", y= " QA", title ="Corpus Callosum Tapetum" ) +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
QA_peAvg_male_neg_cols <-  c("Subjects", as.character(QA_peAvg_male_neg[,1]))
QA_peAvg_male_neg_values <-read.delim(
paste0(working_dir,'/average/PE/QA/male/QA_loopAvgPE_male_neg.csv'), header = FALSE, sep = "\t") %>%
remove_empty("cols") %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>%
`colnames<-`(QA_peAvg_male_neg_cols) %>% cbind(loop_subInfo[,c("sex", "age_scan_years","loop_pe_avg_m")]) %>% filter(sex=="male")
#
# Reorder for my sanity check
QA_peAvg_male_neg_values <- QA_peAvg_male_neg_values[,c(1,7:9,2:6)]
QA_peAvg_male_neg_gathercols <- colnames(QA_peAvg_male_neg_values[5:9])
#
# # for some reason things are being read as a a character and it needs to be a numerical value
QA_peAvg_male_neg_values[5:9] <- apply(QA_peAvg_male_neg_values[5:9],2, as.numeric)
## FEmale Positive #####
QA_peAvg_female_neg_cols <-  c("Subjects", as.character(QA_peAvg_female_neg[,1]))
QA_peAvg_female_neg_values <-read.delim(
paste0(working_dir,'/average/PE/QA/female/QA_loopAvgPE_neg_pos.csv'), header = FALSE, sep = "\t") %>%
remove_empty("cols") %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>%
`colnames<-`(QA_peAvg_female_neg_cols) %>% cbind(loop_subInfo[,c("sex", "age_scan_years","loop_pe_avg_m")]) %>% filter(sex=="female")
#
# Reorder for my sanity check
QA_peAvg_female_neg_values <- QA_peAvg_female_neg_values[,c(1,10:12,2:9)]
QA_peAvg_female_neg_gathercols <- colnames(QA_peAvg_female_neg_values[5:12])
#
# # for some reason things are being read as a a character and it needs to be a numerical value
QA_peAvg_female_neg_values[5:12] <- apply(QA_peAvg_female_neg_values[5:12],2, as.numeric)
QA_neg_df <- QA_peAvg_male_neg_values[, names(QA_peAvg_male_neg_values) %in% names(QA_peAvg_female_neg_values)] %>% rbind(QA_peAvg_female_neg_values[, names(QA_peAvg_female_neg_values) %in% names(QA_peAvg_male_neg_values)])
qa_neg <- ggplot(QA_neg_df, aes(x=sex, y=.data$Corpus_Callosum_Tapetum, group=sex)) +
geom_boxplot(outlier.shape = NA,width =0.5,fill= c("#CF92BF", "#D1E7E6")) +
geom_jitter(color="black",size=0.8,alpha=0.9,width = 0.2) +
#scale_y_binned(n.breaks=10, nice.breaks = TRUE) +
stat_boxplot(geom = "errorbar",
width = 0.15) +
labs(x= "Sex", y= " QA", title ="Corpus Callosum Tapetum" ) +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
png(file = paste0(figpath,"Corpus_Callosum_Tapetum_neg_QA.png"))  #,".png"))
print(qa_neg)
dev.off()
# Men positive and women negative LEts do fornix  ####
QA_peAvg_male_pos_cols <-  c("Subjects", as.character(QA_peAvg_male_pos[,1]))
QA_peAvg_male_pos_values <-read.delim(
paste0(working_dir,'/average/PE/QA/male/QA_loopAvgPE_male_pos.csv'), header = FALSE, sep = "\t") %>%
remove_empty("cols") %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>%
`colnames<-`(QA_peAvg_male_pos_cols) %>% cbind(loop_subInfo[,c("sex", "age_scan_years","loop_pe_avg_m")]) %>% filter(sex=="male")
#
# Reorder for my sanity check
QA_peAvg_male_pos_values <- QA_peAvg_male_pos_values[,c(1,12:14,2:11)]
QA_peAvg_male_pos_gathercols <- colnames(QA_peAvg_male_pos_values[5:11])
#
# # for some reason things are being read as a a character and it needs to be a numerical value
QA_peAvg_male_pos_values[5:11] <- apply(QA_peAvg_male_pos_values[5:11],2, as.numeric)
## FEmale Positive #####
QA_peAvg_female_pos_cols <-  c("Subjects", as.character(QA_peAvg_female_pos[,1]))
QA_peAvg_female_pos_values <- read.delim(
paste0(working_dir,'/average/PE/QA/female/QA_loopAvgPE_fem_pos.csv'), header = FALSE, sep = "\t") %>%
remove_empty("cols") %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>%
`colnames<-`(QA_peAvg_female_pos_cols) %>% cbind(loop_subInfo[,c("sex", "age_scan_years","loop_pe_avg_m")]) %>% filter(sex=="female")
#
# Reorder for my sanity check
QA_peAvg_female_pos_values <- QA_peAvg_female_pos_values[,c(1,4:6,2:3)]
QA_peAvg_female_pos_gathercols <- colnames(QA_peAvg_female_pos_values[5:6])
#
# # for some reason things are being read as a a character and it needs to be a numerical value
QA_peAvg_female_pos_values[5:6] <- apply(QA_peAvg_female_pos_values[5:6],2, as.numeric)
qa_sex_diff <- setdiff(QA_peAvg_male_pos_gathercols,QA_peAvg_female_pos_gathercols) %>% cbind(. ,setdiff(QA_peAvg_female_pos_gathercols,QA_peAvg_male_pos_gathercols))
figpath <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/QA/"
QA_df <- QA_peAvg_male_pos_values[, names(QA_peAvg_male_pos_values) %in% names(QA_peAvg_female_pos_values)]
QA_df <- rbind(QA_df,QA_peAvg_female_pos_values[, !names(QA_peAvg_female_pos_values) %in% qa_sex_diff])
for (ROI in colnames(QA_df[5:6])) {
print(ROI)
y <- ggplot(QA_df, aes(x=sex, y=.data[[ROI]], group=sex)) +
geom_boxplot(outlier.shape = NA,width =0.5,fill= c("#CF92BF", "#D1E7E6")) +
geom_jitter(color="black",size=0.8,alpha=0.9,width = 0.2) +
#scale_y_binned(n.breaks=10, nice.breaks = TRUE) +
stat_boxplot(geom = "errorbar",
width = 0.15) +
labs(x= "Sex", y= " QA", title =paste0(ROI) ) +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
png(file = paste0(figpath,ROI,"_pos_QA.png"))  #,".png"))
print(y)
dev.off()
}
figpath <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/QA/"
QA_peAvg_male_neg_cols <-  c("Subjects", as.character(QA_peAvg_male_neg[,1]))
QA_peAvg_male_neg_values <-read.delim(
paste0(working_dir,'/average/PE/QA/male/QA_loopAvgPE_male_neg.csv'), header = FALSE, sep = "\t") %>%
remove_empty("cols") %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>%
`colnames<-`(QA_peAvg_male_neg_cols) %>% cbind(loop_subInfo[,c("sex", "age_scan_years","loop_pe_avg_m")]) %>% filter(sex=="male")
#
# Reorder for my sanity check
QA_peAvg_male_neg_values <- QA_peAvg_male_neg_values[,c(1,7:9,2:6)]
QA_peAvg_male_neg_gathercols <- colnames(QA_peAvg_male_neg_values[5:9])
#
# # for some reason things are being read as a a character and it needs to be a numerical value
QA_peAvg_male_neg_values[5:9] <- apply(QA_peAvg_male_neg_values[5:9],2, as.numeric)
## FEmale Positive #####
QA_peAvg_female_neg_cols <-  c("Subjects", as.character(QA_peAvg_female_neg[,1]))
QA_peAvg_female_neg_values <-read.delim(
paste0(working_dir,'/average/PE/QA/female/QA_loopAvgPE_neg_pos.csv'), header = FALSE, sep = "\t") %>%
remove_empty("cols") %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>%
`colnames<-`(QA_peAvg_female_neg_cols) %>% cbind(loop_subInfo[,c("sex", "age_scan_years","loop_pe_avg_m")]) %>% filter(sex=="female")
#
# Reorder for my sanity check
QA_peAvg_female_neg_values <- QA_peAvg_female_neg_values[,c(1,10:12,2:9)]
QA_peAvg_female_neg_gathercols <- colnames(QA_peAvg_female_neg_values[5:12])
#
# # for some reason things are being read as a a character and it needs to be a numerical value
QA_peAvg_female_neg_values[5:12] <- apply(QA_peAvg_female_neg_values[5:12],2, as.numeric)
QA_neg_df <- QA_peAvg_male_neg_values[, names(QA_peAvg_male_neg_values) %in% names(QA_peAvg_female_neg_values)] %>% rbind(QA_peAvg_female_neg_values[, names(QA_peAvg_female_neg_values) %in% names(QA_peAvg_male_neg_values)])
qa_neg <- ggplot(QA_neg_df, aes(x=sex, y=.data$Corpus_Callosum_Tapetum, group=sex)) +
geom_boxplot(outlier.shape = NA,width =0.5,fill= c("#CF92BF", "#D1E7E6")) +
geom_jitter(color="black",size=0.8,alpha=0.9,width = 0.2) +
#scale_y_binned(n.breaks=10, nice.breaks = TRUE) +
stat_boxplot(geom = "errorbar",
width = 0.15) +
labs(x= "Sex", y= " QA", title ="Corpus Callosum Tapetum" ) +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
png(file = paste0(figpath,"Corpus_Callosum_Tapetum_neg_QA.png"))  #,".png"))
print(qa_neg)
dev.off()
MD_peAvg_male_pos_cols <-  c("Subjects", as.character(MD_peAvg_male_pos[,1]))
## all subs ####
MD_peAvg_all_neg <-
read.delim(
paste0(working_dir,'/average/PE/MD/allSubs/avg_MD_pe_all_neg.csv'), header = FALSE, sep = "\t") %>%
remove_empty("cols") %>%
filter(V1 %in% rows2grab) %>%
t() %>%
`colnames<-`(rows2grab) %>%
`[`(-c(1),) %>%
as.data.frame()
### Males ####
MD_peAvg_male_pos <-
read.delim(
paste0(working_dir,'/average/PE/MD/male/avg_MD_pe_male_pos.csv'), header = FALSE, sep = "\t") %>%
remove_empty("cols") %>%
filter(V1 %in% rows2grab) %>%
t() %>%
`colnames<-`(rows2grab) %>%
`[`(-c(1),) %>%
as.data.frame()
### Females#####
MD_peAvg_female_neg <-
read.delim(
paste0(working_dir,'/average/PE/MD/female/avg_MD_pe_fem_neg.csv'), header = FALSE, sep = "\t") %>%
remove_empty("cols") %>%
filter(V1 %in% rows2grab) %>%
t() %>%
`colnames<-`(rows2grab) %>%
`[`(-c(1),) %>%
as.data.frame()
###PRE ####
MD_peAvg_pre_neg <-
read.delim(
paste0(working_dir,'/average/PE/MD/pre/avg_MD_pe_pre_neg.csv'), header = FALSE, sep = "\t") %>%
remove_empty("cols") %>%
filter(V1 %in% rows2grab) %>%
t() %>%
`colnames<-`(rows2grab) %>%
`[`(-c(1),) %>%
as.data.frame()
### PERI ####
MD_peAvg_peri_neg <-
read.delim(
paste0(working_dir,'/average/PE/MD/peri/avg_MD_pe_peri_neg.csv'), header = FALSE, sep = "\t") %>%
remove_empty("cols") %>%
filter(V1 %in% rows2grab) %>%
t() %>%
`colnames<-`(rows2grab) %>%
`[`(-c(1),) %>%
as.data.frame()
### POST ####
MD_peAvg_post_neg <-
read.delim(
paste0(working_dir,'/average/PE/MD/post/avg_MD_pe_post_neg.csv'), header = FALSE, sep = "\t") %>%
remove_empty("cols") %>%
filter(V1 %in% rows2grab) %>%
t() %>%
`colnames<-`(rows2grab) %>%
`[`(-c(1),) %>%
as.data.frame()
### PERI and POST ####
MD_peAvg_peripost_neg <-
read.delim(
paste0(working_dir,'/average/PE/MD/peri_post/avg_MD_pe_peri+post_neg.csv'), header = FALSE, sep = "\t") %>%
remove_empty("cols") %>%
filter(V1 %in% rows2grab) %>%
t() %>%
`colnames<-`(rows2grab) %>%
`[`(-c(1),) %>%
as.data.frame()
MD_peAvg_male_pos_cols <-  c("Subjects", as.character(MD_peAvg_male_pos[,1]))
MD_peAvg_male_pos_values <- read.delim(
paste0(working_dir,'/average/PE/MD/male/avg_MD_pe_male_pos.csv'), header = FALSE, sep = "\t")  %>%
remove_empty("cols") %>%
filter(str_detect(V1, c("mean_md"))) %>%
`colnames<-`(MD_peAvg_male_pos_cols) %>% cbind(loop_subInfo[,c("sex", "age_scan_years","loop_pe_avg_m")]) %>% filter(sex=="male")
length(MD_peAvg_male_pos_values)
MD_peAvg_male_pos_values[16:18]
figpath <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/MD/"
MD_peAvg_male_pos_cols <-  c("Subjects", as.character(MD_peAvg_male_pos[,1]))
MD_peAvg_male_pos_values <- read.delim(
paste0(working_dir,'/average/PE/MD/male/avg_MD_pe_male_pos.csv'), header = FALSE, sep = "\t")  %>%
remove_empty("cols") %>%
filter(str_detect(V1, c("mean_md"))) %>%
`colnames<-`(MD_peAvg_male_pos_cols) %>% cbind(loop_subInfo[,c("sex", "age_scan_years","loop_pe_avg_m")]) %>% filter(sex=="male")
#
# Reorder for my sanity check
MD_peAvg_male_pos_values <- MD_peAvg_male_pos_values[,c(1,16:18,2:15)]
MD_peAvg_male_pos_gathercols <- colnames(MD_peAvg_male_pos_values[5:18])
#
# # for some reason things are being read as a a character and it needs to be a numerical value
MD_peAvg_male_pos_values[5:18] <- apply(MD_peAvg_male_pos_values[5:18],2, as.numeric)
MD_peAvg_female_neg_cols <-  c("Subjects", as.character(MD_peAvg_female_neg[,1]))
MD_peAvg_female_neg_values <-read.delim(
paste0(working_dir,'/average/PE/MD/female/avg_MD_pe_fem_neg.csv'), header = FALSE, sep = "\t") %>%
remove_empty("cols") %>%
filter(str_detect(V1, c("mean_md"))) %>%
`colnames<-`(QA_peAvg_female_neg_cols) %>% cbind(loop_subInfo[,c("sex", "age_scan_years","loop_pe_avg_m")]) %>% filter(sex=="female")
MD_peAvg_female_neg_values <-read.delim(
paste0(working_dir,'/average/PE/MD/female/avg_MD_pe_fem_neg.csv'), header = FALSE, sep = "\t")
MD_peAvg_female_neg_values <-read.delim(
paste0(working_dir,'/average/PE/MD/female/avg_MD_pe_fem_neg.csv'), header = FALSE, sep = "\t") %>%
remove_empty("cols") %>%
filter(str_detect(V1, c("mean_md")))
MD_peAvg_female_neg_cols <-  c("Subjects", as.character(MD_peAvg_female_neg[,1]))
MD_peAvg_female_neg_values <-read.delim(
paste0(working_dir,'/average/PE/MD/female/avg_MD_pe_fem_neg.csv'), header = FALSE, sep = "\t") %>%
remove_empty("cols") %>%
filter(str_detect(V1, c("mean_md"))) %>%
`colnames<-`(MD_peAvg_female_neg_cols) %>% cbind(loop_subInfo[,c("sex", "age_scan_years","loop_pe_avg_m")]) %>% filter(sex=="female")
View(MD_peAvg_female_neg_values)
## FEmale Positive #####
MD_peAvg_female_neg_cols <-  c("Subjects", as.character(MD_peAvg_female_neg[,1]))
MD_peAvg_female_neg_values <-read.delim(
paste0(working_dir,'/average/PE/MD/female/avg_MD_pe_fem_neg.csv'), header = FALSE, sep = "\t") %>%
remove_empty("cols") %>%
filter(str_detect(V1, c("mean_md"))) %>%
`colnames<-`(MD_peAvg_female_neg_cols) %>% cbind(loop_subInfo[,c("sex", "age_scan_years","loop_pe_avg_m")]) %>% filter(sex=="female")
#
# Reorder for my sanity check
MD_peAvg_female_neg_values <- MD_peAvg_female_neg_values[,c(1,16:18,2:15)]
MD_peAvg_female_neg_gathercols <- colnames(MD_peAvg_female_neg_values[5:18])
#
# # for some reason things are being read as a a character and it needs to be a numerical value
MD_peAvg_female_neg_values[5:18] <- apply(MD_peAvg_female_neg_values[5:18],2, as.numeric)
View(MD_peAvg_female_neg_values)
QA_neg_df <- MD_peAvg_male_pos_values[, names(QA_peAvg_male_neg_values) %in% names(MD_peAvg_female_neg_values)]
MD_df <- MD_peAvg_male_pos_values[, names(QA_peAvg_male_neg_values) %in% names(MD_peAvg_female_neg_values)]
View(MD_df)
MD_df <- MD_peAvg_male_pos_values[, names(QA_peAvg_male_neg_values) %in% names(MD_peAvg_female_neg_values)] %>% rbind(MD_peAvg_female_neg_values[, names(MD_peAvg_female_neg_values) %in% names(MD_peAvg_male_pos_values)])
MD_df <- MD_peAvg_male_pos_values[, names(MD_peAvg_male_pos_values) %in% names(MD_peAvg_female_neg_values)]
MD_df <- MD_peAvg_male_pos_values[, names(MD_peAvg_male_pos_values) %in% names(MD_peAvg_female_neg_values)] %>% rbind(MD_peAvg_female_neg_values[, names(MD_peAvg_female_neg_values) %in% names(MD_peAvg_male_pos_values)])
colnames(MD_df[5:18])
length(MD_dg)
length(MD_df)
figpath <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/MD/"
MD_peAvg_male_pos_cols <-  c("Subjects", as.character(MD_peAvg_male_pos[,1]))
MD_peAvg_male_pos_values <- read.delim(
paste0(working_dir,'/average/PE/MD/male/avg_MD_pe_male_pos.csv'), header = FALSE, sep = "\t")  %>%
remove_empty("cols") %>%
filter(str_detect(V1, c("mean_md"))) %>%
`colnames<-`(MD_peAvg_male_pos_cols) %>% cbind(loop_subInfo[,c("sex", "age_scan_years","loop_pe_avg_m")]) %>% filter(sex=="male")
#
# Reorder for my sanity check
MD_peAvg_male_pos_values <- MD_peAvg_male_pos_values[,c(1,16:18,2:15)]
MD_peAvg_male_pos_gathercols <- colnames(MD_peAvg_male_pos_values[5:18])
#
# # for some reason things are being read as a a character and it needs to be a numerical value
MD_peAvg_male_pos_values[5:18] <- apply(MD_peAvg_male_pos_values[5:18],2, as.numeric)
## FEmale Positive #####
MD_peAvg_female_neg_cols <-  c("Subjects", as.character(MD_peAvg_female_neg[,1]))
MD_peAvg_female_neg_values <-read.delim(
paste0(working_dir,'/average/PE/MD/female/avg_MD_pe_fem_neg.csv'), header = FALSE, sep = "\t") %>%
remove_empty("cols") %>%
filter(str_detect(V1, c("mean_md"))) %>%
`colnames<-`(MD_peAvg_female_neg_cols) %>% cbind(loop_subInfo[,c("sex", "age_scan_years","loop_pe_avg_m")]) %>% filter(sex=="female")
#
# Reorder for my sanity check
MD_peAvg_female_neg_values <- MD_peAvg_female_neg_values[,c(1,16:18,2:15)]
MD_peAvg_female_neg_gathercols <- colnames(MD_peAvg_female_neg_values[5:18])
#
# # for some reason things are being read as a a character and it needs to be a numerical value
MD_peAvg_female_neg_values[5:18] <- apply(MD_peAvg_female_neg_values[5:18],2, as.numeric)
#
MD_df <- MD_peAvg_male_pos_values[, names(MD_peAvg_male_pos_values) %in% names(MD_peAvg_female_neg_values)] %>% rbind(MD_peAvg_female_neg_values[, names(MD_peAvg_female_neg_values) %in% names(MD_peAvg_male_pos_values)])
for (ROI in colnames(MD_df[5:14])) {
print(ROI)
md_neg <- ggplot(MD_df, aes(x=sex, y=.data[[ROI]], group=sex)) +
geom_boxplot(outlier.shape = NA,width =0.5,fill= c("#CF92BF", "#D1E7E6")) +
geom_jitter(color="black",size=0.8,alpha=0.9,width = 0.2) +
#scale_y_binned(n.breaks=10, nice.breaks = TRUE) +
stat_boxplot(geom = "errorbar",
width = 0.15) +
labs(x= "Sex", y= " QA", title =paste0(ROI) ) +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
png(file = paste0(figpath,ROI,"_MD.png"))
print(ROI)
dev.off()
}
figpath <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/MD/"
MD_peAvg_male_pos_cols <-  c("Subjects", as.character(MD_peAvg_male_pos[,1]))
MD_peAvg_male_pos_values <- read.delim(
paste0(working_dir,'/average/PE/MD/male/avg_MD_pe_male_pos.csv'), header = FALSE, sep = "\t")  %>%
remove_empty("cols") %>%
filter(str_detect(V1, c("mean_md"))) %>%
`colnames<-`(MD_peAvg_male_pos_cols) %>% cbind(loop_subInfo[,c("sex", "age_scan_years","loop_pe_avg_m")]) %>% filter(sex=="male")
#
# Reorder for my sanity check
MD_peAvg_male_pos_values <- MD_peAvg_male_pos_values[,c(1,16:18,2:15)]
MD_peAvg_male_pos_gathercols <- colnames(MD_peAvg_male_pos_values[5:18])
#
# # for some reason things are being read as a a character and it needs to be a numerical value
MD_peAvg_male_pos_values[5:18] <- apply(MD_peAvg_male_pos_values[5:18],2, as.numeric)
## FEmale Positive #####
MD_peAvg_female_neg_cols <-  c("Subjects", as.character(MD_peAvg_female_neg[,1]))
MD_peAvg_female_neg_values <-read.delim(
paste0(working_dir,'/average/PE/MD/female/avg_MD_pe_fem_neg.csv'), header = FALSE, sep = "\t") %>%
remove_empty("cols") %>%
filter(str_detect(V1, c("mean_md"))) %>%
`colnames<-`(MD_peAvg_female_neg_cols) %>% cbind(loop_subInfo[,c("sex", "age_scan_years","loop_pe_avg_m")]) %>% filter(sex=="female")
#
# Reorder for my sanity check
MD_peAvg_female_neg_values <- MD_peAvg_female_neg_values[,c(1,16:18,2:15)]
MD_peAvg_female_neg_gathercols <- colnames(MD_peAvg_female_neg_values[5:18])
#
# # for some reason things are being read as a a character and it needs to be a numerical value
MD_peAvg_female_neg_values[5:18] <- apply(MD_peAvg_female_neg_values[5:18],2, as.numeric)
#
MD_df <- MD_peAvg_male_pos_values[, names(MD_peAvg_male_pos_values) %in% names(MD_peAvg_female_neg_values)] %>% rbind(MD_peAvg_female_neg_values[, names(MD_peAvg_female_neg_values) %in% names(MD_peAvg_male_pos_values)])
for (ROI in colnames(MD_df[5:14])) {
print(ROI)
md_neg <- ggplot(MD_df, aes(x=sex, y=.data[[ROI]], group=sex)) +
geom_boxplot(outlier.shape = NA,width =0.5,fill= c("#CF92BF", "#D1E7E6")) +
geom_jitter(color="black",size=0.8,alpha=0.9,width = 0.2) +
#scale_y_binned(n.breaks=10, nice.breaks = TRUE) +
stat_boxplot(geom = "errorbar",
width = 0.15) +
labs(x= "Sex", y= " QA", title =paste0(ROI) ) +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
png(file = paste0(figpath,ROI,"_MD.png"))
print(md_neg)
dev.off()
}
figpath <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/MD/"
MD_peAvg_male_pos_cols <-  c("Subjects", as.character(MD_peAvg_male_pos[,1]))
MD_peAvg_male_pos_values <- read.delim(
paste0(working_dir,'/average/PE/MD/male/avg_MD_pe_male_pos.csv'), header = FALSE, sep = "\t")  %>%
remove_empty("cols") %>%
filter(str_detect(V1, c("mean_md"))) %>%
`colnames<-`(MD_peAvg_male_pos_cols) %>% cbind(loop_subInfo[,c("sex", "age_scan_years","loop_pe_avg_m")]) %>% filter(sex=="male")
#
# Reorder for my sanity check
MD_peAvg_male_pos_values <- MD_peAvg_male_pos_values[,c(1,16:18,2:15)]
MD_peAvg_male_pos_gathercols <- colnames(MD_peAvg_male_pos_values[5:18])
#
# # for some reason things are being read as a a character and it needs to be a numerical value
MD_peAvg_male_pos_values[5:18] <- apply(MD_peAvg_male_pos_values[5:18],2, as.numeric)
## FEmale Positive #####
MD_peAvg_female_neg_cols <-  c("Subjects", as.character(MD_peAvg_female_neg[,1]))
MD_peAvg_female_neg_values <-read.delim(
paste0(working_dir,'/average/PE/MD/female/avg_MD_pe_fem_neg.csv'), header = FALSE, sep = "\t") %>%
remove_empty("cols") %>%
filter(str_detect(V1, c("mean_md"))) %>%
`colnames<-`(MD_peAvg_female_neg_cols) %>% cbind(loop_subInfo[,c("sex", "age_scan_years","loop_pe_avg_m")]) %>% filter(sex=="female")
#
# Reorder for my sanity check
MD_peAvg_female_neg_values <- MD_peAvg_female_neg_values[,c(1,16:18,2:15)]
MD_peAvg_female_neg_gathercols <- colnames(MD_peAvg_female_neg_values[5:18])
#
# # for some reason things are being read as a a character and it needs to be a numerical value
MD_peAvg_female_neg_values[5:18] <- apply(MD_peAvg_female_neg_values[5:18],2, as.numeric)
#
MD_df <- MD_peAvg_male_pos_values[, names(MD_peAvg_male_pos_values) %in% names(MD_peAvg_female_neg_values)] %>% rbind(MD_peAvg_female_neg_values[, names(MD_peAvg_female_neg_values) %in% names(MD_peAvg_male_pos_values)])
for (ROI in colnames(MD_df[5:14])) {
print(ROI)
md_neg <- ggplot(MD_df, aes(x=sex, y=.data[[ROI]], group=sex)) +
geom_boxplot(outlier.shape = NA,width =0.5,fill= c("#CF92BF", "#D1E7E6")) +
geom_jitter(color="black",size=0.8,alpha=0.9,width = 0.2) +
#scale_y_binned(n.breaks=10, nice.breaks = TRUE) +
stat_boxplot(geom = "errorbar",
width = 0.15) +
labs(x= "Sex", y= " MD", title =paste0(ROI) ) +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
png(file = paste0(figpath,ROI,"_MD.png"))
print(md_neg)
dev.off()
}
