bracket.size = 1,
label.size = 10,
tip.length = c(0.05,0.05 )) +
scale_y_continuous(n.breaks = 4)
print(MD_L_Fornix)
dev.off
MD_p_val <- data.frame(
group1 = "female",
group2 = "male",
label = "*",
y.position = 1.4
)
pdf(file = paste0(figpath,"corr_MD_FornixL.pdf"), width = 10, height=8)
MD_L_Fornix <- MDdf %>%
ggplot(aes(x=sex, y= md_Fornix_L)) +
geom_boxplot(width=0.5 ,fill= c("#E45A5A", "#80792B")) +
scale_y_binned(n.breaks=10, nice.breaks = TRUE) +
labs(x= "Sex", y= " MD" ) +
theme(axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_text(size = 25),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(3, 2, 3, 2, "cm")) +
add_pvalue(MD_p_val,
xmin = "group1",
xmax = "group2",
label = "label",
y.position = "y.position",# bracket
bracket.size = 1,
label.size = 10,
tip.length = c(0.05,0.05 )) +
scale_y_continuous(n.breaks = 5)
print(MD_L_Fornix)
dev.off
MD_p_val <- data.frame(
group1 = "female",
group2 = "male",
label = "*",
y.position = 1.4
)
pdf(file = paste0(figpath,"corr_MD_FornixL.pdf"), width = 10, height=8)
MD_L_Fornix <- MDdf %>%
ggplot(aes(x=sex, y= md_Fornix_L)) +
geom_boxplot(width=0.5 ,fill= c("#E45A5A", "#80792B")) +
scale_y_binned(n.breaks=10, nice.breaks = TRUE) +
labs(x= "Sex", y= " MD" ) +
theme(axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_text(size = 25),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(3, 2, 3, 2, "cm")) +
add_pvalue(MD_p_val,
xmin = "group1",
xmax = "group2",
label = "label",
y.position = "y.position",# bracket
bracket.size = 1,
label.size = 10,
tip.length = c(0.05,0.05 )) +
scale_y_continuous(n.breaks = 4.5)
print(MD_L_Fornix)
dev.off
MD_p_val <- data.frame(
group1 = "female",
group2 = "male",
label = "*",
y.position = 1.4
)
pdf(file = paste0(figpath,"corr_MD_FornixL.pdf"), width = 10, height=8)
MD_L_Fornix <- MDdf %>%
ggplot(aes(x=sex, y= md_Fornix_L)) +
geom_boxplot(width=0.5 ,fill= c("#E45A5A", "#80792B")) +
scale_y_binned(n.breaks=10, nice.breaks = TRUE) +
labs(x= "Sex", y= " MD" ) +
theme(axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_text(size = 25),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(3, 2, 3, 2, "cm")) +
add_pvalue(MD_p_val,
xmin = "group1",
xmax = "group2",
label = "label",
y.position = "y.position",# bracket
bracket.size = 1,
label.size = 10,
tip.length = c(0.05,0.05 )) +
scale_y_continuous(n.breaks = 4)
print(MD_L_Fornix)
dev.off
MD_p_val <- data.frame(
group1 = "female",
group2 = "male",
label = "*",
y.position = 1.4
)
pdf(file = paste0(figpath,"corr_MD_FornixL.pdf"), width = 10, height=8)
MD_L_Fornix <- MDdf %>%
ggplot(aes(x=sex, y= md_Fornix_L)) +
geom_boxplot(width=0.5 ,fill= c("#E45A5A", "#80792B")) +
scale_y_binned(n.breaks=10, nice.breaks = TRUE) +
labs(x= "Sex", y= " MD" ) +
theme(axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_text(size = 25),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(3, 2, 3, 2, "cm")) +
add_pvalue(MD_p_val,
xmin = "group1",
xmax = "group2",
label = "label",
y.position = "y.position",# bracket
bracket.size = 1,
label.size = 10,
tip.length = c(0.05,0.05 )) +
ylim(0,1.4) +
scale_y_continuous(n.breaks = 4)
print(MD_L_Fornix)
dev.off
MD_p_val <- data.frame(
group1 = "female",
group2 = "male",
label = "*",
y.position = 1.4
)
pdf(file = paste0(figpath,"corr_MD_FornixL.pdf"), width = 10, height=8)
MD_L_Fornix <- MDdf %>%
ggplot(aes(x=sex, y= md_Fornix_L)) +
geom_boxplot(width=0.5 ,fill= c("#E45A5A", "#80792B")) +
scale_y_binned(n.breaks=10, nice.breaks = TRUE) +
labs(x= "Sex", y= " MD" ) +
theme(axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_text(size = 25),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(3, 2, 3, 2, "cm")) +
add_pvalue(MD_p_val,
xmin = "group1",
xmax = "group2",
label = "label",
y.position = "y.position",# bracket
bracket.size = 1,
label.size = 10,
tip.length = c(0.05,0.05 )) +
ylim(0,1.4) #+
#scale_y_continuous(n.breaks = 4)
print(MD_L_Fornix)
dev.off
MD_p_val <- data.frame(
group1 = "female",
group2 = "male",
label = "*",
y.position = 1.4
)
pdf(file = paste0(figpath,"corr_MD_FornixL.pdf"), width = 10, height=8)
MD_L_Fornix <- MDdf %>%
ggplot(aes(x=sex, y= md_Fornix_L)) +
geom_boxplot(width=0.5 ,fill= c("#E45A5A", "#80792B")) +
scale_y_binned(n.breaks=10, nice.breaks = TRUE) +
labs(x= "Sex", y= " MD" ) +
theme(axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_text(size = 25),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(3, 2, 3, 2, "cm")) +
add_pvalue(MD_p_val,
xmin = "group1",
xmax = "group2",
label = "label",
y.position = "y.position",# bracket
bracket.size = 1,
label.size = 10,
tip.length = c(0.05,0.05 )) +
ylim(0,2.0) #+
#scale_y_continuous(n.breaks = 4)
print(MD_L_Fornix)
dev.off
MD_p_val <- data.frame(
group1 = "female",
group2 = "male",
label = "*",
y.position = 1.4
)
pdf(file = paste0(figpath,"corr_MD_FornixL.pdf"), width = 10, height=8)
MD_L_Fornix <- MDdf %>%
ggplot(aes(x=sex, y= md_Fornix_L)) +
geom_boxplot(width=0.5 ,fill= c("#E45A5A", "#80792B")) +
scale_y_binned(n.breaks=10, nice.breaks = TRUE) +
labs(x= "Sex", y= " MD" ) +
theme(axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_text(size = 25),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(3, 2, 3, 2, "cm")) +
add_pvalue(MD_p_val,
xmin = "group1",
xmax = "group2",
label = "label",
y.position = "y.position",# bracket
bracket.size = 1,
label.size = 10,
tip.length = c(0.05,0.05 )) +
ylim(0,1.5) #+
#scale_y_continuous(n.breaks = 4)
print(MD_L_Fornix)
dev.off
MD_p_val <- data.frame(
group1 = "female",
group2 = "male",
label = "*",
y.position = 1.4
)
pdf(file = paste0(figpath,"corr_MD_FornixL.pdf"), width = 10, height=8)
MD_L_Fornix <- MDdf %>%
ggplot(aes(x=sex, y= md_Fornix_L)) +
geom_boxplot(width=0.5 ,fill= c("#E45A5A", "#80792B")) +
scale_y_binned(n.breaks=10, nice.breaks = TRUE) +
labs(x= "Sex", y= " MD" ) +
theme(axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_text(size = 25),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(3, 2, 3, 2, "cm")) +
add_pvalue(MD_p_val,
xmin = "group1",
xmax = "group2",
label = "label",
y.position = "y.position",# bracket
bracket.size = 1,
label.size = 10,
tip.length = c(0.05,0.05 )) +
ylim(min(MDdf$md_Fornix_L),1.5) #+
#scale_y_continuous(n.breaks = 4)
print(MD_L_Fornix)
dev.off
MD_p_val <- data.frame(
group1 = "female",
group2 = "male",
label = "*",
y.position = 1.4
)
pdf(file = paste0(figpath,"corr_MD_FornixL.pdf"), width = 10, height=8)
MD_L_Fornix <- MDdf %>%
ggplot(aes(x=sex, y= md_Fornix_L)) +
geom_boxplot(width=0.5 ,fill= c("#E45A5A", "#80792B")) +
scale_y_binned(n.breaks=10, nice.breaks = TRUE) +
labs(x= "Sex", y= " MD" ) +
theme(axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_text(size = 25),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(3, 2, 3, 2, "cm")) +
ylim(min(MDdf$md_Fornix_L),1.5) #+
#scale_y_continuous(n.breaks = 4)
print(MD_L_Fornix)
dev.off
library(ggplot2)
#(plyr)
library(tidyverse)
# library(dplyr)
# library(tidyr)
library(stringr)
library(kableExtra)
# library(data.table)
# library(network)
# library(tidygraph)
# library(ggraph)
# library(igraph)
# library(networkD3)
# library(CINNA)
# library(umap)
# library(plotly)
#library(factoextra)
#library(lsr)
library(car)
library(ggpubr)
#library(entropy)
#library(ds4psy)
# library(pROC)
#library(devtools)
#library(BRRR)
library(stats)
#library(afex)
library(knitr)
library(janitor)
# library(car)
# library(ggiraph)
library(ggiraphExtra)
# library(moonBook)
library(nationalparkcolors)
npc_everglades <- park_palette("Everglades")
npc_channel <- park_palette("ChannelIslands")
npc_saguaro <- park_palette("Saguaro")
knitr::opts_chunk$set(warning=FALSE, message=FALSE, echo = FALSE,
fig.align = "center")
working_dir <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop"
rows2grab <- c("Tract Name", "number of tracts","mean length(mm)","diameter(mm)", "volume(mm^3)")
loop_subInfo <- read.csv("/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/loop_subinfo.csv")
for (row in 1:nrow(loop_subInfo)) {
if (loop_subInfo[row,2] == 0) {
loop_subInfo[row,2] <- "female"
} else {
loop_subInfo[row,2] <- "male"
}
}
## all subs ####
MD_peAvg_all_neg <-
read.delim(
paste0(working_dir,'/average/PE/MD/allSubs/avg_MD_pe_all_neg.csv'), header = FALSE, sep = "\t") %>%
remove_empty("cols") %>%
filter(V1 %in% rows2grab) %>%
t() %>%
`colnames<-`(rows2grab) %>%
`[`(-c(1),) %>%
as.data.frame()
### Males ####
MD_peAvg_male_pos <-
read.delim(
paste0(working_dir,'/average/PE/MD/male/avg_MD_pe_male_pos.csv'), header = FALSE, sep = "\t") %>%
remove_empty("cols") %>%
filter(V1 %in% rows2grab) %>%
t() %>%
`colnames<-`(rows2grab) %>%
`[`(-c(1),) %>%
as.data.frame()
### Females#####
MD_peAvg_female_neg <-
read.delim(
paste0(working_dir,'/average/PE/MD/female/avg_MD_pe_fem_neg.csv'), header = FALSE, sep = "\t") %>%
remove_empty("cols") %>%
filter(V1 %in% rows2grab) %>%
t() %>%
`colnames<-`(rows2grab) %>%
`[`(-c(1),) %>%
as.data.frame()
###PRE ####
MD_peAvg_pre_neg <-
read.delim(
paste0(working_dir,'/average/PE/MD/pre/avg_MD_pe_pre_neg.csv'), header = FALSE, sep = "\t") %>%
remove_empty("cols") %>%
filter(V1 %in% rows2grab) %>%
t() %>%
`colnames<-`(rows2grab) %>%
`[`(-c(1),) %>%
as.data.frame()
### PERI ####
MD_peAvg_peri_neg <-
read.delim(
paste0(working_dir,'/average/PE/MD/peri/avg_MD_pe_peri_neg.csv'), header = FALSE, sep = "\t") %>%
remove_empty("cols") %>%
filter(V1 %in% rows2grab) %>%
t() %>%
`colnames<-`(rows2grab) %>%
`[`(-c(1),) %>%
as.data.frame()
### POST ####
MD_peAvg_post_neg <-
read.delim(
paste0(working_dir,'/average/PE/MD/post/avg_MD_pe_post_neg.csv'), header = FALSE, sep = "\t") %>%
remove_empty("cols") %>%
filter(V1 %in% rows2grab) %>%
t() %>%
`colnames<-`(rows2grab) %>%
`[`(-c(1),) %>%
as.data.frame()
### PERI and POST ####
MD_peAvg_peripost_neg <-
read.delim(
paste0(working_dir,'/average/PE/MD/peri_post/avg_MD_pe_peri+post_neg.csv'), header = FALSE, sep = "\t") %>%
remove_empty("cols") %>%
filter(V1 %in% rows2grab) %>%
t() %>%
`colnames<-`(rows2grab) %>%
`[`(-c(1),) %>%
as.data.frame()
figpath <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/MD/"
MD_peAvg_male_pos_cols <-  c("Subjects", as.character(MD_peAvg_male_pos[,1]))
MD_peAvg_male_pos_values <- read.delim(
paste0(working_dir,'/average/PE/MD/male/avg_MD_pe_male_pos.csv'), header = FALSE, sep = "\t")  %>%
remove_empty("cols") %>%
filter(str_detect(V1, c("mean_md"))) %>%
`colnames<-`(MD_peAvg_male_pos_cols) %>% cbind(loop_subInfo[,c("sex", "age_scan_years","loop_pe_avg_m")]) %>% filter(sex=="male")
#
# Reorder for my sanity check
MD_peAvg_male_pos_values <- MD_peAvg_male_pos_values[,c(1,16:18,2:15)]
MD_peAvg_male_pos_gathercols <- colnames(MD_peAvg_male_pos_values[5:18])
#
# # for some reason things are being read as a a character and it needs to be a numerical value
MD_peAvg_male_pos_values[5:18] <- apply(MD_peAvg_male_pos_values[5:18],2, as.numeric)
## FEmale Positive #####
MD_peAvg_female_neg_cols <-  c("Subjects", as.character(MD_peAvg_female_neg[,1]))
MD_peAvg_female_neg_values <-read.delim(
paste0(working_dir,'/average/PE/MD/female/avg_MD_pe_fem_neg.csv'), header = FALSE, sep = "\t") %>%
remove_empty("cols") %>%
filter(str_detect(V1, c("mean_md"))) %>%
`colnames<-`(MD_peAvg_female_neg_cols) %>% cbind(loop_subInfo[,c("sex", "age_scan_years","loop_pe_avg_m")]) %>% filter(sex=="female")
#
# Reorder for my sanity check
MD_peAvg_female_neg_values <- MD_peAvg_female_neg_values[,c(1,16:18,2:15)]
MD_peAvg_female_neg_gathercols <- colnames(MD_peAvg_female_neg_values[5:18])
#
# # for some reason things are being read as a a character and it needs to be a numerical value
MD_peAvg_female_neg_values[5:18] <- apply(MD_peAvg_female_neg_values[5:18],2, as.numeric)
#
MD_df <- MD_peAvg_male_pos_values[, names(MD_peAvg_male_pos_values) %in% names(MD_peAvg_female_neg_values)] %>% rbind(MD_peAvg_female_neg_values[, names(MD_peAvg_female_neg_values) %in% names(MD_peAvg_male_pos_values)])
for (ROI in colnames(MD_df[5:14])) {
print(ROI)
md_neg <- ggplot(MD_df, aes(x=sex, y=.data[[ROI]], group=sex)) +
geom_boxplot(outlier.shape = NA,width =0.5,fill= c("#CF92BF", "#D1E7E6")) +
geom_jitter(color="black",size=0.8,alpha=0.9,width = 0.2) +
#scale_y_binned(n.breaks=10, nice.breaks = TRUE) +
stat_boxplot(geom = "errorbar",
width = 0.15) +
labs(x= "Sex", y= " MD", title =paste0(ROI) ) +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
png(file = paste0(figpath,ROI,"_MD.png"))
print(md_neg)
dev.off()
}
MD_df<- MD_df %>% mutate(sex_bin = MD_df$sex)
for (row in 1:nrow(MD_df)) {
if (MD_df[row,c("sex_bin")] == "female") {
MD_df[row,c("sex_bin")] <- 0
} else {
MD_df[row,c("sex_bin")] <- 1
}
}
model <- lm(loop_pe_avg_m ~ Fornix_L + sex, data = MD_df)
summary(model)
figpath <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/MD/"
pdf(file = paste0(figpath,"corr_MD_FornixR.pdf"),width=10, height=8)  #ROI,".png"))
ggplot(data = MD_df, aes(x =Fornix_R, y = loop_pe_avg_m, color=factor(sex))) +
geom_point()+
stat_smooth(method="lm",se=FALSE)+
scale_color_manual(values = c("#E45A5A", "#80792B"),name="Sex") +
labs(
x = "Fornix R",
y = "Position Error") +
theme(legend.position = "right",
axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.text.x = element_text(size = 25),
axis.text.y = element_text(size = 25),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
legend.key.size = unit(2, 'cm'),
legend.title = element_text(size=18), #change legend title font size
legend.text = element_text(size=18),
plot.margin = margin(3, 2, 3, 2, "cm")) +
xlim(0.5,2)  +
annotate("text", label = "FDR= 0.000576", x = 1.8 , y = 3, color="#E45A5A", size=7) +
annotate("text", label = "FDR= 0.022854", x = 1.8 , y = 2.8, color="#80792B", size=7)
dev.off()
MD_df<- MD_df %>% mutate(sex_bin = MD_df$sex)
for (row in 1:nrow(MD_df)) {
if (MD_df[row,c("sex_bin")] == "female") {
MD_df[row,c("sex_bin")] <- 0
} else {
MD_df[row,c("sex_bin")] <- 1
}
}
model <- lm(loop_pe_avg_m ~ Fornix_L + sex, data = MD_df)
summary(model)
figpath <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/MD/"
pdf(file = paste0(figpath,"corr_MD_FornixL.pdf"),width=10, height=8)  #ROI,".png"))
ggplot(data = MD_df, aes(x =Fornix_L, y = loop_pe_avg_m, color=factor(sex))) +
geom_point()+
stat_smooth(method="lm",se=FALSE)+
scale_color_manual(values = c("#E45A5A", "#80792B"),name="Sex") +
labs(
x = "Fornix L",
y = "Position Error") +
theme(legend.position = "right",
axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.text.x = element_text(size = 25),
axis.text.y = element_text(size = 25),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
legend.key.size = unit(2, 'cm'),
legend.title = element_text(size=18), #change legend title font size
legend.text = element_text(size=18),
plot.margin = margin(3, 2, 3, 2, "cm")) +
xlim(0.5,2)  +
annotate("text", label = "FDR= 0.000576", x = 1.8 , y = 3, color="#E45A5A", size=7) +
annotate("text", label = "FDR= 0.022854", x = 1.8 , y = 2.8, color="#80792B", size=7)
dev.off()
