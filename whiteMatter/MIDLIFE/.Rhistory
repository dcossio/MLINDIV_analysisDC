x = "Fornix R",
y = "Proportion Correct")+
theme(legend.position = "right",
axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
#plot.margin = margin(0.5, 1, ,1, "cm"),
legend.key.size = unit(1, 'cm'),
aspect.ratio = 20 / 30,
plot.title = element_text(hjust = 0.5, vjust = 5, size = 16, face="bold"))  +
stat_cor(aes(color= sex),method = "spearman", label.x.npc = 0.7, label.y.npc = 0.9, size=4)  +
xlim(min(MD_acc_corr_DF$all_positive_tracts), max(MD_acc_corr_DF$all_positive_tracts)) +
annotate("text", label = "FDR=", x = 1.68 , y = 0.75, color="#90A0C9", size=4) +
annotate("text", label = "FDR=", x = 1.68 , y = 0.70, color="#CF92BF", size=4)
ggplot(data = MD_acc_corr_DF, aes(x = all_positive_tracts, y = maze_accuracy_pct)) +
geom_point(aes(color = factor(sex))) +
scale_color_manual(values = c("#CF92BF", "#90A0C9"),name="Gender")
ggplot(data = MD_acc_corr_DF, aes(x = all_positive_tracts, y = maze_accuracy_pct)) +
geom_point() + #aes(color = factor(sex))) +
scale_color_manual()+#values = c("#CF92BF", "#90A0C9"),name="Gender")+
geom_smooth(method = lm, fullrange=TRUE)
ggplot(data = MD_acc_corr_DF, aes(x = all_positive_tracts, y = maze_accuracy_pct)) +
geom_point() + #aes(color = factor(sex))) +
scale_color_manual()+#values = c("#CF92BF", "#90A0C9"),name="Gender")+
geom_smooth(method = lm, fullrange=TRUE) +#
#aes(color = factor(sex))) +
labs(title = "Accuracy correlated with MD \n in the fornix in men and women",
x = "Fornix R",
y = "Proportion Correct")+
theme(legend.position = "right",
axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
#plot.margin = margin(0.5, 1, ,1, "cm"),
legend.key.size = unit(1, 'cm'),
aspect.ratio = 20 / 30,
plot.title = element_text(hjust = 0.5, vjust = 5, size = 16, face="bold"))  +
stat_cor(aes(color= sex),method = "spearman", label.x.npc = 0.7, label.y.npc = 0.9, size=4)  +
xlim(min(MD_acc_corr_DF$all_positive_tracts), max(MD_acc_corr_DF$all_positive_tracts)) +
annotate("text", label = "FDR=", x = 1.68 , y = 0.75, color="#90A0C9", size=4) +
annotate("text", label = "FDR=", x = 1.68 , y = 0.70, color="#CF92BF", size=4)
ggplot(data = MD_acc_corr_DF, aes(x = all_positive_tracts, y = maze_accuracy_pct)) +
geom_point() + #aes(color = factor(sex))) +
scale_color_manual()+#values = c("#CF92BF", "#90A0C9"),name="Gender")+
geom_smooth(method = lm, fullrange=TRUE) +#
#aes(color = factor(sex))) +
labs(title = "Accuracy correlated with MD \n in the fornix in men and women",
x = "Fornix R",
y = "Proportion Correct")+
theme(legend.position = "right",
axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
#plot.margin = margin(0.5, 1, ,1, "cm"),
legend.key.size = unit(1, 'cm'),
aspect.ratio = 20 / 30,
plot.title = element_text(hjust = 0.5, vjust = 5, size = 16, face="bold"))
ggplot(data = MD_acc_corr_DF, aes(x = all_positive_tracts, y = maze_accuracy_pct)) +
geom_point() + #aes(color = factor(sex))) +
scale_color_manual()+#values = c("#CF92BF", "#90A0C9"),name="Gender")+
#geom_smooth(method = lm, fullrange=TRUE) +#
#aes(color = factor(sex))) +
labs(title = "Accuracy correlated with MD \n in the fornix in men and women",
x = "Fornix R",
y = "Proportion Correct")+
theme(legend.position = "right",
axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
#plot.margin = margin(0.5, 1, ,1, "cm"),
legend.key.size = unit(1, 'cm'),
aspect.ratio = 20 / 30,
plot.title = element_text(hjust = 0.5, vjust = 5, size = 16, face="bold"))  +
stat_cor(aes(color= sex),method = "spearman", label.x.npc = 0.7, label.y.npc = 0.9, size=4)  +
xlim(min(MD_acc_corr_DF$all_positive_tracts), max(MD_acc_corr_DF$all_positive_tracts)) +
annotate("text", label = "FDR=", x = 1.68 , y = 0.75, color="#90A0C9", size=4) +
annotate("text", label = "FDR=", x = 1.68 , y = 0.70, color="#CF92BF", size=4)
ggplot(data = MD_acc_corr_DF, aes(x = all_positive_tracts, y = maze_accuracy_pct)) +
geom_point() + #aes(color = factor(sex))) +
scale_color_manual()+#values = c("#CF92BF", "#90A0C9"),name="Gender")+
#geom_smooth(method = lm, fullrange=TRUE) +#
#aes(color = factor(sex))) +
labs(title = "Accuracy correlated with MD \n in the fornix in men and women",
x = "Fornix R",
y = "Proportion Correct")+
theme(legend.position = "right",
axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
#plot.margin = margin(0.5, 1, ,1, "cm"),
legend.key.size = unit(1, 'cm'),
aspect.ratio = 20 / 30,
plot.title = element_text(hjust = 0.5, vjust = 5, size = 16, face="bold"))  +
stat_cor(aes(color= sex),method = "spearman", label.x.npc = 0.7, label.y.npc = 0.9, size=4)
ggplot(data = MD_acc_corr_DF, aes(x = all_positive_tracts, y = maze_accuracy_pct)) +
geom_point() + #aes(color = factor(sex))) +
scale_color_manual()+#values = c("#CF92BF", "#90A0C9"),name="Gender")+
#geom_smooth(method = lm, fullrange=TRUE) +#
#aes(color = factor(sex))) +
labs(title = "Accuracy correlated with MD \n in the fornix in men and women",
x = "Fornix R",
y = "Proportion Correct")+
theme(legend.position = "right",
axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
#plot.margin = margin(0.5, 1, ,1, "cm"),
legend.key.size = unit(1, 'cm'),
aspect.ratio = 20 / 30,
plot.title = element_text(hjust = 0.5, vjust = 5, size = 16, face="bold"))  +
stat_cor(aes(color= sex),method = "spearman", label.x.npc = 0.2, label.y.npc = 0.2, size=4)  +
xlim(min(MD_acc_corr_DF$all_positive_tracts), max(MD_acc_corr_DF$all_positive_tracts)) +
annotate("text", label = "FDR=", x = 1.68 , y = 0.75, color="#90A0C9", size=4) +
annotate("text", label = "FDR=", x = 1.68 , y = 0.70, color="#CF92BF", size=4)
ggplot(data = MD_acc_corr_DF, aes(x = all_positive_tracts, y = maze_accuracy_pct)) +
geom_point() + #aes(color = factor(sex))) +
scale_color_manual()+#values = c("#CF92BF", "#90A0C9"),name="Gender")+
#geom_smooth(method = lm, fullrange=TRUE) +#
#aes(color = factor(sex))) +
labs(title = "Accuracy correlated with MD \n in the fornix in men and women",
x = "Fornix R",
y = "Proportion Correct")+
theme(legend.position = "right",
axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
#plot.margin = margin(0.5, 1, ,1, "cm"),
legend.key.size = unit(1, 'cm'),
aspect.ratio = 20 / 30,
plot.title = element_text(hjust = 0.5, vjust = 5, size = 16, face="bold"))  +
stat_cor(aes(color= sex),method = "spearman", label.x.npc = 0.2, label.y.npc = 0.2, size=4)
ggplot(data = MD_acc_corr_DF, aes(x = all_positive_tracts, y = maze_accuracy_pct)) +
geom_point() + #aes(color = factor(sex))) +
scale_color_manual()+#values = c("#CF92BF", "#90A0C9"),name="Gender")+
#geom_smooth(method = lm, fullrange=TRUE) +#
#aes(color = factor(sex))) +
labs(title = "Accuracy correlated with MD \n in the fornix in men and women",
x = "Fornix R",
y = "Proportion Correct")+
theme(legend.position = "right",
axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
#plot.margin = margin(0.5, 1, ,1, "cm"),
legend.key.size = unit(1, 'cm'),
aspect.ratio = 20 / 30,
plot.title = element_text(hjust = 0.5, vjust = 5, size = 16, face="bold"))  +
stat_cor(aes(color= sex),method = "spearman")  +
xlim(min(MD_acc_corr_DF$all_positive_tracts), max(MD_acc_corr_DF$all_positive_tracts)) +
annotate("text", label = "FDR=", x = 1.68 , y = 0.75, color="#90A0C9", size=4) +
annotate("text", label = "FDR=", x = 1.68 , y = 0.70, color="#CF92BF", size=4)
ggplot(data = MD_acc_corr_DF, aes(x = all_positive_tracts, y = maze_accuracy_pct)) +
geom_point() + #aes(color = factor(sex))) +
scale_color_manual()+#values = c("#CF92BF", "#90A0C9"),name="Gender")+
#geom_smooth(method = lm, fullrange=TRUE) +#
#aes(color = factor(sex))) +
labs(title = "Accuracy correlated with MD \n in the fornix in men and women",
x = "Fornix R",
y = "Proportion Correct")+
theme(legend.position = "right",
axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
#plot.margin = margin(0.5, 1, ,1, "cm"),
legend.key.size = unit(1, 'cm'),
aspect.ratio = 20 / 30,
plot.title = element_text(hjust = 0.5, vjust = 5, size = 16, face="bold"))  +
stat_cor(aes(color= sex),method = "spearman")  +
xlim(min(MD_acc_corr_DF$all_positive_tracts), max(MD_acc_corr_DF$all_positive_tracts))
ggplot(data = MD_acc_corr_DF, aes(x = all_positive_tracts, y = maze_accuracy_pct)) +
geom_point() + #aes(color = factor(sex))) +
scale_color_manual()+#values = c("#CF92BF", "#90A0C9"),name="Gender")+
geom_smooth(method = lm, fullrange=TRUE) +#
#aes(color = factor(sex))) +
labs(title = "Accuracy correlated with MD \n in the fornix in men and women",
x = "Fornix R",
y = "Proportion Correct")+
theme(legend.position = "right",
axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
#plot.margin = margin(0.5, 1, ,1, "cm"),
legend.key.size = unit(1, 'cm'),
aspect.ratio = 20 / 30,
plot.title = element_text(hjust = 0.5, vjust = 5, size = 16, face="bold"))  +
stat_cor( method = "spearman")
ggplot(data = MD_acc_corr_DF, aes(x = all_positive_tracts, y = maze_accuracy_pct)) +
geom_point() + #aes(color = factor(sex))) +
scale_color_manual()+#values = c("#CF92BF", "#90A0C9"),name="Gender")+
geom_smooth(method = lm, fullrange=TRUE) +#
#aes(color = factor(sex))) +
labs(title = "Accuracy correlated with MD \n in the fornix in men and women",
x = "Fornix R",
y = "Proportion Correct")+
theme(legend.position = "right",
axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
#plot.margin = margin(0.5, 1, ,1, "cm"),
legend.key.size = unit(1, 'cm'),
aspect.ratio = 20 / 30,
plot.title = element_text(hjust = 0.5, vjust = 5, size = 16, face="bold"))  +
stat_cor( aes(label = paste(..rr.label.., ..p.label.., sep = "~`,`~")) ,method = "spearman")
ggplot(data = MD_acc_corr_DF, aes(x = all_positive_tracts, y = maze_accuracy_pct)) +
geom_point() + #aes(color = factor(sex))) +
scale_color_manual()+#values = c("#CF92BF", "#90A0C9"),name="Gender")+
geom_smooth(method = lm, fullrange=TRUE) +#
#aes(color = factor(sex))) +
labs(title = "Accuracy correlated with MD \n in the fornix in men and women",
x = "Fornix R",
y = "Proportion Correct")+
theme(legend.position = "right",
axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
#plot.margin = margin(0.5, 1, ,1, "cm"),
legend.key.size = unit(1, 'cm'),
aspect.ratio = 20 / 30,
plot.title = element_text(hjust = 0.5, vjust = 5, size = 16, face="bold"))
ggplot(data = MD_acc_corr_DF, aes(x = all_positive_tracts, y = maze_accuracy_pct)) +
geom_point() + #aes(color = factor(sex))) +
scale_color_manual()+#values = c("#CF92BF", "#90A0C9"),name="Gender")+
geom_smooth(method = lm, fullrange=TRUE) +#
#aes(color = factor(sex))) +
labs(title = "Accuracy correlated with MD \n in the fornix in men and women",
x = "Fornix R",
y = "Proportion Correct")
ggplot(data = MD_acc_corr_DF, aes(x = all_positive_tracts, y = maze_accuracy_pct)) +
geom_point() + #aes(color = factor(sex))) +
scale_color_manual()+#values = c("#CF92BF", "#90A0C9"),name="Gender")+
geom_smooth(method = "lm")
ggplot(data = MD_acc_corr_DF, aes(x = all_positive_tracts, y = maze_accuracy_pct)) +
geom_point() + #aes(color = factor(sex))) +
#scale_color_manual()+#values = c("#CF92BF", "#90A0C9"),name="Gender")+
geom_smooth(method = "lm")
class(MD_acc_corr_DF$all_positive_tracts)
MD_acc_corr_DF$all_positive_tracts <- as.numeric(MD_acc_corr_DF$all_positive_tracts)
class(MD_acc_corr_DF$all_positive_tracts)
ggplot(data = MD_acc_corr_DF, aes(x = all_positive_tracts, y = maze_accuracy_pct)) +
geom_point() + #aes(color = factor(sex))) +
#scale_color_manual()+#values = c("#CF92BF", "#90A0C9"),name="Gender")+
geom_smooth(method = "lm")
ggplot(data = MD_acc_corr_DF, aes(x = all_positive_tracts, y = maze_accuracy_pct)) +
geom_point() + #aes(color = factor(sex))) +
#scale_color_manual()+#values = c("#CF92BF", "#90A0C9"),name="Gender")+
geom_smooth(method = "lm") +#
#aes(color = factor(sex))) +
labs(title = "Accuracy correlated with MD \n in the fornix in men and women",
x = "Fornix R",
y = "Proportion Correct")+
theme(legend.position = "right",
axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
#plot.margin = margin(0.5, 1, ,1, "cm"),
legend.key.size = unit(1, 'cm'),
aspect.ratio = 20 / 30,
plot.title = element_text(hjust = 0.5, vjust = 5, size = 16, face="bold"))  +
stat_cor( aes(label = paste(..rr.label.., ..p.label.., sep = "~`,`~")) ,method = "spearman")
ggplot(data = MD_acc_corr_DF, aes(x = all_positive_tracts, y = maze_accuracy_pct)) +
geom_point() + #aes(color = factor(sex))) +
scale_color_manual()+#values = c("#CF92BF", "#90A0C9"),name="Gender")+
geom_smooth(method = "lm", aes(color = factor(sex)))
ggplot(data = MD_acc_corr_DF, aes(x = all_positive_tracts, y = maze_accuracy_pct)) +
geom_point() + #aes(color = factor(sex))) +
scale_color_manual(values = c("#CF92BF", "#90A0C9"),name="Gender")+
geom_smooth(method = "lm", aes(color = factor(sex)))
ggplot(data = MD_acc_corr_DF, aes(x = all_positive_tracts, y = maze_accuracy_pct)) +
geom_point() + #aes(color = factor(sex))) +
scale_color_manual(values = c("#CF92BF", "#90A0C9"),name="Gender")+
geom_smooth(method = "lm", aes(color = factor(sex))) +
labs(title = "Accuracy correlated with MD \n in the fornix in men and women",
x = "Fornix R",
y = "Proportion Correct")+
theme(legend.position = "right",
axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
#plot.margin = margin(0.5, 1, ,1, "cm"),
legend.key.size = unit(1, 'cm'),
aspect.ratio = 20 / 30,
plot.title = element_text(hjust = 0.5, vjust = 5, size = 16, face="bold"))  +
stat_cor( aes(label = paste(..rr.label.., ..p.label.., sep = "~`,`~")) ,method = "spearman")
ggplot(data = MD_acc_corr_DF, aes(x = all_positive_tracts, y = maze_accuracy_pct)) +
geom_point() + #aes(color = factor(sex))) +
scale_color_manual(values = c("#CF92BF", "#90A0C9"),name="Gender")+
geom_smooth(method = "lm", aes(color = factor(sex))) +
labs(title = "Accuracy correlated with MD \n in the fornix in men and women",
x = "Fornix R",
y = "Proportion Correct")+
theme(legend.position = "right",
axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
#plot.margin = margin(0.5, 1, ,1, "cm"),
legend.key.size = unit(1, 'cm'),
aspect.ratio = 20 / 30,
plot.title = element_text(hjust = 0.5, vjust = 5, size = 16, face="bold"))  +
stat_cor( aes(color= sex),method = "spearman")  +
xlim(min(MD_acc_corr_DF$all_positive_tracts), max(MD_acc_corr_DF$all_positive_tracts))
model <- lm(maze_accuracy_pct ~ all_positive_tracts + sex + age, data = MD_acc_corr_DF)
model <- lm(maze_accuracy_pct ~ all_positive_tracts + sex + age_scan_years, data = MD_acc_corr_DF)
summary(model
)
library(car)
install.packages("carDAta")
install.packages(‘carData’)
install.packages("carData")
install.packages("carData")
library(car)
avPlots(model)
install.packages("moonBook")
library(moonBook)
require(ggiraph)
require(ggiraphExtra)
require(ply
)
install.packages("ggiraph")
install.packages("ggiraph")
install.packages("ggiraphExtra")
install.packages("ply")
library(knitr)
library(janitor)
library(car)
library(ggiraph)
library(ggiraphExtra)
library(ggiraph)
library(moonBook)
equation1=function(x){coef(model)[2]*x+coef(model)[1]}
equation2=function(x){coef(model)[2]*x+coef(model)[1]+coef(fit1)[3]}
model)[1]
coef(model)[1]
summary(mode())
summary(model
)
coef(model)[2]
model)[3]
coef(model)[3]
ggplot(MD_acc_df,aes(y=maze_accuracy_pct,x=all_positive_tracts,color=sex))+geom_point()+
stat_function(fun=equation1,geom="line",color=scales::hue_pal()(2)[1])+
stat_function(fun=equation2,geom="line",color=scales::hue_pal()(2)[2])
MD_acc_df <- MD_acc_female_neg_values %>% select("Subjects","sex", "Fornix_L", "Fornix_R")
temp_MD_acc_df <- MD_acc_male_pos_values %>% select("Subjects","sex", "Fornix_L", "Fornix_R")
MD_acc_df <- rbind(MD_acc_df, temp_MD_acc_df)
View(MD_acc_df)
MD_acc_corr_DF <- read.delim(paste0(working_dir,'maze/Accuracy/MD/allSubs/MD_all_pos_merged.csv'), header=FALSE, sep="\t") %>%
remove_empty("cols") %>%
filter(str_detect(V1, c("mean_md"))) %>%
`colnames<-`(c("subjects", "all_positive_tracts")) %>%
cbind(Acc_sub_info[,c("sex", "age_scan_years", "repo_status","maze_accuracy_pct")])
MD_acc_corr_DF$all_positive_tracts <- as.numeric(MD_acc_corr_DF$all_positive_tracts)
ggplot(MD_acc_corr_DF,aes(y=maze_accuracy_pct,x=all_positive_tracts,color=sex))+geom_point()+
stat_function(fun=equation1,geom="line",color=scales::hue_pal()(2)[1])+
stat_function(fun=equation2,geom="line",color=scales::hue_pal()(2)[2])
MD_acc_corr_DF <- read.delim(paste0(working_dir,'maze/Accuracy/MD/allSubs/MD_all_pos_merged.csv'), header=FALSE, sep="\t") %>%
remove_empty("cols") %>%
filter(str_detect(V1, c("mean_md"))) %>%
`colnames<-`(c("subjects", "all_positive_tracts")) %>%
cbind(Acc_sub_info[,c("sex", "age_scan_years", "repo_status","maze_accuracy_pct")])
MD_acc_corr_DF$all_positive_tracts <- as.numeric(MD_acc_corr_DF$all_positive_tracts)
model <- lm(maze_accuracy_pct ~ all_positive_tracts + sex + age_scan_years, data = MD_acc_corr_DF)
equation1=function(x){coef(model)[2]*x+coef(model)[1]}
equation2=function(x){coef(model)[2]*x+coef(model)[1]+coef(model)[3]}
ggplot(MD_acc_corr_DF,aes(y=maze_accuracy_pct,x=all_positive_tracts,color=sex))+geom_point()+
stat_function(fun=equation1,geom="line",color=scales::hue_pal()(2)[1])+
stat_function(fun=equation2,geom="line",color=scales::hue_pal()(2)[2])
sumamry(model)
summary(model)
ggpredict(model)
ggPredict(model)
ggPredict
help(ggPredict)
library(ggiraphExtra)
ggplot(MD_acc_corr_DF,aes(y=maze_accuracy_pct,x=all_positive_tracts,color=sex))+geom_point()+
stat_function(fun=equation1,geom="line",color=scales::hue_pal()(2)[1])+
stat_function(fun=equation2,geom="line",color=scales::hue_pal()(2)[2])
summary(model)
equation1
fitted(MD_acc_corr_DF$all_positive_tracts)
fitted(MD_acc_corr_DF)
pcor(MD_acc_all_pos)
library(ppcor)
pcor(MD_acc_all_pos)
install.packages("qgraph")
plotCorGraph(MD_acc_corr_DF)
pcor(MD_acc_all_pos$`number of tracts`,MD_acc_corr_DF$sex,MD_acc_corr_DF$age_scan_years)
pcor(MD_acc_all_pos$`number of tracts`,MD_acc_corr_DF$sex,MD_acc_corr_DF$age_scan_years)
class(MD_acc_corr_DF$age_scan_years)
View(MD_acc_corr_DF)
b <- pcor(MD_acc_all_pos$`number of tracts`,MD_acc_corr_DF$sex,MD_acc_corr_DF$age_scan_years)
b <- pcor(MD_acc_all_pos$`number of tracts`,MD_acc_corr_DF$maze_accuracy_pct, MD_acc_corr_DF$sex)
b <- pcor(MD_acc_corr_DF$all_positive_tracts,MD_acc_corr_DF$maze_accuracy_pct, MD_acc_corr_DF$sex)
b <- pcor(MD_acc_corr_DF$all_positive_tracts,MD_acc_corr_DF$maze_accuracy_pct, MD_acc_corr_DF$sex, method="spearman")
MD_acc_corr_DF$age_scan_years <- as.numeric(MD_acc_corr_DF$age_scan_years)
b <- pcor(MD_acc_corr_DF$all_positive_tracts,MD_acc_corr_DF$maze_accuracy_pct, MD_acc_corr_DF$sex, method="spearman")
View(MD_acc_female_neg_values)
b <- pcor(MD_acc_female_neg_values$maze_accuracy_pct,MD_acc_female_neg_values$Fornix_L,MD_acc_female_neg_values$age_scan_years)
MD_acc_female_neg_values$age_scan_years <- as.numeric(MD_acc_female_neg_values$age_scan_years)
b <- pcor(MD_acc_female_neg_values$maze_accuracy_pct,MD_acc_female_neg_values$Fornix_L,MD_acc_female_neg_values$age_scan_years)
class(MD_acc_female_neg_values)
class(MD_acc_female_neg_values$maze_accuracy_pct)
class(MD_acc_female_neg_values$Fornix_L)
class(MD_acc_female_neg_values$age_scan_years)
pcor(MD_acc_female_neg_values$maze_accuracy_pct,MD_acc_female_neg_values$Fornix_L,MD_acc_female_neg_values$age_scan_years)
pcor(MD_acc_female_neg_values$maze_accuracy_pct,MD_acc_female_neg_values$Fornix_L)
pcor(MD_acc_female_neg_values$maze_accuracy_pct,MD_acc_female_neg_values$Fornix_L,MD_acc_female_neg_values$age_scan_years, method="spearman")
pcor(MD_acc_female_neg_values$maze_accuracy_pct,MD_acc_female_neg_values$Fornix_L, method="spearman")
x <- MD_acc_female_neg_values$maze_accuracy_pct
x
y <- MD_acc_female_neg_values$Fornix_L
z <- MD_acc_female_neg_values$age_scan_years
pcor(x,y,z)
pcor(x,y)
hl=c(7,15,19,15,21,22,57,15,20,18)
class(hl)
x <- MD_acc_female_neg_values %>% select("Fornix_L", "age_scan_years", "maze_accuracy_pct")
x <- MD_acc_female_neg_values %>% select(c("Fornix_L", "age_scan_years", "maze_accuracy_pct")
)
MD_acc_female_neg_values
x <- MD_acc_female_neg_values %>% dyplr::select(c("Fornix_L", "age_scan_years", "maze_accuracy_pct")
)
x <- MD_acc_female_neg_values %>% dplylr::select(c("Fornix_L", "age_scan_years", "maze_accuracy_pct"))
x <- MD_acc_female_neg_values %>% dplyr::select(c("Fornix_L", "age_scan_years", "maze_accuracy_pct"))
pcor(x)
pcor(x, method"spearman")
pcor(x, method="spearman")
QA_peRad3_all_neg <- read.csv(paste0(working_dir,'/loop/rad3/PE/QA/allSubs/QA_all_neg.csv'), header=FALSE) %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()
library(ggplot2)
#(plyr)
library(tidyverse)
# library(dplyr)
# library(tidyr)
library(stringr)
library(kableExtra)
# library(data.table)
# library(network)
# library(tidygraph)
# library(ggraph)
# library(igraph)
# library(networkD3)
# library(CINNA)
# library(umap)
# library(plotly)
#library(factoextra)
#library(lsr)
# library(car)
library(ggpubr)
#library(entropy)
#library(ds4psy)
# library(pROC)
#library(devtools)
#library(BRRR)
#library(stats)
#library(afex)
library(knitr)
knitr::opts_chunk$set(warning=FALSE, message=FALSE, echo = FALSE,
fig.align = "center")
working_dir <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/"
rows2grab <- c("Tract Name", "number of tracts","mean length(mm)","diameter(mm)", "volume(mm^3)")
QA_peRad3_all_neg <- read.csv(paste0(working_dir,'/loop/rad3/PE/QA/allSubs/QA_all_neg.csv'), header=FALSE) %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()
View(QA_peRad3_all_neg)
View(QA_peRad3_all_neg)
QA_peRad3_pre_pos <- read.delim(paste0(working_dir,'/loop/rad3/PE/QA/pre/QA_pre_pos.csv'),header=FALSE, sep="\t") %>%filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame() %>% na.omit()
View(QA_peRad3_pre_pos)
QA_peRad3_pre_pos <- read.delim(paste0(working_dir,'/loop/rad3/PE/QA/pre/QA_pre_pos.csv'),header=FALSE, sep="\t") %>%filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()
View(QA_peRad3_pre_pos)
QA_peRad3_pre_pos <- read.delim(paste0(working_dir,'/loop/rad3/PE/QA/pre/QA_pre_pos.csv'),header=FALSE, sep="\t") %>%filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame() %>% na.omit()
