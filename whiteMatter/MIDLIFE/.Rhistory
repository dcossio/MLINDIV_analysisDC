mutate(age = Acc_sub_info$age_scan_years) %>%
mutate(repo_status = Acc_sub_info$repo_status) %>% filter(sex=="female")
QA_acc_female_neg_values <- QA_acc_female_neg_values[,c(1,11:13,2:10)]
QA_acc_female_neg_gathercols <- colnames(QA_acc_female_neg_values[5:13])
# for some reason things are being read as a a character and it needs to be a numerical value
QA_acc_female_neg_values[5:13] <- apply(QA_acc_female_neg_values[5:13],2, as.numeric)
# Lets  get the difference between female pos and female neg
qa_fem_diff <- setdiff(QA_acc_female_neg_gathercols , QA_acc_female_pos_gathercols)
#now just female neg vs male neg
qa_sex_diff <- setdiff(QA_acc_male_neg_gathercols,QA_acc_female_neg_gathercols) %>% cbind(. ,setdiff(QA_acc_female_neg_gathercols,QA_acc_male_neg_gathercols))
# I will be commenting out the loop since I just need one fig
figpath <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/maze/Accuracy/QA/"
QA_df <- QA_acc_male_neg_values[, !names(QA_acc_male_neg_values) %in% qa_sex_diff]
QA_df <- rbind(QA_df,QA_acc_female_neg_values[, !names(QA_acc_female_neg_values) %in% qa_sex_diff])
for (ROI in colnames(QA_df[5:7])) {
print(ROI)
y <- ggplot(QA_df, aes(x=sex, y=.data[[ROI]], group=sex)) +
geom_boxplot(outlier.shape = NA,width =0.5,fill= c("#CF92BF", "#D1E7E6")) +
geom_jitter(color="black",size=0.8,alpha=0.9,width = 0.2) +
#scale_y_binned(n.breaks=10, nice.breaks = TRUE) +
stat_boxplot(geom = "errorbar",
width = 0.15) +
labs(x= "Sex", y= " QA", title =paste0(ROI) ) +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
png(file = paste0(figpath,ROI,"_sexdiff_QA.png"))  #,".png"))
print(y)
dev.off()
}
# all subjects
MD_acc_all_pos <- read.csv(paste0(working_dir,'maze/Accuracy/MD/allSubs/MD_all_pos.csv'), header=FALSE) %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()
#MEN
MD_acc_male_pos <- read.csv(paste0(working_dir,'maze/Accuracy/MD/male/MD_male_pos.csv'), header=FALSE) %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()
MD_acc_male_neg <- read.delim(paste0(working_dir,'maze/Accuracy/MD/male/MD_male_neg.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()%>% na.omit()
# FEMALE
MD_acc_female_pos <- read.csv(paste0(working_dir,'maze/Accuracy/MD/female/MD_female_pos.csv'), header=FALSE) %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()
MD_acc_female_neg <- read.delim(paste0(working_dir,'maze/Accuracy/MD/female/MD_female_neg.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()%>% na.omit()
# PRE
MD_acc_pre_neg <- read.csv(paste0(working_dir,'maze/Accuracy/MD/pre/MD_pre_neg.csv'), header=FALSE) %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% as.data.frame() %>% `[`(-c(1),)
#PERI
MD_acc_peri_pos <- read.csv(paste0(working_dir,'maze/Accuracy/MD/peri/MD_peri_pos.csv'), header=FALSE) %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()
#POST
MD_acc_post_pos <- read.csv(paste0(working_dir,'maze/Accuracy/MD/post/MD_post_pos.csv'), header=FALSE) %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()
MD_acc_post_neg <- read.csv(paste0(working_dir,'maze/Accuracy/MD/post/MD_post_neg.csv'), header=FALSE) %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% as.data.frame() %>% `[`(-c(1),)
#Peri POST
MD_acc_peripost_pos <- read.delim(paste0(working_dir,'/maze/Accuracy/MD/peripost/MD_acc_peripost_pos.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame() %>% na.omit()
MD_acc_peripost_neg <- read.delim(paste0(working_dir,'/maze/Accuracy/MD/peripost/MD_acc_peripost_neg.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame() %>% na.omit()
# Men positive and women negative LEts do fornix
MD_acc_male_pos_cols <-  c("Subjects", as.character(MD_acc_male_pos[,1]))
#
# # Lets do just male negative since most tracts are neg
# #reading in my csv with the stats and adding in the subject info
MD_acc_male_pos_values <-read.csv(paste0(working_dir,'maze/Accuracy/MD/male/MD_male_pos.csv'), header=FALSE)%>%
filter(str_detect(V1, c("mean_md"))) %>%
`colnames<-`(MD_acc_male_pos_cols) %>% cbind(Acc_sub_info[,c("sex", "age_scan_years", "repo_status","maze_accuracy_pct")]) %>% filter(sex=="male")
#
# Reorder for my sanity check
MD_acc_male_pos_values <- MD_acc_male_pos_values[,c(1,8:11,2:7)]
MD_acc_male_pos_gathercols <- colnames(MD_acc_male_pos_values[5:11])
#
# # for some reason things are being read as a a character and it needs to be a numerical value
MD_acc_male_pos_values[5:11] <- apply(MD_acc_male_pos_values[5:11],2, as.numeric)
#  Lets do female positive
#
MD_acc_female_neg_cols <- c("Subjects", as.character(MD_acc_female_neg[,1]))
#
#
# # Lets do just male negative since most tracts are neg
# #reading in my csv with the stats and adding in the subject info
MD_acc_female_neg_values <-read.delim(paste0(working_dir,'maze/Accuracy/MD/female/MD_female_neg.csv'), header=FALSE, sep="\t") %>%
remove_empty("cols") %>%
filter(str_detect(V1, c("mean_md"))) %>%
`colnames<-`(MD_acc_female_neg_cols) %>%
cbind(Acc_sub_info[,c("sex", "age_scan_years", "repo_status","maze_accuracy_pct")]) %>%  filter(sex=="female")
#
# # Reorder for my sanity check
MD_acc_female_neg_values <- MD_acc_female_neg_values[,c(1,8:11,2:7)]
MD_acc_female_neg_gathercols <- colnames(MD_acc_female_neg_values[5:11])
#
# # for some reason things are being read as a a character and it needs to be a numerical value
MD_acc_female_neg_values[5:11] <- apply(MD_acc_female_neg_values[5:11],2, as.numeric)
#
#normality check
fem_MD_neg_norm <- shapiro.test(MD_acc_female_neg_values$Fornix_R) # not normal
male_MD_pos_norm <- shapiro.test(MD_acc_male_pos_values$Fornix_R) # not normal
sexdif_fornix_L_MD <- wilcox.test(MD_acc_male_pos_values$Fornix_L, MD_acc_female_neg_values$Fornix_L) %>% broom::tidy() # significant
sexdif_fornix_R_MD <- wilcox.test(MD_acc_male_pos_values$Fornix_R, MD_acc_female_neg_values$Fornix_R) %>% broom::tidy() # not significant
MD_sex_diff <- setdiff(MD_acc_female_neg_gathercols,MD_acc_male_pos_gathercols) %>% cbind(. ,setdiff(MD_acc_male_pos_gathercols,MD_acc_female_neg_gathercols))
figpath <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/maze/Accuracy/MD/"
MD_acc_df <- MD_acc_male_pos_values[, !names(MD_acc_male_pos_values) %in% MD_sex_diff]
MD_acc_df <- rbind(MD_acc_df,MD_acc_female_neg_values[, !names(MD_acc_female_neg_values) %in% MD_sex_diff])
MD_gathercols <- colnames(MD_acc_df[6:7])
for (ROI in MD_gathercols) {
# print(ROI)
y <-ggplot(MD_acc_df, aes(x=sex, y=.data[[ROI]], group=sex)) +
geom_boxplot(width=0.5 ,fill= c("#CF92BF", "#D1E7E6")) +
geom_jitter(color="black",alpha=0.9,width = 0.25) +
#scale_y_binned(n.breaks=10, nice.breaks = TRUE) +
stat_boxplot(geom = "errorbar",
width = 0.15) +
labs(x= "Sex", y= " MD", title =ROI ) +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
png(file = paste0(figpath,ROI,"_MD.png"))
print(y)
dev.off()
}
library(ggplot2)
#(plyr)
library(tidyverse)
# library(dplyr)
# library(tidyr)
library(stringr)
library(kableExtra)
# library(data.table)
# library(network)
# library(tidygraph)
# library(ggraph)
# library(igraph)
# library(networkD3)
# library(CINNA)
# library(umap)
# library(plotly)
#library(factoextra)
#library(lsr)
# library(car)
library(ggpubr)
#library(entropy)
#library(ds4psy)
# library(pROC)
#library(devtools)
#library(BRRR)
#library(stats)
#library(afex)
library(knitr)
library(janitor)
# library(car)
# library(ggiraph)
# library(ggiraphExtra)
# library(moonBook)
knitr::opts_chunk$set(warning=FALSE, message=FALSE, echo = FALSE,
fig.align = "center")
working_dir <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/"
rows2grab <- c("Tract Name", "number of tracts","mean length(mm)","diameter(mm)", "volume(mm^3)")
loop_subInfo <- read.csv("/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/loop_subinfo.csv")
for (row in 1:nrow(loop_subInfo)) {
if (loop_subInfo[row,2] == 0) {
loop_subInfo[row,2] <- "female"
} else {
loop_subInfo[row,2] <- "male"
}
}
QA_deAvg_male_neg_cols <-  c("Subjects", as.character(QA_deAvg_male_neg[,1]))
QA_deAvg_male_neg <- read.delim(paste0(working_dir,'/loop/average/DE/QA/male/QA_loopAvgDE_male_neg.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame() %>% na.omit()
### ALL SUBS ####
QA_deAvg_all_pos <- read.delim(paste0(working_dir,'/loop/average/DE/QA/allSubs/QA_loopAvgDE_allsubs_pos.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame() %>% na.omit()
QA_deAvg_all_neg <- read.delim(paste0(working_dir,'/loop/average/DE/QA/allSubs/QA_loopAvgDE_allsubs_neg.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame() %>% na.omit()
# MEN ####
QA_deAvg_male_neg <- read.delim(paste0(working_dir,'/loop/average/DE/QA/male/QA_loopAvgDE_male_neg.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame() %>% na.omit()
# WOMEN ####
QA_deAvg_female_pos <- read.delim(paste0(working_dir,'/loop/average/DE/QA/female/QA_loopAvgDE_fem_pos.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame() %>% na.omit()
QA_deAvg_female_neg <- read.delim(paste0(working_dir,'/loop/average/DE/QA/female/QA_loopAvgDE_fem_neg.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame() %>% na.omit()
# PRE ####
QA_deAvg_pre_neg <- read.delim(paste0(working_dir,'/loop/average/DE/QA/pre/QA_loopAvgDE_pre_neg.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame() %>% na.omit()
# PERI ####
QA_deAvg_peri_neg <- read.delim(paste0(working_dir,'/loop/average/DE/QA/peri/QA_loopAvgDE_peri_neg.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame() %>% na.omit()
#POST ####
QA_deAvg_post_neg <- read.delim(paste0(working_dir,'/loop/average/DE/QA/post/QA_loopAvgDE_post_neg.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame() %>% na.omit()
# Peri + POST ####
QA_deAvg_peripost_neg <- read.delim(paste0(working_dir,'/loop/average/DE/QA/peri_post/QA_loopAvgDE_peripost_neg.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame() %>% na.omit()
QA_deAvg_peripost_pos <- read.delim(paste0(working_dir,'/loop/average/DE/QA/peri_post/QA_loopAvgDE_peripost_pos.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame() %>% na.omit()
QA_deAvg_male_neg_cols <-  c("Subjects", as.character(QA_deAvg_male_neg[,1]))
QA_deAvg_male_neg_values <-read.delim(paste0(working_dir,'/loop/average/DE/QA/male/QA_loopAvgDE_male_neg.csv'), header=FALSE, sep="\t") %>%
remove_empty("cols") %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>%
`colnames<-`(QA_deAvg_male_neg_cols) %>% cbind(loop_subInfo[,c("sex", "age_scan_years","loop_de_avg_m")]) %>% filter(sex=="male")
QA_deAvg_male_neg_values <-read.delim(paste0(working_dir,'/loop/average/DE/QA/male/QA_loopAvgDE_male_neg.csv'), header=FALSE, sep="\t")
View(QA_deAvg_male_neg_values)
QA_deAvg_male_neg_cols <-  c("Subjects", as.character(QA_deAvg_male_neg[,1]))
QA_deAvg_male_neg_values <-read.delim(paste0(working_dir,'/loop/average/DE/QA/male/QA_loopAvgDE_male_neg.csv'), header=FALSE, sep="\t") %>%
remove_empty("cols")
QA_deAvg_male_neg_cols <-  c("Subjects", as.character(QA_deAvg_male_neg[,1]))
QA_deAvg_male_neg_values <-read.delim(paste0(working_dir,'/loop/average/DE/QA/male/QA_loopAvgDE_male_neg.csv'), header=FALSE, sep="\t") %>%
remove_empty("cols") %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm")))
QA_deAvg_male_neg_cols <-  c("Subjects", as.character(QA_deAvg_male_neg[,1]))
QA_deAvg_male_neg_values <-read.delim(paste0(working_dir,'/loop/average/DE/QA/male/QA_loopAvgDE_male_neg.csv'), header=FALSE, sep="\t") %>%
remove_empty("cols") %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>%
`colnames<-`(QA_deAvg_male_neg_cols)
library(ggplot2)
#(plyr)
library(tidyverse)
# library(dplyr)
# library(tidyr)
library(stringr)
library(kableExtra)
# library(data.table)
# library(network)
# library(tidygraph)
# library(ggraph)
# library(igraph)
# library(networkD3)
# library(CINNA)
# library(umap)
# library(plotly)
#library(factoextra)
#library(lsr)
# library(car)
library(ggpubr)
#library(entropy)
#library(ds4psy)
# library(pROC)
#library(devtools)
#library(BRRR)
#library(stats)
#library(afex)
library(knitr)
library(janitor)
# library(car)
# library(ggiraph)
# library(ggiraphExtra)
# library(moonBook)
knitr::opts_chunk$set(warning=FALSE, message=FALSE, echo = FALSE,
fig.align = "center")
working_dir <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/"
rows2grab <- c("Tract Name", "number of tracts","mean length(mm)","diameter(mm)", "volume(mm^3)")
loop_subInfo <- read.csv("/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/loop_subinfo.csv")
for (row in 1:nrow(loop_subInfo)) {
if (loop_subInfo[row,2] == 0) {
loop_subInfo[row,2] <- "female"
} else {
loop_subInfo[row,2] <- "male"
}
}
View(loop_subInfo)
QA_deAvg_male_neg_cols <-  c("Subjects", as.character(QA_deAvg_male_neg[,1]))
QA_deAvg_male_neg_values <-read.delim(paste0(working_dir,'/loop/average/DE/QA/male/QA_loopAvgDE_male_neg.csv'), header=FALSE, sep="\t") %>%
remove_empty("cols") %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>%
`colnames<-`(QA_deAvg_male_neg_cols) %>% cbind(loop_subInfo[,c("sex", "age_scan_years","loop_de_avg_degree")]) %>% filter(sex=="male")
length(QA_deAvg_male_neg_values)
# Men positive and women negative LEts do fornix  ####
QA_deAvg_male_neg_cols <-  c("Subjects", as.character(QA_deAvg_male_neg[,1]))
QA_deAvg_male_neg_values <-read.delim(paste0(working_dir,'/loop/average/DE/QA/male/QA_loopAvgDE_male_neg.csv'), header=FALSE, sep="\t") %>%
remove_empty("cols") %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>%
`colnames<-`(QA_deAvg_male_neg_cols) %>% cbind(loop_subInfo[,c("sex", "age_scan_years","loop_de_avg_degree")]) %>% filter(sex=="male")
#
# Reorder for my sanity check
QA_deAvg_male_neg_values <- QA_deAvg_male_neg_values[,c(1,22:24,2:21)]
QA_deAvg_male_neg_gathercols <- colnames(QA_deAvg_male_neg_values[5:21])
#
# # for some reason things are being read as a a character and it needs to be a numerical value
QA_deAvg_male_neg_values[5:21] <- apply(QA_deAvg_male_neg_values[5:21],2, as.numeric)
QA_deAvg_female_neg_cols <-  c("Subjects", as.character(QA_deAvg_female_neg[,1]))
QA_deAvg_female_neg_values <-read.delim(paste0(working_dir,'/loop/average/DE/QA/female/QA_loopAvgDE_fem_neg.csv'), header=FALSE, sep="\t") %>%
remove_empty("cols") %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>%
`colnames<-`(QA_deAvg_female_neg_cols) %>% cbind(loop_subInfo[,c("sex", "age_scan_years","loop_de_avg_degree")]) %>% filter(sex=="female")
View(QA_deAvg_female_neg_values)
length(QA_deAvg_female_neg_values)
QA_deAvg_female_neg_cols <-  c("Subjects", as.character(QA_deAvg_female_neg[,1]))
QA_deAvg_female_neg_values <-read.delim(paste0(working_dir,'/loop/average/DE/QA/female/QA_loopAvgDE_fem_neg.csv'), header=FALSE, sep="\t") %>%
remove_empty("cols") %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>%
`colnames<-`(QA_deAvg_female_neg_cols) %>% cbind(loop_subInfo[,c("sex", "age_scan_years","loop_de_avg_degree")]) %>% filter(sex=="female")
#
# Reorder for my sanity check
QA_deAvg_female_neg_values <- QA_deAvg_female_neg_values[,c(1,16:18,2:15)]
QA_deAvg_female_neg_gathercols <- colnames(QA_deAvg_female_neg_values[5:18])
#
# # for some reason things are being read as a a character and it needs to be a numerical value
QA_deAvg_female_neg_values[5:18] <- apply(QA_deAvg_female_neg_values[5:18],2, as.numeric)
# Men neg and women negative LEts do fornix  ####
QA_deAvg_male_neg_cols <-  c("Subjects", as.character(QA_deAvg_male_neg[,1]))
QA_deAvg_male_neg_values <-read.delim(paste0(working_dir,'/loop/average/DE/QA/male/QA_loopAvgDE_male_neg.csv'), header=FALSE, sep="\t") %>%
remove_empty("cols") %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>%
`colnames<-`(QA_deAvg_male_neg_cols) %>% cbind(loop_subInfo[,c("sex", "age_scan_years","loop_de_avg_degree")]) %>% filter(sex=="male")
#
# Reorder for my sanity check
QA_deAvg_male_neg_values <- QA_deAvg_male_neg_values[,c(1,22:24,2:21)]
QA_deAvg_male_neg_gathercols <- colnames(QA_deAvg_male_neg_values[5:21])
#
# # for some reason things are being read as a a character and it needs to be a numerical value
QA_deAvg_male_neg_values[5:21] <- apply(QA_deAvg_male_neg_values[5:21],2, as.numeric)
#  women negative  ####
QA_deAvg_female_neg_cols <-  c("Subjects", as.character(QA_deAvg_female_neg[,1]))
QA_deAvg_female_neg_values <-read.delim(paste0(working_dir,'/loop/average/DE/QA/female/QA_loopAvgDE_fem_neg.csv'), header=FALSE, sep="\t") %>%
remove_empty("cols") %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>%
`colnames<-`(QA_deAvg_female_neg_cols) %>% cbind(loop_subInfo[,c("sex", "age_scan_years","loop_de_avg_degree")]) %>% filter(sex=="female")
#
# Reorder for my sanity check
QA_deAvg_female_neg_values <- QA_deAvg_female_neg_values[,c(1,16:18,2:15)]
QA_deAvg_female_neg_gathercols <- colnames(QA_deAvg_female_neg_values[5:18])
#
# # for some reason things are being read as a a character and it needs to be a numerical value
QA_deAvg_female_neg_values[5:18] <- apply(QA_deAvg_female_neg_values[5:18],2, as.numeric)
qa_sex_diff <- setdiff(QA_deAvg_male_neg_gathercols,QA_deAvg_female_neg_gathercols) %>% cbind(. ,setdiff(QA_deAvg_female_neg_gathercols,QA_deAvg_male_neg_gathercols))
qa_sex_diff
QA_df <- QA_deAvg_male_neg_values[, !names(QA_deAvg_female_neg_values)]
QA_df <- QA_deAvg_male_neg_values[, !names(QA_deAvg_female_neg_values) %in% QA_deAvg_female_neg_values]
View(QA_df)
QA_df <- QA_deAvg_male_neg_values[, !names(QA_deAvg_female_neg_values) %in% QA_deAvg_female_neg_values]
QA_df <- rbind(QA_df,QA_acc_female_neg_values[, !names(QA_deAvg_male_neg_values) %in% QA_deAvg_male_neg_values])
QA_acc_female_neg_values[, !names(QA_deAvg_male_neg_values) %in% QA_deAvg_male_neg_values]
QA_deAvg_male_neg_values[, !names(QA_deAvg_female_neg_values) %in% QA_deAvg_female_neg_values]
QA_acc_female_neg_values[, !names(QA_deAvg_male_neg_values) %in% QA_deAvg_male_neg_values]
QA_df <- QA_deAvg_male_neg_values[, !names(QA_deAvg_male_neg_values) %in% QA_deAvg_female_neg_values]
QA_df <- QA_deAvg_male_neg_values[, !names(QA_deAvg_male_neg_values) %in% QA_deAvg_female_neg_values]
QA_df <- rbind(QA_df,QA_acc_female_neg_values[, !names(QA_acc_female_neg_values) %in% QA_deAvg_male_neg_values])
QA_acc_female_neg_values[, !names(QA_acc_female_neg_values) %in% QA_deAvg_male_neg_values]
colnames(QA_acc_female_neg_values[, !names(QA_acc_female_neg_values) %in% QA_deAvg_male_neg_values])
colnames(QA_deAvg_male_neg_values[, !names(QA_deAvg_male_neg_values) %in% QA_deAvg_female_neg_values])
View(QA_deAvg_female_neg_values)
names(QA_deAvg_male_neg_values)
names(QA_acc_female_neg_values)
View(loop_subInfo)
QA_deAvg_female_neg_cols
QA_deAvg_female_neg_values <-read.delim(paste0(working_dir,'/loop/average/DE/QA/female/QA_loopAvgDE_fem_neg.csv'), header=FALSE, sep="\t") %>%
remove_empty("cols") %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>%
`colnames<-`(QA_deAvg_female_neg_cols) %>% cbind(loop_subInfo[,c("sex", "age_scan_years","loop_de_avg_degree")]) %>% filter(sex=="female")
colnames(QA_deAvg_female_neg_values)
QA_deAvg_male_neg_cols <-  c("Subjects", as.character(QA_deAvg_male_neg[,1]))
QA_deAvg_male_neg_values <-read.delim(paste0(working_dir,'/loop/average/DE/QA/male/QA_loopAvgDE_male_neg.csv'), header=FALSE, sep="\t") %>%
remove_empty("cols") %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>%
`colnames<-`(QA_deAvg_male_neg_cols) %>% cbind(loop_subInfo[,c("sex", "age_scan_years","loop_de_avg_degree")]) %>% filter(sex=="male")
#
# Reorder for my sanity check
QA_deAvg_male_neg_values <- QA_deAvg_male_neg_values[,c(1,22:24,2:21)]
QA_deAvg_male_neg_gathercols <- colnames(QA_deAvg_male_neg_values[5:21])
#
# # for some reason things are being read as a a character and it needs to be a numerical value
QA_deAvg_male_neg_values[5:21] <- apply(QA_deAvg_male_neg_values[5:21],2, as.numeric)
#  women negative  ####
QA_deAvg_female_neg_cols <-  c("Subjects", as.character(QA_deAvg_female_neg[,1]))
QA_deAvg_female_neg_values <-read.delim(paste0(working_dir,'/loop/average/DE/QA/female/QA_loopAvgDE_fem_neg.csv'), header=FALSE, sep="\t") %>%
remove_empty("cols") %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>%
`colnames<-`(QA_deAvg_female_neg_cols) %>% cbind(loop_subInfo[,c("sex", "age_scan_years","loop_de_avg_degree")]) %>% filter(sex=="female")
#
# Reorder for my sanity check
QA_deAvg_female_neg_values <- QA_deAvg_female_neg_values[,c(1,16:18,2:15)]
QA_deAvg_female_neg_gathercols <- colnames(QA_deAvg_female_neg_values[5:18])
QA_deAvg_female_neg_gathercols
names(QA_deAvg_female_neg_values)
QA_df <- QA_deAvg_male_neg_values[, !names(QA_deAvg_male_neg_values) %in% QA_deAvg_female_neg_values]
QA_df <- rbind(QA_df,QA_acc_female_neg_values[, !names(QA_acc_female_neg_values) %in% QA_deAvg_male_neg_values])
QA_df <- QA_deAvg_male_neg_values[, !names(QA_deAvg_male_neg_values) %in% QA_deAvg_female_neg_values]
View(QA_df)
QA_deAvg_male_neg_cols <-  c("Subjects", as.character(QA_deAvg_male_neg[,1]))
QA_deAvg_male_neg_values <-read.delim(paste0(working_dir,'/loop/average/DE/QA/male/QA_loopAvgDE_male_neg.csv'), header=FALSE, sep="\t") %>%
remove_empty("cols") %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>%
`colnames<-`(QA_deAvg_male_neg_cols) %>% cbind(loop_subInfo[,c("sex", "age_scan_years","loop_de_avg_degree")]) %>% filter(sex=="male")
#
# Reorder for my sanity check
QA_deAvg_male_neg_values <- QA_deAvg_male_neg_values[,c(1,22:24,2:21)]
QA_deAvg_male_neg_gathercols <- colnames(QA_deAvg_male_neg_values[5:21])
#
# # for some reason things are being read as a a character and it needs to be a numerical value
QA_deAvg_male_neg_values[5:21] <- apply(QA_deAvg_male_neg_values[5:21],2, as.numeric)
#  women negative  ####
QA_deAvg_female_neg_cols <-  c("Subjects", as.character(QA_deAvg_female_neg[,1]))
QA_deAvg_female_neg_values <-read.delim(paste0(working_dir,'/loop/average/DE/QA/female/QA_loopAvgDE_fem_neg.csv'), header=FALSE, sep="\t") %>%
remove_empty("cols") %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>%
`colnames<-`(QA_deAvg_female_neg_cols) %>% cbind(loop_subInfo[,c("sex", "age_scan_years","loop_de_avg_degree")]) %>% filter(sex=="female")
#
# Reorder for my sanity check
QA_deAvg_female_neg_values <- QA_deAvg_female_neg_values[,c(1,16:18,2:15)]
QA_deAvg_female_neg_gathercols <- colnames(QA_deAvg_female_neg_values[5:18])
#
# # for some reason things are being read as a a character and it needs to be a numerical value
QA_deAvg_female_neg_values[5:18] <- apply(QA_deAvg_female_neg_values[5:18],2, as.numeric)
### Actual fig #####
figpath <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/DE/QA"
QA_df <- QA_deAvg_male_neg_values[, !names(QA_deAvg_male_neg_values) %in% QA_deAvg_female_neg_values]
QA_df <- QA_deAvg_male_neg_values[, !names(QA_deAvg_male_neg_values) %in% QA_deAvg_female_neg_values]
QA_df <- rbind(QA_df,QA_deAvg_female_neg_values[, !names(QA_deAvg_female_neg_values) %in% QA_deAvg_male_neg_values])
QA_deAvg_female_neg_values[, !names(QA_deAvg_female_neg_values) %in% QA_deAvg_male_neg_values])
QA_deAvg_female_neg_values[, !names(QA_deAvg_female_neg_values) %in% QA_deAvg_male_neg_values]
length(QA_deAvg_female_neg_values[, !names(QA_deAvg_female_neg_values) %in% QA_deAvg_male_neg_values])
length(QA_deAvg_male_neg_values[, !names(QA_deAvg_male_neg_values) %in% QA_deAvg_female_neg_values] )
QA_df <- QA_deAvg_male_neg_values[, !names(QA_deAvg_male_neg_values) %in% names(QA_deAvg_female_neg_values)]
QA_df <- rbind(QA_df,QA_deAvg_female_neg_values[, !names(QA_deAvg_female_neg_values) %in% names(QA_deAvg_male_neg_values)])
QA_df <- QA_deAvg_male_neg_values[, !names(QA_deAvg_male_neg_gathercols) %in% names(QA_deAvg_female_neg_gathercols)]
QA_df <- QA_deAvg_male_neg_values[, !names(QA_deAvg_male_neg_values) %in% names(QA_deAvg_female_neg_values)]
View(QA_df)
QA_df <- QA_deAvg_male_neg_values[, !names(QA_deAvg_male_neg_values) %in% names(QA_deAvg_female_neg_gathercols)]
QA_df <- QA_deAvg_male_neg_values[, names(QA_deAvg_male_neg_values) %in% names(QA_deAvg_female_neg_gathercols)]
QA_df <- QA_deAvg_male_neg_values[, names(QA_deAvg_male_neg_values) %in% QA_deAvg_female_neg_gathercols]
QA_df <- QA_deAvg_male_neg_values[, names(QA_deAvg_male_neg_values) %in% QA_deAvg_female_neg_values]
QA_df <- QA_deAvg_male_neg_values[, names(QA_deAvg_male_neg_values) %in% names(QA_deAvg_female_neg_values)]
QA_deAvg_male_neg_cols <-  c("Subjects", as.character(QA_deAvg_male_neg[,1]))
QA_deAvg_male_neg_values <-read.delim(paste0(working_dir,'/loop/average/DE/QA/male/QA_loopAvgDE_male_neg.csv'), header=FALSE, sep="\t") %>%
remove_empty("cols") %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>%
`colnames<-`(QA_deAvg_male_neg_cols) %>% cbind(loop_subInfo[,c("sex", "age_scan_years","loop_de_avg_degree")]) %>% filter(sex=="male")
#
# Reorder for my sanity check
QA_deAvg_male_neg_values <- QA_deAvg_male_neg_values[,c(1,22:24,2:21)]
QA_deAvg_male_neg_gathercols <- colnames(QA_deAvg_male_neg_values[5:21])
#
# # for some reason things are being read as a a character and it needs to be a numerical value
QA_deAvg_male_neg_values[5:21] <- apply(QA_deAvg_male_neg_values[5:21],2, as.numeric)
#  women negative  ####
QA_deAvg_female_neg_cols <-  c("Subjects", as.character(QA_deAvg_female_neg[,1]))
QA_deAvg_female_neg_values <-read.delim(paste0(working_dir,'/loop/average/DE/QA/female/QA_loopAvgDE_fem_neg.csv'), header=FALSE, sep="\t") %>%
remove_empty("cols") %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>%
`colnames<-`(QA_deAvg_female_neg_cols) %>% cbind(loop_subInfo[,c("sex", "age_scan_years","loop_de_avg_degree")]) %>% filter(sex=="female")
#
# Reorder for my sanity check
QA_deAvg_female_neg_values <- QA_deAvg_female_neg_values[,c(1,16:18,2:15)]
QA_deAvg_female_neg_gathercols <- colnames(QA_deAvg_female_neg_values[5:18])
#
# # for some reason things are being read as a a character and it needs to be a numerical value
QA_deAvg_female_neg_values[5:18] <- apply(QA_deAvg_female_neg_values[5:18],2, as.numeric)
QA_df <- QA_deAvg_male_neg_values[, names(QA_deAvg_male_neg_values) %in% names(QA_deAvg_female_neg_values)]
View(QA_df)
length(QA_deAvg_female_neg_values[, names(QA_deAvg_female_neg_values) %in% names(QA_deAvg_male_neg_values)])
QA_df <- rbind(QA_df,QA_deAvg_female_neg_values[, names(QA_deAvg_female_neg_values) %in% names(QA_deAvg_male_neg_values)])
figpath <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/DE/QA"
QA_df <- QA_deAvg_male_neg_values[, names(QA_deAvg_male_neg_values) %in% names(QA_deAvg_female_neg_values)]
QA_df <- rbind(QA_df,QA_deAvg_female_neg_values[, names(QA_deAvg_female_neg_values) %in% names(QA_deAvg_male_neg_values)])
length(QA_df)
# Men neg and women negative LEts do fornix  ####
QA_deAvg_male_neg_cols <-  c("Subjects", as.character(QA_deAvg_male_neg[,1]))
QA_deAvg_male_neg_values <-read.delim(paste0(working_dir,'/loop/average/DE/QA/male/QA_loopAvgDE_male_neg.csv'), header=FALSE, sep="\t") %>%
remove_empty("cols") %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>%
`colnames<-`(QA_deAvg_male_neg_cols) %>% cbind(loop_subInfo[,c("sex", "age_scan_years","loop_de_avg_degree")]) %>% filter(sex=="male")
#
# Reorder for my sanity check
QA_deAvg_male_neg_values <- QA_deAvg_male_neg_values[,c(1,22:24,2:21)]
QA_deAvg_male_neg_gathercols <- colnames(QA_deAvg_male_neg_values[5:21])
#
# # for some reason things are being read as a a character and it needs to be a numerical value
QA_deAvg_male_neg_values[5:21] <- apply(QA_deAvg_male_neg_values[5:21],2, as.numeric)
#  women negative  ####
QA_deAvg_female_neg_cols <-  c("Subjects", as.character(QA_deAvg_female_neg[,1]))
QA_deAvg_female_neg_values <-read.delim(paste0(working_dir,'/loop/average/DE/QA/female/QA_loopAvgDE_fem_neg.csv'), header=FALSE, sep="\t") %>%
remove_empty("cols") %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>%
`colnames<-`(QA_deAvg_female_neg_cols) %>% cbind(loop_subInfo[,c("sex", "age_scan_years","loop_de_avg_degree")]) %>% filter(sex=="female")
#
# Reorder for my sanity check
QA_deAvg_female_neg_values <- QA_deAvg_female_neg_values[,c(1,16:18,2:15)]
QA_deAvg_female_neg_gathercols <- colnames(QA_deAvg_female_neg_values[5:18])
#
# # for some reason things are being read as a a character and it needs to be a numerical value
QA_deAvg_female_neg_values[5:18] <- apply(QA_deAvg_female_neg_values[5:18],2, as.numeric)
### Actual fig #####
figpath <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/DE/QA/"
QA_df <- QA_deAvg_male_neg_values[, names(QA_deAvg_male_neg_values) %in% names(QA_deAvg_female_neg_values)]
QA_df <- rbind(QA_df,QA_deAvg_female_neg_values[, names(QA_deAvg_female_neg_values) %in% names(QA_deAvg_male_neg_values)])
for (ROI in colnames(QA_df[5:14])) {
print(ROI)
y <- ggplot(QA_df, aes(x=sex, y=.data[[ROI]], group=sex)) +
geom_boxplot(outlier.shape = NA,width =0.5,fill= c("#CF92BF", "#D1E7E6")) +
geom_jitter(color="black",size=0.8,alpha=0.9,width = 0.2) +
#scale_y_binned(n.breaks=10, nice.breaks = TRUE) +
stat_boxplot(geom = "errorbar",
width = 0.15) +
labs(x= "Sex", y= " QA", title =paste0(ROI) ) +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
png(file = paste0(figpath,ROI,"_neg_QA.png"))  #,".png"))
print(y)
dev.off()
}
