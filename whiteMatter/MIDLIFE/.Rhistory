#library(factoextra)
#library(lsr)
# library(car)
library(ggpubr)
#library(entropy)
#library(ds4psy)
# library(pROC)
#library(devtools)
#library(BRRR)
#library(stats)
#library(afex)
library(knitr)
library(janitor)
# library(car)
# library(ggiraph)
# library(ggiraphExtra)
# library(moonBook)
# WE'll need to make several lists ahead of time in order to get the if statements together
subjects <- read.csv("/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/maze/maze_subinfo.csv") %>% select(subject_id) %>% `colnames<-`(c("V1"))
subInfo <- read.csv("/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/maze/maze_subinfo.csv") %>% select(sex,age_scan_years, repo_status)
subInfo$sex <- replace(subInfo$sex, subInfo$sex==0, "female")
subInfo$sex <- replace(subInfo$sex, subInfo$sex==1, "male")
working_dir <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/maze/tractometry"
master_tractometryDF <- data.frame(matrix(ncol = 0, nrow = 105))
databases <- c("ad","rd","qa","md")
ROI_folders <- list.dirs(working_dir, recursive = FALSE) # finding the main folders for ROI
for (ROI_folder in ROI_folders) {
print(ROI_folder)
for (db in 1:length(databases)){
print(db)
metric <- list.files(ROI_folder, pattern = paste0("*.",databases[db],".*txt"))
for (m in metric){
print(m)
if (databases[db] == "qa"){
roi_col <- substring(m, 19) %>% str_sub(end = -5)
tempdf<-
read.table(paste0(ROI_folder, "/", m), sep = "\t") %>% filter(!str_detect(V1, c("mean_qa_post_norm"))) %>% select(V2) %>% `colnames<-`(paste0(databases[db],"_",roi_col))
master_tractometryDF <- cbind(master_tractometryDF, tempdf)
} else {
roi_col <- substring(m, 19) %>% str_sub(end = -5)
tempdf<-
read.table(paste0(ROI_folder, "/", m), sep = "\t") %>% select(V2) %>% `colnames<-`(paste0(databases[db],"_",roi_col))
master_tractometryDF <- cbind(master_tractometryDF, tempdf)
}
}
}
}
rows <- read.table(paste0(ROI_folder, "/", m), sep = "\t") %>% select(V1) %>% filter(!str_detect(V1, c("mean_md")))
rows <- rbind(rows,subjects)
master_tractometryDF <- cbind(master_tractometryDF,rows)
master_tractometryDF <- master_tractometryDF[ ,c(17,1:16)]
# Lets compare set up our QA data frame
QAdf <- master_tractometryDF %>% select(V1,qa_Cingulum_L,qa_Cingulum_R,qa_Fornix_L,qa_Fornix_R) %>% filter(V1 %in% as.character(subjects$V1)) %>% mutate(sex = subInfo$sex)
m_QA <- QAdf %>% filter(sex=="male")
f_QA <- QAdf %>% filter(sex=="female")
# male left cingulum failed normality 0.02
male_cing_L_norm <- shapiro.test(m_QA$qa_Cingulum_L)
male_cingL_pval <- male_cing_L_norm[["p.value"]]
male_cing_R_norm <- shapiro.test(m_QA$qa_Cingulum_R)
male_cingR_norm_pval <-male_cing_R_norm[["p.value"]]
male_cingR_norm_pval
male_cing_R_norm
View(m_QA)
female_cing_L_norm
#female left cingulum  # normal 0.8221
female_cing_L_norm <- shapiro.test(f_QA$qa_Cingulum_L)
print(paste0("Shapiro normality test p value","  = ", female_cing_L_norm[["p.value"]]))
#female left cingulum  # normal 0.8221
female_cing_R_norm <- shapiro.test(f_QA$qa_Cingulum_L)
print(paste0("Shapiro normality test p value","  = ", female_cing_L_norm[["p.value"]]))
#female left cingulum  # normal 0.8221
female_cing_L_norm <- shapiro.test(f_QA$qa_Cingulum_L)
print(paste0("Shapiro normality test p value","  = ", female_cing_L_norm[["p.value"]]))
#female left cingulum  # normal 0.8221
female_cing_R_norm <- shapiro.test(f_QA$qa_Cingulum_R)
print(paste0("Shapiro normality test p value","  = ", female_cing_L_norm[["p.value"]]))
#female left cingulum  # normal 0.8221
female_cing_L_norm <- shapiro.test(f_QA$qa_Cingulum_L)
print(paste0("Shapiro normality test p value","  = ", female_cing_L_norm[["p.value"]]))
#female left cingulum  # normal 0.8221
female_cing_R_norm <- shapiro.test(f_QA$qa_Cingulum_R)
print(paste0("Shapiro normality test p value","  = ", female_cing_R_norm[["p.value"]]))
left_cing_norm <- c("fem_left","fem_right", "male_left", "male_right")
left_cing_norm
groups <- c("fem_left","fem_right", "male_left", "male_right")
groups <- c("Left cingulum","Right cingulum", "male", "female")
groups[1]
c("ROI", groups[1:2])
left_cing_norm <- c("ROI",groups[1:2])
groups <- c("Left cingulum","Right cingulum", "male", "female")
left_cing_norm <- as.data.frame(c("ROI",groups[1:2]))
View(left_cing_norm)
groups <- c("Left cingulum","Right cingulum", "male", "female")
left_cing_norm <- as.data.frame(c("ROI",groups[1:2]))
left_cing_norm <- (left_cing_norm , groups[3:4])
groups <- as.data.frame(c("Left cingulum","Right cingulum", "male", "female"))
left_cing_norm <- as.data.frame(c("ROI",groups[1:2]))
View(groups)
groups[1:2]
groups[,1:2]
groups[1:2, ]
left_cing_norm <- groups[1:2, ]
left_cing_norm[,1] <- groups[1:2, ]
groups <- as.data.frame(c("Left cingulum","Right cingulum", "male", "female"))
left_cing_norm[1:2,1] <- groups[1:2, ]
left_cing_norm[1:2,] <- groups[1:2, ]
groups <- as.data.frame(c("Left cingulum","Right cingulum", "male", "female"))
left_cing_norm[1] <- groups[1:2, ]
groups <- as.data.frame(c("Left cingulum","Right cingulum", "male", "female"))
left_cing_norm[1] <- as.data.frame(groups[1:2, ])
View(left_cing_norm)
groups <- as.data.frame(c("Left cingulum","Right cingulum", "male", "female"))
left_cing_norm <- as.data.frame(groups[1:2, ])
groups <- as.data.frame(c("Left cingulum","Right cingulum", "male", "female"))
left_cing_norm <- as.data.frame(c("ROI",groups[1:2, ]))
left_cing_norm[1,]
groups[3:4]
groups[3:4]
groups[3:4, ]
groups <- as.data.frame(c("Left cingulum","Right cingulum", "male", "female"))
left_cing_norm <- as.data.frame(c("ROI",groups[1:2, ]))
left_cing_norm[1,] <- as.data.frame(groups[3:4, ])
groups <- as.data.frame(c("Left cingulum","Right cingulum", "male", "female"))
left_cing_norm <- as.data.frame(c("ROI",groups[1:2, ]))
groups <- as.data.frame(c("Left cingulum","Right cingulum", "male", "female"))
left_cing_norm <- as.data.frame(c("ROI",groups[1:2, ]))
left_cing_norm[1, 2:3] <- as.data.frame(groups[3:4, ])
groups[3:4, ]
groups <- as.data.frame(c("Left cingulum","Right cingulum", "male", "female"))
left_cing_norm <- as.data.frame(c("ROI",groups[1:2, ]))
left_cing_norm[1,2:3] <- as.data.frame(groups[3:4, ])
View(groups)
left_cing_norm <- as.data.frame(c("Left cingulum","Right cingulum"))
View(left_cing_norm)
left_cing_norm <- cbind(left_cing_norm, female_cing_L_norm[["p.value"]])
left_cing_norm <- as.data.frame(c("Left cingulum","Right cingulum"))
left_cing_norm <- cbind(left_cing_norm, female_cing_L_norm[["p.value"]],female_cing_R_norm[["p.value"]])
left_cing_norm <- male_cing_L_norm[["p.value"]]
male_cing_L_norm[["p.value"]]
left_cing_norm <- cbind(male_cing_L_norm[["p.value"]],male_cing_R_norm[["p.value"]])
left_cing_norm <- cbind(male_cing_L_norm[["p.value"]],male_cing_R_norm[["p.value"]]) %>% `colnames<-`(c("Left cingulum","Right cingulum"))
left_cing_norm <- cbind(male_cing_L_norm[["p.value"]],male_cing_R_norm[["p.value"]]) %>% `colnames<-`(c("Left cingulum","Right cingulum")) %>% `row.names<-`(c("Males"))
# male left cingulum failed normality 0.02
male_cing_L_norm <- shapiro.test(m_QA$qa_Cingulum_L)
left_cing_norm <- cbind(male_cing_L_norm[["p.value"]],male_cing_R_norm[["p.value"]]) %>% `colnames<-`(c("Left cingulum","Right cingulum")) %>% `row.names<-`(c("Males"))
# male_cingL_pval <- male_cing_L_norm[["p.value"]]
#
# male_cing_R_norm <- shapiro.test(m_QA$qa_Cingulum_R)
# male_cingR_norm_pval <-male_cing_R_norm[["p.value"]]
#
# temp_pval_df
tempdf <- cbind(female_cing_L_norm[["p.value"]],female_cing_R_norm[["p.value"]])
tempdf <- cbind(female_cing_L_norm[["p.value"]],female_cing_R_norm[["p.value"]]) %>% `rownames<-`(c("females"))
left_cing_norm <- rbind(left_cing_norm,tempdf)
# male left cingulum failed normality 0.02
male_cing_L_norm <- shapiro.test(m_QA$qa_Cingulum_L)
male_cing_R_norm <- shapiro.test(m_QA$qa_Cingulum_R)
male_cing_norm_vals <- cbind(male_cing_L_norm[["p.value"]], male_cing_R_norm[["p.value"]]) %>% `colnames<-`(c("Left cingulum","Right cingulum")) %>% `row.names<-`(c("Males"))
male_cing_L_norm <- shapiro.test(m_QA$qa_Cingulum_L)
male_cing_R_norm <- shapiro.test(m_QA$qa_Cingulum_R)
male_fornix_L_norm <- shapiro.test(m_QA$qa_Fornix_L)
male_fornix_R_norm <- shapiro.test(m_QA$qa_Fornix_R)
male_fornix_R_norm
# male left cingulum failed normality 0.02
male_cing_L_norm <- shapiro.test(m_QA$qa_Cingulum_L) #
male_cing_R_norm <- shapiro.test(m_QA$qa_Cingulum_R)
male_fornix_L_norm <- shapiro.test(m_QA$qa_Fornix_L)
male_fornix_R_norm <- shapiro.test(m_QA$qa_Fornix_R)
male_cing_norm_vals <- cbind(male_cing_L_norm[["p.value"]], male_cing_R_norm[["p.value"]],male_fornix_L_norm[["p.value"]], male_fornix_R_norm[["p.value"]]) %>% `colnames<-`(c("Left cingulum","Right cingulum", "Left Fornix","Right Fornix")) %>% `row.names<-`(c("Males"))
male_cing_norm_vals
#female left cingulum  # normal 0.8221
female_cing_L_norm <- shapiro.test(f_QA$qa_Cingulum_L)
#female left cingulum  # normal 0.8221
female_cing_R_norm <- shapiro.test(f_QA$qa_Cingulum_R)
female_fornix_L_norm <- shapiro.test(f_QA$qa_Fornix_L)
female_fornix_R_norm <- shapiro.test(f_QA$qa_Fornix_R)
female_norm_vals <-
cbind(female_cing_L_norm[["p.value"]],
female_cing_R_norm[["p.value"]],
female_fornix_L_norm[["p.value"]],
female_fornix_R_norm[["p.value"]]) %>% `colnames<-`(c("Left cingulum", "Right cingulum", "Left Fornix", "Right Fornix")) %>% `row.names<-`(c("Females"))
# male left cingulum failed normality 0.02
male_cing_L_norm <- shapiro.test(m_QA$qa_Cingulum_L) #
male_cing_R_norm <- shapiro.test(m_QA$qa_Cingulum_R)
male_fornix_L_norm <- shapiro.test(m_QA$qa_Fornix_L)
male_fornix_R_norm <- shapiro.test(m_QA$qa_Fornix_R)
male_cing_norm_vals <-
cbind(male_cing_L_norm[["p.value"]],
male_cing_R_norm[["p.value"]],
male_fornix_L_norm[["p.value"]],
male_fornix_R_norm[["p.value"]]) %>% `colnames<-`(c("Left cingulum", "Right cingulum", "Left Fornix", "Right Fornix")) %>% `row.names<-`(c("Males"))
knitr::kable(male_cing_norm_vals)%>%
kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>%
scroll_box(width = "350px", height = "100px")
#female left cingulum  # normal 0.8221
female_cing_L_norm <- shapiro.test(f_QA$qa_Cingulum_L)
#female left cingulum  # normal 0.8221
female_cing_R_norm <- shapiro.test(f_QA$qa_Cingulum_R)
female_fornix_L_norm <- shapiro.test(f_QA$qa_Fornix_L)
female_fornix_R_norm <- shapiro.test(f_QA$qa_Fornix_R)
female_norm_vals <-
cbind(female_cing_L_norm[["p.value"]],
female_cing_R_norm[["p.value"]],
female_fornix_L_norm[["p.value"]],
female_fornix_R_norm[["p.value"]]) %>% `colnames<-`(c("Left cingulum", "Right cingulum", "Left Fornix", "Right Fornix")) %>% `row.names<-`(c("Females"))
View(male_cing_norm_vals)
m_QA_cing_L_summary <- summary(m_QA$qa_Cingulum_L)
m_QA_cing_R_summary <- summary(m_QA$qa_Cingulum_R)
m_QA_fornix_R_summary <- summary(m_QA$qa_Fornix_R)
m_QA_fornix_L_summary <- summary(m_QA$qa_Fornix_L)
m_QA_cing_L_summary
QA_male_summary <- rbind(m_QA_cing_L_summary, m_QA_cing_R_summary,m_QA_fornix_L_summary,m_QA_fornix_R_summary)
View(QA_male_summary)
m_QA_cing_L_summary <- summary(m_QA$qa_Cingulum_L)
m_QA_cing_R_summary <- summary(m_QA$qa_Cingulum_R)
m_QA_fornix_R_summary <- summary(m_QA$qa_Fornix_R)
m_QA_fornix_L_summary <- summary(m_QA$qa_Fornix_L)
QA_male_summary <- rbind(m_QA_cing_L_summary, m_QA_cing_R_summary,m_QA_fornix_L_summary,m_QA_fornix_R_summary) %>% `row.names<-`(c("Left cingulum", "Right cingulum", "Left Fornix", "Right Fornix")) %>% as.data.frame()
View(female_norm_vals)
QA_Cing_L
QA_Cing_L <- wilcox.test(m_QA$qa_Cingulum_L,f_QA$qa_Cingulum_L)
QA_Cing_R <- wilcox.test(m_QA$qa_Cingulum_R,f_QA$qa_Cingulum_R)
QA_fornix_L <- t.test(m_QA$qa_Fornix_L,f_QA$qa_Fornix_R)
QA_fornix_R <- wilcox.test(m_QA$qa_Fornix_R,f_QA$qa_Fornix_R)
QA_Cing_L
QA_Cing_L <- wilcox.test(m_QA$qa_Cingulum_L,f_QA$qa_Cingulum_L)
QA_Cing_R <- wilcox.test(m_QA$qa_Cingulum_R,f_QA$qa_Cingulum_R)
QA_fornix_L <- t.test(m_QA$qa_Fornix_L,f_QA$qa_Fornix_R)
QA_fornix_R <- wilcox.test(m_QA$qa_Fornix_R,f_QA$qa_Fornix_R)
QA_pvalues <-
cbind(QA_Cing_L[["p.value"]],
QA_Cing_R[["p.value"]],
QA_fornix_L[["p.value"]],
QA_fornix_R[["p.value"]]) %>% `colnames<-`(c("Left cingulum", "Right cingulum", "Left Fornix", "Right Fornix"))
View(QA_pvalues)
QA_Cing_L <- wilcox.test(m_QA$qa_Cingulum_L,f_QA$qa_Cingulum_L)
QA_Cing_R <- wilcox.test(m_QA$qa_Cingulum_R,f_QA$qa_Cingulum_R)
QA_fornix_L <- t.test(m_QA$qa_Fornix_L,f_QA$qa_Fornix_R)
QA_fornix_R <- wilcox.test(m_QA$qa_Fornix_R,f_QA$qa_Fornix_R)
QA_pvalues <-
cbind(QA_Cing_L[["p.value"]],
QA_Cing_R[["p.value"]],
QA_fornix_L[["p.value"]],
QA_fornix_R[["p.value"]]) %>% `colnames<-`(c("Left cingulum", "Right cingulum", "Left Fornix", "Right Fornix")) %>% as.data.frame()
View(QA_pvalues)
QA_L_Cing <- QAdf %>%
ggplot(aes(x=sex, y= qa_Cingulum_L, group=sex)) +
geom_boxplot(width=0.5 ,fill= c("#CF92BF", "#D1E7E6")) +
scale_y_binned(n.breaks=10, nice.breaks = TRUE) +
labs(x= "Sex", y= " QA", title ="Left Cingulum" ) +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
QAdf %>%
ggplot(aes(x=sex, y= qa_Fornix_L, group=sex)) +
geom_boxplot(width=0.5 ,fill= c("#CF92BF", "#D1E7E6")) +
scale_y_binned(n.breaks=10, nice.breaks = TRUE) +
labs(x= "Sex", y= " QA", title ="Left Fornix" ) +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
QA_R_fornix <- QAdf %>%
ggplot(aes(x=sex, y= qa_Fornix_R, group=sex)) +
geom_boxplot(width=0.5 ,fill= c("#CF92BF", "#D1E7E6")) +
scale_y_binned(n.breaks=10, nice.breaks = TRUE) +
labs(x= "Sex", y= " QA", title ="Right Fornix" ) +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
print(QA_R_fornix)
# Lets compare set up our QA data frame
MDdf <- master_tractometryDF %>% select(V1,md_Cingulum_L,md_Cingulum_R,md_Fornix_L,md_Fornix_R) %>% filter(V1 %in% as.character(subjects$V1)) %>% mutate(sex = subInfo$sex)
m_MD <- MDdf %>% filter(sex=="male")
f_MD <- MDdf %>% filter(sex=="female")
View(f_MD)
# male left cingulum failed normality 0.02
MD_male_cing_L_norm <- shapiro.test(m_MD$qa_Cingulum_L) #
m_MD$qa_Cingulum_L
# Lets compare set up our QA data frame
MDdf <- master_tractometryDF %>% select(V1,md_Cingulum_L,md_Cingulum_R,md_Fornix_L,md_Fornix_R) %>% filter(V1 %in% as.character(subjects$V1)) %>% mutate(sex = subInfo$sex)
m_MD <- MDdf %>% filter(sex=="male")
f_MD <- MDdf %>% filter(sex=="female")
View(m_MD)
# male left cingulum failed normality 0.02
MD_male_cing_L_norm <- shapiro.test(m_MD$qa_Cingulum_L) #
# male left cingulum failed normality 0.02
MD_male_cing_L_norm <- shapiro.test(m_MD$md_Cingulum_L) #
MD_male_cing_R_norm <- shapiro.test(m_MD$md_Cingulum_R)
MD_male_fornix_L_norm <- shapiro.test(m_MD$md_Fornix_L)
MD_male_fornix_R_norm <- shapiro.test(m_MD$md_Fornix_R)
MD_male_cing_norm_vals <-
cbind(MD_male_cing_L_norm[["p.value"]],
MD_male_cing_R_norm[["p.value"]],
MD_male_fornix_L_norm[["p.value"]],
MD_male_fornix_R_norm[["p.value"]]) %>% `colnames<-`(c("Left cingulum", "Right cingulum", "Left Fornix", "Right Fornix")) %>% `row.names<-`(c("Males"))
View(MD_male_cing_norm_vals)
MD_male_cing_L_norm
MD_male_cing_R_norm
MD_male_fornix_L_norm
MD_male_fornix_R_norm
m_MD_cing_L_summary <- summary(m_MD$md_Cingulum_L)
m_MD_cing_R_summary <- summary(m_MD$md_Cingulum_R)
m_MD_fornix_R_summary <- summary(m_MD$md_Fornix_R)
m_MD_fornix_L_summary <- summary(m_MD$md_Fornix_L)
MD_male_summary <- rbind(m_MD_cing_L_summary, m_MD_cing_R_summary,m_MD_fornix_L_summary,m_MD_fornix_R_summary) %>% `row.names<-`(c("Left cingulum", "Right cingulum", "Left Fornix", "Right Fornix")) %>% as.data.frame()
MD_male_summary
knitr::kable(MD_male_summary)%>%
kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>%
scroll_box(width = "575px", height = "200px")
#female left cingulum  # normal 0.8221
MD_female_cing_L_norm <- shapiro.test(f_MD$md_Cingulum_L)
#female left cingulum  # normal 0.8221
MD_female_cing_R_norm <- shapiro.test(f_MD$md_Cingulum_R)
MD_female_fornix_L_norm <- shapiro.test(f_MD$md_Fornix_L)
MD_female_fornix_R_norm <- shapiro.test(f_MD$md_Fornix_R)
MD_female_norm_vals <-
cbind(MD_female_cing_L_norm[["p.value"]],
MD_female_cing_R_norm[["p.value"]],
MD_female_fornix_L_norm[["p.value"]],
MD_female_fornix_R_norm[["p.value"]]) %>% `colnames<-`(c("Left cingulum", "Right cingulum", "Left Fornix", "Right Fornix")) %>% `row.names<-`(c("Females"))
MD_female_norm_vals
MD_Cing_L <- t.test(m_MD$qa_Cingulum_L,f_MD$qa_Cingulum_L)
MD_Cing_L <- t.test(m_MD$md_Cingulum_L,f_MD$md_Cingulum_L)
MD_Cing_R <- t.test(m_MD$md_Cingulum_R,f_MD$md_Cingulum_R)
MD_fornix_L <- t.test(m_MD$md_Fornix_L,f_MD$md_Fornix_R)
MD_fornix_R <- t.test(m_MD$md_Fornix_R,f_MD$md_Fornix_R)
MD_pvalues <-
cbind(MD_Cing_L[["p.value"]],
MD_Cing_R[["p.value"]],
MD_fornix_L[["p.value"]],
MD_fornix_R[["p.value"]]) %>% `colnames<-`(c("Left cingulum", "Right cingulum", "Left Fornix", "Right Fornix")) %>% as.data.frame()
knitr::kable(MD_pvalues, row.names = FALSE)%>%
kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>%
scroll_box(width = "575px", height = "100px")
AD_male_cing_L_norm <- shapiro.test(m_AD$ad_Cingulum_L) #normal
# Lets compare set up our MD data frame
ADdf <- master_tractometryDF %>% select(V1,ad_Cingulum_L,ad_Cingulum_R,ad_Fornix_L,ad_Fornix_R) %>% filter(V1 %in% as.character(subjects$V1)) %>% mutate(sex = subInfo$sex)
m_AD <- ADdf %>% filter(sex=="male")
f_AD <- ADdf %>% filter(sex=="female")
AD_male_cing_L_norm <- shapiro.test(m_AD$ad_Cingulum_L) #normal
AD_male_cing_R_norm <- shapiro.test(m_AD$ad_Cingulum_R) #normal
AD_male_fornix_L_norm <- shapiro.test(m_AD$ad_Fornix_L) # not normal but very barely
AD_male_fornix_R_norm <- shapiro.test(m_AD$ad_Fornix_R) #normal
AD_male_cing_norm_vals <-
cbind(AD_male_cing_L_norm[["p.value"]],
AD_male_cing_R_norm[["p.value"]],
AD_male_fornix_L_norm[["p.value"]],
AD_male_fornix_R_norm[["p.value"]]) %>% `colnames<-`(c("Left cingulum", "Right cingulum", "Left Fornix", "Right Fornix")) %>% `row.names<-`(c("Males"))
AD_male_cing_norm_vals
m_AD_cing_L_summary <- summary(m_AD$ad_Cingulum_L)
m_AD_cing_R_summary <- summary(m_AD$ad_Cingulum_R)
m_AD_fornix_R_summary <- summary(m_AD$ad_Fornix_R)
m_AD_fornix_L_summary <- summary(m_AD$ad_Fornix_L)
AD_male_summary <- rbind(m_AD_cing_L_summary, m_AD_cing_R_summary,m_AD_fornix_L_summary,m_AD_fornix_R_summary) %>% `row.names<-`(c("Left cingulum", "Right cingulum", "Left Fornix", "Right Fornix")) %>% as.data.frame()
knitr::kable(AD_male_summary)%>%
kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>%
scroll_box(width = "575px", height = "200px")
AD_female_cing_L_norm <- shapiro.test(f_AD$ad_Cingulum_L) #normal
AD_female_cing_R_norm <- shapiro.test(f_AD$ad_Cingulum_R) #normal
AD_female_fornix_L_norm <- shapiro.test(f_AD$ad_Fornix_L) # not normal but very barely
AD_female_fornix_R_norm <- shapiro.test(f_AD$ad_Fornix_R) #normal
AD_female_cing_norm_vals <-
cbind(AD_female_cing_L_norm[["p.value"]],
AD_female_cing_R_norm[["p.value"]],
AD_female_fornix_L_norm[["p.value"]],
AD_female_fornix_R_norm[["p.value"]]) %>% `colnames<-`(c("Left cingulum", "Right cingulum", "Left Fornix", "Right Fornix")) %>% `row.names<-`(c("Males"))
AD_female_cing_norm_vals
AD_Cing_L <- t.test(m_AD$md_Cingulum_L,f_AD$md_Cingulum_L)
AD_female_cing_L_norm <- shapiro.test(f_AD$ad_Cingulum_L) #normal
AD_female_cing_R_norm <- shapiro.test(f_AD$ad_Cingulum_R) #normal
AD_female_fornix_L_norm <- shapiro.test(f_AD$ad_Fornix_L) # not normal but very barely
AD_female_fornix_R_norm <- shapiro.test(f_AD$ad_Fornix_R) #normal
AD_female_cing_norm_vals <-
cbind(AD_female_cing_L_norm[["p.value"]],
AD_female_cing_R_norm[["p.value"]],
AD_female_fornix_L_norm[["p.value"]],
AD_female_fornix_R_norm[["p.value"]]) %>% `colnames<-`(c("Left cingulum", "Right cingulum", "Left Fornix", "Right Fornix")) %>% `row.names<-`(c("Males"))
knitr::kable(AD_female_cing_norm_vals)%>%
kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>%
scroll_box(width = "500px", height = "100px")
f_AD_cing_L_summary <- summary(f_AD$ad_Cingulum_L)
f_AD_cing_R_summary <- summary(f_AD$ad_Cingulum_R)
f_AD_fornix_R_summary <- summary(f_AD$ad_Fornix_R)
f_AD_fornix_L_summary <- summary(f_AD$ad_Fornix_L)
AD_female_summary <- rbind(f_AD_cing_L_summary, f_AD_cing_R_summary,f_AD_fornix_L_summary,f_AD_fornix_R_summary) %>% `row.names<-`(c("Left cingulum", "Right cingulum", "Left Fornix", "Right Fornix")) %>% as.data.frame()
knitr::kable(AD_female_summary)%>%
kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>%
scroll_box(width = "575px", height = "200px")
AD_Cing_L <- t.test(m_AD$md_Cingulum_L,f_AD$md_Cingulum_L)
m_AD$md_Cingulum_L
AD_male_cing_L_norm <- shapiro.test(m_AD$ad_Cingulum_L) #normal
AD_male_cing_R_norm <- shapiro.test(m_AD$ad_Cingulum_R) #normal
AD_male_fornix_L_norm <- shapiro.test(m_AD$ad_Fornix_L) # not normal but very barely
AD_male_fornix_R_norm <- shapiro.test(m_AD$ad_Fornix_R) #normal
AD_male_cing_norm_vals <-
cbind(AD_male_cing_L_norm[["p.value"]],
AD_male_cing_R_norm[["p.value"]],
AD_male_fornix_L_norm[["p.value"]],
AD_male_fornix_R_norm[["p.value"]]) %>% `colnames<-`(c("Left cingulum", "Right cingulum", "Left Fornix", "Right Fornix")) %>% `row.names<-`(c("Males"))
AD_Cing_L <- t.test(m_AD$md_Cingulum_L,f_AD$md_Cingulum_L)
AD_Cing_L <- t.test(m_AD$ad_Cingulum_L,f_AD$ad_Cingulum_L)
AD_Cing_R <- t.test(m_AD$ad_Cingulum_R,f_AD$ad_Cingulum_R)
AD_fornix_L <- t.test(m_AD$ad_Fornix_L,f_AD$ad_Fornix_R)
AD_fornix_R <- t.test(m_AD$ad_Fornix_R,f_AD$ad_Fornix_R)
AD_pvalues <-
cbind(AD_Cing_L[["p.value"]],
AD_Cing_R[["p.value"]],
AD_fornix_L[["p.value"]],
AD_fornix_R[["p.value"]]) %>% `colnames<-`(c("Left cingulum", "Right cingulum", "Left Fornix", "Right Fornix")) %>% as.data.frame()
AD_pvalues
MD_acc_peripost_pos <- read.delim(paste0(working_dir,'/maze/Accuracy/MD/peripost/MD_acc_peripost_pos.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()
# all subjects
MD_acc_all_pos <- read.csv(paste0(working_dir,'maze/Accuracy/MD/allSubs/MD_all_pos.csv'), header=FALSE) %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()
library(ggplot2)
#(plyr)
library(tidyverse)
# library(dplyr)
# library(tidyr)
library(stringr)
library(kableExtra)
# library(data.table)
# library(network)
# library(tidygraph)
# library(ggraph)
# library(igraph)
# library(networkD3)
# library(CINNA)
# library(umap)
# library(plotly)
#library(factoextra)
#library(lsr)
# library(car)
library(ggpubr)
#library(entropy)
#library(ds4psy)
# library(pROC)
#library(devtools)
#library(BRRR)
#library(stats)
#library(afex)
library(knitr)
library(janitor)
library(car)
library(ggiraph)
library(ggiraphExtra)
library(moonBook)
knitr::opts_chunk$set(warning=FALSE, message=FALSE, echo = FALSE,
fig.align = "center")
working_dir <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/"
rows2grab <- c("Tract Name", "number of tracts","mean length(mm)","diameter(mm)", "volume(mm^3)")
Acc_sub_info <- read.csv("/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/maze/maze_subinfo.csv")
for (row in 1:nrow(Acc_sub_info)) {
if (Acc_sub_info[row,2] == 0) {
Acc_sub_info[row,2] <- "female"
} else {
Acc_sub_info[row,2] <- "male"
}
}
# all subjects
MD_acc_all_pos <- read.csv(paste0(working_dir,'maze/Accuracy/MD/allSubs/MD_all_pos.csv'), header=FALSE) %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()
#MEN
MD_acc_male_pos <- read.csv(paste0(working_dir,'maze/Accuracy/MD/male/MD_male_pos.csv'), header=FALSE) %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()
MD_acc_male_neg <- read.delim(paste0(working_dir,'maze/Accuracy/MD/male/MD_male_neg.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()%>% na.omit()
# FEMALE
MD_acc_female_pos <- read.csv(paste0(working_dir,'maze/Accuracy/MD/female/MD_female_pos.csv'), header=FALSE) %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()
MD_acc_female_neg <- read.delim(paste0(working_dir,'maze/Accuracy/MD/female/MD_female_neg.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()%>% na.omit()
# PRE
MD_acc_pre_neg <- read.csv(paste0(working_dir,'maze/Accuracy/MD/pre/MD_pre_neg.csv'), header=FALSE) %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% as.data.frame() %>% `[`(-c(1),)
#PERI
MD_acc_peri_pos <- read.csv(paste0(working_dir,'maze/Accuracy/MD/peri/MD_peri_pos.csv'), header=FALSE) %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()
#POST
MD_acc_post_pos <- read.csv(paste0(working_dir,'maze/Accuracy/MD/post/MD_post_pos.csv'), header=FALSE) %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()
MD_acc_post_neg <- read.csv(paste0(working_dir,'maze/Accuracy/MD/post/MD_post_neg.csv'), header=FALSE) %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% as.data.frame() %>% `[`(-c(1),)
#Peri POST
MD_acc_peripost_pos <- read.delim(paste0(working_dir,'/maze/Accuracy/MD/peripost/MD_acc_peripost_pos.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()
MD_acc_peripost_neg <- read.delim(paste0(working_dir,'/maze/Accuracy/MD/peripost/MD_acc_peripost_neg.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()
# ALL subjects
AD_all_acc_pos <- read.delim(paste0(working_dir,'maze/Accuracy/AD/allSubs/AD_all__acc_pos.csv'),header=FALSE, sep="\t") %>%filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame() %>% na.omit()
AD_all_acc_neg <- read.csv(paste0(working_dir,'maze/Accuracy/AD/allSubs/AD_all__acc_neg.csv'), header=FALSE) %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% as.data.frame()
AD_all_acc_neg <- AD_all_acc_neg[-c(1),]
# MEN'
AD_acc_male_pos <- read.csv(paste0(working_dir,'maze/Accuracy/AD/male/AD_male_acc_pos.csv'), header=FALSE) %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()
AD_acc_male_neg <- read.csv(paste0(working_dir,'maze/Accuracy/AD/male/AD_male_acc_neg.csv'), header=FALSE) %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% as.data.frame() %>% `[`(-c(1),)
# WOMEN
AD_acc_female_neg <- read.csv(paste0(working_dir,'maze/Accuracy/AD/female/AD_fem_acc_neg.csv'), header=FALSE) %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% as.data.frame() %>% `[`(-c(1),)
# PRE
AD_acc_pre_neg <- read.csv(paste0(working_dir,'maze/Accuracy/AD/pre/AD_pre_acc_neg.csv'), header=FALSE) %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% as.data.frame() %>% `[`(-c(1),)
# Peri
AD_acc_peri_pos <- read.csv(paste0(working_dir,'maze/Accuracy/AD/peri/AD_peri_all_pos.csv'), header=FALSE) %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% as.data.frame() %>% `[`(-c(1),)
AD_acc_peri_neg <- read.csv(paste0(working_dir,'maze/Accuracy/AD/peri/AD_peri_all_neg.csv'), header=FALSE) %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% as.data.frame() %>% `[`(-c(1),)
# POST
AD_acc_post_pos <- read.csv(paste0(working_dir,'maze/Accuracy/AD/post/ad_post_acc_pos.csv'), header=FALSE) %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% as.data.frame() %>% `[`(-c(1),)
AD_acc_post_neg <- read.csv(paste0(working_dir,'maze/Accuracy/AD/post/ad_post_acc_neg.csv'), header=FALSE) %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% as.data.frame() %>% `[`(-c(1),)
# Peri POST
AD_acc_periost_pos <- read.delim(paste0(working_dir,'/maze/Accuracy/MD/peripost/MD_acc_peripost_pos.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% as.data.frame() %>% `[`(-c(1),) %>% na.omit()
AD_acc_peripost_neg <- read.delim(paste0(working_dir,'/maze/Accuracy/MD/peripost/MD_acc_peripost_neg.csv'), header=FALSE, sep="\t")) %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% as.data.frame() %>% `[`(-c(1),) %>% na.omit()
AD_acc_peripost_neg <- read.delim(paste0(working_dir,'/maze/Accuracy/MD/peripost/MD_acc_peripost_neg.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% as.data.frame() %>% `[`(-c(1),) %>% na.omit()
