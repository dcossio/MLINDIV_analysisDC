---
title: "28andb DSI studio analysis"
author: "Daniela Cossio"
date: "02/07/2023"
output: html_document
---

```{r adding libraries,echo=FALSE, results='hide',message=FALSE}
library(ggplot2)
#(plyr)
library(tidyverse)
# library(dplyr)
# library(tidyr)
library(stringr)
# library(data.table)
# library(network)
# library(tidygraph)
# library(ggraph)
# library(igraph)
# library(networkD3)
# library(CINNA)
# library(umap)
# library(plotly)
#library(factoextra)
#library(lsr)
# library(car)
library(ggpubr)
#library(entropy)
#library(ds4psy)
# library(pROC)
#library(devtools)
#library(BRRR)
#library(stats)
#library(afex)
library(knitr)

```

```{css, echo=FALSE}
h1, h2 {
  text-align: center;
  color: darkblue;
  font-weight: bold;
}
```

```{r Global Vars, echo=FALSE, results='hide',message=FALSE}

# working directory to data 
estrogen_path <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/28andB/estrogen/"
Prog_path <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/28andB/progesterone/"

rows2grab <- c("Tract Name", "number of tracts","mean length(mm)","diameter(mm)", "volume(mm^3)")

```
## Overview 
This is the analysis of the relationship between white matter microstructure and hormones across pregnancy in one single subject.

#### **Participants** 
  * One subject and a total of 25 scans from July 2019 to May 2021. Scans range from baseline to IVF to post pregnancy. The number of scans in the analyses varies by hormone analysis and time. 
  
  * 18 scans were preprocessed successfully. 7 scans removed due to issues with the DWI.   

#### **Scan parameters** 
  * Locations from UCSB and UCI

#### **Blood work**
  * Subject was measured for various levels of hormones including estrogen, progesterone, LH, FSH

#### **Exclusions** 
  * Scan 08/13/19 (labeled as sub-003) was excluded 

#### **QSIprep** 
  * Version used

#### **DSI Studio : Correlational connectometry **
###### Version and tags used **chen-2022-07-31**
###### Parameters 
* Length = 25
* Permutation = 10,000
* pruning 4
* non normalized QA T threshold: 2.5

##### Analyses {.tabset}
###### Estrogen 
* Total scans: 16
* Total pregnancy scans = 9 
* 2 scans removed due to having no estrogen measurement
  
###### Progesterone
* Total scans: 15
* Total pregnancy scans = 9 
* 3 scans removed due to having no progesterone measurement

    
### Results    
## <span style="color: pink;"> Estrogen </span>  {.tabset .tabset-dropdown}
### Summary 
QA was positively correlated with estrogen levels across numerous tracts including corpus callosum and cingulum. DSI found tracts in the cerebellum with AD, RD, and MD were negatively associated with estrogen levels. Suggesting that increased levels of estrogen are associated with better white matter micro structure. When analyzing pregnancy only scans, DSI only found significant results in the QA analysis. QA was positively associated with estrogen levels.
### QA {.tabset}
```{r QA  correlations,echo=FALSE, results='hide',message=FALSE}
# ALl weeks 
Est_QA_all_pos <- read.csv(paste0(estrogen_path,'QA/Allwks/pos_stats.csv'), header=FALSE) %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()

# Pregnancy only

Est_QA_pregnancy_pos <- read.csv(paste0(estrogen_path,'QA/pregnancy/pos_stats_2.csv'), header=FALSE) %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()

```
#### All weeks 
##### <span style="color: hotpink;"> Positive (FDR= 0.002484) </span> 
```{r, layout="l-body-outset",echo=FALSE}
knitr::kable(Est_QA_all_pos, row.names=F)
```
#####  <span class="text-center" style="color: Teal;"> Negative (FDR= 0.250000)</span> 
No significant Findings

#### Pregnancy only
##### <span style="color: hotpink;"> Positive (FDR= 0.043802) </span> 
```{r, layout="l-body-outset",echo=FALSE}
knitr::kable(Est_QA_pregnancy_pos, row.names=F)
```

#####  <span class="text-center" style="color: Teal;"> Negative (FDR= 1.0000)</span> 
No significant Findings

### AD {.tabset}
```{r AD all scans correlations,echo=FALSE, results='hide',message=FALSE}

Est_AD_allwks_neg <- read.csv(paste0(estrogen_path,'AD/Allwks/neg_stats_2.csv'), header=FALSE) %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()

Est_AD_allwks_pos <- read.csv(paste0(estrogen_path,'AD/Allwks/pos_2.csv'), header=FALSE) %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()
```

#### All weeks 
##### <span style="color: hotpink;"> Positive (FDR= 0.058824) </span> 
```{r, layout="l-body-outset",echo=FALSE}
knitr::kable(Est_AD_allwks_pos, row.names=F)
```

#####  <span class="text-center" style="color: Teal;"> Negative (FDR= 0.000125)</span> 
```{r, layout="l-body-outset",echo=FALSE}
knitr::kable(Est_AD_allwks_neg, row.names=F)
```

#### Pregnancy 
No significant findings 

### MD {.tabset}
```{r MD all scans correlations,echo=FALSE, results='hide',message=FALSE}
Est_MD_allwks_neg <- read.csv(paste0(estrogen_path,'MD/Allwks/neg_stats_2.5.csv'), header=FALSE) %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()
```

##### <span style="color: hotpink;"> Positive (FDR= 0.205882) </span> 
No significant findings

#####  <span class="text-center" style="color: Teal;"> Negative (FDR= 0.002002)</span> 
```{r, layout="l-body-outset",echo=FALSE}
knitr::kable(Est_MD_allwks_neg, row.names=F)
```

#### Pregnancy 
No significant findings 

### RD {.tabset}
#### All weeks 
```{r RD all scans correlations,echo=FALSE, results='hide',message=FALSE}
Est_RD_allwks_neg <- read.csv(paste0(estrogen_path,'RD/Allwks/neg_2.5_all.csv'), header=FALSE) %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()

Est_RD_allwks_pos <- read.csv(paste0(estrogen_path,'RD/Allwks/pos_2.csv'), header=FALSE) %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()

```
##### <span style="color: hotpink;"> Positive (FDR= 0.122222) </span> 
```{r, layout="l-body-outset",echo=FALSE}
knitr::kable(Est_RD_allwks_pos, row.names=F)
```
#####  <span class="text-center" style="color: Teal;"> Negative (FDR= 0.001106)</span> 
```{r, layout="l-body-outset",echo=FALSE}
knitr::kable(Est_RD_allwks_neg, row.names=F)
```

#### pregnancy only
No significant findings


## <span style="color: magenta;"> Progesterone </span>  {.tabset .tabset-dropdown}

### Summary 
DSI found significant positive and negative correlations between QA and progesterone in various tracts. There were positive and negative correlations between progesterone and AD, RD, and MD but most of the tracts show a positive association. This suggests that higher levels of progesterone may be associated with decreased or altered white matter integrity and increased levels of diffusion. When analyzing pregnancy only, DSI found significant positive correlations with QA only. Interestingly, it appears that tracts in the cerebellum have the opposite relationship with progesterone compared to estrogen. Tracts in the cerebellum show a positive relationship between progesterone and AD, MD and MD. This suggests that higher levels of progesterone in the cerebellum are associated with increased levels of diffusion, a typical signal of weakened or decreased white matter integrity. 

### QA {.tabset}
```{r QA vars,echo=FALSE, results='hide',message=FALSE}
# ALl weeks 
prog_QA_all_pos <- read.csv(paste0(Prog_path,'QA/Allwks/pos_all_2.5.csv'), header=FALSE) %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()

prog_QA_all_neg <- read.csv(paste0(Prog_path,'QA/Allwks/neg_ALL_2.5.csv'), header=FALSE) %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()

# Pregnancy only

prog_QA_pregnancy_pos <- read.csv(paste0(Prog_path,'QA/pregnancy/pos_pregnancy-2.5.csv'), header=FALSE) %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()

```
#### All weeks 
##### <span style="color: hotpink;"> Positive ( FDR= 0.002484 ) </span> 
```{r, layout="l-body-outset",echo=FALSE}
knitr::kable(prog_QA_all_pos, row.names=F)
```
#####  <span class="text-center" style="color: Teal;"> Neg ( FDR= 0.250000)</span> 
```{r, layout="l-body-outset",echo=FALSE}
knitr::kable(prog_QA_all_neg, row.names=F)
```

#### Pregnancy only
##### <span style="color: hotpink;"> Positive ( FDR= 0.043802 ) </span> 
```{r, layout="l-body-outset",echo=FALSE}
knitr::kable(prog_QA_pregnancy_pos, row.names=F)
```

#####  <span class="text-center" style="color: Teal;"> Neg ( FDR= 1.0000)</span> 
No significant Findings




### MD {.tabset}
```{r MD vars,echo=FALSE, results='hide',message=FALSE}
# ALl weeks 
prog_MD_all_pos <- read.csv(paste0(Prog_path,'MD/Allwks/MD_allwks_prog_pos_2.5.csv'), header=FALSE) %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()

prog_MD_all_neg <- read.csv(paste0(Prog_path,'MD/Allwks/MD_allwks_prog_neg_2.5.csv'), header=FALSE) %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()

```
#### All weeks 
##### <span style="color: hotpink;"> Positive ( FDR= 0.002484 ) </span> 
```{r, layout="l-body-outset",echo=FALSE}
knitr::kable(prog_MD_all_pos, row.names=F)
```
#####  <span class="text-center" style="color: Teal;"> Neg ( FDR= 0.250000)</span> 
```{r, layout="l-body-outset",echo=FALSE}
knitr::kable(prog_MD_all_neg, row.names=F)
```

#### Pregnancy only
No significant Findings

### AD {.tabset}
```{r AD vars,echo=FALSE, results='hide',message=FALSE}
# ALl weeks 
prog_AD_all_pos <- read.csv(paste0(Prog_path,'AD/Allwks/AD_allwks_prog_pos_2.5.csv'), header=FALSE) %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()

prog_AD_all_neg <- read.csv(paste0(Prog_path,'AD/Allwks/AD_allwks_prog_neg_2.5.csv'), header=FALSE) %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()

```
#### All weeks 
##### <span style="color: hotpink;"> Positive ( FDR= 0.002484 ) </span> 
```{r, layout="l-body-outset",echo=FALSE}
knitr::kable(prog_AD_all_pos, row.names=F)
```
#####  <span class="text-center" style="color: Teal;"> Neg ( FDR= 0.250000)</span> 
```{r, layout="l-body-outset",echo=FALSE}
knitr::kable(prog_AD_all_neg, row.names=F)
```

#### Pregnancy only
No significant Findings

### RD {.tabset}
```{r RD vars,echo=FALSE, results='hide',message=FALSE}
# ALl weeks 
prog_RD_all_pos <- read.csv(paste0(Prog_path,'RD/Allwks/RD_allwks_prog_pos_2.5.csv'), header=FALSE) %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()

prog_RD_all_neg <- read.csv(paste0(Prog_path,'RD/Allwks/RD_allwks_prog_neg_2.csv'), header=FALSE) %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()

```
#### All weeks 
##### <span style="color: hotpink;"> Positive ( FDR= 0.002484 ) </span> 
```{r, layout="l-body-outset",echo=FALSE}
knitr::kable(prog_RD_all_pos, row.names=F)
```
#####  <span class="text-center" style="color: Teal;"> Neg ( FDR= 0.250000)</span> 
```{r, layout="l-body-outset",echo=FALSE}
knitr::kable(prog_RD_all_neg, row.names=F)
```

#### Pregnancy only
No significant Findings

## END


