#
#   md_df <- as.data.frame(matrix(ncol = nrow(ROIS)+1, nrow = 1))
#   md_df[,1] <- subfiles[sub]
#
#   qa_df <- as.data.frame(matrix(ncol = nrow(ROIS)+1, nrow = 1))
#   qa_df[,1] <- subfiles[sub]
#
#   for ( roi in 1:nrow(ROIS)){
#
#   print(paste("running ",ROIS[roi,1]))
#
#     # Check if CSV exists
#     CSV_path <- paste0(tract_workdir,"/",subfiles[sub],"/",ROIS[roi,1],".stat.csv")
#
#     if (file.exists(CSV_path) == TRUE){
#
#       print("File Exists lets read it in")
#       ROI_csv <- read.delim(paste0(tract_workdir,"/",subfiles[sub],"/",ROIS[roi,1],".stat.csv"), header=FALSE, sep="\t") %>% filter(V1 %in% c("qa","md"))
#       qa_df[,roi+1] <- ROI_csv %>% filter(V1 =="qa") %>% pull(V2)
#       md_df[,roi+1] <- ROI_csv %>% filter(V1 =="md") %>% pull(V2)
#     }
#     else{
#       print("File does not exist. Add NA instead")
#
#       qa_df[,roi+1] <- NA
#       md_df[,roi+1] <- NA
#
#     }
#
#   }
#
#   QA_master_DF[sub,] <- qa_df[1,]
#   MD_master_DF[sub,] <- md_df[1,]
# }
#
# colnames(QA_master_DF) <- c("subjects",ROIS$V1)
# colnames(MD_master_DF) <- c("subjects",ROIS$V1)
#
# QA_master_DF <- QA_master_DF %>% filter(.$subjects != "boxplots")
#
# MD_master_DF <- MD_master_DF %>% filter(.$subjects != "boxplots")
#
# write.csv(QA_master_DF, paste0(tract_workdir,"/QA_master_DF.csv"), row.names=FALSE)
# write.csv(MD_master_DF, paste0(tract_workdir,"/MD_master_DF.csv"), row.names=FALSE)
View(AllScanInfo)
QA_master_DF <- read.csv(paste0(tract_workdir,"/QA_master_DF.csv")) %>% filter(!(subjects %in% c("sub-026", "sub-027")))
TableOutput(QA_master_DF,"QA")
MD_master_DF<- read.csv(paste0(tract_workdir,"/MD_master_DF.csv"))%>% filter(!(subjects %in% c("sub-026", "sub-027")))
TableOutput(MD_master_DF,"MD")
QA_master_DF <- read.csv(paste0(tract_workdir,"/QA_master_DF.csv")) %>% filter(!(subjects %in% c("sub-026", "sub-027")))
# MD_master_DF<- read.csv(paste0(tract_workdir,"/MD_master_DF.csv"))%>% filter(!(subjects %in% c("sub-026", "sub-027")))
QA_scans <- QA_master_DF %>%  mutate(trimester = factor(AllScanInfo$Trimester, levels= c('Pre','1st','2nd', '3rd', 'Post')))
View(QA_scans)
QA_master_DF <- read.csv(paste0(tract_workdir,"/QA_master_DF.csv")) %>% filter(!(subjects %in% c("sub-026", "sub-027")))
# MD_master_DF<- read.csv(paste0(tract_workdir,"/MD_master_DF.csv"))%>% filter(!(subjects %in% c("sub-026", "sub-027")))
QA_scans <- QA_master_DF %>%  mutate(trimester = factor(AllScanInfo$Trimester, levels= c('Pre','1st','2nd', '3rd', 'Post')))
for (ROI in 2:nrow(ROIS)) {
print(ROI)
roiname <- stringr::str_split_1(ROIS[ROI,1], '_') %>% paste(collapse=' ')
y <- ROIS[ROI,1]
QAplot <- QA_scans %>%
ggplot(aes(x = trimester, y = QA_scans[, ROI], group = trimester)) +
#geom_jitter(color = "black",size = 0.8, alpha = 0.9,width = 0.25) +
geom_boxplot(width = 0.5 , fill = grp_colors) +
scale_y_binned(n.breaks=10, nice.breaks = TRUE) +
labs(x = "Trimester", y = "QA", title = roiname) +
theme(
strip.text.x = element_text(
size = 12,
color = "black",
face = "bold.italic"
),
strip.text.y = element_text(
size = 12,
color = "black",
face = "bold.italic"
)
) + xlab("Trimester") + ylab("QA") +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background = element_rect(fill = 'white', color='gray'),
panel.grid.major=element_line(colour='gray90'),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))+ theme(legend.position = "none")
#
pdf(file = paste0(tract_workdir,"/boxplots/QA/",y,"_QA.pdf"),width=10, height=8)
print(QAplot)
dev.off()
}
QA_scans %>%
ggplot(aes(x = trimester, y = QA_scans[, ROI], group = trimester)) +
#geom_jitter(color = "black",size = 0.8, alpha = 0.9,width = 0.25) +
geom_boxplot( fill = grp_colors) +
scale_y_binned(n.breaks=10, nice.breaks = TRUE) +
labs(x = "Trimester", y = "QA", title = roiname) +
theme(
strip.text.x = element_text(
size = 12,
color = "black",
face = "bold.italic"
),
strip.text.y = element_text(
size = 12,
color = "black",
face = "bold.italic"
)
) + xlab("Trimester") + ylab("QA") +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background = element_rect(fill = 'white', color='gray'),
panel.grid.major=element_line(colour='gray90'),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))+ theme(legend.position = "none")
ggplot(aes(x = trimester, y = QA_scans[, ROI], group = trimester)) +
#geom_jitter(color = "black",size = 0.8, alpha = 0.9,width = 0.25) +
geom_boxplot() +
theme_bw() + scale_fill_manual(values = grp_colors)
QA_scans %>%
ggplot(aes(x = trimester, y = QA_scans[, ROI], group = trimester)) +
#geom_jitter(color = "black",size = 0.8, alpha = 0.9,width = 0.25) +
geom_boxplot() +
theme_bw() + scale_fill_manual(values = grp_colors)
# scale_y_binned(n.breaks=10, nice.breaks = TRUE) +
labs(x = "Trimester", y = "QA", title = roiname) +
theme(
strip.text.x = element_text(
size = 12,
color = "black",
face = "bold.italic"
),
strip.text.y = element_text(
size = 12,
color = "black",
face = "bold.italic"
)
) + xlab("Trimester") + ylab("QA") +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background = element_rect(fill = 'white', color='gray'),
panel.grid.major=element_line(colour='gray90'),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))+ theme(legend.position = "none")
QA_scans %>%
ggplot(aes(x = trimester, y = QA_scans[, ROI], group = trimester)) +
#geom_jitter(color = "black",size = 0.8, alpha = 0.9,width = 0.25) +
geom_boxplot() +
theme_bw() + scale_fill_manual(values = grp_colors)+
# scale_y_binned(n.breaks=10, nice.breaks = TRUE) +
labs(x = "Trimester", y = "QA", title = roiname) +
theme(
strip.text.x = element_text(
size = 12,
color = "black",
face = "bold.italic"
),
strip.text.y = element_text(
size = 12,
color = "black",
face = "bold.italic"
)
) + xlab("Trimester") + ylab("QA") +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background = element_rect(fill = 'white', color='gray'),
panel.grid.major=element_line(colour='gray90'),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))+ theme(legend.position = "none")
QA_scans %>%
ggplot(aes(x = trimester, y = QA_scans[, ROI], fill = trimester)) +
#geom_jitter(color = "black",size = 0.8, alpha = 0.9,width = 0.25) +
geom_boxplot() +
theme_bw() + scale_fill_manual(values = grp_colors)+
# scale_y_binned(n.breaks=10, nice.breaks = TRUE) +
labs(x = "Trimester", y = "QA", title = roiname) +
theme(
strip.text.x = element_text(
size = 12,
color = "black",
face = "bold.italic"
),
strip.text.y = element_text(
size = 12,
color = "black",
face = "bold.italic"
)
) + xlab("Trimester") + ylab("QA") +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background = element_rect(fill = 'white', color='gray'),
panel.grid.major=element_line(colour='gray90'),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))+ theme(legend.position = "none")
QA_scans %>%
ggplot(aes(x = trimester, y = QA_scans[, ROI], fill = trimester)) +
#geom_jitter(color = "black",size = 0.8, alpha = 0.9,width = 0.25) +
geom_boxplot() +
theme_bw() + scale_fill_manual(values = grp_colors)+
scale_y_binned(n.breaks=10, nice.breaks = TRUE) +
labs(x = "Trimester", y = "QA", title = roiname)
QA_scans %>%
ggplot(aes(x = trimester, y = QA_scans[, ROI], fill = trimester)) +
#geom_jitter(color = "black",size = 0.8, alpha = 0.9,width = 0.25) +
geom_boxplot() +
theme_bw() + scale_fill_manual(values = grp_colors)+
scale_y_binned(n.breaks=5, nice.breaks = TRUE) +
labs(x = "Trimester", y = "QA", title = roiname)
QA_scans %>%
ggplot(aes(x = trimester, y = QA_scans[, ROI], fill = trimester)) +
#geom_jitter(color = "black",size = 0.8, alpha = 0.9,width = 0.25) +
geom_boxplot() +
theme_bw() + scale_fill_manual(values = grp_colors)+
# scale_y_binned(n.breaks=5, nice.breaks = TRUE) +
labs(x = "Trimester", y = "QA", title = roiname)
QAplot <- QA_scans %>%
ggplot(aes(x = trimester, y = QA_scans[, ROI], fill = trimester)) +
#geom_jitter(color = "black",size = 0.8, alpha = 0.9,width = 0.25) +
geom_boxplot() +
theme_bw() + scale_fill_manual(values = grp_colors)+
# scale_y_binned(n.breaks=5, nice.breaks = TRUE) +
labs(x = "Trimester", y = "QA", title = roiname) +
theme(
strip.text.x = element_text(
size = 12,
color = "black",
face = "bold.italic"
),
strip.text.y = element_text(
size = 12,
color = "black",
face = "bold.italic"
)
) + xlab("Trimester") + ylab("QA") +
theme(axis.title.x = element_text(size = 16),
axis.title.y = element_text(size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
axis.title = element_text(size = 16))+ theme(legend.position = "none")
QA_scans %>%
ggplot(aes(x = trimester, y = QA_scans[, ROI], fill = trimester)) +
#geom_jitter(color = "black",size = 0.8, alpha = 0.9,width = 0.25) +
geom_boxplot() +
theme_bw() + scale_fill_manual(values = grp_colors)+
# scale_y_binned(n.breaks=5, nice.breaks = TRUE) +
labs(x = "Trimester", y = "QA", title = roiname) +
theme(
strip.text.x = element_text(
size = 12,
color = "black",
face = "bold.italic"
),
strip.text.y = element_text(
size = 12,
color = "black",
face = "bold.italic"
)
) + xlab("Trimester") + ylab("QA") +
theme(axis.title.x = element_text(size = 16),
axis.title.y = element_text(size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
axis.title = element_text(size = 16))+ theme(legend.position = "none")
QA_scans %>%
ggplot(aes(x = trimester, y = QA_scans[, ROI], fill = trimester)) +
#geom_jitter(color = "black",size = 0.8, alpha = 0.9,width = 0.25) +
geom_boxplot() +
theme_bw() + scale_fill_manual(values = grp_colors)+
# scale_y_binned(n.breaks=5, nice.breaks = TRUE) +
labs(x = "Trimester", y = "QA", title = roiname) +
theme(
strip.text.x = element_text(
size = 12,
color = "black",
face = "bold.italic"
),
strip.text.y = element_text(
size = 12,
color = "black",
face = "bold.italic"
)
) + xlab("Trimester") + ylab("QA") +
theme(axis.title.x = element_text(size = 16),
axis.title.y = element_text(size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
axis.title.y = element_text(size = 16))+ theme(legend.position = "none")
QA_scans %>%
ggplot(aes(x = trimester, y = QA_scans[, ROI], fill = trimester)) +
#geom_jitter(color = "black",size = 0.8, alpha = 0.9,width = 0.25) +
geom_boxplot() +
theme_bw() + scale_fill_manual(values = grp_colors)+
# scale_y_binned(n.breaks=5, nice.breaks = TRUE) +
labs(x = "Trimester", y = "QA", title = roiname) +
theme(
strip.text.x = element_text(
size = 12,
color = "black",
face = "bold.italic"
),
strip.text.y = element_text(
size = 12,
color = "black",
face = "bold.italic"
)
) + xlab("Trimester") + ylab("QA") +
theme(axis.title.x = element_text(size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
axis.title.y = element_text(size = 16))+ theme(legend.position = "none")
QA_scans %>%
ggplot(aes(x = trimester, y = QA_scans[, ROI], fill = trimester)) +
#geom_jitter(color = "black",size = 0.8, alpha = 0.9,width = 0.25) +
geom_boxplot() +
theme_bw() + scale_fill_manual(values = grp_colors)+
# scale_y_binned(n.breaks=5, nice.breaks = TRUE) +
labs(x = "Trimester", y = "QA") +
theme(
strip.text.x = element_text(
size = 12,
color = "black",
face = "bold.italic"
),
strip.text.y = element_text(
size = 12,
color = "black",
face = "bold.italic"
)
) + xlab("Trimester") + ylab("QA") +
theme(axis.title.x = element_text(size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
axis.title.y = element_text(size = 16))+ theme(legend.position = "none")
QAplot <- QA_scans %>%
ggplot(aes(x = trimester, y = QA_scans[, ROI], fill = trimester)) +
#geom_jitter(color = "black",size = 0.8, alpha = 0.9,width = 0.25) +
geom_boxplot() +
theme_bw() + scale_fill_manual(values = grp_colors)+
# scale_y_binned(n.breaks=5, nice.breaks = TRUE) +
labs(x = "Trimester", y = "QA") +
theme(
strip.text.x = element_text(
size = 12,
color = "black",
face = "bold.italic"
),
strip.text.y = element_text(
size = 12,
color = "black",
face = "bold.italic"
)
) + xlab("Trimester") + ylab("QA") +
theme(axis.title.x = element_text(size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
axis.title.y = element_text(size = 16))+ theme(legend.position = "none")
jpeg(file=paste0(tract_workdir,"/boxplots/QA/",y,"_QA.jpg", res=600, units = "px", width=449, height=319))
#    pdf(file = paste0(tract_workdir,"/boxplots/QA/",y,"_QA.pdf"),width=10, height=8)
print(QAplot)
dev.off()
QAplot <- QA_scans %>%
ggplot(aes(x = trimester, y = QA_scans[, ROI], fill = trimester)) +
#geom_jitter(color = "black",size = 0.8, alpha = 0.9,width = 0.25) +
geom_boxplot() +
theme_bw() + scale_fill_manual(values = grp_colors)+
# scale_y_binned(n.breaks=5, nice.breaks = TRUE) +
labs(x = "Trimester", y = "QA") +
theme(
strip.text.x = element_text(
size = 12,
color = "black",
face = "bold.italic"
),
strip.text.y = element_text(
size = 12,
color = "black",
face = "bold.italic"
)
) + xlab("Trimester") + ylab("QA") +
theme(axis.title.x = element_text(size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
axis.title.y = element_text(size = 16))+ theme(legend.position = "none")
jpeg(file=paste0(tract_workdir,"/boxplots/QA/",y,"_QA.jpg"), res=600, units = "px", width=449, height=319)
#    pdf(file = paste0(tract_workdir,"/boxplots/QA/",y,"_QA.pdf"),width=10, height=8)
print(QAplot)
dev.off()
jpeg(file=paste0(tract_workdir,"/boxplots/QA/",y,"_QA.jpg"), width=449, height=319)
#    pdf(file = paste0(tract_workdir,"/boxplots/QA/",y,"_QA.pdf"),width=10, height=8)
print(QAplot)
dev.off()
QA_master_DF <- read.csv(paste0(tract_workdir,"/QA_master_DF.csv")) %>% filter(!(subjects %in% c("sub-026", "sub-027")))
# MD_master_DF<- read.csv(paste0(tract_workdir,"/MD_master_DF.csv"))%>% filter(!(subjects %in% c("sub-026", "sub-027")))
QA_scans <- QA_master_DF %>%  mutate(trimester = factor(AllScanInfo$Trimester, levels= c('Pre','1st','2nd', '3rd', 'Post')))
for (ROI in 2:nrow(ROIS)) {
print(ROI)
roiname <- stringr::str_split_1(ROIS[ROI,1], '_') %>% paste(collapse=' ')
y <- ROIS[ROI,1]
#
QAplot <- QA_scans %>%
ggplot(aes(x = trimester, y = QA_scans[, ROI], fill = trimester)) +
#geom_jitter(color = "black",size = 0.8, alpha = 0.9,width = 0.25) +
geom_boxplot() +
theme_bw() + scale_fill_manual(values = grp_colors)+
# scale_y_binned(n.breaks=5, nice.breaks = TRUE) +
labs(x = "Trimester", y = "QA") +
theme(
strip.text.x = element_text(
size = 12,
color = "black",
face = "bold.italic"
),
strip.text.y = element_text(
size = 12,
color = "black",
face = "bold.italic"
)
) + xlab("Trimester") + ylab("QA") +
theme(axis.title.x = element_text(size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
axis.title.y = element_text(size = 16))+ theme(legend.position = "none")
jpeg(file=paste0(tract_workdir,"/boxplots/QA/",y,"_QA.jpg"), width=449, height=319)
#    pdf(file = paste0(tract_workdir,"/boxplots/QA/",y,"_QA.pdf"),width=10, height=8)
print(QAplot)
dev.off()
}
QA_master_DF <- read.csv(paste0(tract_workdir,"/QA_master_DF.csv")) %>% filter(!(subjects %in% c("sub-026", "sub-027")))
# MD_master_DF<- read.csv(paste0(tract_workdir,"/MD_master_DF.csv"))%>% filter(!(subjects %in% c("sub-026", "sub-027")))
QA_scans <- QA_master_DF %>%  mutate(trimester = factor(AllScanInfo$Trimester, levels= c('Pre','1st','2nd', '3rd', 'Post')))
for (ROI in 2:nrow(ROIS)) {
print(ROI)
roiname <- stringr::str_split_1(ROIS[ROI,1], '_') %>% paste(collapse=' ')
y <- ROIS[ROI,1]
#
QAplot <- QA_scans %>%
ggplot(aes(x = trimester, y = QA_scans[, ROI], fill = trimester)) +
#geom_jitter(color = "black",size = 0.8, alpha = 0.9,width = 0.25) +
geom_boxplot() +
theme_bw() + scale_fill_manual(values = grp_colors)+
# scale_y_binned(n.breaks=5, nice.breaks = TRUE) +
labs(x = "Trimester", y = "Quantitative Anisotropy") +
theme(
strip.text.x = element_text(
size = 12,
color = "black",
face = "bold.italic"
),
strip.text.y = element_text(
size = 12,
color = "black",
face = "bold.italic"
)
) + xlab("Trimester") + ylab("QA") +
theme(axis.title.x = element_text(size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
axis.title.y = element_text(size = 16))+ theme(legend.position = "none")
jpeg(file=paste0(tract_workdir,"/boxplots/QA/",y,"_QA.jpg"), width=449, height=319)
#    pdf(file = paste0(tract_workdir,"/boxplots/QA/",y,"_QA.pdf"),width=10, height=8)
print(QAplot)
dev.off()
}
QA_master_DF <- read.csv(paste0(tract_workdir,"/QA_master_DF.csv")) %>% filter(!(subjects %in% c("sub-026", "sub-027")))
# MD_master_DF<- read.csv(paste0(tract_workdir,"/MD_master_DF.csv"))%>% filter(!(subjects %in% c("sub-026", "sub-027")))
QA_scans <- QA_master_DF %>%  mutate(trimester = factor(AllScanInfo$Trimester, levels= c('Pre','1st','2nd', '3rd', 'Post')))
for (ROI in 2:nrow(ROIS)) {
print(ROI)
roiname <- stringr::str_split_1(ROIS[ROI,1], '_') %>% paste(collapse=' ')
y <- ROIS[ROI,1]
#
QAplot <- QA_scans %>%
ggplot(aes(x = trimester, y = QA_scans[, ROI], fill = trimester)) +
#geom_jitter(color = "black",size = 0.8, alpha = 0.9,width = 0.25) +
geom_boxplot() +
theme_bw() + scale_fill_manual(values = grp_colors)+
# scale_y_binned(n.breaks=5, nice.breaks = TRUE) +
labs(x = "Trimester", y = "Quantitative Anisotropy") +
theme(
strip.text.x = element_text(
size = 12,
color = "black",
face = "bold.italic"
),
strip.text.y = element_text(
size = 12,
color = "black",
face = "bold.italic"
)
) + xlab("Trimester") + ylab("Quantitative Anisotropy") +
theme(axis.title.x = element_text(size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
axis.title.y = element_text(size = 16))+ theme(legend.position = "none")
jpeg(file=paste0(tract_workdir,"/boxplots/QA/",y,"_QA.jpg"), width=449, height=319)
#    pdf(file = paste0(tract_workdir,"/boxplots/QA/",y,"_QA.pdf"),width=10, height=8)
print(QAplot)
dev.off()
}
