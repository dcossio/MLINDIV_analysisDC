plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
ggplot(data = MergedWholebrain, mapping = aes(x = gestWK, y = qa)) + geom_point() + geom_smooth(method = "gam")+
labs(x= "Trimester", y= " QA" ) + theme_bw() + scale_color_manual(values = "CF92BF") +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background = element_rect(fill = 'white', color='gray'),
panel.grid.major=element_line(colour='gray96'),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
ggplot(data = MergedWholebrain, mapping = aes(x = gestWK, y = qa)) + geom_point(color= "CF92BF") + geom_smooth(method = "gam")+
labs(x= "Trimester", y= " QA" )
ggplot(data = MergedWholebrain, mapping = aes(x = gestWK, y = qa)) + geom_point(color= "#CF92BF")
ggplot(data = MergedWholebrain, mapping = aes(x = gestWK, y = qa)) + geom_point() + geom_smooth(method = "gam" )+
labs(x= "Trimester", y= " QA" ) + theme_bw() + scale_color_manual(values =  "#CF92BF")
ggplot(data = MergedWholebrain, mapping = aes(x = gestWK, y = qa)) + geom_point() + geom_smooth(method = "gam" )+
labs(x= "Trimester", y= " QA" )  + scale_color_manual(values =  "#CF92BF")
ggplot(data = MergedWholebrain, mapping = aes(x = gestWK, y = qa)) + geom_point(color = "#CF92BF") + geom_smooth(method = "gam", color ="#CF92BF" )+
labs(x= "Trimester", y= " QA" ) + theme_bw()
ggplot(data = MergedWholebrain, mapping = aes(x = gestWK, y = qa)) + geom_point(color = "#CF92BF") + geom_smooth(method = "gam", color ="#CF92BF" )+
labs(x= "Trimester", y= " QA" ) + theme_bw() +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background = element_rect(fill = 'white', color='gray'),
panel.grid.major=element_line(colour='gray96'),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
ggplot(data = MergedWholebrain, mapping = aes(x = gestWK, y = qa)) + geom_point(color = "#CF92BF") + geom_smooth(method = "gam", color ="#CF92BF" )+ geom_vline(xintercept=c(-2,2),linetype="dotted") +
labs(x= "gestational week", y= " QA" ) + theme_bw() +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background = element_rect(fill = 'white', color='gray'),
panel.grid.major=element_line(colour='gray96'),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
ggplot(data = MergedWholebrain, mapping = aes(x = gestWK, y = qa)) + geom_point(color = "#CF92BF") + geom_smooth(method = "gam", color ="#CF92BF" )+ geom_vline(xintercept=c(40),linetype="dotted") +
labs(x= "gestational week", y= " QA" ) + theme_bw() +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background = element_rect(fill = 'white', color='gray'),
panel.grid.major=element_line(colour='gray96'),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
ggplot(data = MergedWholebrain, mapping = aes(x = gestWK, y = qa)) + geom_point(color = "#CF92BF") + geom_smooth(method = "gam", color ="#CF92BF" )+ geom_vline(xintercept=c(40),linetype="dotted") +
labs(x= "gestational week", y= " QA" ) + theme_bw() +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background = element_rect(fill = 'white', color='gray'),
panel.grid.major=element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
ggplot(data = MergedWholebrain, mapping = aes(x = gestWK, y = qa)) + geom_point(color = "#CF92BF") + geom_smooth(method = "gam", color ="#CF92BF" )+ geom_vline(xintercept=c(40),linetype="dotted") +
labs(x= "gestational week", y= " QA" ) + theme_bw() +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
ggplot(data = MergedWholebrain, mapping = aes(x = gestWK, y = qa)) + geom_point(color = "#CF92BF") + geom_smooth(method = "gam", color ="#CF92BF" )+ geom_vline(xintercept=c(40),linetype="dotted") +
labs(x= "gestational week", y= " QA" )  +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background = element_blank(fill = 'white'),
panel.grid.major=element_blank(colour='gray96'),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
ggplot(data = MergedWholebrain, mapping = aes(x = gestWK, y = qa)) + geom_point(color = "#CF92BF") + geom_smooth(method = "gam", color ="#CF92BF" )+ geom_vline(xintercept=c(40),linetype="dotted") +
labs(x= "gestational week", y= " QA" )  +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background = element_blank(),
panel.grid.major=element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
ggplot(data = MergedWholebrain, mapping = aes(x = gestWK, y = qa)) + geom_point(color = "#CF92BF") + geom_smooth(method = "gam", color ="#CF92BF" )+ geom_vline(xintercept=c(40),linetype="dotted") +
labs(x= "gestational week", y= " QA" )  + geom_label(label="birth",
x=40,
y=0.46,
label.padding = unit(0.55, "lines"), # Rectangle size around label
label.size = 0.35,
color = "black") +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background = element_blank(),
panel.grid.major=element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
plot(qa_mod_gam1)
ggplot(data = MergedWholebrain, mapping = aes(x = gestWK, y = qa)) + geom_point(color = "#CF92BF") + geom_smooth(method = "gam", color ="#CF92BF" )+ geom_vline(xintercept=c(40),linetype="dotted") +
labs(x= "gestational week", y= " QA" )  + geom_label(label="birth",
x=42,
y=0.44,
label.padding = unit(0.55, "lines"), # Rectangle size around label
label.size = 0.35,
color = "black") +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background = element_blank(),
panel.grid.major=element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
ggplot(data = MergedWholebrain, mapping = aes(x = gestWK, y = qa)) + geom_point(color = "#CF92BF") + geom_smooth(method = "gam", color ="#CF92BF" )+ geom_vline(xintercept=c(40),linetype="dotted") +
labs(x= "gestational week", y= " QA" )  + geom_label(label="birth",
x=48,
y=0.44, # Rectangle size around label
label.size = 0.2,
color = "black") +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background = element_blank(),
panel.grid.major=element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
ggplot(data = MergedWholebrain, mapping = aes(x = gestWK, y = qa)) + geom_point(color = "#CF92BF") + geom_smooth(method = "gam", color ="#CF92BF" )+ geom_vline(xintercept=c(40),linetype="dotted") +
labs(x= "gestational week", y= " QA" )  + geom_label(label="birth",
x=48,
y=0.44, # Rectangle size around label
label.size = NA,
color = "black")
ggplot(data = MergedWholebrain, mapping = aes(x = gestWK, y = qa)) + geom_point(color = "#CF92BF") + geom_smooth(method = "gam", color ="#CF92BF" )+ geom_vline(xintercept=c(40),linetype="dotted") +
labs(x= "gestational week", y= " QA" )  + geom_label(label="birth",
x=48,
y=0.44, # Rectangle size around label
label.size = NA,
color = "black") +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background = element_blank(),
panel.grid.major=element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
ggplot(data = MergedWholebrain, mapping = aes(x = gestWK, y = qa)) + geom_point(color = "#CF92BF") + geom_smooth(method = "gam", color ="#CF92BF" )+ geom_vline(xintercept=c(40),linetype="dotted") +
labs(x= "gestational week", y= " QA" )  + geom_label(label="birth",
x=42,
y=0.46, # Rectangle size around label
label.size = NA,
color = "black") +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background = element_blank(),
panel.grid.major=element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
ggplot(data = MergedWholebrain, mapping = aes(x = gestWK, y = qa)) + geom_point(color = "#CF92BF") + geom_smooth(method = "gam", color ="#CF92BF" )+ geom_vline(xintercept=c(40),linetype="dotted") +
labs(x= "gestational week", y= " QA" )  + geom_label(label="birth",
x=42,
y=0.48, # Rectangle size around label
label.size = NA,
color = "black") +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background = element_blank(),
panel.grid.major=element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
ggplot(data = MergedWholebrain, mapping = aes(x = gestWK, y = qa)) + geom_point(color = "#CF92BF") + geom_smooth(method = "gam", color ="#CF92BF" )+ geom_vline(xintercept=c(40),linetype="dotted") +
labs(x= "gestational week", y= " QA" )  + geom_label(label="birth",
x=42,
y=0.46, # Rectangle size around label
label.size = NA,
color = "black") +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background = element_blank(),
panel.grid.major=element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
ggplot(data = MergedWholebrain, mapping = aes(x = gestWK, y = qa)) + geom_point(color = "#CF92BF") + geom_smooth(method = "gam", color ="#CF92BF" )+ geom_vline(xintercept=c(40),linetype="dotted") +
labs(x= "gestational week", y= " QA" )  + geom_label(label="birth",
x=42,
y=0.46, # Rectangle size around label
label.size = NA,
color = "black") +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background = element_blank(),
panel.grid.major=element_blank(),
axis.line = element_line(colour = "black"))
ggplot(data = MergedWholebrain, mapping = aes(x = gestWK, y = qa)) + geom_point(color = "#CF92BF") + geom_smooth(method = "gam", color ="#CF92BF" )+ geom_vline(xintercept=c(40),linetype="dotted") +
labs(x= "gestational week", y= " QA" )  + geom_label(label="birth",
x=42,
y=0.46, # Rectangle size around label
label.size = NA,
color = "black") +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background = element_blank(),
panel.grid.major=element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
summary(qa_mod_gam1)
ggplot(data = MergedWholebrain, mapping = aes(x = gestWK, y = qa)) + geom_point(color = "#CF92BF") + geom_smooth(method = "gam", color ="#CF92BF" )+ geom_vline(xintercept=c(40),linetype="dotted") +
labs(x= "gestational week", y= " QA" )  + geom_label(label="birth",
x=42,
y=0.46, # Rectangle size around label
label.size = NA,
color = "black") + geom_label(label="deviance explained = 69.9%",
x=42,
y=0.46, # Rectangle size around label
label.size = NA,
color = "black")+
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background = element_blank(),
panel.grid.major=element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
summary(mod_gam1)
ggplot(data = MergedWholebrain, mapping = aes(x = gestWK, y = iso)) + geom_point(color = "#CF92BF") + geom_smooth(method = "gam", color ="#CF92BF" )+ geom_vline(xintercept=c(40),linetype="dotted") +
labs(x= "gestational week", y= " Isotropic Diffusion" )  + geom_label(label="birth",
x=42,
y=0.46, # Rectangle size around label
label.size = NA,
color = "black") + geom_label(label="deviance explained = 74.7%",
x=42,
y=0.46, # Rectangle size around label
label.size = NA,
color = "black")+
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background = element_blank(),
panel.grid.major=element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
# you'll need:
library(mgcv)
##### GAM models
# linear fit
mod_lm = gam(iso ~ gestWK, data = MergedWholebrain)
summary(mod_lm)
# GAM fit
mod_gam1 = gam(iso ~ s(MergedWholebrain$gestWK, bs = "cr"), data =MergedWholebrain)
summary(mod_gam1)
# assess model differences
anova(mod_lm, mod_gam1, test = "Chisq")
#plotting, basic & w/ ggplot
plot(mod_gam1)
ggplot(data = MergedWholebrain, mapping = aes(x = gestWK, y = iso)) + geom_point(color = "#CF92BF") + geom_smooth(method = "gam", color ="#CF92BF" )+ geom_vline(xintercept=c(40),linetype="dotted") +
labs(x= "gestational week", y= " Isotropic Diffusion" )  + geom_label(label="birth",
x=42,
y=0.46, # Rectangle size around label
label.size = NA,
color = "black") + geom_label(label="deviance explained = 74.7%",
x=42,
y=0.46, # Rectangle size around label
label.size = NA,
color = "black")+
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background = element_blank(),
panel.grid.major=element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
ggplot(data = MergedWholebrain, mapping = aes(x = gestWK, y = iso)) + geom_point(color = "#CF92BF") + geom_smooth(method = "gam", color ="#CF92BF" )+ geom_vline(xintercept=c(40),linetype="dotted") +
labs(x= "gestational week", y= " Isotropic Diffusion" )  + geom_label(label="birth",
x=42,
y=0.46, # Rectangle size around label
label.size = NA,
color = "black") + geom_label(label="deviance explained = 74.7%",
x=42,
y=1, # Rectangle size around label
label.size = NA,
color = "black")+
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background = element_blank(),
panel.grid.major=element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
# you'll need:
library(mgcv)
##### GAM models
# linear fit
qa_mod_lm = gam(qa ~ gestWK, data = MergedWholebrain)
summary(qa_mod_lm)
# GAM fit
qa_mod_gam1 = gam(qa ~ s(MergedWholebrain$gestWK, bs = "cr"), data =MergedWholebrain)
summary(qa_mod_gam1)
# assess model differences
anova(qa_mod_lm, qa_mod_gam1, test = "Chisq")
#plotting, basic & w/ ggplot
plot(qa_mod_gam1)
ggplot(data = MergedWholebrain, mapping = aes(x = gestWK, y = qa)) + geom_point(color = "#CF92BF") + geom_smooth(method = "gam", color ="#CF92BF" )+ geom_vline(xintercept=c(40),linetype="dotted") +
labs(x= "gestational week", y= " QA" )  + geom_label(label="birth",
x=42,
y=0.46, # Rectangle size around label
label.size = NA,
color = "black") + geom_label(label="deviance explained = 69.9%",
x=50,
y=0.44, # Rectangle size around label
label.size = NA,
color = "black")+
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background = element_blank(),
panel.grid.major=element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
ggplot(data = MergedWholebrain, mapping = aes(x = gestWK, y = qa)) + geom_point(color = "#CF92BF") + geom_smooth(method = "gam", color ="#CF92BF" )+ geom_vline(xintercept=c(40),linetype="dotted") +
labs(x= "gestational week", y= " QA" )  + geom_label(label="birth",
x=42,
y=0.46, # Rectangle size around label
label.size = NA,
color = "black") + geom_label(label="deviance explained = 69.9%",
x=60,
y=0.44, # Rectangle size around label
label.size = NA,
color = "black")+
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background = element_blank(),
panel.grid.major=element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
ggplot(data = MergedWholebrain, mapping = aes(x = gestWK, y = qa)) + geom_point(color = "#CF92BF") + geom_smooth(method = "gam", color ="#CF92BF" )+ geom_vline(xintercept=c(40),linetype="dotted") +
labs(x= "gestational week", y= " QA" )  + geom_label(label="birth",
x=42,
y=0.46, # Rectangle size around label
label.size = NA,
color = "black") + geom_label(label="deviance explained = 69.9%",
x=70,
y=0.44, # Rectangle size around label
label.size = NA,
color = "black")+
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background = element_blank(),
panel.grid.major=element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
ggplot(data = MergedWholebrain, mapping = aes(x = gestWK, y = iso)) + geom_point(color = "#CF92BF") + geom_smooth(method = "gam", color ="#CF92BF" )+ geom_vline(xintercept=c(40),linetype="dotted") +
labs(x= "gestational week", y= " Isotropic Diffusion" )  + geom_label(label="birth",
x=42,
y=1, # Rectangle size around label
label.size = NA,
color = "black") + geom_label(label="deviance explained = 74.7%",
x=70,
y=90, # Rectangle size around label
label.size = NA,
color = "black")+
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background = element_blank(),
panel.grid.major=element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
ggplot(data = MergedWholebrain, mapping = aes(x = gestWK, y = iso)) + geom_point(color = "#CF92BF") + geom_smooth(method = "gam", color ="#CF92BF" )+ geom_vline(xintercept=c(40),linetype="dotted") +
labs(x= "gestational week", y= " Isotropic Diffusion" )  + geom_label(label="birth",
x=42,
y=1.2, # Rectangle size around label
label.size = NA,
color = "black") + geom_label(label="deviance explained = 74.7%",
x=70,
y=.90, # Rectangle size around label
label.size = NA,
color = "black")+
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background = element_blank(),
panel.grid.major=element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
ggplot(data = MergedWholebrain, mapping = aes(x = gestWK, y = iso)) + geom_point(color = "#CF92BF") + geom_smooth(method = "gam", color ="#CF92BF" )+ geom_vline(xintercept=c(40),linetype="dotted") +
labs(x= "gestational week", y= " Isotropic Diffusion" )  + geom_label(label="birth",
x=42,
y=1.2, # Rectangle size around label
label.size = NA,
color = "black") + geom_label(label="deviance explained = 74.7%",
x=70,
y=.98, # Rectangle size around label
label.size = NA,
color = "black")+
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background = element_blank(),
panel.grid.major=element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
ggplot(data = MergedWholebrain, mapping = aes(x = gestWK, y = iso)) + geom_point(color = "#CF92BF") + geom_smooth(method = "gam", color ="#CF92BF" )+ geom_vline(xintercept=c(40),linetype="dotted") +
labs(x= "gestational week", y= " Isotropic Diffusion" )  + geom_label(label="birth",
x=42,
y=1.05, # Rectangle size around label
label.size = NA,
color = "black") + geom_label(label="deviance explained = 74.7%",
x=70,
y=.98, # Rectangle size around label
label.size = NA,
color = "black")+
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background = element_blank(),
panel.grid.major=element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
ggplot(data = MergedWholebrain, mapping = aes(x = gestWK, y = iso)) + geom_point(color = "#CF92BF") + geom_smooth(method = "gam", color ="#CF92BF" )+ geom_vline(xintercept=c(40),linetype="dotted") +
labs(x= "gestational week", y= " Isotropic Diffusion" )  + geom_label(label="birth",
x=42,
y=1.00, # Rectangle size around label
label.size = NA,
color = "black") + geom_label(label="deviance explained = 74.7%",
x=70,
y=.98, # Rectangle size around label
label.size = NA,
color = "black")+
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background = element_blank(),
panel.grid.major=element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
qa_mod_gam1 = gam(qa ~ s(MergedWholebrain$gestWK, bs = "cr"), data =MergedWholebrain)
summary(qa_mod_gam1)
ICC_output
ICC <- read_csv("/Users/danielacossio/Downloads/Global_QA/ROI_QA_master_DF.csv")
# Need to create a loop fix the subject IDs to match
for (sub in 1:nrow((ICC))) {
clean_subnum <- str_split(ICC$subjects[sub], "_")[[1]][1]  %>% str_split("-") %>% as.data.frame() %>% `[`(2,)
ICC$subjects[sub] <-  sub("^0+", "", clean_subnum)
}
# Need to transpose and clean up data
ICC <- ICC %>% filter(subjects %in% c("26","27"))
ICC <- as.data.frame(t(ICC[,-1]))
colnames(ICC) <- c("26", "27")
ICC_output <- icc(ICC, model = "twoway",
type = "agreement", unit = "single")
p <- format(ICC_output[["p.value"]], scientific=FALSE)
ICC_output
