labs(x= "Trimester", y= " QA", title =paste0(ROI) ) +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
dev.off()
}
print(Est_QA_all_pos_values[[ROI]])
print(Est_QA_all_pos_values[ROI])
print(Est_QA_all_pos_values[ROI])
Est_QA_all_pos_values %>%
ggplot( aes(x=trimester, y=Est_QA_all_pos_values[[ROI]], group=trimester)) +
geom_boxplot(width=0.5 ,fill= c("#CF92BF", "#D1E7E6", "#A8D2C6", "#6AA390","#90A0C9")) +
scale_y_binned(n.breaks=10, nice.breaks = TRUE) +
labs(x= "Trimester", y= " QA", title =paste0(ROI) ) +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
paste0(figpath,ROI,'.png')
png(file = paste0(figpath,ROI,'.png'))
Est_QA_all_pos_values %>%
ggplot( aes(x=trimester, y=Est_QA_all_pos_values[[ROI]], group=trimester)) +
geom_boxplot(width=0.5 ,fill= c("#CF92BF", "#D1E7E6", "#A8D2C6", "#6AA390","#90A0C9")) +
scale_y_binned(n.breaks=10, nice.breaks = TRUE) +
labs(x= "Trimester", y= " QA", title =paste0(ROI) ) +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
dev.off()
for (ROI in gathercols) {
print(Est_QA_all_pos_values[ROI])
png(file = paste0(figpath,ROI,'.png'))
Est_QA_all_pos_values %>%
ggplot( aes(x=trimester, y=Est_QA_all_pos_values[[ROI]], group=trimester)) +
geom_boxplot(width=0.5 ,fill= c("#CF92BF", "#D1E7E6", "#A8D2C6", "#6AA390","#90A0C9")) +
scale_y_binned(n.breaks=10, nice.breaks = TRUE) +
labs(x= "Trimester", y= " QA", title =paste0(ROI) ) +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
dev.off()
}
print(Est_QA_all_pos_values[ROI])
print(Est_QA_all_pos_values[ROI])
print(ROI)
gathercols
for (ROI in gathercols) {
print(ROI)
png(file = paste0(figpath,ROI,'.png'))
Est_QA_all_pos_values %>%
ggplot( aes(x=trimester, y=Est_QA_all_pos_values[[ROI]], group=trimester)) +
geom_boxplot(width=0.5 ,fill= c("#CF92BF", "#D1E7E6", "#A8D2C6", "#6AA390","#90A0C9")) +
scale_y_binned(n.breaks=10, nice.breaks = TRUE) +
labs(x= "Trimester", y= " QA", title =paste0(ROI) ) +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
dev.off()
}
for (ROI in gathercols) {
print(ROI)
png(file = paste0(figpath,ROI,'.png'))
Est_QA_all_pos_values %>%
ggplot( aes(x=trimester, y=Est_QA_all_pos_values[[ROI]], group=trimester)) +
geom_boxplot(width=0.5 ,fill= c("#CF92BF", "#D1E7E6", "#A8D2C6", "#6AA390","#90A0C9")) +
scale_y_binned(n.breaks=10, nice.breaks = TRUE) +
labs(x= "Trimester", y= " QA", title =paste0(ROI) ) +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
}
dev.off()
paste0(figpath,ROI,".png"))
paste0(figpath,ROI,".png")
y <- Est_QA_all_pos_values %>%
ggplot( aes(x=trimester, y=Est_QA_all_pos_values[[ROI]], group=trimester)) +
geom_boxplot(width=0.5 ,fill= c("#CF92BF", "#D1E7E6", "#A8D2C6", "#6AA390","#90A0C9")) +
scale_y_binned(n.breaks=10, nice.breaks = TRUE) +
labs(x= "Trimester", y= " QA", title =paste0(ROI) ) +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
y
y
y <- Est_QA_all_pos_values %>%
ggplot( aes(x=trimester, y=Est_QA_all_pos_values[[ROI]], group=trimester)) +
geom_boxplot(width=0.5 ,fill= c("#CF92BF", "#D1E7E6", "#A8D2C6", "#6AA390","#90A0C9")) +
scale_y_binned(n.breaks=10, nice.breaks = TRUE) +
labs(x= "Trimester", y= " QA", title =paste0(ROI) ) +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
y
y <- Est_QA_all_pos_values %>%
ggplot( aes(x=trimester, y=Est_QA_all_pos_values[[ROI]], group=trimester)) +
geom_boxplot(width=0.5 ,fill= c("#CF92BF", "#D1E7E6", "#A8D2C6", "#6AA390","#90A0C9")) +
scale_y_binned(n.breaks=10, nice.breaks = TRUE) +
labs(x= "Trimester", y= " QA", title =paste0(ROI) ) +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
print(y)
for (ROI in gathercols) {
print(ROI)
y <- Est_QA_all_pos_values %>%
ggplot( aes(x=trimester, y=Est_QA_all_pos_values[[ROI]], group=trimester)) +
geom_boxplot(width=0.5 ,fill= c("#CF92BF", "#D1E7E6", "#A8D2C6", "#6AA390","#90A0C9")) +
scale_y_binned(n.breaks=10, nice.breaks = TRUE) +
labs(x= "Trimester", y= " QA", title =paste0(ROI) ) +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
png(file = paste0(figpath,ROI,".png"))
print(y)
dev.off()
}
Est_QA_all_pos_values %>%
ggplot( aes(x=trimester, y=.data[[ROI]], group=trimester)) +
geom_boxplot(width=0.5 ,fill= c("#CF92BF", "#D1E7E6", "#A8D2C6", "#6AA390","#90A0C9")) +
scale_y_binned(n.breaks=10, nice.breaks = TRUE) +
labs(x= "Trimester", y= " QA", title =paste0(ROI) ) +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
Est_QA_all_pos_values %>%
ggplot( aes(x=trimester, y=.data[[ROI]], group=trimester)) +
geom_boxplot(width=0.5 ,fill= c("#CF92BF", "#D1E7E6", "#A8D2C6", "#6AA390","#90A0C9")) +
scale_y_binned(n.breaks=10, nice.breaks = TRUE) +
labs(x= "Trimester", y= " QA", title =paste0(ROI) ) +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
y <- Est_QA_all_pos_values %>%
ggplot( aes(x=trimester, y=.data[[ROI]], group=trimester)) +
geom_boxplot(width=0.5 ,fill= c("#CF92BF", "#D1E7E6", "#A8D2C6", "#6AA390","#90A0C9")) +
scale_y_binned(n.breaks=10, nice.breaks = TRUE) +
labs(x= "Trimester", y= " QA", title =paste0(ROI) ) +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
print(y)
Est_QA_all_pos_values %>%
ggplot( aes(x=trimester, y=.Est_QA_all_pos_values[[ROI]], group=trimester)) +
geom_boxplot(width=0.5 ,fill= c("#CF92BF", "#D1E7E6", "#A8D2C6", "#6AA390","#90A0C9")) +
scale_y_binned(n.breaks=10, nice.breaks = TRUE) +
labs(x= "Trimester", y= " QA", title =paste0(ROI) ) +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
Est_QA_all_pos_values %>%
ggplot( aes(x=trimester, y=.[[ROI]], group=trimester)) +
geom_boxplot(width=0.5 ,fill= c("#CF92BF", "#D1E7E6", "#A8D2C6", "#6AA390","#90A0C9")) +
scale_y_binned(n.breaks=10, nice.breaks = TRUE) +
labs(x= "Trimester", y= " QA", title =paste0(ROI) ) +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
Est_QA_all_pos_values %>%
ggplot( aes(x=trimester, y=.Est_QA_all_pos_values[[ROI]], group=trimester)) +
geom_boxplot(width=0.5 ,fill= c("#CF92BF", "#D1E7E6", "#A8D2C6", "#6AA390","#90A0C9")) +
scale_y_binned(n.breaks=10, nice.breaks = TRUE) +
labs(x= "Trimester", y= " QA", title =paste0(ROI) ) +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
Est_QA_all_pos_values %>%
ggplot( aes(x=trimester, y=Est_QA_all_pos_values[[ROI]], group=trimester)) +
geom_boxplot(width=0.5 ,fill= c("#CF92BF", "#D1E7E6", "#A8D2C6", "#6AA390","#90A0C9")) +
scale_y_binned(n.breaks=10, nice.breaks = TRUE) +
labs(x= "Trimester", y= " QA", title =paste0(ROI) ) +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
print(y)
Est_MD_all_pos_values <-
read.csv(paste0(estrogen_path, 'MD/Allwks/neg_stats_2.5.csv'), header = FALSE)
View(Est_MD_all_pos_values)
estr_cols
# ALl weeks
Est_QA_all_pos <-
read.csv(paste0(estrogen_path, 'QA/Allwks/pos_stats.csv'), header = FALSE) %>%
filter(V1 %in% rows2grab) %>%
t() %>%
`colnames<-`(rows2grab) %>%
`[`(-c(1), ) %>%
as.data.frame()
# Pregnancy only
Est_QA_pregnancy_pos <- read.csv(paste0(estrogen_path,'QA/pregnancy/pos_stats_2.csv'), header=FALSE) %>%filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()
#GEtting my variables together for plots
estr_QA_cols <- c("Subjects", as.character(Est_QA_all_pos[,1]))
#reading in my csv with the stats and adding in the subject info
Est_QA_all_pos_values <-
read.csv(paste0(estrogen_path, 'QA/Allwks/pos_stats.csv'), header = FALSE) %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>%
`colnames<-`(estr_cols) %>%
mutate(estrogen = Est_subinfo$Estrogen) %>%
mutate(status = as.factor(Est_subinfo$`Endocrine Status`)) %>%
mutate(trimester = factor(Est_subinfo$trimester, levels= c('pre','first','second', 'third', 'post')))
# Reorder for my sanity check
Est_QA_all_pos_values <- Est_QA_all_pos_values[,c(1,19,20,21,2:18)]
QA_est_gathercols <- colnames(Est_QA_all_pos_values[5:21])
# for some reason things are being read as a a character and it needs to be a numerical value
Est_QA_all_pos_values[5:21] <- apply(Est_QA_all_pos_values[5:21],2, as.numeric)
## GAther it long for large compiled figure
Est_QA_all_pos_values_long <- gather(Est_QA_all_pos_values, ROI, QA ,gathercols, factor_key = TRUE) %>% select(!(Subjects))
estr_QA_cols <- c("Subjects", as.character(Est_MD_allwks_neg[,1]))
Est_MD_allwks_neg <- read.csv(paste0(estrogen_path,'MD/Allwks/neg_stats_2.5.csv'), header=FALSE) %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()
View(Est_MD_allwks_neg)
View(Est_QA_all_pos)
estr_QA_cols <- c("Subjects", as.character(Est_MD_allwks_neg[,1]))
estr_MD_cols <- c("Subjects", as.character(Est_MD_allwks_neg[,1]))
Est_MD_allwks_neg <- read.csv(paste0(estrogen_path,'MD/Allwks/neg_stats_2.5.csv'), header=FALSE) %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()
estr_MD_cols <- c("Subjects", as.character(Est_MD_allwks_neg[,1]))
# prepping for figs
Est_MD_all_neg_values <-
read.csv(paste0(estrogen_path, 'MD/Allwks/neg_stats_2.5.csv'), header = FALSE) %>%
filter(str_detect(V1, c("mean_md"))) %>%
`colnames<-`(estr_MD_cols) %>%
mutate(estrogen = Est_subinfo$Estrogen) %>%
mutate(status = as.factor(Est_subinfo$`Endocrine Status`)) %>%
mutate(trimester = factor(Est_subinfo$trimester, levels= c('pre','first','second', 'third', 'post')))
View(Est_MD_all_neg_values)
Est_MD_all_neg_values <- Est_MD_all_neg_values[,c(1,5,6,7,2:4)]
MD_est_gathercols <- colnames(Est_MD_all_neg_values[5:7])
View(Est_MD_allwks_neg)
class(Est_MD_all_neg_values[5])
class(Est_MD_all_neg_values[,5])
Est_MD_all_neg_values <- Est_MD_all_neg_values[,c(1,5,6,7,2:4)]
MD_est_gathercols <- colnames(Est_MD_all_neg_values[5:7])
# for some reason things are being read as a a character and it needs to be a numerical value
Est_MD_all_neg_values[5:7] <- apply(Est_MD_all_neg_values[5:7],2, as.numeric)
## GAther it long for large compiled figure
Est_MD_all_neg_values_long <- gather(Est_MD_all_neg_values, ROI, QA ,MD_est_gathercols, factor_key = TRUE) %>% select(!(Subjects))
Est_MD_all_neg_values <- Est_MD_all_neg_values[,c(1,5,6,7,2:4)]
MD_est_gathercols <- colnames(Est_MD_all_neg_values[5:7])
Est_MD_all_neg_values[5:7] <- apply(Est_MD_all_neg_values[5:7],2, as.numeric)
Est_MD_all_neg_values_long <- gather(Est_MD_all_neg_values, ROI, QA ,MD_est_gathercols, factor_key = TRUE) %>% select(!(Subjects))
View(Est_MD_all_neg_values_long)
View(Est_MD_all_neg_values)
Est_MD_allwks_neg <- read.csv(paste0(estrogen_path,'MD/Allwks/neg_stats_2.5.csv'), header=FALSE) %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()
estr_MD_cols <- c("Subjects", as.character(Est_MD_allwks_neg[,1]))
# prepping for figs
Est_MD_all_neg_values <-
read.csv(paste0(estrogen_path, 'MD/Allwks/neg_stats_2.5.csv'), header = FALSE) %>%
filter(str_detect(V1, c("mean_md"))) %>%
`colnames<-`(estr_MD_cols) %>%
mutate(estrogen = Est_subinfo$Estrogen) %>%
mutate(status = as.factor(Est_subinfo$`Endocrine Status`)) %>%
mutate(trimester = factor(Est_subinfo$trimester, levels= c('pre','first','second', 'third', 'post')))
View(Est_MD_all_neg_values)
Est_MD_all_neg_values <- Est_MD_all_neg_values[,c(1,5:7,2:4)]
MD_est_gathercols <- colnames(Est_MD_all_neg_values[5:7])
Est_MD_all_neg_values[5:7] <- apply(Est_MD_all_neg_values[5:7],2, as.numeric)
Est_MD_all_neg_values_long <- gather(Est_MD_all_neg_values, ROI, QA ,MD_est_gathercols, factor_key = TRUE)
View(Est_MD_all_neg_values_long)
Est_MD_all_neg_values_long <- gather(Est_MD_all_neg_values, ROI, QA ,MD_est_gathercols, factor_key = TRUE) %>% select(!(Subjects))
Est_MD_allwks_neg <- read.csv(paste0(estrogen_path,'MD/Allwks/neg_stats_2.5.csv'), header=FALSE) %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()
estr_MD_cols <- c("Subjects", as.character(Est_MD_allwks_neg[,1]))
# prepping for figs
Est_MD_all_neg_values <-
read.csv(paste0(estrogen_path, 'MD/Allwks/neg_stats_2.5.csv'), header = FALSE) %>%
filter(str_detect(V1, c("mean_md"))) %>%
`colnames<-`(estr_MD_cols) %>%
mutate(estrogen = Est_subinfo$Estrogen) %>%
mutate(status = as.factor(Est_subinfo$`Endocrine Status`)) %>%
mutate(trimester = factor(Est_subinfo$trimester, levels= c('pre','first','second', 'third', 'post')))
# Reorder for my sanity check
Est_MD_all_neg_values <- Est_MD_all_neg_values[,c(1,5:7,2:4)]
MD_est_gathercols <- colnames(Est_MD_all_neg_values[5:7])
# for some reason things are being read as a a character and it needs to be a numerical value
Est_MD_all_neg_values[5:7] <- apply(Est_MD_all_neg_values[5:7],2, as.numeric)
## GAther it long for large compiled figure
Est_MD_all_neg_values_long <- gather(Est_MD_all_neg_values, ROI, QA ,MD_est_gathercols, factor_key = TRUE) %>% select(!(Subjects))
est_MD_figpath <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/28andB/estrogen/MD/Allwks/"
for (ROI in estr_MD_cols) {
print(ROI)
y <- Est_MD_all_neg_values %>%
ggplot( aes(x=trimester, y=Est_MD_all_neg_values[[ROI]], group=trimester)) +
geom_boxplot(width=0.5 ,fill= c("#CF92BF", "#D1E7E6", "#A8D2C6", "#6AA390","#90A0C9")) +
scale_y_binned(n.breaks=10, nice.breaks = TRUE) +
labs(x= "Trimester", y= " QA", title =paste0(ROI) ) +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
png(file = paste0(est_MD_figpath ,ROI,".png"))
print(y)
dev.off()
}
Est_MD_all_neg_values %>%
ggplot( aes(x=trimester, y=Est_MD_all_neg_values[[ROI]], group=trimester)) +
geom_boxplot(width=0.5 ,fill= c("#CF92BF", "#D1E7E6", "#A8D2C6", "#6AA390","#90A0C9")) +
scale_y_binned(n.breaks=10, nice.breaks = TRUE) +
labs(x= "Trimester", y= " QA", title =paste0(ROI) ) +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
print(ROI)
estr_MD_cols
est_MD_figpath <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/28andB/estrogen/MD/Allwks/"
for (ROI in MD_est_gathercols) {
print(ROI)
y <- Est_MD_all_neg_values %>%
ggplot( aes(x=trimester, y=Est_MD_all_neg_values[[ROI]], group=trimester)) +
geom_boxplot(width=0.5 ,fill= c("#CF92BF", "#D1E7E6", "#A8D2C6", "#6AA390","#90A0C9")) +
scale_y_binned(n.breaks=10, nice.breaks = TRUE) +
labs(x= "Trimester", y= " QA", title =paste0(ROI) ) +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
png(file = paste0(est_MD_figpath ,ROI,".png"))
print(y)
dev.off()
}
est_MD_figpath <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/28andB/estrogen/MD/Allwks/"
for (ROI in MD_est_gathercols) {
print(ROI)
y <- Est_MD_all_neg_values %>%
ggplot( aes(x=trimester, y=Est_MD_all_neg_values[[ROI]], group=trimester)) +
geom_boxplot(width=0.5 ,fill= c("#CF92BF", "#D1E7E6", "#A8D2C6", "#6AA390","#90A0C9")) +
scale_y_binned(n.breaks=10, nice.breaks = TRUE) +
labs(x= "Trimester", y= " MD", title =paste0(ROI) ) +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
png(file = paste0(est_MD_figpath ,ROI,".png"))
print(y)
dev.off()
}
Est_subinfo <- read_csv(paste0(estrogen_path,'estr_demo.csv'))
Gest_subinfo <- read_csv(paste0(Gest_path,'gestWeek_info.csv'))
Prog_subinfo <- read_csv(paste0(Prog_path,'prog_scan.csv'))
View(Gest_subinfo)
gest_QA_pos <- read.delim(paste0(Gest_path,'QA/Pre_Preg_wks/QA_gestWeek_PreandPreg_pos.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame() %>% na.omit()
gest_QA_cols <- c("Subjects", as.character(gest_QA_pos[,1]))
View(gest_QA_pos)
gest_QA_pos_values <-
read.csv(paste0(estrogen_path, 'QA/Pre_Preg_wks/QA_gestWeek_PreandPreg_pos.csv'), header = FALSE) %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>%
`colnames<-`(estr_MD_cols) %>%
mutate(estrogen = Gest_subinfo$Estrogen) %>%
mutate(status = as.factor(Gest_subinfo$`Endocrine Status`)) %>%
mutate(trimester = factor(Gest_subinfo$trimester, levels= c('pre','first','second', 'third', 'post')))
gest_QA_pos_values <-
read.csv(paste0(Gest_path, 'QA/Pre_Preg_wks/QA_gestWeek_PreandPreg_pos.csv'), header = FALSE) %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>%
`colnames<-`(estr_MD_cols) %>%
mutate(estrogen = Gest_subinfo$Estrogen) %>%
mutate(status = as.factor(Gest_subinfo$`Endocrine Status`)) %>%
mutate(trimester = factor(Gest_subinfo$trimester, levels= c('pre','first','second', 'third', 'post')))
library(ggplot2)
#(plyr)
library(tidyverse)
# library(dplyr)
# library(tidyr)
library(stringr)
library(kableExtra)
# library(data.table)
# library(network)
# library(tidygraph)
# library(ggraph)
# library(igraph)
# library(networkD3)
# library(CINNA)
# library(umap)
# library(plotly)
#library(factoextra)
#library(lsr)
# library(car)
library(ggpubr)
#library(entropy)
#library(ds4psy)
# library(pROC)
#library(devtools)
#library(BRRR)
#library(stats)
#library(afex)
library(knitr)
knitr::opts_chunk$set(warning=FALSE, message=FALSE, echo = FALSE,
fig.align = "center")
working_dir <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/"
rows2grab <- c("Tract Name", "number of tracts","mean length(mm)","diameter(mm)", "volume(mm^3)")
MD_alltrialsPE_all_neg <- read.delim(paste0(working_dir,'/maze/Path_eff/All_trials/MD/allSubs/MD_alltrialspatheff_allsubs_neg.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()%>% na.omit()
#MEN
MD_alltrialsPE_male_neg <- read.delim(paste0(working_dir,'/maze/Path_eff/All_trials/MD/male/MD_alltrialspatheff_male_neg.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()%>% na.omit()
#women
MD_alltrialsPE_female_pos <- read.delim(paste0(working_dir,'/maze/Path_eff/All_trials/MD/female/MD_alltrialspatheff_female_pos.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()%>% na.omit()
MD_alltrialsPE_female_neg <- read.delim(paste0(working_dir,'/maze/Path_eff/All_trials/MD/female/MD_alltrialspatheff_female_neg.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()%>% na.omit()
#PRE
MD_alltrialsPE_pre_neg <- read.delim(paste0(working_dir,'/maze/Path_eff/All_trials/MD/pre/MD_alltrialspatheff_pre_neg.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()%>% na.omit()
# # PERI
MD_alltrialsPE_peri_neg <- read.delim(paste0(working_dir,'/maze/Path_eff/All_trials/MD/peri/MD_alltrialspatheff_peri_neg.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()%>% na.omit()
# POST
MD_alltrialsPE_post_pos <- read.delim(paste0(working_dir,'/maze/Path_eff/All_trials/MD/post/MD_alltrialspatheff_post_pos.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()%>% na.omit()
MD_alltrialsPE_post_neg <- read.delim(paste0(working_dir,'/maze/Path_eff/All_trials/MD/post/MD_alltrialspatheff_post_neg.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()%>% na.omit()
# PEri Post
MD_alltrialsPE_peripost_neg <- read.delim(paste0(working_dir,'/maze/Path_eff/All_trials/MD/peripost/MD_alltrialspatheff_peripost_neg.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()%>% na.omit()
MD_alltrialsPE_peripost_pos <- read.delim(paste0(working_dir,'/maze/Path_eff/All_trials/MD/peripost/MD_alltrialspatheff_peripost_pos.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()%>% na.omit()
MD_alltrialsPE_pre_pos <- read.delim(paste0(working_dir,'/maze/Path_eff/All_trials/MD/pre/MD_alltrialspatheff_pre_pos.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()%>% na.omit()
MD_alltrialsPE_peri_pos <- read.delim(paste0(working_dir,'/maze/Path_eff/All_trials/MD/peri/MD_alltrialspatheff_peri_pos.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()%>% na.omit()
View(MD_alltrialsPE_peri_pos)
AD_alltrialsPE_male_neg <- read.delim(paste0(working_dir,'/maze/Path_eff/All_trials/AD/male/AD_alltrialspatheff_male_neg.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()%>% na.omit()
#women
AD_alltrialsPE_female_pos <- read.delim(paste0(working_dir,'/maze/Path_eff/All_trials/AD/female/AD_alltrialspatheff_female_pos.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()%>% na.omit()
AD_alltrialsPE_female_neg <- read.delim(paste0(working_dir,'/maze/Path_eff/All_trials/AD/female/AD_alltrialspatheff_female_neg.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()%>% na.omit()
AD_alltrialsPE_peripost_pos <- read.delim(paste0(working_dir,'/maze/Path_eff/All_trials/AD/peripost/AD_alltrialspatheff_peripost_pos.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()%>% na.omit()
