#library(stats)
#library(afex)
library(knitr)
knitr::opts_chunk$set(warning=FALSE, message=FALSE, echo = FALSE,
fig.align = "center")
# working directory to data
estrogen_path <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/28andB/estrogen/"
Prog_path <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/28andB/progesterone/"
Gest_path <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/28andB/GestationalWks/"
rows2grab <- c("Tract Name", "number of tracts","mean length(mm)","diameter(mm)", "volume(mm^3)")
# REading in subject info for each analysis
#Estrogen
Est_subinfo <- read_csv(paste0(estrogen_path,'estr_demo.csv'))
Gest_subinfo <- read_csv(paste0(Gest_path,'gestWeek_info.csv'))
Prog_subinfo <- read_csv(paste0(Prog_path,'prog_scan.csv'))
View(Prog_subinfo)
View(Gest_subinfo)
Est_MD_all_neg_values <-
read.csv(paste0(estrogen_path, 'MD/Allwks/neg_stats_2.5.csv'), header = FALSE) %>%
filter(str_detect(V1, c("mean_md"))) %>%
`colnames<-`(estr_MD_cols) %>%
mutate(estrogen = Est_subinfo$Estrogen) %>%
mutate(status = as.factor(Est_subinfo$`Endocrine Status`)) %>%
mutate(trimester = factor(Est_subinfo$trimester, levels= c('pre','first','second', 'third', 'post')))
prog_MD_all_pos <- read.csv(paste0(Prog_path,'MD/Allwks/MD_allwks_prog_pos_2.5.csv'), header=FALSE) %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()
prog_MD_all_neg <- read.csv(paste0(Prog_path,'MD/Allwks/MD_allwks_prog_neg_2.5.csv'), header=FALSE) %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()
prog_MD_cols <- c("Subjects", as.character(prog_MD_all_pos[,1]))
#reading in my csv with the stats and adding in the subject info
prog_MD_all_pos_values <-
read.csv(paste0(Prog_path,'MD/Allwks/MD_allwks_prog_pos_2.5.csv'), header = FALSE) %>%
filter(str_detect(V1, c("mean_md"))) %>%
`colnames<-`(prog_MD_cols) %>%
mutate(estrogen = Prog_subinfo$Progesterone) %>%
mutate(status = as.factor(Prog_subinfo$`Endocrine Status`)) %>%
mutate(trimester = factor(Prog_subinfo$trimester, levels= c('pre','first','second', 'third', 'post')))
View(prog_MD_all_pos_values)
length(prog_MD_all_pos_values)
View(prog_MD_all_pos_values)
# ALl weeks
prog_MD_all_pos <- read.csv(paste0(Prog_path,'MD/Allwks/MD_allwks_prog_pos_2.5.csv'), header=FALSE) %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()
prog_MD_all_neg <- read.csv(paste0(Prog_path,'MD/Allwks/MD_allwks_prog_neg_2.5.csv'), header=FALSE) %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()
prog_MD_cols <- c("Subjects", as.character(prog_MD_all_pos[,1]))
#reading in my csv with the stats and adding in the subject info
prog_MD_all_pos_values <-
read.csv(paste0(Prog_path,'MD/Allwks/MD_allwks_prog_pos_2.5.csv'), header = FALSE) %>%
filter(str_detect(V1, c("mean_md"))) %>%
`colnames<-`(prog_MD_cols) %>%
mutate(estrogen = Prog_subinfo$Progesterone) %>%
mutate(status = as.factor(Prog_subinfo$`Endocrine Status`)) %>%
mutate(trimester = factor(Prog_subinfo$trimester, levels= c('pre','first','second', 'third', 'post')))
# Reorder for my sanity check
prog_MD_all_pos_values <- prog_MD_all_pos_values[,c(1,9,10,11,2:8)]
prog_MD_cols <- colnames(prog_MD_all_pos_values[5:11])
# for some reason things are being read as a a character and it needs to be a numerical value
prog_MD_all_pos_values[5:22] <- apply(prog_MD_all_pos_values[5:11],2, as.numeric)
# ALl weeks
prog_MD_all_pos <- read.csv(paste0(Prog_path,'MD/Allwks/MD_allwks_prog_pos_2.5.csv'), header=FALSE) %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()
prog_MD_all_neg <- read.csv(paste0(Prog_path,'MD/Allwks/MD_allwks_prog_neg_2.5.csv'), header=FALSE) %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()
prog_MD_cols <- c("Subjects", as.character(prog_MD_all_pos[,1]))
#reading in my csv with the stats and adding in the subject info
prog_MD_all_pos_values <-
read.csv(paste0(Prog_path,'MD/Allwks/MD_allwks_prog_pos_2.5.csv'), header = FALSE) %>%
filter(str_detect(V1, c("mean_md"))) %>%
`colnames<-`(prog_MD_cols) %>%
mutate(estrogen = Prog_subinfo$Progesterone) %>%
mutate(status = as.factor(Prog_subinfo$`Endocrine Status`)) %>%
mutate(trimester = factor(Prog_subinfo$trimester, levels= c('pre','first','second', 'third', 'post')))
# Reorder for my sanity check
prog_MD_all_pos_values <- prog_MD_all_pos_values[,c(1,9,10,11,2:8)]
prog_MD_cols <- colnames(prog_MD_all_pos_values[5:11])
# for some reason things are being read as a a character and it needs to be a numerical value
prog_MD_all_pos_values[5:11] <- apply(prog_MD_all_pos_values[5:11],2, as.numeric)
MD_prog_gathercols <- colnames(prog_MD_all_pos_values[5:11])
MD_prog_figpath <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/28andB/progesterone/MD/Allwks"
for (ROI in MD_prog_gathercols) {
print(ROI)
y <- prog_MD_all_pos_values %>%
ggplot( aes(x=trimester, y=prog_MD_all_pos_values[[ROI]], group=trimester)) +
geom_boxplot(width=0.5 ,fill= c("#CF92BF", "#D1E7E6", "#A8D2C6", "#6AA390","#90A0C9")) +
scale_y_binned(n.breaks=10, nice.breaks = TRUE) +
labs(x= "Trimester", y= " QA", title =paste0(ROI) ) +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
png(file = paste0(MD_prog_figpath,ROI,"_pos.png"))
print(y)
dev.off()
}
Est_QA_all_pos <-
read.csv(paste0(estrogen_path, 'QA/Allwks/pos_stats.csv'), header = FALSE) %>%
filter(V1 %in% rows2grab) %>%
t() %>%
`colnames<-`(rows2grab) %>%
`[`(-c(1), ) %>%
as.data.frame()
# Pregnancy only
Est_QA_pregnancy_pos <- read.csv(paste0(estrogen_path,'QA/pregnancy/pos_stats_2.csv'), header=FALSE) %>%filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()
#GEtting my variables together for plots
estr_QA_cols <- c("Subjects", as.character(Est_QA_all_pos[,1]))
estr_QA_cols
Est_QA_all_pos <-
read.csv(paste0(estrogen_path, 'QA/Allwks/pos_stats.csv'), header = FALSE) %>%
filter(V1 %in% rows2grab) %>%
t() %>%
`colnames<-`(rows2grab) %>%
`[`(-c(1), ) %>%
as.data.frame()
# Pregnancy only
Est_QA_pregnancy_pos <- read.csv(paste0(estrogen_path,'QA/pregnancy/pos_stats_2.csv'), header=FALSE) %>%filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()
#GEtting my variables together for plots
### Positive #####
estr_QA_positive_cols <- c("Subjects", as.character(Est_QA_all_pos[,1]))
#reading in my csv with the stats and adding in the subject info
Est_QA_all_pos_values <-
read.csv(paste0(estrogen_path, 'QA/Allwks/pos_stats.csv'), header = FALSE) %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>%
`colnames<-`(estr_QA_positive_cols) %>%
mutate(estrogen = Est_subinfo$Estrogen) %>%
mutate(status = as.factor(Est_subinfo$`Endocrine Status`)) %>%
mutate(trimester = factor(Est_subinfo$trimester, levels= c('pre','first','second', 'third', 'post')))
# Reorder for my sanity check
Est_QA_all_pos_values <- Est_QA_all_pos_values[,c(1,19,20,21,2:18)]
QA_est_pos_gathercols <- colnames(Est_QA_all_pos_values[5:21])
# for some reason things are being read as a a character and it needs to be a numerical value
Est_QA_all_pos_values[5:21] <- apply(Est_QA_all_pos_values[5:21],2, as.numeric
)
Est_QA_all_pos_values
figpath <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/28andB/estrogen/QA/Allwks/"
# positive ROIS
for (ROI in QA_est_pos_gathercols) {
print(ROI)
y <- Est_QA_all_pos_values %>%
ggplot( aes(x=trimester, y=Est_QA_all_pos_values[[ROI]], group=trimester)) +
geom_boxplot(width=0.5 ,fill= c("#CF92BF", "#D1E7E6", "#A8D2C6", "#6AA390","#90A0C9")) +
scale_y_binned(n.breaks=10, nice.breaks = TRUE) +
labs(x= "Trimester", y= " QA", title =paste0(ROI) ) +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
png(file = paste0(figpath,ROI,"_pos.png"))
print(y)
dev.off()
}
# NEgative ROIS
figpath <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/28andB/estrogen/QA/Allwks/"
# positive ROIS
for (ROI in QA_est_pos_gathercols) {
print(ROI)
y <- Est_QA_all_pos_values %>%
ggplot( aes(x=trimester, y=Est_QA_all_pos_values[[ROI]], group=trimester)) +
geom_boxplot(width=0.5 ,fill= c("#CF92BF", "#D1E7E6", "#A8D2C6", "#6AA390","#90A0C9")) +
scale_y_binned(n.breaks=10, nice.breaks = TRUE) +
labs(x= "Trimester", y= " QA", title =paste0(ROI) ) +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
png(file = paste0(figpath,ROI,"_pos.png"))
print(y)
dev.off()
}
# NEgative ROIS
prog_QA_neg_cols <- c("Subjects", as.character(prog_QA_all_neg[,1]))
prog_QA_all_pos <- read.csv(paste0(Prog_path,'QA/Allwks/pos_all_2.5.csv'), header=FALSE) %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()
prog_QA_all_neg <- read.csv(paste0(Prog_path,'QA/Allwks/neg_ALL_2.5.csv'), header=FALSE) %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()
prog_QA_pos_cols <- c("Subjects", as.character(prog_QA_all_pos[,1]))
#reading in my csv with the stats and adding in the subject info
prog_QA_all_pos_values <-
read.csv(paste0(Prog_path,'QA/Allwks/pos_all_2.5.csv'), header = FALSE) %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>%
`colnames<-`(prog_QA_pos_cols) %>%
mutate(estrogen = Prog_subinfo$Progesterone) %>%
mutate(status = as.factor(Prog_subinfo$`Endocrine Status`)) %>%
mutate(trimester = factor(Prog_subinfo$trimester, levels= c('pre','first','second', 'third', 'post')))
prog_QA_all_pos_values
View(prog_QA_all_neg)
prog_QA_neg_cols <- c("Subjects", as.character(prog_QA_all_neg[,1]))
#reading in my csv with the stats and adding in the subject info
prog_QA_neg_cols_values <-
read.csv(paste0(Prog_path,'QA/Allwks/neg_all_2.5.csv'), header = FALSE) %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>%
`colnames<-`(prog_QA_neg_cols) %>%
mutate(estrogen = Prog_subinfo$Progesterone) %>%
mutate(status = as.factor(Prog_subinfo$`Endocrine Status`)) %>%
mutate(trimester = factor(Prog_subinfo$trimester, levels= c('pre','first','second', 'third', 'post')))
View(prog_QA_neg_cols_values)
prog_QA_neg_cols <- c("Subjects", as.character(prog_QA_all_neg[,1]))
#reading in my csv with the stats and adding in the subject info
prog_QA_neg_cols_values <-
read.csv(paste0(Prog_path,'QA/Allwks/neg_all_2.5.csv'), header = FALSE) %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>%
`colnames<-`(prog_QA_neg_cols) %>%
mutate(estrogen = Prog_subinfo$Progesterone) %>%
mutate(status = as.factor(Prog_subinfo$`Endocrine Status`)) %>%
mutate(trimester = factor(Prog_subinfo$trimester, levels= c('pre','first','second', 'third', 'post')))
# Reorder for my sanity check
prog_QA_neg_cols_values <- prog_QA_neg_cols_values[,c(1,15,16,17,2:14)]
QA_prog_neg_gathercols <- colnames(prog_QA_neg_cols_values[5:17])
# for some reason things are being read as a a character and it needs to be a numerical value
prog_QA_neg_cols_values[5:17] <- apply(prog_QA_neg_cols_values[5:17],2, as.numeric)
for (ROI in prog_QA_neg_cols_values) {
print(ROI)
x <- prog_QA_neg_cols_values %>%
ggplot( aes(x=trimester, y=prog_QA_neg_cols_values[[ROI]], group=trimester)) +
geom_boxplot(width=0.5 ,fill= c("#CF92BF", "#D1E7E6", "#A8D2C6", "#6AA390","#90A0C9")) +
scale_y_binned(n.breaks=10, nice.breaks = TRUE) +
labs(x= "Trimester", y= " QA", title =paste0(ROI) ) +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
png(file = paste0(prog_figpath,ROI, "neg.png"))
print(y)
dev.off()
}
prog_figpath <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/28andB/progesterone/QA/Allwks/"
for (ROI in prog_QA_neg_cols_values) {
print(ROI)
x <- prog_QA_neg_cols_values %>%
ggplot( aes(x=trimester, y=prog_QA_neg_cols_values[[ROI]], group=trimester)) +
geom_boxplot(width=0.5 ,fill= c("#CF92BF", "#D1E7E6", "#A8D2C6", "#6AA390","#90A0C9")) +
scale_y_binned(n.breaks=10, nice.breaks = TRUE) +
labs(x= "Trimester", y= " QA", title =paste0(ROI) ) +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
png(file = paste0(prog_figpath,ROI, "neg.png"))
print(x)
dev.off()
}
for (ROI in QA_prog_neg_gathercols) {
print(ROI)
x <- prog_QA_neg_cols_values %>%
ggplot( aes(x=trimester, y=prog_QA_neg_cols_values[[ROI]], group=trimester)) +
geom_boxplot(width=0.5 ,fill= c("#CF92BF", "#D1E7E6", "#A8D2C6", "#6AA390","#90A0C9")) +
scale_y_binned(n.breaks=10, nice.breaks = TRUE) +
labs(x= "Trimester", y= " QA", title =paste0(ROI) ) +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
png(file = paste0(prog_figpath,ROI, "neg.png"))
print(x)
dev.off()
}
prog_figpath <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/28andB/progesterone/QA/Allwks/"
# positive ####
for (ROI in QA_prog_pos_gathercols) {
print(ROI)
y <- prog_QA_all_pos_values %>%
ggplot( aes(x=trimester, y=prog_QA_all_pos_values[[ROI]], group=trimester)) +
geom_boxplot(width=0.5 ,fill= c("#CF92BF", "#D1E7E6", "#A8D2C6", "#6AA390","#90A0C9")) +
scale_y_binned(n.breaks=10, nice.breaks = TRUE) +
labs(x= "Trimester", y= " QA", title =paste0(ROI) ) +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
png(file = paste0(prog_figpath,ROI, "_pos.png"))
print(y)
dev.off()
}
# ALl weeks
prog_QA_all_pos <- read.csv(paste0(Prog_path,'QA/Allwks/pos_all_2.5.csv'), header=FALSE) %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()
prog_QA_all_neg <- read.csv(paste0(Prog_path,'QA/Allwks/neg_ALL_2.5.csv'), header=FALSE) %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()
#GEtting my variables together for plots
#### Positive ####
prog_QA_pos_cols <- c("Subjects", as.character(prog_QA_all_pos[,1]))
#reading in my csv with the stats and adding in the subject info
prog_QA_all_pos_values <-
read.csv(paste0(Prog_path,'QA/Allwks/pos_all_2.5.csv'), header = FALSE) %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>%
`colnames<-`(prog_QA_pos_cols) %>%
mutate(estrogen = Prog_subinfo$Progesterone) %>%
mutate(status = as.factor(Prog_subinfo$`Endocrine Status`)) %>%
mutate(trimester = factor(Prog_subinfo$trimester, levels= c('pre','first','second', 'third', 'post')))
# Reorder for my sanity check
prog_QA_all_pos_values <- prog_QA_all_pos_values[,c(1,20,21,22,2:19)]
QA_prog_pos_gathercols <- colnames(prog_QA_all_pos_values[5:22])
# for some reason things are being read as a a character and it needs to be a numerical value
prog_QA_all_pos_values[5:22] <- apply(prog_QA_all_pos_values[5:22],2, as.numeric)
## GAther it long for large compiled figure
prog_QA_all_pos_values_long <- gather(prog_QA_all_pos_values, ROI, QA ,QA_prog_gathercols, factor_key = TRUE) %>% select(!(Subjects))
# ALl weeks
prog_QA_all_pos <- read.csv(paste0(Prog_path,'QA/Allwks/pos_all_2.5.csv'), header=FALSE) %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()
prog_QA_all_neg <- read.csv(paste0(Prog_path,'QA/Allwks/neg_ALL_2.5.csv'), header=FALSE) %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()
#GEtting my variables together for plots
#### Positive ####
prog_QA_pos_cols <- c("Subjects", as.character(prog_QA_all_pos[,1]))
#reading in my csv with the stats and adding in the subject info
prog_QA_all_pos_values <-
read.csv(paste0(Prog_path,'QA/Allwks/pos_all_2.5.csv'), header = FALSE) %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>%
`colnames<-`(prog_QA_pos_cols) %>%
mutate(estrogen = Prog_subinfo$Progesterone) %>%
mutate(status = as.factor(Prog_subinfo$`Endocrine Status`)) %>%
mutate(trimester = factor(Prog_subinfo$trimester, levels= c('pre','first','second', 'third', 'post')))
# Reorder for my sanity check
prog_QA_all_pos_values <- prog_QA_all_pos_values[,c(1,20,21,22,2:19)]
QA_prog_pos_gathercols <- colnames(prog_QA_all_pos_values[5:22])
# for some reason things are being read as a a character and it needs to be a numerical value
prog_QA_all_pos_values[5:22] <- apply(prog_QA_all_pos_values[5:22],2, as.numeric)
## GAther it long for large compiled figure
prog_QA_all_pos_values_long <- gather(prog_QA_all_pos_values, ROI, QA ,prog_QA_pos_cols, factor_key = TRUE) %>% select(!(Subjects))
# ALl weeks
prog_QA_all_pos <- read.csv(paste0(Prog_path,'QA/Allwks/pos_all_2.5.csv'), header=FALSE) %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()
prog_QA_all_neg <- read.csv(paste0(Prog_path,'QA/Allwks/neg_ALL_2.5.csv'), header=FALSE) %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()
#GEtting my variables together for plots
#### Positive ####
prog_QA_pos_cols <- c("Subjects", as.character(prog_QA_all_pos[,1]))
#reading in my csv with the stats and adding in the subject info
prog_QA_all_pos_values <-
read.csv(paste0(Prog_path,'QA/Allwks/pos_all_2.5.csv'), header = FALSE) %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>%
`colnames<-`(prog_QA_pos_cols) %>%
mutate(estrogen = Prog_subinfo$Progesterone) %>%
mutate(status = as.factor(Prog_subinfo$`Endocrine Status`)) %>%
mutate(trimester = factor(Prog_subinfo$trimester, levels= c('pre','first','second', 'third', 'post')))
# Reorder for my sanity check
prog_QA_all_pos_values <- prog_QA_all_pos_values[,c(1,20,21,22,2:19)]
QA_prog_pos_gathercols <- colnames(prog_QA_all_pos_values[5:22])
# for some reason things are being read as a a character and it needs to be a numerical value
prog_QA_all_pos_values[5:22] <- apply(prog_QA_all_pos_values[5:22],2, as.numeric)
# ## GAther it long for large compiled figure
# prog_QA_all_pos_values_long <- gather(prog_QA_all_pos_values, ROI, QA ,prog_QA_pos_cols, factor_key = TRUE) %>% select(!(Subjects))
#### Negative ####
prog_QA_neg_cols <- c("Subjects", as.character(prog_QA_all_neg[,1]))
#reading in my csv with the stats and adding in the subject info
prog_QA_neg_cols_values <-
read.csv(paste0(Prog_path,'QA/Allwks/neg_all_2.5.csv'), header = FALSE) %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>%
`colnames<-`(prog_QA_neg_cols) %>%
mutate(estrogen = Prog_subinfo$Progesterone) %>%
mutate(status = as.factor(Prog_subinfo$`Endocrine Status`)) %>%
mutate(trimester = factor(Prog_subinfo$trimester, levels= c('pre','first','second', 'third', 'post')))
# Reorder for my sanity check
prog_QA_neg_cols_values <- prog_QA_neg_cols_values[,c(1,15,16,17,2:14)]
QA_prog_neg_gathercols <- colnames(prog_QA_neg_cols_values[5:17])
# for some reason things are being read as a a character and it needs to be a numerical value
prog_QA_neg_cols_values[5:17] <- apply(prog_QA_neg_cols_values[5:17],2, as.numeric)
## GAther it long for large compiled figure
prog_QA_all_neg_values_long <- gather(prog_QA_all_neg_values, ROI, QA ,QA_prog_neg_gathercols, factor_key = TRUE) %>% select(!(Subjects))
prog_QA_neg_cols_values <-
read.csv(paste0(Prog_path,'QA/Allwks/neg_all_2.5.csv'), header = FALSE) %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>%
`colnames<-`(prog_QA_neg_cols) %>%
mutate(estrogen = Prog_subinfo$Progesterone) %>%
mutate(status = as.factor(Prog_subinfo$`Endocrine Status`)) %>%
mutate(trimester = factor(Prog_subinfo$trimester, levels= c('pre','first','second', 'third', 'post')))
# ALl weeks
prog_QA_all_pos <- read.csv(paste0(Prog_path,'QA/Allwks/pos_all_2.5.csv'), header=FALSE) %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()
prog_QA_all_neg <- read.csv(paste0(Prog_path,'QA/Allwks/neg_ALL_2.5.csv'), header=FALSE) %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()
#GEtting my variables together for plots
#### Positive ####
prog_QA_pos_cols <- c("Subjects", as.character(prog_QA_all_pos[,1]))
#reading in my csv with the stats and adding in the subject info
prog_QA_all_pos_values <-
read.csv(paste0(Prog_path,'QA/Allwks/pos_all_2.5.csv'), header = FALSE) %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>%
`colnames<-`(prog_QA_pos_cols) %>%
mutate(estrogen = Prog_subinfo$Progesterone) %>%
mutate(status = as.factor(Prog_subinfo$`Endocrine Status`)) %>%
mutate(trimester = factor(Prog_subinfo$trimester, levels= c('pre','first','second', 'third', 'post')))
# Reorder for my sanity check
prog_QA_all_pos_values <- prog_QA_all_pos_values[,c(1,20,21,22,2:19)]
QA_prog_pos_gathercols <- colnames(prog_QA_all_pos_values[5:22])
# for some reason things are being read as a a character and it needs to be a numerical value
prog_QA_all_pos_values[5:22] <- apply(prog_QA_all_pos_values[5:22],2, as.numeric)
# ## GAther it long for large compiled figure
# prog_QA_all_pos_values_long <- gather(prog_QA_all_pos_values, ROI, QA ,prog_QA_pos_cols, factor_key = TRUE) %>% select(!(Subjects))
#### Negative ####
prog_QA_neg_cols <- c("Subjects", as.character(prog_QA_all_neg[,1]))
#reading in my csv with the stats and adding in the subject info
prog_QA_neg_cols_values <-
read.csv(paste0(Prog_path,'QA/Allwks/neg_all_2.5.csv'), header = FALSE) %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>%
`colnames<-`(prog_QA_neg_cols) %>%
mutate(estrogen = Prog_subinfo$Progesterone) %>%
mutate(status = as.factor(Prog_subinfo$`Endocrine Status`)) %>%
mutate(trimester = factor(Prog_subinfo$trimester, levels= c('pre','first','second', 'third', 'post')))
# Reorder for my sanity check
prog_QA_neg_cols_values <- prog_QA_neg_cols_values[,c(1,15,16,17,2:14)]
QA_prog_neg_gathercols <- colnames(prog_QA_neg_cols_values[5:17])
# for some reason things are being read as a a character and it needs to be a numerical value
prog_QA_neg_cols_values[5:17] <- apply(prog_QA_neg_cols_values[5:17],2, as.numeric)
## GAther it long for large compiled figure
prog_QA_all_neg_values_long <- gather(prog_QA_all_neg_values, ROI, QA ,QA_prog_neg_gathercols, factor_key = TRUE) %>% select(!(Subjects))
# ALl weeks
prog_QA_all_pos <- read.csv(paste0(Prog_path,'QA/Allwks/pos_all_2.5.csv'), header=FALSE) %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()
prog_QA_all_neg <- read.csv(paste0(Prog_path,'QA/Allwks/neg_ALL_2.5.csv'), header=FALSE) %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()
#GEtting my variables together for plots
#### Positive ####
prog_QA_pos_cols <- c("Subjects", as.character(prog_QA_all_pos[,1]))
#reading in my csv with the stats and adding in the subject info
prog_QA_all_pos_values <-
read.csv(paste0(Prog_path,'QA/Allwks/pos_all_2.5.csv'), header = FALSE) %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>%
`colnames<-`(prog_QA_pos_cols) %>%
mutate(estrogen = Prog_subinfo$Progesterone) %>%
mutate(status = as.factor(Prog_subinfo$`Endocrine Status`)) %>%
mutate(trimester = factor(Prog_subinfo$trimester, levels= c('pre','first','second', 'third', 'post')))
# Reorder for my sanity check
prog_QA_all_pos_values <- prog_QA_all_pos_values[,c(1,20,21,22,2:19)]
QA_prog_pos_gathercols <- colnames(prog_QA_all_pos_values[5:22])
# for some reason things are being read as a a character and it needs to be a numerical value
prog_QA_all_pos_values[5:22] <- apply(prog_QA_all_pos_values[5:22],2, as.numeric)
# ## GAther it long for large compiled figure
# prog_QA_all_pos_values_long <- gather(prog_QA_all_pos_values, ROI, QA ,prog_QA_pos_cols, factor_key = TRUE) %>% select(!(Subjects))
#### Negative ####
prog_QA_neg_cols <- c("Subjects", as.character(prog_QA_all_neg[,1]))
#reading in my csv with the stats and adding in the subject info
prog_QA_neg_cols_values <-
read.csv(paste0(Prog_path,'QA/Allwks/neg_all_2.5.csv'), header = FALSE) %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>%
`colnames<-`(prog_QA_neg_cols) %>%
mutate(estrogen = Prog_subinfo$Progesterone) %>%
mutate(status = as.factor(Prog_subinfo$`Endocrine Status`)) %>%
mutate(trimester = factor(Prog_subinfo$trimester, levels= c('pre','first','second', 'third', 'post')))
# Reorder for my sanity check
prog_QA_neg_cols_values <- prog_QA_neg_cols_values[,c(1,15,16,17,2:14)]
QA_prog_neg_gathercols <- colnames(prog_QA_neg_cols_values[5:17])
# for some reason things are being read as a a character and it needs to be a numerical value
prog_QA_neg_cols_values[5:17] <- apply(prog_QA_neg_cols_values[5:17],2, as.numeric)
## GAther it long for large compiled figure
# prog_QA_all_neg_values_long <- gather(prog_QA_all_neg_values, ROI, QA ,QA_prog_neg_gathercols, factor_key = TRUE) %>% select(!(Subjects))
# Pregnancy only
prog_QA_pregnancy_pos <- read.csv(paste0(Prog_path,'QA/pregnancy/pos_pregnancy-2.5.csv'), header=FALSE) %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()
prog_figpath <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/28andB/progesterone/QA/Allwks/"
# positive ####
for (ROI in QA_prog_pos_gathercols) {
print(ROI)
y <- prog_QA_all_pos_values %>%
ggplot( aes(x=trimester, y=prog_QA_all_pos_values[[ROI]], group=trimester)) +
geom_boxplot(width=0.5 ,fill= c("#CF92BF", "#D1E7E6", "#A8D2C6", "#6AA390","#90A0C9")) +
scale_y_binned(n.breaks=10, nice.breaks = TRUE) +
labs(x= "Trimester", y= " QA", title =paste0(ROI) ) +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
png(file = paste0(prog_figpath,ROI, "_pos.png"))
print(y)
dev.off()
}
# Negative
for (ROI in QA_prog_neg_gathercols) {
print(ROI)
x <- prog_QA_neg_cols_values %>%
ggplot( aes(x=trimester, y=prog_QA_neg_cols_values[[ROI]], group=trimester)) +
geom_boxplot(width=0.5 ,fill= c("#CF92BF", "#D1E7E6", "#A8D2C6", "#6AA390","#90A0C9")) +
scale_y_binned(n.breaks=10, nice.breaks = TRUE) +
labs(x= "Trimester", y= " QA", title =paste0(ROI) ) +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
png(file = paste0(prog_figpath,ROI, "_neg.png"))
print(x)
dev.off()
}
