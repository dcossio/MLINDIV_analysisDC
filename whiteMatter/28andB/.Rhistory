Prog_subinfo <- read_csv('/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/28andB/PublicationRerun/QA/Demographics.csv') %>% select("Progesterone","Trimester") %>% na.omit()
View(Gest_subinfo)
# working directory to data
estrogen_path <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/28andB/PublicationRerun/QA/Estrogen"
Prog_path <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/28andB/PublicationRerun/QA/Progesterone"
Gest_path <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/28andB/PublicationRerun/QA/gestweek"
rows2grab <- c("Tract Name", "number of tracts","mean length(mm)","diameter(mm)", "volume(mm^3)")
# REading in subject info for each analysis
#Estrogen
Est_subinfo <- read_csv('/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/28andB/PublicationRerun/QA/Demographics.csv') %>% select("Estrogen","Trimester") %>% na.omit()
Gest_subinfo <- read_csv('/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/28andB/PublicationRerun/QA/Demographics.csv') %>% select("GestWeek","Trimester") %>% na.omit()%>% filter(Trimester <4)
Prog_subinfo <- read_csv('/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/28andB/PublicationRerun/QA/Demographics.csv') %>% select("Progesterone","Trimester") %>% na.omit()
Est_QA_all_pos <-read.delim(paste0(estrogen_path, '/allscans/Est_qa_preg_pos.csv'), header=FALSE, sep="\t")
View(Est_QA_all_pos)
Est_QA_all_pos <-read.delim(paste0(estrogen_path, '/allscans/Est_qa_preg_pos.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame() %>% na.omit()
Est_QA_all_pos_values <-
read.delim(paste0(estrogen_path, '/allscans/Est_qa_preg_pos.csv'), header=FALSE, sep="\t") %>%
filter(str_detect(V1, c("mean_qa")))
View(Est_QA_all_pos)
View(Est_QA_all_pos_values)
Est_QA_all_pos_values <-
read.delim(paste0(estrogen_path, '/allscans/Est_qa_preg_pos.csv'), header=FALSE, sep="\t") %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm")))
library(ggplot2)
#(plyr)
library(tidyverse)
# library(dplyr)
# library(tidyr)
library(stringr)
library(kableExtra)
# library(data.table)
# library(network)
# library(tidygraph)
# library(ggraph)
# library(igraph)
# library(networkD3)
# library(CINNA)
# library(umap)
# library(plotly)
#library(factoextra)
#library(lsr)
# library(car)
library(ggpubr)
#library(entropy)
#library(ds4psy)
# library(pROC)
#library(devtools)
#library(BRRR)
#library(stats)
#library(afex)
library(knitr)
knitr::opts_chunk$set(warning=FALSE, message=FALSE, echo = FALSE,
fig.align = "center")
# working directory to data
estrogen_path <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/28andB/PublicationRerun/QA/Estrogen"
Prog_path <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/28andB/PublicationRerun/QA/Progesterone"
Gest_path <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/28andB/PublicationRerun/QA/gestweek"
rows2grab <- c("Tract Name", "number of tracts","mean length(mm)","diameter(mm)", "volume(mm^3)")
# REading in subject info for each analysis
#Estrogen
Est_subinfo <- read_csv('/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/28andB/PublicationRerun/QA/Demographics.csv') %>% select("Estrogen","Trimester") %>% na.omit()
Gest_subinfo <- read_csv('/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/28andB/PublicationRerun/QA/Demographics.csv') %>% select("GestWeek","Trimester") %>% na.omit()%>% filter(Trimester <4)
Prog_subinfo <- read_csv('/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/28andB/PublicationRerun/QA/Demographics.csv') %>% select("Progesterone","Trimester") %>% na.omit()
Est_QA_allwks_pos_values <-
read.delim(paste0(estrogen_path, '/allscans/Est_qa_preg_pos.csv'), header=FALSE, sep="\t") %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>%
`colnames<-`(estr_QA_pos_allwks_cols)
estr_QA_pos_allwks_cols <- c("Subjects", as.character(Est_QA_all_pos[,1]))
Est_QA_all_pos <-read.delim(paste0(estrogen_path, '/allscans/Est_qa_preg_pos.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame() %>% na.omit()
# All weeks
estr_QA_pos_allwks_cols <- c("Subjects", as.character(Est_QA_all_pos[,1]))
View(Est_QA_all_pos)
View(Est_subinfo)
estr_QA_pos_allwks_cols
Est_QA_allwks_pos_values <-
read.delim(paste0(estrogen_path, '/allscans/Est_qa_preg_pos.csv'), header=FALSE, sep="\t") %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm")))
View(Est_QA_allwks_pos_values)
Est_QA_allwks_pos_values <-
read.delim(paste0(estrogen_path, '/allscans/Est_qa_preg_pos.csv'), header=FALSE, sep="\t") %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>%
`colnames<-`(estr_QA_pos_allwks_cols)
Est_QA_allwks_pos_values <-
read.delim(paste0(estrogen_path, '/allscans/Est_qa_preg_pos.csv'), header=FALSE, sep="\t") %>%
filter(str_detect(V1, c("mean_qa")))
Est_QA_allwks_pos_values <-
read.delim(paste0(estrogen_path, '/allscans/Est_qa_preg_pos.csv'), header=FALSE, sep="\t") %>%
na.omit()
Est_QA_allwks_pos_values <-
read.delim(paste0(estrogen_path, '/allscans/Est_qa_preg_pos.csv'), header=FALSE, sep="\t") %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>%
`colnames<-`(estr_QA_pos_allwks_cols) %>%
mutate(estrogen = Est_subinfo$Estrogen)
View(Est_subinfo)
View(Est_QA_allwks_pos_values)
Est_QA_allwks_pos_values <-
read.delim(paste0(estrogen_path, '/allscans/Est_qa_preg_pos.csv'), header=FALSE, sep="\t") %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>%
`colnames<-`(estr_QA_pos_allwks_cols)
Est_QA_allwks_pos_values <-
read.delim(paste0(estrogen_path, '/allscans/Est_qa_preg_pos.csv'), header=FALSE, sep="\t") %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>%
`colnames<-`(estr_QA_pos_allwks_cols) %>%
mutate(estrogen = Est_subinfo$Estrogen)
Est_subinfo$Estrogen
View(Est_subinfo)
View(Est_QA_allwks_pos_values)
View(Est_QA_all_pos)
View(Est_subinfo)
Est_subinfo <- read_csv('/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/28andB/PublicationRerun/QA/Demographics.csv')
colnames(Est_subinfo)
Est_subinfo <- read_csv('/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/28andB/PublicationRerun/QA/Demographics.csv') %>% select("new scan name"," Estrogen","Trimester") %>% na.omit()
Est_subinfo <- read_csv('/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/28andB/PublicationRerun/QA/Demographics.csv') %>% select("new scan name","Estrogen","Trimester") %>% na.omit()
# working directory to data
estrogen_path <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/28andB/PublicationRerun/QA/Estrogen"
Prog_path <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/28andB/PublicationRerun/QA/Progesterone"
Gest_path <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/28andB/PublicationRerun/QA/gestweek"
rows2grab <- c("Tract Name", "number of tracts","mean length(mm)","diameter(mm)", "volume(mm^3)")
# REading in subject info for each analysis
#Estrogen
Est_subinfo <- read_csv('/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/28andB/PublicationRerun/QA/Demographics.csv') %>% select("new scan name","Estrogen","Trimester") %>% na.omit()
Gest_subinfo <- read_csv('/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/28andB/PublicationRerun/QA/Demographics.csv') %>% select("new scan name","GestWeek","Trimester") %>% na.omit()%>% filter(Trimester <4)
Prog_subinfo <- read_csv('/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/28andB/PublicationRerun/QA/Demographics.csv') %>% select("new scan name","Progesterone","Trimester") %>% na.omit()
c(Est_subinfo$`new scan name`)
Est_QA_allwks_pos_values <-
read.delim(paste0(estrogen_path, '/allscans/Est_qa_preg_pos.csv'), header=FALSE, sep="\t") %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm")))
Est_QA_allwks_pos_values <-
read.delim(paste0(estrogen_path, '/allscans/Est_qa_preg_pos.csv'), header=FALSE, sep="\t") %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>%
filter(str_detect(V1,c(Est_subinfo$`new scan name`)))
Est_QA_allwks_pos_values <-
read.delim(paste0(estrogen_path, '/allscans/Est_qa_preg_pos.csv'), header=FALSE, sep="\t") %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>%
filter(grpl(c(Est_subinfo$`new scan name`),V1))
Est_QA_allwks_pos_values <-
read.delim(paste0(estrogen_path, '/allscans/Est_qa_preg_pos.csv'), header=FALSE, sep="\t") %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>%
filter(grepl(c(Est_subinfo$`new scan name`),V1))
View(Est_subinfo)
Est_QA_allwks_pos_values <-
read.delim(paste0(estrogen_path, '/allscans/Est_qa_preg_pos.csv'), header=FALSE, sep="\t") %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>%
filter(V1 %in%  Est_subinfo$`new scan name`)
Est_QA_allwks_pos_values <-
read.delim(paste0(estrogen_path, '/allscans/Est_qa_preg_pos.csv'), header=FALSE, sep="\t") %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))
)
View(Est_QA_allwks_pos_values)
str_split_1(Est_QA_allwks_pos_values, "_)
str_split_1(Est_QA_allwks_pos_values, "_")
str_split_1(Est_QA_allwks_pos_values$V1[1], "_)
str_split_1(Est_QA_allwks_pos_values$V1[1], "_")
str_split_1(Est_QA_allwks_pos_values$V1, "_")
str_split_1(Est_QA_allwks_pos_values$V1[1], "_")
str_split_1(Est_QA_allwks_pos_values$V1[1], "_") [1]
str_split_1(Est_QA_allwks_pos_values$V1[1], "_") [1] %>% str_split(., "-")
str_split_1(Est_QA_allwks_pos_values$V1[1], "_") [1] %>% str_split(, "-")
str_split_1(Est_QA_allwks_pos_values$V1[1], "_") [1] %>% str_split( , "-")
str_split_1(Est_QA_allwks_pos_values$V1[1], "_") [1] %>% str_split("-")
str_split_1(Est_QA_allwks_pos_values$V1[1], "_") [1] %>% str_split("-")[2]
str_split_1(Est_QA_allwks_pos_values$V1[1], "_") [1] %>% str_split("-")
str_split_1(Est_QA_allwks_pos_values$V1[1], "_") [1] %>% str_split("-")[2]
str_split_1(Est_QA_allwks_pos_values$V1[1], "_") [1] %>% str_split("-")[1]
str_split_1(Est_QA_allwks_pos_values$V1[1], "_") [1] %>% str_split("-")
str_split_1(Est_QA_allwks_pos_values$V1[1], "_") [1] %>% str_split("-")[,2]
x <- str_split_1(Est_QA_allwks_pos_values$V1[1], "_") [1] %>% str_split("-")[,2]
x <- str_split_1(Est_QA_allwks_pos_values$V1[1], "_") [1] %>% str_split("-")
View(x)
x[[1]][2]
x <- str_split_1(Est_QA_allwks_pos_values$V1[1], "_") [1] %>% str_split("-")[[1]][2]
x <- str_split_1(Est_QA_allwks_pos_values$V1[1], "_") [1] %>% str_split("-") %>% select([[1]][2])
x <- str_split_1(Est_QA_allwks_pos_values$V1[1], "_") [1] %>% str_split("-") %>% as.data.frame()
x <- str_split_1(Est_QA_allwks_pos_values$V1[1], "_") [1] %>% str_split("-") %>% as.data.frame()
Est_QA_allwks_pos_values <-
read.delim(paste0(estrogen_path, '/allscans/Est_qa_preg_pos.csv'), header=FALSE, sep="\t") %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm")))
# ALl weeks
Est_QA_all_pos <-read.delim(paste0(estrogen_path, '/allscans/Est_qa_preg_pos.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame() %>% na.omit()
Est_QA_allwks_pos_values <-
read.delim(paste0(estrogen_path, '/allscans/Est_qa_preg_pos.csv'), header=FALSE, sep="\t") %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>% `colnames<-`(estr_QA_pos_allwks_cols)
Est_QA_all_pos <-read.delim(paste0(estrogen_path, '/allscans/Est_qa_preg_pos.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame()
View(Est_QA_all_pos)
Est_QA_all_pos <-read.delim(paste0(estrogen_path, '/allscans/Est_qa_preg_pos.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab)  %>% as.data.frame() %>% na.omit()
Est_QA_all_pos <-read.delim(paste0(estrogen_path, '/allscans/Est_qa_preg_pos.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab)  %>% as.data.frame()  %>% `[`(-c(1),)
Est_QA_all_pos <-read.delim(paste0(estrogen_path, '/allscans/Est_qa_preg_pos.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab)  %>% as.data.frame()  %>% `[`(-c(1),) %>% na.omit()
Est_QA_allwks_pos_values <-
read.delim(paste0(estrogen_path, '/allscans/Est_qa_preg_pos.csv'), header=FALSE, sep="\t") %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>% `colnames<-`(estr_QA_pos_allwks_cols)
Est_QA_allwks_pos_values <-
read.delim(paste0(estrogen_path, '/allscans/Est_qa_preg_pos.csv'), header=FALSE, sep="\t") %>% %>% as.data.frame()  %>% `[`(-c(1),) %>% na.omit()
Est_QA_allwks_pos_values <-
read.delim(paste0(estrogen_path, '/allscans/Est_qa_preg_pos.csv'), header=FALSE, sep="\t") %>%  as.data.frame()  %>% `[`(-c(1),) %>% na.omit()
Est_QA_allwks_pos_values <-
read.delim(paste0(estrogen_path, '/allscans/Est_qa_preg_pos.csv'), header=FALSE, sep="\t") %>%  as.data.frame()
Est_QA_allwks_pos_values <-
read.delim(paste0(estrogen_path, '/allscans/Est_qa_preg_pos.csv'), header=FALSE, sep="\t") %>%  as.data.frame()  %>% filter(is.na())
Est_QA_allwks_pos_values <-
read.delim(paste0(estrogen_path, '/allscans/Est_qa_preg_pos.csv'), header=FALSE, sep="\t") %>%  as.data.frame()  %>% filter(!is.na())
Est_QA_allwks_pos_values <-
read.delim(paste0(estrogen_path, '/allscans/Est_qa_preg_pos.csv'), header=FALSE, sep="\t") %>%  as.data.frame()
Est_QA_allwks_pos_values <-
read.delim(paste0(estrogen_path, '/allscans/Est_qa_preg_pos.csv'), header=FALSE, sep="\t") %>%  as.data.frame() %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>% `colnames<-`(estr_QA_pos_allwks_cols)
Est_QA_allwks_pos_values <-
read.delim(paste0(estrogen_path, '/allscans/Est_qa_preg_pos.csv'), header=FALSE, sep="\t") %>%  as.data.frame() %>% janitor::remove_empty( which = "cols")
Est_QA_allwks_pos_values <-
read.delim(paste0(estrogen_path, '/allscans/Est_qa_preg_pos.csv'), header=FALSE, sep="\t") %>%  as.data.frame() %>% janitor::remove_empty( which = "cols") %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>% `colnames<-`(estr_QA_pos_allwks_cols)
for (sub in 1:nrow((Est_QA_allwks_pos_values))) {
x <- str_split_1(Est_QA_allwks_pos_values$V1[sub], "_") [1] %>% str_split("-") %>% as.data.frame()
}
1:nrow((Est_QA_allwks_pos_values))
Est_QA_allwks_pos_values$V1[sub]
Est_QA_allwks_pos_values$V1[1]
for (sub in 1:nrow((Est_QA_allwks_pos_values))) {
x <- str_split_1(Est_QA_allwks_pos_values$Subjects[sub], "_") [1] %>% str_split("-") %>% as.data.frame()
}
View(x)
View(Est_subinfo)
length(Est_QA_allwks_pos_values)
Est_QA_allwks_pos_df <- data.frame(matrix(ncol = length(Est_QA_allwks_pos_values), nrow = 0))
View(Est_QA_allwks_pos_df)
Est_QA_allwks_pos_df <- data.frame(matrix(ncol = length(Est_QA_allwks_pos_values), nrow = 0)) %>% `colnames<-`(estr_QA_pos_allwks_cols)
View(Est_QA_allwks_pos_df)
for (sub in 1:nrow((Est_QA_allwks_pos_values))) {
x <- str_split_1(Est_QA_allwks_pos_values$Subjects[sub], "_") [1] %>% str_split("-") %>% as.data.frame()
if (x[[1]][2] %in% Est_subinfo$`new scan name`){
Est_QA_allwks_pos_df <- rbind(Est_QA_allwks_pos_df,Est_QA_allwks_pos_values[sub])
}
}
rbind(Est_QA_allwks_pos_df,Est_QA_allwks_pos_values[sub]
)
Est_QA_allwks_pos_values[sub]
x[[1]][2]
x[[1]][2] %in% Est_subinfo$`new scan name`
# Need to create a loop to grab the correct subjects
for (sub in 1:nrow((Est_QA_allwks_pos_values))) {
x <- str_split_1(Est_QA_allwks_pos_values$Subjects[sub], "_") [1] %>% str_split("-") %>% as.data.frame()
if (x[[1]][2] %in% Est_subinfo$`new scan name` == TRUE){
Est_QA_allwks_pos_df <- rbind(Est_QA_allwks_pos_df,Est_QA_allwks_pos_values[sub])
}
}
rbind(Est_QA_allwks_pos_df,Est_QA_allwks_pos_values[1])
rbind(Est_QA_allwks_pos_df,Est_QA_allwks_pos_values[,1])
rbind(Est_QA_allwks_pos_df,Est_QA_allwks_pos_values[sub,])
x <-
a <- rbind(Est_QA_allwks_pos_df,Est_QA_allwks_pos_values[sub,])
for (sub in 1:nrow((Est_QA_allwks_pos_values))) {
x <- str_split_1(Est_QA_allwks_pos_values$Subjects[sub], "_") [1] %>% str_split("-") %>% as.data.frame()
if (x[[1]][2] %in% Est_subinfo$`new scan name` == TRUE){
Est_QA_allwks_pos_df <- rbind(Est_QA_allwks_pos_df,Est_QA_allwks_pos_values[sub,])
}
}
View(Est_QA_allwks_pos_df)
x <- str_split_1(Est_QA_allwks_pos_values$Subjects[sub], "_") [1] %>% str_split("-") %>% as.data.frame()
if (x[[1]][2] %in% Est_subinfo$`new scan name` == TRUE){
Est_QA_allwks_pos_df <- rbind(Est_QA_allwks_pos_df,Est_QA_allwks_pos_values[sub,])
}
View(Est_QA_all_pos)
Est_sub_list <- data.frame(matrix(ncol = 1, nrow = nrow(Est_QA_allwks_pos_values))) %>% `colnames<-`("subjects")
View(Est_sub_list)
nrow(Est_QA_allwks_pos_values)
View(Est_QA_allwks_pos_values)
Est_sub_list <- data.frame(matrix(ncol = 1, nrow = nrow(Est_QA_allwks_pos_values))) %>% `colnames<-`("subjects")
# Need to create a loop to grab the correct subjects
for (sub in 1:nrow((Est_QA_allwks_pos_values))) {
clean_subnum <- str_split_1(Est_QA_allwks_pos_values$Subjects[sub], "_") [1] %>% str_split("-") %>% as.data.frame()
Est_sub_list[sub,] <- clean_subnum[[1]][2]
}
}
Est_sub_list <- data.frame(matrix(ncol = 1, nrow = nrow(Est_QA_allwks_pos_values))) %>% `colnames<-`("subjects")
# Need to create a loop to grab the correct subjects
for (sub in 1:nrow((Est_QA_allwks_pos_values))) {
clean_subnum <- str_split_1(Est_QA_allwks_pos_values$Subjects[sub], "_") [1] %>% str_split("-") %>% as.data.frame()
Est_sub_list[sub,] <- clean_subnum[[1]][2]
}
Est_QA_allwks_pos_values <- mutate(cleansubs =Est_sub_list$subjects)
Est_QA_allwks_pos_values <- mutate(cleansubs = Est_sub_list$subjects)
View(Est_QA_allwks_pos_values)
Est_QA_allwks_pos_values <- Est_QA_allwks_pos_values %>% mutate(cleansubs = Est_sub_list$subjects)
Est_QA_all_pos <-read.delim(paste0(estrogen_path, '/allscans/Est_qa_preg_pos.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab)  %>% as.data.frame()  %>% `[`(-c(1),) %>% na.omit()
Est_QA_allwks_pos_values <-
read.delim(paste0(estrogen_path, '/allscans/Est_qa_preg_pos.csv'), header=FALSE, sep="\t") %>%  as.data.frame() %>% janitor::remove_empty( which = "cols") %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>% `colnames<-`(c("Subjects", as.character(Est_QA_all_pos[,1])))
for (sub in 1:nrow((Est_QA_allwks_pos_values))) {
clean_subnum <- str_split_1(Est_QA_allwks_pos_values$Subjects[sub], "_") [1] %>% str_split("-") %>% as.data.frame()
Est_QA_allwks_pos_value$Subjects[sub] <- clean_subnum[[1]][2]
}
Est_QA_allwks_pos_values <-
read.delim(paste0(estrogen_path, '/allscans/Est_qa_preg_pos.csv'), header=FALSE, sep="\t") %>%  as.data.frame() %>% janitor::remove_empty( which = "cols") %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>% `colnames<-`(c("Subjects", as.character(Est_QA_all_pos[,1])))
for (sub in 1:nrow((Est_QA_allwks_pos_values))) {
clean_subnum <- str_split_1(Est_QA_allwks_pos_values$Subjects[sub], "_") [1] %>% str_split("-") %>% as.data.frame()
Est_QA_allwks_pos_value$Subjects[sub] <- clean_subnum[[1]][2]
}
for (sub in 1:nrow((Est_QA_allwks_pos_values))) {
clean_subnum <- str_split_1(Est_QA_allwks_pos_values$Subjects[sub], "_") [1] %>% str_split("-") %>% as.data.frame()
Est_QA_allwks_pos_values$Subjects[sub] <- clean_subnum[[1]][2]
}
Est_QA_allwks_pos_DF <-read.delim(paste0(estrogen_path, '/allscans/Est_qa_preg_pos.csv'), header=FALSE, sep="\t")
Est_QA_allwks_pos_DF <-read.delim(paste0(estrogen_path, '/allscans/Est_qa_preg_pos.csv'), header=FALSE, sep="\t") %>% as.data.frame()
View(Est_QA_allwks_pos_DF)
Est_QA_allwks_pos_DF <-read.delim(paste0(estrogen_path, '/allscans/Est_qa_preg_pos.csv'), header=FALSE, sep="\t") %>% as.data.frame() %>% janitor::remove_empty( which = "cols")
View(Est_QA_allwks_pos_DF)
Est_QA_all_pos <- Est_QA_allwks_pos_DF %>%filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab)
Est_QA_all_pos_stats <- Est_QA_allwks_pos_DF %>%filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab)  %>%  `[`(-c(1),)
Est_QA_allwks_pos_DF[,1]
Est_QA_all_pos_stats[,1]
Est_QA_allwks_pos_DF <-read.delim(paste0(estrogen_path, '/allscans/Est_qa_preg_pos.csv'), header=FALSE, sep="\t") %>% as.data.frame() %>% janitor::remove_empty( which = "cols")
# ALl weeks
Est_QA_all_pos_stats <- Est_QA_allwks_pos_DF %>%filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab)  %>%  `[`(-c(1),)
Est_QA_allwks_pos_ROIs <- Est_QA_allwks_pos_DF %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>% `colnames<-`(c("Subjects", as.character(Est_QA_all_pos_stats[,1])))
library(ggplot2)
#(plyr)
library(tidyverse)
# library(dplyr)
# library(tidyr)
library(stringr)
library(kableExtra)
# library(data.table)
# library(network)
# library(tidygraph)
# library(ggraph)
# library(igraph)
# library(networkD3)
# library(CINNA)
# library(umap)
# library(plotly)
#library(factoextra)
#library(lsr)
# library(car)
library(ggpubr)
#library(entropy)
#library(ds4psy)
# library(pROC)
#library(devtools)
#library(BRRR)
#library(stats)
#library(afex)
library(knitr)
knitr::opts_chunk$set(warning=FALSE, message=FALSE, echo = FALSE,
fig.align = "center")
# working directory to data
estrogen_path <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/28andB/PublicationRerun/QA/Estrogen"
Prog_path <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/28andB/PublicationRerun/QA/Progesterone"
Gest_path <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/28andB/PublicationRerun/QA/gestweek"
rows2grab <- c("Tract Name", "number of tracts","mean length(mm)","diameter(mm)", "volume(mm^3)")
# REading in subject info for each analysis
#Estrogen
Est_subinfo <- read_csv('/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/28andB/PublicationRerun/QA/Demographics.csv') %>% select("new scan name","Estrogen","Trimester") %>% na.omit()
Gest_subinfo <- read_csv('/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/28andB/PublicationRerun/QA/Demographics.csv') %>% select("new scan name","GestWeek","Trimester") %>% na.omit()%>% filter(Trimester <4)
Prog_subinfo <- read_csv('/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/28andB/PublicationRerun/QA/Demographics.csv') %>% select("new scan name","Progesterone","Trimester") %>% na.omit()
Est_QA_allwks_pos_DF <-read.delim(paste0(estrogen_path, '/allscans/Est_qa_preg_pos.csv'), header=FALSE, sep="\t") %>% as.data.frame() %>% janitor::remove_empty( which = "cols")
# ALl weeks
Est_QA_all_pos_stats <- Est_QA_allwks_pos_DF %>%filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab)  %>%  `[`(-c(1),)
Est_QA_allwks_pos_ROIs <- Est_QA_allwks_pos_DF %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>% `colnames<-`(c("Subjects", as.character(Est_QA_all_pos_stats[,1])))
View(Est_QA_allwks_pos_DF)
for (sub in 1:nrow((Est_QA_allwks_pos_ROIs))) {
clean_subnum <- str_split_1(Est_QA_allwks_pos_ROIs$Subjects[sub], "_") [1] %>% str_split("-") %>% as.data.frame()
Est_QA_allwks_pos_ROIs$Subjects[sub] <- clean_subnum[[1]][2]
}
View(Est_QA_allwks_pos_ROIs)
View(Est_QA_all_pos_stats)
View(Est_subinfo)
Est_QA_allwks_pos_ROIs <- Est_QA_allwks_pos_ROIs %>% filter(Subjects %in% Est_subinfo$`new scan name`)
clean_subnum <- str_split_1(Est_QA_allwks_pos_ROIs$Subjects[sub], "_") [1] %>% str_split("-") %>% str_split("00")
View(clean_subnum)
View(clean_subnum)
# Lets read in one main df and clean from there
Est_QA_allwks_pos_DF <-read.delim(paste0(estrogen_path, '/allscans/Est_qa_preg_pos.csv'), header=FALSE, sep="\t") %>% as.data.frame() %>% janitor::remove_empty( which = "cols")
# ALl weeks
Est_QA_all_pos_stats <- Est_QA_allwks_pos_DF %>%filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab)  %>%  `[`(-c(1),)
Est_QA_allwks_pos_ROIs <- Est_QA_allwks_pos_DF %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>% `colnames<-`(c("Subjects", as.character(Est_QA_all_pos_stats[,1])))
# Need to create a loop to grab the correct subjects
for (sub in 1:nrow((Est_QA_allwks_pos_ROIs))) {
clean_subnum <- str_split_1(Est_QA_allwks_pos_ROIs$Subjects[sub], "_") [1] %>% str_split("-") %>% str_split("0") %>% as.data.frame()
Est_QA_allwks_pos_ROIs$Subjects[sub] <- clean_subnum[[1]][2]
}
Est_QA_allwks_pos_ROIs <- Est_QA_allwks_pos_ROIs %>% filter(Subjects %in% Est_subinfo$`new scan name`)
# Lets do the pregnancy cleaning
# add column to
# All weeks
estr_QA_pos_allwks_cols <- )
clean_subnum <- str_split_1(Est_QA_allwks_pos_ROIs$Subjects[sub], "_") [1] %>% str_split("-") %>% str_split("0") %>% as.data.frame()
clean_subnum <- str_split_1(Est_QA_allwks_pos_ROIs$Subjects[sub], "_") %>% str_split("-") %>% str_split("0") %>% as.data.frame()
clean_subnum <- str_split_1(Est_QA_allwks_pos_ROIs$Subjects[sub], "_")[1] %>% str_split("-")
clean_subnum <- str_split(Est_QA_allwks_pos_ROIs$Subjects[sub], "_")[1] %>% str_split("-")
clean_subnum <- str_split(Est_QA_allwks_pos_ROIs$Subjects[sub], "_") %>% str_split("-") %>% str_split("0") %>% as.data.frame()
View(clean_subnum)
format(13.7, nsmall = 3)
format(zz, justify = "left")
format(c(6.0, 13.1), digits = 2)
subinfo_DF <- read_csv('/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/28andB/PublicationRerun/QA/Demographics.csv')
View(subinfo_DF)
clean_subnum <- str_split(Est_QA_allwks_pos_ROIs$Subjects[sub], "_") %>% str_split("-") %>% str_remove("^0+") %>%  as.data.frame()
View(clean_subnum)
clean_subnum <- str_split(Est_QA_allwks_pos_ROIs$Subjects[sub], "_") %>% str_split("-") %>% str_remove("^0+")
clean_subnum <- str_split(Est_QA_allwks_pos_ROIs$Subjects[sub], "_") %>% str_split("-")
View(clean_subnum)
Est_QA_allwks_pos_ROIs <- Est_QA_allwks_pos_DF %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>% `colnames<-`(c("Subjects", as.character(Est_QA_all_pos_stats[,1])))
View(Est_QA_allwks_pos_ROIs)
clean_subnum <- str_split(Est_QA_allwks_pos_ROIs$Subjects[sub], "_") %>% str_split("-") %>% str_remove("^0+")
clean_subnum <- str_split(Est_QA_allwks_pos_ROIs$Subjects[sub], "_") %>% str_split("-")
clean_subnum <- str_split(Est_QA_allwks_pos_ROIs$Subjects[sub], "_") %>% str_split("-")  %>%  as.data.frame()
clean_subnum <- str_split(Est_QA_allwks_pos_ROIs$Subjects[sub], "_")[1] %>% str_split("-")
clean_subnum <- str_split(Est_QA_allwks_pos_ROIs$Subjects[sub], "_")[1] %>% str_split("-") %>%  as.data.frame()
Est_QA_allwks_pos_ROIs$Subjects[sub], "_")[1]
Est_QA_allwks_pos_ROIs$Subjects[sub], "_")
Est_QA_allwks_pos_ROIs$Subjects[sub]
str_split(Est_QA_allwks_pos_ROIs$Subjects[sub], "_")
str_split(Est_QA_allwks_pos_ROIs$Subjects[sub], "_")[1]
clean_subnum <- str_split(Est_QA_allwks_pos_ROIs$Subjects[sub], "_")%>% str_split("-")
clean_subnum <- str_split(Est_QA_allwks_pos_ROIs$Subjects[sub], "_")%>% str_split("-")
clean_subnum[[1]][2]
str_split(Est_QA_allwks_pos_ROIs$Subjects[sub], "_")%>% str_split("-") %>%  as.data.frame()
clean_subnum <- str_split(Est_QA_allwks_pos_ROIs$Subjects[sub], "_") %>% str_split("-")
View(clean_subnum)
str_split(Est_QA_allwks_pos_ROIs$Subjects[sub], "_")[1]%>% str_split("-")
clean_subnum <- str_split(Est_QA_allwks_pos_ROIs$Subjects[sub], "_")[1]%>% str_split("-")
View(clean_subnum)
str_split(Est_QA_allwks_pos_ROIs$Subjects[sub], "_")[[1]] %>% str_split("-")
clean_subnum <- str_split(Est_QA_allwks_pos_ROIs$Subjects[sub], "_")[[1]] %>% str_split("-")
View(clean_subnum)
clean_subnum <- str_split(Est_QA_allwks_pos_ROIs$Subjects[sub], "_") %>% str_split("-") %>% as.data.frame()
clean_subnum <- str_split(Est_QA_allwks_pos_ROIs$Subjects[sub], "_") %>% str_split("-")
clean_subnum[[1]]
Est_QA_allwks_pos_DF <-read.delim(paste0(estrogen_path, '/allscans/Est_qa_preg_pos.csv'), header=FALSE, sep="\t") %>% as.data.frame() %>% janitor::remove_empty( which = "cols")
# ALl weeks
Est_QA_all_pos_stats <- Est_QA_allwks_pos_DF %>%filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab)  %>%  `[`(-c(1),)
Est_QA_allwks_pos_ROIs <- Est_QA_allwks_pos_DF %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>% `colnames<-`(c("Subjects", as.character(Est_QA_all_pos_stats[,1])))
clean_subnum <- str_split(Est_QA_allwks_pos_ROIs$Subjects[sub], "_")
View(clean_subnum)
clean_subnum[[1]]
clean_subnum <- str_split(Est_QA_allwks_pos_ROIs$Subjects[sub], "_")[[1]]
clean_subnum <- str_split(Est_QA_allwks_pos_ROIs$Subjects[sub], "_")[[1]] %>% str_split("-")
View(clean_subnum)
clean_subnum <- str_split(Est_QA_allwks_pos_ROIs$Subjects[sub], "_") %>% str_split([[1]], "-")
clean_subnum <- str_split(Est_QA_allwks_pos_ROIs$Subjects[sub], "_") %>% str_split(.[[1]])
View(clean_subnum)
clean_subnum <- str_split(Est_QA_allwks_pos_ROIs$Subjects[sub], "_") %>% str_split(.[[1]], "-")
View(clean_subnum)
clean_subnum <- str_split(Est_QA_allwks_pos_ROIs$Subjects[sub], "_")[[1]] %>% str_split("-")
clean_subnum <- str_split(Est_QA_allwks_pos_ROIs$Subjects[sub], "_")[[1]]
str_split(Est_QA_allwks_pos_ROIs$Subjects[sub], "_")[[1]] %>% str_split("-")
str_split(Est_QA_allwks_pos_ROIs$Subjects[sub], "_")[[1]] %>% str_split(., "-")
str_split(Est_QA_allwks_pos_ROIs$Subjects[sub], "_")[[1]] %>% as.data.frame()
clean_subnum[[1]][2]
str_split(Est_QA_allwks_pos_ROIs$Subjects[sub], "_")[[1]] %>% str_split("-")
str_split(Est_QA_allwks_pos_ROIs$Subjects[sub], "_")[1] %>% str_split("-")
str_split(Est_QA_allwks_pos_ROIs$Subjects[sub], "_") %>% str_split("-")
str_split(Est_QA_allwks_pos_ROIs$Subjects[sub], "_")[[1]]  %>% str_split(., "-")
str_split(clean_subnum, "-")
clean_subnum
clean_subnum <- str_split(Est_QA_allwks_pos_ROIs$Subjects[sub], "_")[[1]]
clean_subnum
clean_subnum <- str_split(Est_QA_allwks_pos_ROIs$Subjects[sub], "_")[[1]][1]
clean_subnum
clean_subnum <- str_split(Est_QA_allwks_pos_ROIs$Subjects[sub], "_")[[1]][1]  %>% str_split("-")
View(clean_subnum)
clean_subnum <- str_split(Est_QA_allwks_pos_ROIs$Subjects[sub], "_")[[1]][1]  %>% str_split("-") %>% as.data.frame()
clean_subnum <- str_split(Est_QA_allwks_pos_ROIs$Subjects[sub], "_")[[1]][1]  %>% str_split("-") %>% as.data.frame() %>% `[`,2]
clean_subnum <- str_split(Est_QA_allwks_pos_ROIs$Subjects[sub], "_")[[1]][1]  %>% str_split("-") %>% as.data.frame() %>% [2,]
clean_subnum <- str_split(Est_QA_allwks_pos_ROIs$Subjects[sub], "_")[[1]][1]  %>% str_split("-") %>% as.data.frame() %>% `[`(2,)
length(clean_subnum)
length(print(clean_subnum))
nchar(clean_subnum)
sub("^0+", "", clean_subnum)
Est_QA_allwks_pos_DF <-read.delim(paste0(estrogen_path, '/allscans/Est_qa_preg_pos.csv'), header=FALSE, sep="\t") %>% as.data.frame() %>% janitor::remove_empty( which = "cols")
# ALl weeks
Est_QA_all_pos_stats <- Est_QA_allwks_pos_DF %>%filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab)  %>%  `[`(-c(1),)
Est_QA_allwks_pos_ROIs <- Est_QA_allwks_pos_DF %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>% `colnames<-`(c("Subjects", as.character(Est_QA_all_pos_stats[,1])))
# Need to create a loop to grab the correct subjects
for (sub in 1:nrow((Est_QA_allwks_pos_ROIs))) {
clean_subnum <- str_split(Est_QA_allwks_pos_ROIs$Subjects[sub], "_")[[1]][1]  %>% str_split("-") %>% as.data.frame() %>% `[`(2,)
Est_QA_allwks_pos_ROIs$Subjects[sub] <-  sub("^0+", "", clean_subnum)
}
View(Est_QA_allwks_pos_ROIs)
Est_QA_allwks_pos_ROIs <- Est_QA_allwks_pos_ROIs %>% filter(Subjects %in% Est_subinfo$`new scan name`)
