face = "bold.italic"
),
strip.text.y = element_text(
size = 12,
color = "black",
face = "bold.italic"
),
axis.title.x = element_text(size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
axis.title.y = element_text(size = 16),
plot.title = element_text(hjust = 0.5,size=16),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
) +
xlim(min(scatterdf[ROI]), max(scatterdf[ROI]))
# <!--      annotate("text", label = "FDR= 0.000576", x = 1.8 , y = 3, color="#E45A5A", size=7) +
# <!--      annotate("text", label = "FDR= 0.022854", x = 1.8 , y = 2.8, color="#80792B", size=7)
#pdf(file = paste0(figpath,ROI,"MD_Average_PE.pdf"),width=10, height=8)
print(y)
#dev.off()
}
# prepping the data
fem_csv <- read.delim(
paste0(Avg_work_dir,'/MD/female/avg_MD_pe_fem_neg.csv'), header = FALSE, sep = "\t") %>% PrepforPlotting(Metric = "MD",Sex ="female",LoopVar = "loop_pe_avg_m")
male_csv <- read.delim(paste0(Avg_work_dir,'MD/male/avg_MD_pe_male_pos.csv'), header = FALSE, sep = "\t")  %>% PrepforPlotting(Metric = "MD",Sex = "male",LoopVar = "loop_pe_avg_m")
scatterdf <- SexDiffDF(male_csv,fem_csv)
# Let's get out figures
figpath <-paste0(Avg_work_dir,"MD/scatterplots/")
ROIcols <- colnames(scatterdf[,5:length(scatterdf)])
# positive ROIS
for (ROI in ROIcols) {
print(ROI)
roiname <- str_split_1(ROI, '_') %>% paste(collapse=' ')
y <-
scatterdf %>% ggplot(aes(x = Corpus_Callosum_Tapetum, y = loop_pe_avg_m)) +
geom_point(aes(color = sex), size = 4) +
stat_smooth(aes(color = sex, group = sex), method = "lm") +
scale_color_manual(values = c(npc_saguaro[2], npc_saguaro[4]),
name = "sex") +
labs(x = "QA",
y = "Position Error ",
title = roiname) +
stat_cor(method = "spearman", label.y.npc='top',
aes(
color = sex,
label = paste(..r.label.., ..p.label.., sep = "~`,`~")
)) +
theme(
strip.text.x = element_text(
size = 12,
color = "black",
face = "bold.italic"
),
strip.text.y = element_text(
size = 12,
color = "black",
face = "bold.italic"
),
axis.title.x = element_text(size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
axis.title.y = element_text(size = 16),
plot.title = element_text(hjust = 0.5,size=16),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
) +
xlim(min(scatterdf[ROI]), max(scatterdf[ROI]))
# <!--      annotate("text", label = "FDR= 0.000576", x = 1.8 , y = 3, color="#E45A5A", size=7) +
# <!--      annotate("text", label = "FDR= 0.022854", x = 1.8 , y = 2.8, color="#80792B", size=7)
pdf(file = paste0(figpath,ROI,"_MD_Average_PE.pdf"),width=10, height=8)
print(y)
#dev.off()
}
# prepping the data
fem_csv <- read.delim(
paste0(Avg_work_dir,'/MD/female/avg_MD_pe_fem_neg.csv'), header = FALSE, sep = "\t") %>% PrepforPlotting(Metric = "MD",Sex ="female",LoopVar = "loop_pe_avg_m")
male_csv <- read.delim(paste0(Avg_work_dir,'MD/male/avg_MD_pe_male_pos.csv'), header = FALSE, sep = "\t")  %>% PrepforPlotting(Metric = "MD",Sex = "male",LoopVar = "loop_pe_avg_m")
scatterdf <- SexDiffDF(male_csv,fem_csv)
# Let's get out figures
figpath <-paste0(Avg_work_dir,"MD/scatterplots/")
ROIcols <- colnames(scatterdf[,5:length(scatterdf)])
# positive ROIS
for (ROI in ROIcols) {
print(ROI)
roiname <- str_split_1(ROI, '_') %>% paste(collapse=' ')
y <-
scatterdf %>% ggplot(aes(x = Corpus_Callosum_Tapetum, y = loop_pe_avg_m)) +
geom_point(aes(color = sex), size = 4) +
stat_smooth(aes(color = sex, group = sex), method = "lm") +
scale_color_manual(values = c(npc_saguaro[2], npc_saguaro[4]),
name = "sex") +
labs(x = "QA",
y = "Position Error ",
title = roiname) +
stat_cor(method = "spearman", label.y.npc='top',
aes(
color = sex,
label = paste(..r.label.., ..p.label.., sep = "~`,`~")
)) +
theme(
strip.text.x = element_text(
size = 12,
color = "black",
face = "bold.italic"
),
strip.text.y = element_text(
size = 12,
color = "black",
face = "bold.italic"
),
axis.title.x = element_text(size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
axis.title.y = element_text(size = 16),
plot.title = element_text(hjust = 0.5,size=16),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
) +
xlim(min(scatterdf[ROI]), max(scatterdf[ROI]))
# <!--      annotate("text", label = "FDR= 0.000576", x = 1.8 , y = 3, color="#E45A5A", size=7) +
# <!--      annotate("text", label = "FDR= 0.022854", x = 1.8 , y = 2.8, color="#80792B", size=7)
pdf(file = paste0(figpath,ROI,"_MD_Average_PE.pdf"),width=10, height=8)
print(y)
#dev.off()
}
# prepping the data
fem_csv <- read.delim(
paste0(Avg_work_dir,'/MD/female/avg_MD_pe_fem_neg.csv'), header = FALSE, sep = "\t") %>% PrepforPlotting(Metric = "MD",Sex ="female",LoopVar = "loop_pe_avg_m")
male_csv <- read.delim(paste0(Avg_work_dir,'MD/male/avg_MD_pe_male_pos.csv'), header = FALSE, sep = "\t")  %>% PrepforPlotting(Metric = "MD",Sex = "male",LoopVar = "loop_pe_avg_m")
scatterdf <- SexDiffDF(male_csv,fem_csv)
# Let's get out figures
figpath <-paste0(Avg_work_dir,"MD/scatterplots/")
ROIcols <- colnames(scatterdf[,5:length(scatterdf)])
# positive ROIS
for (ROI in ROIcols) {
print(ROI)
roiname <- str_split_1(ROI, '_') %>% paste(collapse=' ')
y <-
scatterdf %>% ggplot(aes(x = Corpus_Callosum_Tapetum, y = loop_pe_avg_m)) +
geom_point(aes(color = sex), size = 4) +
stat_smooth(aes(color = sex, group = sex), method = "lm") +
scale_color_manual(values = c(npc_saguaro[2], npc_saguaro[4]),
name = "sex") +
labs(x = "QA",
y = "Position Error ",
title = roiname) +
stat_cor(method = "spearman", label.y.npc='top',
aes(
color = sex,
label = paste(..r.label.., ..p.label.., sep = "~`,`~")
)) +
theme(
strip.text.x = element_text(
size = 12,
color = "black",
face = "bold.italic"
),
strip.text.y = element_text(
size = 12,
color = "black",
face = "bold.italic"
),
axis.title.x = element_text(size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
axis.title.y = element_text(size = 16),
plot.title = element_text(hjust = 0.5,size=16),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
) +
xlim(min(scatterdf[ROI]), max(scatterdf[ROI]))
# <!--      annotate("text", label = "FDR= 0.000576", x = 1.8 , y = 3, color="#E45A5A", size=7) +
# <!--      annotate("text", label = "FDR= 0.022854", x = 1.8 , y = 2.8, color="#80792B", size=7)
pdf(file = paste0(figpath,ROI,"_MD_Average_PE.pdf"),width=10, height=8)
print(y)
dev.off()
}
min(scatterdf[ROI]
)
library(ggplot2)
#(plyr)
library(tidyverse)
# library(dplyr)
# library(tidyr)
library(stringr)
library(kableExtra)
# library(data.table)
# library(network)
# library(tidygraph)
# library(ggraph)
# library(igraph)
# library(networkD3)
# library(CINNA)
# library(umap)
# library(plotly)
#library(factoextra)
#library(lsr)
library(car)
library(ggpubr)
#library(entropy)
#library(ds4psy)
# library(pROC)
#library(devtools)
#library(BRRR)
library(stats)
#library(afex)
library(knitr)
library(janitor)
# library(car)
# library(ggiraph)
library(ggiraphExtra)
# library(moonBook)
library(nationalparkcolors)
npc_everglades <- park_palette("Everglades")
npc_channel <- park_palette("ChannelIslands")
npc_saguaro <- park_palette("Saguaro")
knitr::opts_chunk$set(warning=FALSE, message=FALSE, echo = FALSE,
fig.align = "center")
Rad3_work_dir <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/rad3/PE/"
Avg_work_dir <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/average/PE/"
rows2grab <- c("Tract Name", "number of tracts","mean length(mm)","diameter(mm)", "volume(mm^3)")
loop_subInfo <- read.csv("/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/White matter tract/MidlifeWM_DSI2023/DSI/loop/loop_subinfo.csv") %>% select("subject_id", "sex", "age_scan_years", "repo_status","loop_pe_rad1_m","loop_pe_rad2_m","loop_pe_rad3_m","loop_pe_avg_m")
for (row in 1:nrow(loop_subInfo)) {
if (loop_subInfo[row,2] == 0) {
loop_subInfo[row,2] <- "female"
} else {
loop_subInfo[row,2] <- "male"
}
}
View(loop_subInfo)
library(ggplot2)
#(plyr)
library(tidyverse)
# library(dplyr)
# library(tidyr)
library(stringr)
library(kableExtra)
# library(data.table)
# library(network)
# library(tidygraph)
# library(ggraph)
# library(igraph)
# library(networkD3)
# library(CINNA)
# library(umap)
# library(plotly)
#library(factoextra)
#library(lsr)
# library(car)
library(ggpubr)
#library(entropy)
#library(ds4psy)
# library(pROC)
#library(devtools)
#library(BRRR)
#library(stats)
#library(afex)
library(knitr)
knitr::opts_chunk$set(warning=FALSE, message=FALSE, echo = FALSE,
fig.align = "center")
# working directory to data
estrogen_path <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/28andB/PublicationRerun/QA/Estrogen"
Prog_path <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/28andB/PublicationRerun/QA/Progesterone"
Gest_path <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/28andB/PublicationRerun/QA/gestweek"
rows2grab <- c("Tract Name", "number of tracts","mean length(mm)","diameter(mm)", "volume(mm^3)")
grp_colors <- c("#CF92BF", "#D1E7E6", "#A8D2C6", "#6AA390","#90A0C9")
# REading in subject info for each analysis
# Read in main df
subinfo_DF <- read_csv('/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/28andB/PublicationRerun/QA/Demographics.csv')
# changing all trimester to labels
ChangeTrimesterLabels <- function(dataframe){
for (row in 1:nrow(dataframe)) {
if (dataframe$Trimester[row] == 0) {
dataframe$Trimester[row] <- c("Pre")
}
if (dataframe$Trimester[row] == 1) {
dataframe$Trimester[row] <- c("1st")
}
if (dataframe$Trimester[row] == 2) {
dataframe$Trimester[row] <- c("2nd")
}
if (dataframe$Trimester[row] == 3) {
dataframe$Trimester[row] <- c("3rd")
}
if (dataframe$Trimester[row] == 4) {
dataframe$Trimester[row] <- c("Post")
}
}
return(dataframe)
}
subinfo_DF <- ChangeTrimesterLabels(subinfo_DF)
# Tractography working dir
tract_workdir <-"/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/28andB/tractography"
AllScanInfo <- read.csv(paste0(tract_workdir,"/allscansInfo.csv"), header=TRUE) %>% `colnames<-`(c("scans","gest_week","Trimester"))
AllScanInfo$scans <- lapply(AllScanInfo$scans, sprintf, fmt = "%03d")
AllScanInfo <- ChangeTrimesterLabels(AllScanInfo)
ROIS <- read.table(paste0(tract_workdir,"/HCp842ROIS.txt")) %>% filter(V1 !="CNX_R")
subfiles <- list.dirs(path = tract_workdir, full.names = FALSE,recursive = FALSE)
QA_master_DF <- as.data.frame(matrix(ncol = nrow(ROIS)+1, nrow = length(subfiles)))
MD_master_DF<- as.data.frame(matrix(ncol = nrow(ROIS)+1, nrow = length(subfiles)))
for(sub in 1:length(subfiles)){
print(paste("running subject",sub))
md_df <- as.data.frame(matrix(ncol = nrow(ROIS)+1, nrow = 1))
md_df[,1] <- subfiles[sub]
qa_df <- as.data.frame(matrix(ncol = nrow(ROIS)+1, nrow = 1))
qa_df[,1] <- subfiles[sub]
for ( roi in 1:nrow(ROIS)){
print(paste("running ",ROIS[roi,1]))
# Check if CSV exists
CSV_path <- paste0(tract_workdir,"/",subfiles[sub],"/",ROIS[roi,1],".stat.csv")
if (file.exists(CSV_path) == TRUE){
print("File Exists lets read it in")
ROI_csv <- read.delim(paste0(tract_workdir,"/",subfiles[sub],"/",ROIS[roi,1],".stat.csv"), header=FALSE, sep="\t") %>% filter(V1 %in% c("qa","md"))
qa_df[,roi+1] <- ROI_csv %>% filter(V1 =="qa") %>% pull(V2)
md_df[,roi+1] <- ROI_csv %>% filter(V1 =="md") %>% pull(V2)
}
else{
print("File does not exist. Add NA instead")
qa_df[,roi+1] <- NA
md_df[,roi+1] <- NA
}
}
QA_master_DF[sub,] <- qa_df[1,]
MD_master_DF[sub,] <- md_df[1,]
}
View(MD_master_DF)
View(QA_master_DF)
subfiles[sub]
View(ROIS)
# Tractography working dir
tract_workdir <-"/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/28andB/tractography"
AllScanInfo <- read.csv(paste0(tract_workdir,"/allscansInfo.csv"), header=TRUE) %>% `colnames<-`(c("scans","gest_week","Trimester"))
AllScanInfo$scans <- lapply(AllScanInfo$scans, sprintf, fmt = "%03d")
AllScanInfo <- ChangeTrimesterLabels(AllScanInfo)
ROIS <- read.table(paste0(tract_workdir,"/HCp842ROIS.txt")) %>% filter(V1 !="CNX_R")
subfiles <- list.dirs(path = tract_workdir, full.names = FALSE,recursive = FALSE)
QA_master_DF <- as.data.frame(matrix(ncol = nrow(ROIS)+1, nrow = length(subfiles)))
MD_master_DF<- as.data.frame(matrix(ncol = nrow(ROIS)+1, nrow = length(subfiles)))
for(sub in 1:length(subfiles)){
print(paste("running subject",subfiles[sub]))
md_df <- as.data.frame(matrix(ncol = nrow(ROIS)+1, nrow = 1))
md_df[,1] <- subfiles[sub]
qa_df <- as.data.frame(matrix(ncol = nrow(ROIS)+1, nrow = 1))
qa_df[,1] <- subfiles[sub]
for ( roi in 1:nrow(ROIS)){
print(paste("running ",ROIS[roi,1]))
# Check if CSV exists
CSV_path <- paste0(tract_workdir,"/",subfiles[sub],"/",ROIS[roi,1],".stat.csv")
if (file.exists(CSV_path) == TRUE){
print("File Exists lets read it in")
ROI_csv <- read.delim(paste0(tract_workdir,"/",subfiles[sub],"/",ROIS[roi,1],".stat.csv"), header=FALSE, sep="\t") %>% filter(V1 %in% c("qa","md"))
qa_df[,roi+1] <- ROI_csv %>% filter(V1 =="qa") %>% pull(V2)
md_df[,roi+1] <- ROI_csv %>% filter(V1 =="md") %>% pull(V2)
}
else{
print("File does not exist. Add NA instead")
qa_df[,roi+1] <- NA
md_df[,roi+1] <- NA
}
}
QA_master_DF[sub,] <- qa_df[1,]
MD_master_DF[sub,] <- md_df[1,]
}
colnames(QA_master_DF) <- c("subjects",ROIS$V1)
colnames(MD_master_DF) <- c("subjects",ROIS$V1)
View(MD_master_DF)
subfiles
list.dirs(path = tract_workdir, full.names = FALSE,recursive = FALSE) %>% filter("boxplots")
View(MD_master_DF)
QA_master_DF <- QA_master_DF %>% filter(.$subjects != "boxplots")
View(QA_master_DF)
QA_master_DF <- QA_master_DF %>% filter(.$subjects != "boxplots")
MD_master_DF <- MD_master_DF %>% filter(.$subjects != "boxplots")
write.csv(QA_master_DF, paste0(tract_workdir,"/QA_master_DF.csv"), row.names=FALSE)
write.csv(MD_master_DF, paste0(tract_workdir,"/MD_master_DF"), row.names=FALSE)
write.csv(QA_master_DF, paste0(tract_workdir,"/QA_master_DF.csv"), row.names=FALSE)
write.csv(MD_master_DF, paste0(tract_workdir,"/MD_master_DF.csv"), row.names=FALSE)
QA_master_DF <- read.csv(paste0(tract_workdir,"/MD_master_DF.csv"))
View(QA_master_DF)
QA_master_DF <- read.csv(paste0(tract_workdir,"/QA_master_DF.csv"))
View(QA_master_DF)
QA_master_DF <- read.csv(paste0(tract_workdir,"/QA_master_DF.csv")) %>% filter(subjects %in% c("sub-26", "sub-027"))
View(QA_master_DF)
QA_master_DF <- read.csv(paste0(tract_workdir,"/QA_master_DF.csv")) %>% filter(!(subjects %in% c("sub-26", "sub-027")))
View(QA_master_DF)
QA_master_DF <- read.csv(paste0(tract_workdir,"/QA_master_DF.csv")) %>% filter(!(subjects %in% c("sub-026", "sub-027")))
View(QA_master_DF)
QA_master_DF <- read.csv(paste0(tract_workdir,"/QA_master_DF.csv")) %>% filter(!(subjects %in% c("sub-026", "sub-027")))
MD_master_DF<- read.csv(paste0(tract_workdir,"/QA_master_DF.csv"))%>% filter(!(subjects %in% c("sub-026", "sub-027")))
QA_scans <- QA_master_DF %>%  mutate(trimester = factor(AllScanInfo$Trimester, levels= c('Pre','1st','2nd', '3rd', 'Post')))
library(ggplot2)
#(plyr)
library(tidyverse)
# library(dplyr)
# library(tidyr)
library(stringr)
library(kableExtra)
# library(data.table)
# library(network)
# library(tidygraph)
# library(ggraph)
# library(igraph)
# library(networkD3)
# library(CINNA)
# library(umap)
# library(plotly)
#library(factoextra)
#library(lsr)
# library(car)
library(ggpubr)
#library(entropy)
#library(ds4psy)
# library(pROC)
#library(devtools)
#library(BRRR)
#library(stats)
#library(afex)
library(knitr)
knitr::opts_chunk$set(warning=FALSE, message=FALSE, echo = FALSE,
fig.align = "center")
# working directory to data
estrogen_path <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/28andB/PublicationRerun/QA/Estrogen"
Prog_path <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/28andB/PublicationRerun/QA/Progesterone"
Gest_path <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/28andB/PublicationRerun/QA/gestweek"
rows2grab <- c("Tract Name", "number of tracts","mean length(mm)","diameter(mm)", "volume(mm^3)")
grp_colors <- c("#CF92BF", "#D1E7E6", "#A8D2C6", "#6AA390","#90A0C9")
# REading in subject info for each analysis
# Read in main df
subinfo_DF <- read_csv('/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/28andB/PublicationRerun/QA/Demographics.csv')
# changing all trimester to labels
ChangeTrimesterLabels <- function(dataframe){
for (row in 1:nrow(dataframe)) {
if (dataframe$Trimester[row] == 0) {
dataframe$Trimester[row] <- c("Pre")
}
if (dataframe$Trimester[row] == 1) {
dataframe$Trimester[row] <- c("1st")
}
if (dataframe$Trimester[row] == 2) {
dataframe$Trimester[row] <- c("2nd")
}
if (dataframe$Trimester[row] == 3) {
dataframe$Trimester[row] <- c("3rd")
}
if (dataframe$Trimester[row] == 4) {
dataframe$Trimester[row] <- c("Post")
}
}
return(dataframe)
}
subinfo_DF <- ChangeTrimesterLabels(subinfo_DF)
View(AllScanInfo)
View(QA_master_DF)
tract_workdir <-"/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/28andB/tractography"
AllScanInfo <- read.csv(paste0(tract_workdir,"/allscansInfo.csv"), header=TRUE) %>% `colnames<-`(c("scans","gest_week","Trimester"))  filter(!(subjects %in% c("sub-026", "sub-027")))
View(AllScanInfo)
AllScanInfo <- read.csv(paste0(tract_workdir,"/allscansInfo.csv"), header=TRUE) %>% `colnames<-`(c("scans","gest_week","Trimester"))  filter(!(scans %in% c("sub-026", "sub-027")))
AllScanInfo <- read.csv(paste0(tract_workdir,"/allscansInfo.csv"), header=TRUE)
View(AllScanInfo)
AllScanInfo <- read.csv(paste0(tract_workdir,"/allscansInfo.csv"), header=TRUE) %>% `colnames<-`(c("scans","gest_week","Trimester")) %>%  filter(!(scans %in% c("sub-026", "sub-027")))
View(AllScanInfo)
tract_workdir <-"/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/28andB/tractography"
AllScanInfo <- read.csv(paste0(tract_workdir,"/allscansInfo.csv"), header=TRUE) %>% `colnames<-`(c("scans","gest_week","Trimester")) %>%  filter(!(scans %in% c("26", "27")))
AllScanInfo$scans <- lapply(AllScanInfo$scans, sprintf, fmt = "%03d")
AllScanInfo <- ChangeTrimesterLabels(AllScanInfo)
ROIS <- read.table(paste0(tract_workdir,"/HCp842ROIS.txt")) %>% filter(V1 !="CNX_R")
QA_master_DF <- read.csv(paste0(tract_workdir,"/QA_master_DF.csv")) %>% filter(!(subjects %in% c("sub-026", "sub-027")))
MD_master_DF<- read.csv(paste0(tract_workdir,"/QA_master_DF.csv"))%>% filter(!(subjects %in% c("sub-026", "sub-027")))
QA_scans <- QA_master_DF %>%  mutate(trimester = factor(AllScanInfo$Trimester, levels= c('Pre','1st','2nd', '3rd', 'Post')))
for (ROI in 2:nrow(ROIS)) {
print(ROI)
roiname <- str_split_1(ROIS[ROI,1], '_') %>% paste(collapse=' ')
y <- ROIS[ROI,1]
QAplot <- QA_scans %>%
ggplot(aes(x = trimester, y = QA_scans[, ROI], group = trimester)) +
#geom_jitter(color = "black",size = 0.8, alpha = 0.9,width = 0.25) +
geom_boxplot(width = 0.5 , fill = grp_colors) +
#scale_y_binned(n.breaks=10, nice.breaks = TRUE) +
labs(x = "Trimester", y = "QA", title = roiname) +
theme(
strip.text.x = element_text(
size = 12,
color = "black",
face = "bold.italic"
),
strip.text.y = element_text(
size = 12,
color = "black",
face = "bold.italic"
)
) + xlab("Trimester") + ylab("QA") +
theme(
axis.title.x = element_text(size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
axis.title.y = element_text(size = 16),
plot.title = element_text(hjust = 0.5,size=16)
) + theme(legend.position = "none")
#
pdf(file = paste0(tract_workdir,"/boxplots/QA/",y,"_QA.pdf"),width=10, height=8)
print(QAplot)
dev.off()
}
library(stringr)
str_split_1(ROIS[ROI,1], '_') %>% paste(collapse=' ')
library(stringr)
help("stringr-package")
roiname <- stringr::str_split_1(ROIS[ROI,1], '_') %>% paste(collapse=' ')
install.packages("stringr")
install.packages("stringr")
install.packages("stringr")
