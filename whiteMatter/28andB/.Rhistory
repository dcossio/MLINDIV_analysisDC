gest_QA_pos <- read.delim(paste0(Gest_path,'QA/Pre_Preg_wks/QA_gestWeek_PreandPreg_pos.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame() %>% na.omit()
gest_QA_cols <- c("Subjects", as.character(gest_QA_pos[,1]))
# prepping for figs
gest_QA_pos_values <-
read.delim(paste0(Gest_path, 'QA/Pre_Preg_wks/QA_gestWeek_PreandPreg_pos.csv'), header = FALSE, sep="\t") %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>%
`colnames<-`(gest_QA_cols) %>%
mutate(gest_wks = Gest_subinfo$GestWeek) %>%
mutate(status = as.factor(Gest_subinfo$`Endo Status`)) %>%
mutate(trimester = factor(Gest_subinfo$Trimester, levels= c('pre','first','second', 'third', 'post')))
gest_QA_pos_values <-
read.delim(paste0(Gest_path, 'QA/Pre_Preg_wks/QA_gestWeek_PreandPreg_pos.csv'), header = FALSE, sep="\t") %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>%
`colnames<-`(gest_QA_cols) %>%
mutate(gest_wks = Gest_subinfo$GestWeek)
Gest_subinfo$GestWeek
gest_QA_pos_values <-
read.delim(paste0(Gest_path, 'QA/Pre_Preg_wks/QA_gestWeek_PreandPreg_pos.csv'), header = FALSE, sep="\t") %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>%
`colnames<-`(gest_QA_cols) %>%
mutate(gest_wks = Gest_subinfo$GestWeek)
gest_QA_pos_values <-
read.delim(paste0(Gest_path, 'QA/Pre_Preg_wks/QA_gestWeek_PreandPreg_pos.csv'), header = FALSE, sep="\t") %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>%
`colnames<-`(gest_QA_cols) %>%
mutate(gest_wks = Gest_subinfo$GestWeek)
gest_QA_pos_values <-
read.delim(paste0(Gest_path, 'QA/Pre_Preg_wks/QA_gestWeek_PreandPreg_pos.csv'), header = FALSE, sep="\t") %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>%
`colnames<-`(gest_QA_cols) %>%
mutate(gest_wks = Gest_subinfo$GestWeek)
gest_QA_pos_values <-
read.delim(paste0(Gest_path, 'QA/Pre_Preg_wks/QA_gestWeek_PreandPreg_pos.csv'), header = FALSE, sep="\t") %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>%
`colnames<-`(gest_QA_cols)
gest_QA_pos_values <-
read.delim(paste0(Gest_path, 'QA/Pre_Preg_wks/QA_gestWeek_PreandPreg_pos.csv'), header = FALSE, sep="\t") %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>%
`colnames<-`(gest_QA_cols) %>%
mutate(gest_wks = Gest_subinfo$GestWeek)
gest_QA_pos_values <-
read.delim(paste0(Gest_path, 'QA/Pre_Preg_wks/QA_gestWeek_PreandPreg_pos.csv'), header = FALSE, sep="\t") %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>%
`colnames<-`(gest_QA_cols)
gest_QA_pos_values <-
read.delim(paste0(Gest_path, 'QA/Pre_Preg_wks/QA_gestWeek_PreandPreg_pos.csv'), header = FALSE, sep="\t") %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>%
`colnames<-`(gest_QA_cols) %>%
#mutate(gest_wks = Gest_subinfo$GestWeek) %>%
mutate(status = as.factor(Gest_subinfo$`Endo Status`))
library(ggplot2)
#(plyr)
library(tidyverse)
# library(dplyr)
# library(tidyr)
library(stringr)
library(kableExtra)
# library(data.table)
# library(network)
# library(tidygraph)
# library(ggraph)
# library(igraph)
# library(networkD3)
# library(CINNA)
# library(umap)
# library(plotly)
#library(factoextra)
#library(lsr)
# library(car)
library(ggpubr)
#library(entropy)
#library(ds4psy)
# library(pROC)
#library(devtools)
#library(BRRR)
#library(stats)
#library(afex)
library(knitr)
knitr::opts_chunk$set(warning=FALSE, message=FALSE, echo = FALSE,
fig.align = "center")
# working directory to data
estrogen_path <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/28andB/estrogen/"
Prog_path <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/28andB/progesterone/"
Gest_path <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/28andB/GestationalWks/"
rows2grab <- c("Tract Name", "number of tracts","mean length(mm)","diameter(mm)", "volume(mm^3)")
# REading in subject info for each analysis
#Estrogen
Est_subinfo <- read_csv(paste0(estrogen_path,'estr_demo.csv'))
Gest_subinfo <- read_csv(paste0(Gest_path,'gestWeek_info.csv'))
Prog_subinfo <- read_csv(paste0(Prog_path,'prog_scan.csv'))
# Pre and during pregnancy weeks up to week 40
gest_QA_pos <- read.delim(paste0(Gest_path,'QA/Pre_Preg_wks/QA_gestWeek_PreandPreg_pos.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame() %>% na.omit()
gest_QA_cols <- c("Subjects", as.character(gest_QA_pos[,1]))
# prepping for figs
gest_QA_pos_values <-
read.delim(paste0(Gest_path, 'QA/Pre_Preg_wks/QA_gestWeek_PreandPreg_pos.csv'), header = FALSE, sep="\t") %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>%
`colnames<-`(gest_QA_cols) %>%
#mutate(gest_wks = Gest_subinfo$GestWeek) %>%
mutate(status = as.factor(Gest_subinfo$`Endo Status`)) %>%
mutate(trimester = factor(Gest_subinfo$Trimester, levels= c('pre','first','second', 'third', 'post')))
View(Gest_subinfo)
# Pre and during pregnancy weeks up to week 40
gest_QA_pos <- read.delim(paste0(Gest_path,'QA/Pre_Preg_wks/QA_gestWeek_PreandPreg_pos.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame() %>% na.omit()
gest_QA_cols <- c("Subjects", as.character(gest_QA_pos[,1]))
# prepping for figs
gest_QA_pos_values <-
read.delim(paste0(Gest_path, 'QA/Pre_Preg_wks/QA_gestWeek_PreandPreg_pos.csv'), header = FALSE, sep="\t") %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>%
`colnames<-`(gest_QA_cols) %>%
#mutate(gest_wks = Gest_subinfo$GestWeek) %>%
mutate(status = as.factor(Gest_subinfo$`Endo Status`)) %>%
mutate(trimester = factor(Gest_subinfo$Trimester, levels= c('pre','first','second', 'third', 'post')))
gest_QA_pos_values <-
read.delim(paste0(Gest_path, 'QA/Pre_Preg_wks/QA_gestWeek_PreandPreg_pos.csv'), header = FALSE, sep="\t") %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>%
`colnames<-`(gest_QA_cols)
View(gest_QA_pos_values)
gest_QA_pos_values <-
read.delim(paste0(Gest_path, 'QA/Pre_Preg_wks/QA_gestWeek_PreandPreg_pos.csv'), header = FALSE, sep="\t") %>% na.omit()%>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>%
`colnames<-`(gest_QA_cols) %>%
#mutate(gest_wks = Gest_subinfo$GestWeek) %>%
mutate(status = as.factor(Gest_subinfo$`Endo Status`)) %>%
mutate(trimester = factor(Gest_subinfo$Trimester, levels= c('pre','first','second', 'third', 'post')))
# Pre and during pregnancy weeks up to week 40
gest_QA_pos <- read.delim(paste0(Gest_path,'QA/Pre_Preg_wks/QA_gestWeek_PreandPreg_pos.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame() %>% na.omit()
gest_QA_cols <- c("Subjects", as.character(gest_QA_pos[,1]))
# prepping for figs
gest_QA_pos_values <-
read.delim(paste0(Gest_path, 'QA/Pre_Preg_wks/QA_gestWeek_PreandPreg_pos.csv'), header = FALSE, sep="\t") %>% na.omit()%>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>%
`colnames<-`(gest_QA_cols) %>%
#mutate(gest_wks = Gest_subinfo$GestWeek) %>%
mutate(status = as.factor(Gest_subinfo$`Endo Status`)) %>%
mutate(trimester = factor(Gest_subinfo$Trimester, levels= c('pre','first','second', 'third', 'post')))
gest_QA_pos_values <- read.delim(paste0(Gest_path, 'QA/Pre_Preg_wks/QA_gestWeek_PreandPreg_pos.csv'), header = FALSE, sep="\t") %>% na.omit()
gest_QA_pos_values <- read.delim(paste0(Gest_path, 'QA/Pre_Preg_wks/QA_gestWeek_PreandPreg_pos.csv'), header = FALSE, sep="\t")
View(Gest_subinfo)
# Pre and during pregnancy weeks up to week 40
gest_QA_pos <- read.delim(paste0(Gest_path,'QA/Pre_Preg_wks/QA_gestWeek_PreandPreg_pos.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame() %>% na.omit()
gest_QA_cols <- c("Subjects", as.character(gest_QA_pos[,1]))
# prepping for figs
gest_QA_pos_values <- read.delim(paste0(Gest_path, 'QA/Pre_Preg_wks/QA_gestWeek_PreandPreg_pos.csv'), header = FALSE, sep="\t") %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>%
`colnames<-`(gest_QA_cols) %>%
mutate(gest_wks = Gest_subinfo$GestWeek) %>%
#mutate(status = as.factor(Gest_subinfo$`Endo Status`)) %>%
mutate(trimester = factor(Gest_subinfo$Trimester, levels= c('pre','first','second', 'third', 'post')))
# Pre and during pregnancy weeks up to week 40
gest_QA_pos <- read.delim(paste0(Gest_path,'QA/Pre_Preg_wks/QA_gestWeek_PreandPreg_pos.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame() %>% na.omit()
gest_QA_cols <- c("Subjects", as.character(gest_QA_pos[,1]))
# prepping for figs
gest_QA_pos_values <- read.delim(paste0(Gest_path, 'QA/Pre_Preg_wks/QA_gestWeek_PreandPreg_pos.csv'), header = FALSE, sep="\t") %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>%
#`colnames<-`(gest_QA_cols) %>%
mutate(gest_wks = Gest_subinfo$GestWeek) %>%
mutate(status = as.factor(Gest_subinfo$`Endo Status`)) %>%
mutate(trimester = factor(Gest_subinfo$Trimester, levels= c('pre','first','second', 'third', 'post')))
# Reorder for my sanity check
gest_QA_pos_values <- gest_QA_pos_values[,c(1,5:7,2:4)]
qa_gest_gathercols <- colnames(gest_QA_pos_values[5:7])
# for some reason things are being read as a a character and it needs to be a numerical value
gest_QA_pos_values[5:7] <- apply(gest_QA_pos_values[5:7],2, as.numeric)
## GAther it long for large compiled figure
gest_QA_pos_values_long <- gather(gest_QA_pos_values, ROI, QA ,qa_gest_gathercols, factor_key = TRUE) %>% select(!(Subjects))
View(gest_QA_pos_values)
gest_QA_pos <- read.delim(paste0(Gest_path,'QA/Pre_Preg_wks/QA_gestWeek_PreandPreg_pos.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame() %>% na.omit()
gest_QA_cols <- c("Subjects", as.character(gest_QA_pos[,1]))
# prepping for figs
gest_QA_pos_values <- read.delim(paste0(Gest_path, 'QA/Pre_Preg_wks/QA_gestWeek_PreandPreg_pos.csv'), header = FALSE, sep="\t") %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>%
#`colnames<-`(gest_QA_cols) %>%
mutate(gest_wks = Gest_subinfo$GestWeek) %>%
mutate(status = as.factor(Gest_subinfo$`Endo Status`)) %>%
mutate(trimester = factor(Gest_subinfo$Trimester, levels= c('pre','first','second', 'third', 'post')))
View(Gest_subinfo)
gest_QA_pos_values <- read.delim(paste0(Gest_path, 'QA/Pre_Preg_wks/QA_gestWeek_PreandPreg_pos.csv'), header = FALSE, sep="\t") %>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>%
na.omit()
View(gest_QA_pos)
gest_QA_pos_values <- read.delim(paste0(Gest_path, 'QA/Pre_Preg_wks/QA_gestWeek_PreandPreg_pos.csv'), header = FALSE, sep="\t") %>% select_if(~ !any(is.na(.)))
gest_QA_pos_values <- read.delim(paste0(Gest_path, 'QA/Pre_Preg_wks/QA_gestWeek_PreandPreg_pos.csv'), header = FALSE, sep="\t") %>% select_if(~ !any(is.na(.)))%>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm")))
gest_QA_pos_values <- read.delim(paste0(Gest_path, 'QA/Pre_Preg_wks/QA_gestWeek_PreandPreg_pos.csv'), header = FALSE, sep="\t") %>% select_if(~ !any(is.na(.)))%>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>%
`colnames<-`(gest_QA_cols) %>%
mutate(gest_wks = Gest_subinfo$GestWeek) %>%
mutate(status = as.factor(Gest_subinfo$`Endo Status`))
# Pre and during pregnancy weeks up to week 40
gest_QA_pos <- read.delim(paste0(Gest_path,'QA/Pre_Preg_wks/QA_gestWeek_PreandPreg_pos.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame() %>% na.omit()
gest_QA_cols <- c("Subjects", as.character(gest_QA_pos[,1]))
# prepping for figs
gest_QA_pos_values <- read.delim(paste0(Gest_path, 'QA/Pre_Preg_wks/QA_gestWeek_PreandPreg_pos.csv'), header = FALSE, sep="\t") %>% select_if(~ !any(is.na(.)))%>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>%
`colnames<-`(gest_QA_cols) %>%
mutate(gest_wks = Gest_subinfo$GestWeek) %>%
mutate(status = as.factor(Gest_subinfo$`Endo Status`)) %>%
mutate(trimester = factor(Gest_subinfo$Trimester)) #levels= c('pre','first','second', 'third', 'post'
# Reorder for my sanity check
gest_QA_pos_values <- gest_QA_pos_values[,c(1,5:7,2:4)]
qa_gest_gathercols <- colnames(gest_QA_pos_values[5:7])
# for some reason things are being read as a a character and it needs to be a numerical value
gest_QA_pos_values[5:7] <- apply(gest_QA_pos_values[5:7],2, as.numeric)
## GAther it long for large compiled figure
gest_QA_pos_values_long <- gather(gest_QA_pos_values, ROI, QA ,qa_gest_gathercols, factor_key = TRUE) %>% select(!(Subjects))
gest_QA_figpath <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/28andB/GestationalWks/QA/Pre_Preg_wks/"
for (ROI in QA_gest_gathercols) {
print(ROI)
y <- gest_QA_all_neg_values %>%
ggplot( aes(x=trimester, y=gest_QA_all_neg_values[[ROI]], group=trimester)) +
geom_boxplot(width=0.5 ,fill= c("#CF92BF", "#D1E7E6", "#A8D2C6", "#6AA390","#90A0C9")) +
scale_y_binned(n.breaks=10, nice.breaks = TRUE) +
labs(x= "Trimester", y= " MD", title =paste0(ROI) ) +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
png(file = paste0(gest_QA_figpath ,ROI,".png"))
print(y)
dev.off()
}
gest_QA_pos <- read.delim(paste0(Gest_path,'QA/Pre_Preg_wks/QA_gestWeek_PreandPreg_pos.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame() %>% na.omit()
gest_QA_cols <- c("Subjects", as.character(gest_QA_pos[,1]))
# prepping for figs
gest_QA_pos_values <- read.delim(paste0(Gest_path, 'QA/Pre_Preg_wks/QA_gestWeek_PreandPreg_pos.csv'), header = FALSE, sep="\t") %>% select_if(~ !any(is.na(.)))%>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>%
`colnames<-`(gest_QA_cols) %>%
mutate(gest_wks = Gest_subinfo$GestWeek) %>%
mutate(status = as.factor(Gest_subinfo$`Endo Status`)) %>%
mutate(trimester = factor(Gest_subinfo$Trimester))
gest_QA_pos_values <- gest_QA_pos_values[,c(1,21:23,2:20)]
gest_QA_pos_values[5:23]
colnames(gest_QA_pos_values[5:23]
)
# Pre and during pregnancy weeks up to week 40
gest_QA_pos <- read.delim(paste0(Gest_path,'QA/Pre_Preg_wks/QA_gestWeek_PreandPreg_pos.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame() %>% na.omit()
gest_QA_cols <- c("Subjects", as.character(gest_QA_pos[,1]))
# prepping for figs
gest_QA_pos_values <- read.delim(paste0(Gest_path, 'QA/Pre_Preg_wks/QA_gestWeek_PreandPreg_pos.csv'), header = FALSE, sep="\t") %>% select_if(~ !any(is.na(.)))%>%
filter(str_detect(V1, c("mean_qa"))) %>%
filter(!str_detect(V1, c("mean_qa_post_norm"))) %>%
`colnames<-`(gest_QA_cols) %>%
mutate(gest_wks = Gest_subinfo$GestWeek) %>%
mutate(status = as.factor(Gest_subinfo$`Endo Status`)) %>%
mutate(trimester = factor(Gest_subinfo$Trimester)) #levels= c('pre','first','second', 'third', 'post'
# Reorder for my sanity check
gest_QA_pos_values <- gest_QA_pos_values[,c(1,21:23,2:20)]
qa_gest_gathercols <- colnames(gest_QA_pos_values[5:23])
# for some reason things are being read as a a character and it needs to be a numerical value
gest_QA_pos_values[5:23] <- apply(gest_QA_pos_values[5:23],2, as.numeric)
## GAther it long for large compiled figure
gest_QA_pos_values_long <- gather(gest_QA_pos_values, ROI, QA ,qa_gest_gathercols, factor_key = TRUE) %>% select(!(Subjects))
gest_QA_figpath <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/28andB/GestationalWks/QA/Pre_Preg_wks/"
for (ROI in QA_gest_gathercols) {
print(ROI)
y <- gest_QA_all_neg_values %>%
ggplot( aes(x=trimester, y=gest_QA_all_neg_values[[ROI]], group=trimester)) +
geom_boxplot(width=0.5 ,fill= c("#CF92BF", "#D1E7E6", "#A8D2C6", "#6AA390","#90A0C9")) +
scale_y_binned(n.breaks=10, nice.breaks = TRUE) +
labs(x= "Trimester", y= " MD", title =paste0(ROI) ) +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
png(file = paste0(gest_QA_figpath ,ROI,".png"))
print(y)
dev.off()
}
gest_QA_figpath <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/28andB/GestationalWks/QA/Pre_Preg_wks/"
for (ROI in qa_gest_gathercols) {
print(ROI)
y <- gest_QA_pos_values %>%
ggplot( aes(x=trimester, y=gest_QA_pos_values[[ROI]], group=trimester)) +
geom_boxplot(width=0.5 ,fill= c("#CF92BF", "#D1E7E6", "#A8D2C6", "#6AA390","#90A0C9")) +
scale_y_binned(n.breaks=10, nice.breaks = TRUE) +
labs(x= "Trimester", y= " QA", title =paste0(ROI) ) +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
png(file = paste0(gest_QA_figpath ,ROI,".png"))
print(y)
dev.off()
}
gest_MD_pos <- read.delim(paste0(Gest_path,'MD/Pre_Preg_wks/MD_gestWeek_PreandPreg_pos.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame() %>% na.omit()
gest_MD_neg <- read.delim(paste0(Gest_path,'MD/Pre_Preg_wks/MD_gestWeek_PreandPreg_neg.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame() %>% na.omit()
#Positive
gest_MD_pos_cols <- c("Subjects", as.character(gest_QA_pos[,1]))
# prepping for figs
gest_MD_pos_values <- read.delim(paste0(Gest_path,'MD/Pre_Preg_wks/MD_gestWeek_PreandPreg_neg.csv'), header=FALSE, sep="\t") %>% select_if(~ !any(is.na(.)))%>%
filter(str_detect(V1, c("mean_md"))) %>%
`colnames<-`(gest_MD_pos_cols) %>%
mutate(gest_wks = Gest_subinfo$GestWeek) %>%
mutate(status = as.factor(Gest_subinfo$`Endo Status`)) %>%
mutate(trimester = factor(Gest_subinfo$Trimester)) #levels= c('pre','first','second', 'third', 'post'
gest_MD_pos_values <- read.delim(paste0(Gest_path,'MD/Pre_Preg_wks/MD_gestWeek_PreandPreg_neg.csv'), header=FALSE, sep="\t")
View(gest_MD_pos_values)
gest_MD_pos <- read.delim(paste0(Gest_path,'MD/Pre_Preg_wks/MD_gestWeek_PreandPreg_pos.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame() %>% na.omit()
gest_MD_neg <- read.delim(paste0(Gest_path,'MD/Pre_Preg_wks/MD_gestWeek_PreandPreg_neg.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame() %>% na.omit()
#Positive
gest_MD_pos_cols <- c("Subjects", as.character(gest_MD_pos[,1]))
# prepping for figs
gest_MD_pos_values <- read.delim(paste0(Gest_path,'MD/Pre_Preg_wks/MD_gestWeek_PreandPreg_neg.csv'), header=FALSE, sep="\t") %>% select_if(~ !any(is.na(.)))%>%
filter(str_detect(V1, c("mean_md"))) %>%
`colnames<-`(gest_MD_pos_cols) %>%
mutate(gest_wks = Gest_subinfo$GestWeek) %>%
mutate(status = as.factor(Gest_subinfo$`Endo Status`)) %>%
mutate(trimester = factor(Gest_subinfo$Trimester)) #levels= c('pre','first','second', 'third', 'post'
gest_MD_pos_values <- read.delim(paste0(Gest_path,'MD/Pre_Preg_wks/MD_gestWeek_PreandPreg_neg.csv'), header=FALSE, sep="\t")
gest_MD_pos_cols
gest_MD_pos <- read.delim(paste0(Gest_path,'MD/Pre_Preg_wks/MD_gestWeek_PreandPreg_pos.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame() %>% na.omit()
gest_MD_neg <- read.delim(paste0(Gest_path,'MD/Pre_Preg_wks/MD_gestWeek_PreandPreg_neg.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame() %>% na.omit()
#Positive
gest_MD_pos_cols <- c("Subjects", as.character(gest_MD_pos[,1]))
# prepping for figs
gest_MD_pos_values <- read.delim(paste0(Gest_path,'MD/Pre_Preg_wks/MD_gestWeek_PreandPreg_pos.csv'), header=FALSE, sep="\t") %>% select_if(~ !any(is.na(.)))%>%
filter(str_detect(V1, c("mean_md"))) %>%
`colnames<-`(gest_MD_pos_cols) %>%
mutate(gest_wks = Gest_subinfo$GestWeek) %>%
mutate(status = as.factor(Gest_subinfo$`Endo Status`)) %>%
mutate(trimester = factor(Gest_subinfo$Trimester))
gest_MD_pos_values[,c(1,7:9,2:6)]
gest_MD_pos_values <- gest_MD_pos_values[,c(1,7:9,2:6)]
gest_MD_pos_cols <- c("Subjects", as.character(gest_MD_pos[,1]))
# prepping for figs
gest_MD_pos_values <- read.delim(paste0(Gest_path,'MD/Pre_Preg_wks/MD_gestWeek_PreandPreg_pos.csv'), header=FALSE, sep="\t") %>% select_if(~ !any(is.na(.)))%>%
filter(str_detect(V1, c("mean_md"))) %>%
`colnames<-`(gest_MD_pos_cols) %>%
mutate(gest_wks = Gest_subinfo$GestWeek) %>%
mutate(status = as.factor(Gest_subinfo$`Endo Status`)) %>%
mutate(trimester = factor(Gest_subinfo$Trimester)) #levels= c('pre','first','second', 'third', 'post'
# Reorder for my sanity check
gest_MD_pos_values <- gest_MD_pos_values[,c(1,7:9,2:6)]
md_gest_pos_gathercols <- colnames(gest_MD_pos_values[5:9])
# for some reason things are being read as a a character and it needs to be a numerical value
gest_MD_pos_values[5:9] <- apply(gest_MD_pos_values[5:9],2, as.numeric)
## GAther it long for large compiled figure
gest_MD_pos_values_long <- gather(gest_MD_pos_values, ROI, QA ,md_gest_pos_gathercols, factor_key = TRUE) %>% select(!(Subjects))
### negative
gest_MD_neg_cols <- c("Subjects", as.character(gest_MD_neg[,1]))
# prepping for figs
gest_MD_neg_cols_values <- read.delim(paste0(Gest_path,'MD/Pre_Preg_wks/MD_gestWeek_PreandPreg_neg.csv'), header=FALSE, sep="\t") %>% select_if(~ !any(is.na(.)))%>%
filter(str_detect(V1, c("mean_md"))) %>%
`colnames<-`(gest_MD_neg_cols) %>%
mutate(gest_wks = Gest_subinfo$GestWeek) %>%
mutate(status = as.factor(Gest_subinfo$`Endo Status`)) %>%
mutate(trimester = factor(Gest_subinfo$Trimester))
View(gest_MD_neg_cols_values)
# ALl weeks
gest_MD_pos <- read.delim(paste0(Gest_path,'MD/Pre_Preg_wks/MD_gestWeek_PreandPreg_pos.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame() %>% na.omit()
gest_MD_neg <- read.delim(paste0(Gest_path,'MD/Pre_Preg_wks/MD_gestWeek_PreandPreg_neg.csv'), header=FALSE, sep="\t") %>%  filter(V1 %in% rows2grab) %>% t() %>% `colnames<-`(rows2grab) %>% `[`(-c(1),) %>% as.data.frame() %>% na.omit()
#Positive
gest_MD_pos_cols <- c("Subjects", as.character(gest_MD_pos[,1]))
# prepping for figs
gest_MD_pos_values <- read.delim(paste0(Gest_path,'MD/Pre_Preg_wks/MD_gestWeek_PreandPreg_pos.csv'), header=FALSE, sep="\t") %>% select_if(~ !any(is.na(.)))%>%
filter(str_detect(V1, c("mean_md"))) %>%
`colnames<-`(gest_MD_pos_cols) %>%
mutate(gest_wks = Gest_subinfo$GestWeek) %>%
mutate(status = as.factor(Gest_subinfo$`Endo Status`)) %>%
mutate(trimester = factor(Gest_subinfo$Trimester)) #levels= c('pre','first','second', 'third', 'post'
# Reorder for my sanity check
gest_MD_pos_values <- gest_MD_pos_values[,c(1,7:9,2:6)]
md_gest_pos_gathercols <- colnames(gest_MD_pos_values[5:9])
# for some reason things are being read as a a character and it needs to be a numerical value
gest_MD_pos_values[5:9] <- apply(gest_MD_pos_values[5:9],2, as.numeric)
## GAther it long for large compiled figure
gest_MD_pos_values_long <- gather(gest_MD_pos_values, ROI, QA ,md_gest_pos_gathercols, factor_key = TRUE) %>% select(!(Subjects))
### negative
gest_MD_neg_cols <- c("Subjects", as.character(gest_MD_neg[,1]))
# prepping for figs
gest_MD_neg_cols_values <- read.delim(paste0(Gest_path,'MD/Pre_Preg_wks/MD_gestWeek_PreandPreg_neg.csv'), header=FALSE, sep="\t") %>% select_if(~ !any(is.na(.)))%>%
filter(str_detect(V1, c("mean_md"))) %>%
`colnames<-`(gest_MD_neg_cols) %>%
mutate(gest_wks = Gest_subinfo$GestWeek) %>%
mutate(status = as.factor(Gest_subinfo$`Endo Status`)) %>%
mutate(trimester = factor(Gest_subinfo$Trimester)) #levels= c('pre','first','second', 'third', 'post'
# Reorder for my sanity check
gest_MD_neg_cols_values <- gest_MD_neg_cols_values[,c(1,5:7,2:4)]
md_gest_negs_gathercols <- colnames(gest_MD_neg_cols_values[5:7])
# for some reason things are being read as a a character and it needs to be a numerical value
gest_MD_neg_cols_values[5:7] <- apply(gest_MD_neg_cols_values[5:7],2, as.numeric)
## GAther it long for large compiled figure
gest_MD_neg_cols_values_long <- gather(gest_MD_neg_cols_values, ROI, QA ,md_gest_negs_gathercols, factor_key = TRUE) %>% select(!(Subjects))
gest_QA_pos_values %>%
ggplot( aes(x=trimester, y=gest_QA_pos_values[[ROI]], group=trimester)) +
geom_boxplot(width=0.5 ,fill= c("#CF92BF", "#D1E7E6", "#A8D2C6", "#6AA390","#90A0C9")) +
scale_y_binned(n.breaks=10, nice.breaks = TRUE) +
labs(x= "Trimester", y= " QA", title =paste0(ROI) ) +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
gest_md_figpath <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/28andB/GestationalWks/QA/Pre_Preg_wks/"
for (ROI in md_gest_pos_gathercols) {
print(ROI)
y <- gest_QA_pos_values %>%
ggplot( aes(x=trimester, y=gest_MD_pos_values[[ROI]], group=trimester)) +
geom_boxplot(width=0.5 ,fill= c("#CF92BF", "#D1E7E6", "#A8D2C6", "#6AA390","#90A0C9")) +
scale_y_binned(n.breaks=10, nice.breaks = TRUE) +
labs(x= "Trimester", y= " QA", title =paste0(ROI) ) +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
png(file = paste0(gest_md_figpath ,ROI,"POS.png"))
print(y)
dev.off()
}
View(gest_MD_pos_values)
gest_md_figpath <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/28andB/GestationalWks/MD/Pre_Preg_wks/"
for (ROI in md_gest_negs_gathercols) {
print(ROI)
y <- gest_MD_neg_cols_values %>%
ggplot( aes(x=trimester, y=gest_MD_neg_cols_values[[ROI]], group=trimester)) +
geom_boxplot(width=0.5 ,fill= c("#CF92BF", "#D1E7E6", "#A8D2C6", "#6AA390","#90A0C9")) +
scale_y_binned(n.breaks=10, nice.breaks = TRUE) +
labs(x= "Trimester", y= " QA", title =paste0(ROI) ) +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
png(file = paste0(gest_md_figpath ,ROI,"_NEG.png"))
print(y)
dev.off()
}
gest_md_figpath <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/28andB/GestationalWks/MD/Pre_Preg_wks/"
for (ROI in md_gest_pos_gathercols) {
print(ROI)
y <-  gest_MD_pos_values %>%
ggplot( aes(x=trimester, y=gest_MD_pos_values[[ROI]], group=trimester)) +
geom_boxplot(width=0.5 ,fill= c("#CF92BF", "#D1E7E6", "#A8D2C6", "#6AA390","#90A0C9")) +
scale_y_binned(n.breaks=10, nice.breaks = TRUE) +
labs(x= "Trimester", y= " MD", title =paste0(ROI) ) +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
png(file = paste0(gest_md_figpath ,ROI,"_POS.png"))
print(y)
dev.off()
}
gest_md_figpath <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/My Drive/28andB/GestationalWks/MD/Pre_Preg_wks/"
for (ROI in md_gest_negs_gathercols) {
print(ROI)
y <- gest_MD_neg_cols_values %>%
ggplot( aes(x=trimester, y=gest_MD_neg_cols_values[[ROI]], group=trimester)) +
geom_boxplot(width=0.5 ,fill= c("#CF92BF", "#D1E7E6", "#A8D2C6", "#6AA390","#90A0C9")) +
scale_y_binned(n.breaks=10, nice.breaks = TRUE) +
labs(x= "Trimester", y= " MD", title =paste0(ROI) ) +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
png(file = paste0(gest_md_figpath ,ROI,"_NEG.png"))
print(y)
dev.off()
}
