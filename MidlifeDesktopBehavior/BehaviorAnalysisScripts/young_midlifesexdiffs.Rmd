---
title: "Young_MidlifeSexDiff"
purpose: "This is to analyze sex differences in behavior both in the toung participants. This uses parts of viasakhs and kates code"   #
input: Trial.csv and participant.csv and participant info               
output: Figures and analysis for various variables                    
Notes:  
output: html_document

---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(ggplot2)
#(plyr)
library(tidyverse)
# library(dplyr)
# library(tidyr)
library(stringr)
# library(data.table)
# library(network)
# library(tidygraph)
# library(ggraph)
# library(igraph)
# library(networkD3)
# library(CINNA)
# library(umap)
# library(plotly)
library(factoextra)
library(lsr)
# library(car)
library(ggpubr)
# library(entropy)
# library(ds4psy)
# library(pROC)
library(devtools)
library(BRRR)
library(stats)
library(afex)

cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
workdir<- "/Users/danielacossio/Desktop/MLINDIV_analysisDC/MidlifeDesktopBehavior"
setwd(workdir)
```

```{r reading in midlife }
#infosheet with age/sex
subjInfo<-read.csv ("/Users/danielacossio/Desktop/MLINDIV_analysisDC/MidlifeDesktopBehavior/BehaviorAnalysisScripts/MAZE_data_old.csv")  %>% select(Subject.ID,Sex,Age.Scan..years.,) %>% `colnames<-` (c("Subject","sex","age")) %>% arrange(.$Subject)

#preprocessed data 
trialDF<-read.csv ("/Users/danielacossio/Desktop/MLINDIV_analysisDC/MidlifeDesktopBehavior/BehaviorAnalysisScripts/MLINDIV_trial_master.csv") %>% filter(Subject %in% c(as.character(subjInfo$Subject))) 

participantDF<-read.csv ("/Users/danielacossio/Desktop/MLINDIV_analysisDC/MidlifeDesktopBehavior/BehaviorAnalysisScripts/MLINDIV_participant_master.csv") %>%  filter(Subject %in% c(as.character(subjInfo$Subject)))

mid_master_trial <- inner_join(subjInfo, trialDF, by="Subject") 
mid_master_participant <- inner_join(subjInfo, participantDF, by="Subject") 
mid_master_participant$age <- as.factor("midlife")
mid_master_participant$sex <- as.factor(mid_master_participant$sex)

```

```{r reading in young participants}
yngsubjInfo<-read.csv("/Volumes/GoogleDrive/My Drive/MLINDIV_SNAG_preprocessing/young_SNAG/young_snag_participantinfo.csv")  %>% select(subject_id,sex,age_spatial_years) %>% `colnames<-` (c("Subject","sex","age"))

yngtrialDF<-read.csv ("/Volumes/GoogleDrive/My Drive/MLINDIV_SNAG_preprocessing/young_SNAG/young_trial_master (1).csv") %>% filter(Subject %in% c(as.character(yngsubjInfo$Subject))) 

yngparticipantDF <-read.csv("/Volumes/GoogleDrive/My Drive/MLINDIV_SNAG_preprocessing/young_SNAG/young_participant_master (1).csv") %>% filter(Subject %in% c(as.character(yngsubjInfo$Subject))) 


yng_master_trial <- inner_join(yngsubjInfo, yngtrialDF, by="Subject") 
yng_master_participant <- inner_join(yngsubjInfo, yngparticipantDF, by="Subject") 
yng_master_participant$age <-as.factor("young")
yng_master_participant$sex <-as.factor(yng_master_participant$sex)
```

```{r prepping variables for later use}

locs <- c('A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', "Y", "Z")
objs_orientations<- c('A4', 'I2', 'K4', 'L2', 'N3', 'O2', 'P2', 'Y2', 'W4')
objects<-c('A', 'I', 'K', 'L', 'N', 'O', 'P', 'Y', 'W')
hallways <- c('B', 'C', 'D', 'E', 'F', 'G', 'H', 'J', 'M', 'Q', 'R', 'S', 'T', 'U', "V", 'X', "Z")

#A=guitar
#I=snowman
#L=spaceship
#K=lamp post
#N=chicken
#O=trophy
#P=chair
#Y=umbrella
#W=cuckoo clock

#ttest output colnames for data later 
#colttest <-  c("estimate","statistic", "p.value", "parameter"," conf.low"," conf.high"," method","alternative")
```

```{r prepping datafranes for later use}

mid_female_analysis<-mid_master_participant %>% filter(sex == "Female") %>% select(Subject,sex,age) %>% as.data.frame() %>% mutate(group = "midlife") %>% mutate(group=paste(sex,group))       #creating master analysis data-frame to store all final exploration variable outputs into 

mid_male_analysis<-mid_master_participant %>% filter(sex == "Male") %>% select(Subject,sex,age) %>% as.data.frame() %>% mutate(group = "midlife") %>% mutate(group=paste(sex,group))
  
yng_female_analysis<-yng_master_participant %>% filter(sex == "Female") %>% select(Subject,sex,age) %>% as.data.frame() %>% mutate(group = "young") %>% mutate(group=paste(sex,group))

yng_male_analysis<-yng_master_participant %>% filter(sex == "Male") %>% select(Subject,sex,age) %>% as.data.frame() %>% mutate(group = "young") %>% mutate(group=paste(sex,group))#same thing for young

```

```{r Little bit of preprocessing on the explore trials }

mid_explor <- mid_master_trial %>% filter(is.na(accuracy) == TRUE)


#creating empty dataframe to store contents of for loop into 
# midlife 

mid_expl_df<- data.frame(matrix(nrow = nrow(mid_explor)))

for (i in 1:nrow(mid_explor)){
  e_string_orient<-as.list(strsplit(mid_explor$e_paths[i],split=" ")) 
  e_string<-as.list(strsplit(mid_explor$paths[i],split=" ")) 
  F3_index<-which(sapply(e_string_orient[[1]], FUN=function(X) "F3" %in% X))+1  
  e_string[[1]][F3_index]<-"N" #replacing with N
  V2_index<-which(sapply(e_string_orient[[1]], FUN=function(X) "V2" %in% X))+1
  e_string[[1]][V2_index]<-"Y" #replacing with Y
  e_string<-paste(e_string[[1]], collapse = " ") 
  mid_expl_df[i,1]<-e_string 
}

mid_expl_df$Subject<-mid_explor$Subject
mid_expl_df <- mid_expl_df %>% rename(paths = matrix.nrow...nrow.mid_explor..) 

mid_explr_Subinfo <- inner_join(mid_master_participant,mid_expl_df) %>% mutate(group = "midlife") %>% mutate(group=paste(sex,group))
```

```{r explore trial young preprocessing }
yng_explor <- yng_master_trial %>% filter(is.na(accuracy) == TRUE)
yng_expl_df<- data.frame(matrix(nrow = nrow(yng_explor)))

for (i in 1:nrow(yng_explor)){
  e_string_orient<-as.list(strsplit(yng_explor$e_paths[i],split=" ")) 
  e_string<-as.list(strsplit(yng_explor$paths[i],split=" ")) 
  F3_index<-which(sapply(e_string_orient[[1]], FUN=function(X) "F3" %in% X))+1  
  e_string[[1]][F3_index]<-"N" #replacing with N
  V2_index<-which(sapply(e_string_orient[[1]], FUN=function(X) "V2" %in% X))+1
  e_string[[1]][V2_index]<-"Y" #replacing with Y
  e_string<-paste(e_string[[1]], collapse = " ") 
  yng_expl_df[i,1]<-e_string 
}

yng_expl_df$Subject<-yng_explor$Subject
yng_expl_df <- yng_expl_df %>% rename(paths = matrix.nrow...nrow.yng_explor..) 

yng_explr_Subinfo <- inner_join(yng_master_participant,yng_expl_df) %>% mutate(group = "young") %>% mutate(group=paste(sex,group))#same thing for young

```

Distance Summary of results: No sex differences in men and women during midlife:

There's no significant difference between men and women at the young age but there was at the midlife age. Midlife Women traveled significantly less than midlife men did. No significant difference between midlife men and young  men. Midlife women did travel significantly less than young women. 
```{r Distance analysis using just wilcox }

#Let's look at the young men first 
 yng_male_analysis$Dist<- yng_master_participant %>% filter(sex == "Male") %>% pull(em_path_dist_trav)
shapiro.test(yng_male_analysis$Dist)  #not normal 
# young female 
 yng_female_analysis$Dist<- yng_master_participant %>% filter(sex == "Female") %>% pull(em_path_dist_trav)
shapiro.test(yng_female_analysis$Dist) # not normal 

# Lets do the young 
wilcox.test(yng_female_analysis$Dist,yng_male_analysis$Dist) #no difference 

# LEts do Midlife 
mid_female_analysis$Dist<-mid_master_participant%>% filter(sex == "Female") %>% pull(em_path_dist_trav)
shapiro.test(mid_female_analysis$Dist)
#male
mid_male_analysis$Dist<-mid_master_participant%>% filter(sex == "Male") %>% pull(em_path_dist_trav)
shapiro.test(mid_male_analysis$Dist)


#Midlife women vs midlife men
wilcox.test(mid_female_analysis$Dist,mid_male_analysis$Dist) #0.03 


# young female vs  midlife female
wilcox.test(mid_female_analysis$Dist,yng_female_analysis$Dist) # significant pvalue = 0.001139 
#midlife women =217.6289
#yng=244.3077

# young men vs midlife men 
wilcox.test(mid_male_analysis$Dist,yng_male_analysis$Dist) #not significantly different 
# young men =248.3646
#midlife men = 233.9728

```

#Theres no significant differece between men and women at any age when seeing an anova
```{r Distance analysis using ANOVA }

yng_male_analysis$Dist <- yng_master_participant %>% filter(sex == "Male") %>% pull(em_path_dist_trav)
yng_female_analysis$Dist<- yng_master_participant %>% filter(sex == "Female") %>% pull(em_path_dist_trav)
dist <- rbind(yng_male_analysis, yng_female_analysis)

#Midlife
mid_female_analysis$Dist<-mid_master_participant%>% filter(sex == "Female") %>% pull(em_path_dist_trav)
dist <- rbind(dist, mid_female_analysis)
#male
mid_male_analysis$Dist<-mid_master_participant%>% filter(sex == "Male") %>% pull(em_path_dist_trav)
dist <- rbind(dist, mid_male_analysis) 
#normality

shapiro.test(yng_male_analysis$Dist)  # p-value = 0.04028
shapiro.test(yng_female_analysis$Dist) # p-value = 0.03625
shapiro.test(mid_female_analysis$Dist) # p-value = 0.01943
shapiro.test(mid_male_analysis$Dist) #p-value = 0.1104


#1) is to create a df with a column for sex, column for age and column for distance and run anova on that way 
dist_aov <-  aov(formula=Dist ~ sex * age, dist)
summary(dist_aov)

pairwise.t.test(dist$Dist, dist$group, p.adj="bonferroni")
TukeyHSD(dist_aov)



```

No difference in speed
```{r SPEED }

yng_male_analysis$speed <-yng_master_participant %>% filter(sex == "Male") %>% select(em_path_dist_trav) %>% .$em_path_dist_trav/480
yng_female_analysis$speed<- yng_master_participant %>% filter(sex == "Female") %>% select(em_path_dist_trav) %>% .$em_path_dist_trav/480
Speed <- rbind(yng_female_analysis,  yng_male_analysis)

#Midlife
mid_female_analysis$speed<-mid_master_participant%>% filter(sex == "Female") %>% select(em_path_dist_trav) %>% .$em_path_dist_trav/480
Speed <- rbind(Speed, mid_female_analysis)
#male
mid_male_analysis$speed<-mid_master_participant%>% filter(sex == "Male") %>% select(em_path_dist_trav) %>% .$em_path_dist_trav/480
Speed <- rbind( Speed,  mid_male_analysis) %>% select(!(Dist))


#Normality test to assess whether samples are normally distributed 
# Midlife
shapiro.test(mid_female_analysis$speed) #p=0.019
shapiro.test(mid_male_analysis$speed)# p =.1104

#young
shapiro.test(yng_female_analysis$speed) #p= 0.03
shapiro.test(yng_male_analysis$speed)# p = 0,.04 

# Plotting the distribution
ym <- ggplot(yng_male_analysis, aes(x=speed)) + 
  geom_histogram(bins=15)
yf <- ggplot(yng_female_analysis, aes(x=speed)) + 
  geom_histogram(bins=15)

mm <- ggplot(mid_male_analysis,aes(x=speed))+ 
  geom_histogram(bins=15)
mf <- ggplot(mid_female_analysis, aes(x=speed))+ 
  geom_histogram(bins=15)

multi_plot <- ggarrange(ym,yf,mm,mf,
                       labels = c("Young Male", "Young Female", "Midlife Male","Midlife Female"),
                       font.label = list(size = 12, color = "red"),
                       vjust = 1.5,
                       ncol=2, nrow = 3)
annotate_figure(multi_plot,
                top = text_grob("Visualizing mpg", color = "red", face = "bold", size = 14))
multi_plot
#does the plot have a common legend)

#1) is to create a df with a column for sex, column for age and column for distance and run anova on that way 
speed_aov <-  aov(formula=speed ~ sex * age,Speed)
summary(speed_aov)
# not significant 
pairwise.t.test(dist$Dist, dist$group, p.adj="bonferroni")
TukeyHSD(dist_aov)



```

```{r midlife explore object processing }

mid_big_explore<-as.data.frame(str_split_fixed(mid_expl_df$paths," ",nrow(mid_expl_df)))
mid_big_explore <- mid_big_explore %>% mutate(subject = mid_expl_df$Subject) 
mid_big_explore <-mid_big_explore[,c(ncol(mid_big_explore), 1:(ncol(mid_big_explore)-1))] 

row_labels<-c(1:nrow(mid_big_explore))
mid_big_explore<- split( mid_big_explore , f = row_labels)

#for loop to find consecutive location repeats, and remove them 
for (i in 1:length(mid_big_explore)){
  mid_big_explore[[i]]<-t(mid_big_explore[[i]])
  mid_big_explore[[i]][mid_big_explore[[i]] == ""] <- NA 
  repeat_logical<-t(c(NA, mid_big_explore[[i]]) == c(mid_big_explore[[i]], NA))[1:length(mid_big_explore[[i]])]
  repeats<- grep("TRUE",repeat_logical)
  mid_big_explore[[i]][repeats,1]<-"repeats"  
  mid_big_explore[[i]]<-t(mid_big_explore[[i]])
  mid_big_explore[[i]]<-as.data.frame(mid_big_explore[[i]]) 
}

mid_big_explore<-unsplit(mid_big_explore,row_labels)#merging all chunks back into single dataframe 
mid_big_explore[is.na(mid_big_explore)]<-"none" #replacing all NAs with string, otherwise for loop below won't work 
mid_big_explore <-  mid_big_explore %>% mutate(sex = mid_explr_Subinfo$sex)

#for loop to determine location counts 
mid_big_explore_counts <- data.frame(matrix(ncol = 0, nrow = nrow(mid_big_explore)))#creating dataframe to store counts into  

for (i in locs){
  mid_big_explore_counts$subject <- mid_big_explore$subject
  d <- as.data.frame(apply(mid_big_explore,1,function(x) sum(x==i))) # not sure what this function is 
  names(d) <- i
  mid_big_explore_counts <- cbind(d, mid_big_explore_counts)
}

mid_big_explore_counts <- mid_big_explore_counts %>% mutate(sex=mid_explr_Subinfo$sex) %>% mutate(group =mid_explr_Subinfo$group)


```

```{r explore object processing }
#location visits
yng_big_explore<-as.data.frame(str_split_fixed(yng_expl_df$paths," ",nrow(yng_expl_df)))
yng_big_explore <- yng_big_explore %>% mutate(subject = yng_expl_df$Subject) 
yng_big_explore <-yng_big_explore[,c(ncol(yng_big_explore), 1:(ncol(yng_big_explore)-1))] 

row_labels<-c(1:nrow(yng_big_explore))
yng_big_explore<- split( yng_big_explore , f = row_labels)

#for loop to find consecutive location repeats, and remove them 
for (i in 1:length(yng_big_explore)){
  yng_big_explore[[i]]<-t(yng_big_explore[[i]])
  yng_big_explore[[i]][yng_big_explore[[i]] == ""] <- NA 
  repeat_logical<-t(c(NA, yng_big_explore[[i]]) == c(yng_big_explore[[i]], NA))[1:length(yng_big_explore[[i]])]
  repeats<- grep("TRUE",repeat_logical)
  yng_big_explore[[i]][repeats,1]<-"repeats"  
  yng_big_explore[[i]]<-t(yng_big_explore[[i]])
  yng_big_explore[[i]]<-as.data.frame(yng_big_explore[[i]]) 
}

yng_big_explore<-unsplit(yng_big_explore,row_labels)#merging all chunks back into single dataframe 
yng_big_explore[is.na(yng_big_explore)]<-"none" #replacing all NAs with string, otherwise for loop below won't work 
yng_big_explore <-  yng_big_explore %>% mutate(sex = yng_explr_Subinfo$sex)

#for loop to determine location counts 
yng_big_explore_counts <- data.frame(matrix(ncol = 0, nrow = nrow(yng_big_explore)))#creating dataframe to store counts into  

for (i in locs){
  yng_big_explore_counts$subject <- yng_big_explore$subject
  d <- as.data.frame(apply(yng_big_explore,1,function(x) sum(x==i))) # not sure what this function is 
  names(d) <- i
  yng_big_explore_counts <- cbind(d, yng_big_explore_counts)
}

yng_big_explore_counts <- yng_big_explore_counts %>% mutate(sex=yng_explr_Subinfo$sex) %>% mutate(group =yng_explr_Subinfo$group)


```

```{r object visits }

#midlife 
male_obj_visits <- mid_big_explore_counts %>% filter(sex=="Male") %>%   transmute(subject,sex,group, A, I, L, K, N, O, P, Y, W)
cols_sum<-c(4:length(male_obj_visits))
male_obj_visits$total= rowSums(male_obj_visits[,cols_sum])
mObj_ave <-aggregate(male_obj_visits$total, list(male_obj_visits$subject), FUN=mean)
mid_male_analysis$TotalObjVisits <- mObj_ave$x


#females
female_obj_visits <- mid_big_explore_counts %>% filter(sex=="Female") %>%   transmute(subject,sex,group, A, I, L, K, N, O, P, Y, W)
cols_sum<-c(4:length(female_obj_visits))
female_obj_visits$total= rowSums(female_obj_visits[,cols_sum])
fObj_ave <- aggregate(female_obj_visits$total, list(female_obj_visits$subject), FUN=mean)
mid_female_analysis$TotalObjVisits<-fObj_ave$x

#Object Visits- Normality test to assess whether samples are normally distributed
shapiro.test(mid_male_analysis$TotalObjVisits) #normal 
shapiro.test(mid_female_analysis$TotalObjVisits) # normal

ObjVisits <- rbind(mid_female_analysis,mid_male_analysis)

# GRabbing the young group

yng_male_obj_visits <- yng_big_explore_counts %>% filter(sex=="Male") %>%   transmute(subject,sex,group, A, I, L, K, N, O, P, Y, W)
cols_sum<-c(4:length(yng_male_obj_visits))
yng_male_obj_visits$total= rowSums(yng_male_obj_visits[,cols_sum])
yng_mObj_ave <-aggregate(yng_male_obj_visits$total, list(yng_male_obj_visits$subject), FUN=mean)
yng_male_analysis$TotalObjVisits <- yng_mObj_ave$x

ObjVisits <- rbind(ObjVisits,yng_male_analysis)

#females
yng_female_obj_visits <- yng_big_explore_counts %>% filter(sex=="Female") %>%   transmute(subject,sex, A, I, L, K, N, O, P, Y, W)
cols_sum<-c(3:length(yng_female_obj_visits))
yng_female_obj_visits$total= rowSums(yng_female_obj_visits[,cols_sum])
fObj_ave <- aggregate(yng_female_obj_visits$total, list(yng_female_obj_visits$subject), FUN=mean)
yng_female_analysis$TotalObjVisits<-fObj_ave$x

ObjVisits <- rbind(ObjVisits,yng_female_analysis) %>% select(!(Dist)) %>% select(!(speed))

shapiro.test(yng_male_analysis$TotalObjVisits) #normal 
shapiro.test(yng_female_analysis$TotalObjVisits) # normal 


# or do you do 
Obj_aov <- aov(formula=TotalObjVisits ~ sex * age ,ObjVisits)
summary(Obj_aov)

```

```{r Hallway visits}

#midlife male
mid_male_hall_visits <- mid_big_explore_counts %>% filter(sex =="Male") %>% transmute(subject,sex,group, B, C, D, E, `F`, G, H, J, M, Q, R, S, `T`, U, V, X, Z)
cols_sum<-c(4:length(mid_male_hall_visits))
mid_male_hall_visits$total<-rowSums(mid_male_hall_visits[,cols_sum])#finding total hallway counts for each subject for each session 
mid_male_hall_visits_mean<-aggregate(mid_male_hall_visits$total, list(mid_male_hall_visits$subject), FUN=mean)
mid_male_analysis$TotalHallwayVisits<-mid_male_hall_visits_mean$x 

# midlife female
mid_female_hall_visits <- mid_big_explore_counts %>% filter(sex =="Female") %>%   transmute(subject,sex,group, B, C, D, E, `F`, G, H, J, M, Q, R, S, `T`, U, V, X, Z)
cols_sum<-c(4:length(mid_female_hall_visits))
mid_female_hall_visits$total<-rowSums(mid_female_hall_visits[,cols_sum])#finding total hallway counts for each subject for each session 
mid_female_hall_visits_mean<-aggregate(mid_female_hall_visits$total, list(mid_female_hall_visits$subject), FUN=mean)
mid_female_analysis$TotalHallwayVisits<-mid_female_hall_visits_mean$x 

halls <- rbind(mid_female_analysis,mid_male_analysis)

#Young male

yng_male_hall_visits <- yng_big_explore_counts %>% filter(sex =="Male") %>%   transmute(subject,sex,group, B, C, D, E, `F`, G, H, J, M, Q, R, S, `T`, U, V, X, Z)
cols_sum<-c(4:length(yng_male_hall_visits))
yng_male_hall_visits$total<-rowSums(yng_male_hall_visits[,cols_sum])#finding total hallway counts for each subject for each session 
yng_male_hall_visits_mean<-aggregate(yng_male_hall_visits$total, list(yng_male_hall_visits$subject), FUN=mean)
yng_male_analysis$TotalHallwayVisits<-yng_male_hall_visits_mean$x 

halls <- rbind(halls,yng_male_analysis)

# ynglife female
yng_female_hall_visits <- yng_big_explore_counts %>% filter(sex =="Female") %>%   transmute(subject,sex,group, B, C, D, E, `F`, G, H, J, M, Q, R, S, `T`, U, V, X, Z)
cols_sum<-c(4:length(yng_female_hall_visits))
yng_female_hall_visits$total<-rowSums(yng_female_hall_visits[,cols_sum])#finding total hallway counts for each subject for each session 
yng_female_hall_visits_mean<-aggregate(yng_female_hall_visits$total, list(yng_female_hall_visits$subject), FUN=mean)
yng_female_analysis$TotalHallwayVisits<-yng_female_hall_visits_mean$x 

halls <- rbind(halls,yng_female_analysis) %>% select(sex,age,group,TotalHallwayVisits)

#normality distribution

shapiro.test(yng_male_analysis$TotalHallwayVisits) #normal 
shapiro.test(yng_female_analysis$TotalHallwayVisits)
shapiro.test(mid_male_analysis$TotalHallwayVisits) #normal 
shapiro.test(mid_female_analysis$TotalHallwayVisits)


hallvis_aov<- aov(formula=TotalHallwayVisits ~ sex*age ,halls)
summary(hallvis_aov)

```



```{r Plots for distance }
yng_distance <- yng_master_participant %>% select(Subject,sex,age) %>% as.data.frame() %>% mutate(Dist = yng_master_participant$em_path_dist_trav)
mid_distance <- mid_master_participant %>% select(Subject,sex,age) %>% as.data.frame() %>% mutate(Dist = mid_master_participant$em_path_dist_trav)

dist <- rbind(yng_distance,mid_distance)

#this was just to create a better grouping


sam_size <- dist%>%dplyr::group_by(group)%>% dplyr::summarize(num=n())


pdf("Distance Traveled in young and midlife split by gender.pdf")
dist %>%
  left_join(sam_size) %>%
  mutate(myaxis=paste0(group,"\n", "n=", num)) %>%
  ggplot( aes(x=myaxis, y=Dist, fill=group)) +
  geom_violin() +
  geom_boxplot(width=0.2, color="grey", alpha=0.2) +
  geom_jitter(position = position_jitter(seed = 1, width = 0.1)) +
  scale_colour_brewer(cbPalette) +
  stat_summary(fun="mean",size =0.2, color="red" )+
  theme(legend.position="none", plot.title = element_text(size=14)) +
  ggtitle("Distance in young and midlife split by gender") +
  xlab("") +
  ylab("Distance traveled")
dev.off()

```

```{r Plot for object visits }
yng_obj <- rbind(yng_female_analysis,yng_male_analysis) %>% 
  select(Subject,TotalObjVisits) %>% 
  arrange() %>% 
  mutate(sex= yng_master_participant$sex)%>% 
  mutate(age= yng_master_participant$age)

mid_obj <- rbind(mid_female_analysis,mid_male_analysis) %>% 
  select(Subject,TotalObjVisits) %>% 
  arrange() %>% 
  mutate(sex= mid_master_participant$sex)%>% 
  mutate(age= mid_master_participant$age)

ObjVisits <- rbind(yng_obj,mid_obj)


sam_size <- ObjVisits%>%dplyr::group_by(group)%>% dplyr::summarize(num=n())


pdf("Distance Traveled in young and midlife split by gender.pdf")
ObjVisits %>%
  left_join(sam_size) %>%
  mutate(myaxis=paste0(group,"\n", "n=", num)) %>%
  ggplot( aes(x=myaxis, y=TotalObjVisits, fill=group)) +
  #geom_violin() +
    geom_boxplot(width=0.2, color="grey", alpha=0.2) +
    geom_jitter(position = position_jitter(seed = 1, width = 0.1)) +
    scale_colour_brewer(cbPalette) +
    stat_summary(fun="mean",size =0.2, color="red" )+
    theme(legend.position="none", plot.title = element_text(size=14)) +
    ggtitle("Object Visits in young and midlife split by gender") +
    theme(plot.title = element_text(hjust = 0.5))+
  xlab("") +
  ylab("Object Visits")
dev.off()

# LEts just do women 
pdf("Distance Traveled in young and midlife Women.pdf")
ObjVisits %>%
  left_join(sam_size) %>% 
  filter(sex == "Female") %>% 
  mutate(myaxis=paste0(group,"\n", "n=", num)) %>%
  ggplot( aes(x=myaxis, y=TotalObjVisits, fill=group)) +
  #geom_violin() +
    geom_boxplot(width=0.2, color="grey", alpha=0.2) +
    geom_jitter(position = position_jitter(seed = 1, width = 0.1)) +
    scale_colour_brewer(cbPalette) +
    stat_summary(fun="mean",size =0.2, color="red" )+
    theme(legend.position="none", plot.title = element_text(size=14)) +
    ggtitle("Object Visits in young and midlife women") +
    theme(plot.title = element_text(hjust = 0.5))+
    xlab("") +
    ylab("Total bject Visits")
dev.off()


#Lets do men
pdf("Distance Traveled in young and midlife Men.pdf")
ObjVisits %>%
  left_join(sam_size) %>% 
  filter(sex == "Male") %>% 
  mutate(myaxis=paste0(group,"\n", "n=", num)) %>%
  ggplot( aes(x=myaxis, y=TotalObjVisits, fill=group)) +
  #geom_violin() +
    geom_boxplot(width=0.2, color="grey", alpha=0.2) +
    geom_jitter(position = position_jitter(seed = 1, width = 0.1)) +
    scale_colour_brewer(cbPalette) +
    stat_summary(fun="mean",size =0.2, color="red" )+
    theme(legend.position="none", plot.title = element_text(size=14)) +
    ggtitle("Object Visits in young and midlife women") +
    theme(plot.title = element_text(hjust = 0.5))+
    xlab("") +
    ylab("Total Object Visits")
dev.off()





```








Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
