---
title: "Sex differences in young and midlife exploration"
purpose: "This is to analyze sex differences in behavior both in the young participants. This uses parts of viasakhs and kates code"   #
input: Trial.csv and participant.csv and participant info             
Notes:  Updated August 2023
output:
   html_document:
    toc: true
    toc_float: true
    toc_depth: 6
    theme: flatly
editor_options: 
  chunk_output_type: inline

---
```{css, echo=FALSE}
h1, h2 {
  text-align: center;
  color: darkblue;
  font-weight: bold;
}
```

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(ggplot2)
#(plyr)
library(tidyverse)
library(dplyr)
# library(tidyr)
library(stringr)
# library(data.table)
# library(network)
# library(tidygraph)
# library(ggraph)
# library(igraph)
# library(networkD3)
# library(CINNA)
# library(umap)
# library(plotly)
library(factoextra)
library(lsr)
# library(car)
library(ggpubr)
library(entropy)
#library(ds4psy)
# library(pROC)
library(devtools)
library(stats)
library(afex)
#library(mediation) not install on laptop
library(plotrix)
library(ggpubr)
#library(afex)
library(knitr)
library(janitor)
library(car)
library(ggiraph)
library(ggiraphExtra)
library(moonBook)
library(nationalparkcolors)
library(gridExtra)
library(markdown)
library(kableExtra)


cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
# workdir<- "/Users/danielacossio/Desktop/SNAG_Exploration_sexdiff/"
# setwd(workdir)
```

<!-- ```{r Functions, echo=FALSE, results='hide',message=FALSE} -->

<!-- # # # Getting list ouptut into a nice table  -->
<!-- # GetStats <- function(YoungMale,YoungFemale,MidlifeMale,MidlifeFemale){ -->
<!-- #  -->
<!-- #   df <- as.data.frame(c("Group", "method","pval") -->
<!-- #  -->
<!-- #     YoungMale[["method"]]) -->
<!-- #  -->
<!-- #   testoutput[["statistic"]] -->
<!-- #   # have shiny output -->
<!-- #   table <- knitr::kable(var1, row.names=F)%>% -->
<!-- #   kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% -->
<!-- #   scroll_box(width = "800px", height = "400px") -->
<!-- #   #print -->
<!-- #   pdf_name <- deparse(substitute(var1)) %>% paste0("_",metric,".pdf") -->
<!-- #   pdf(pdf_name, width=15, height=12) -->
<!-- #   grid.table(var1,rows = NULL) -->
<!-- #   dev.off() -->
<!-- #   return(table) -->
<!-- # } -->

<!-- ``` -->

<!-- ```{r reading in midlife files, echo=FALSE, results='hide',message=FALSE } -->
<!-- #infosheet with age/sex -->
<!-- subjInfo<-read.csv (paste0(workdir,"MAZE_data_old.csv"))  %>% dplyr::select(Subject.ID,Sex,Age.Spatial..years.,) %>% `colnames<-` (c("Subject","sex","age")) %>% arrange(.$Subject) -->

<!-- #preprocessed trial data  -->
<!-- midlife_trial<-read.csv (paste0(workdir,"Midlife_trial_master.csv")) %>% filter(Subject %in% c(as.character(subjInfo$Subject)))  -->

<!-- #preprocessed participant data  -->
<!-- midlife_participant<-read.csv (paste0(workdir,"Midlife_participant_master.csv")) %>%  filter(Subject %in% c(as.character(subjInfo$Subject))) -->

<!-- # # Combining sex and age columns to trial and participant sheet  -->
<!-- # mid_master_trial <- inner_join(subjInfo, midlife_trial, by="Subject")  -->
<!-- # mid_master_trial$agegroup <- as.factor("midlife") -->
<!-- # mid_master_trial$sex <- as.factor(mid_master_trial$sex) -->
<!-- mid_master_trial <- midlife_trial -->

<!-- mid_master_participant <- inner_join(subjInfo, midlife_participant, by="Subject")  -->
<!-- mid_master_participant$agegroup <- as.factor("midlife") -->
<!-- mid_master_participant$sex <- as.factor(mid_master_participant$sex) -->

<!-- ``` -->

<!-- ```{r reading in young participants, echo=FALSE, results='hide',message=FALSE} -->
<!-- #repeating what i did for midlife to the young group. -->
<!-- yngsubjInfo<-read.csv(paste0(workdir,"young_snag_participantinfo.csv"))  %>% dplyr::select(subject_id,sex,age_spatial_years) %>% `colnames<-` (c("Subject","sex","age")) -->

<!-- yngtrialDF<-read.csv (paste0(workdir,"Young_trial_master.csv")) %>% filter(Subject %in% c(as.character(yngsubjInfo$Subject)))  -->

<!-- yngparticipantDF <-read.csv(paste0(workdir,"Young_participant_master.csv")) %>% filter(Subject %in% c(as.character(yngsubjInfo$Subject)))  -->


<!-- # yng_master_trial <- inner_join(yngsubjInfo, yngtrialDF, by="Subject")  -->
<!-- # yng_master_trial$age <- as.factor("young") -->
<!-- # yng_master_trial$sex <- as.factor(yng_master_trial$sex) -->

<!-- yng_master_trial <- yngtrialDF -->

<!-- yng_master_participant <- inner_join(yngsubjInfo, yngparticipantDF, by="Subject")  -->
<!-- yng_master_participant$age <-as.factor("young") -->
<!-- yng_master_participant$sex <-as.factor(yng_master_participant$sex) -->
<!-- ``` -->

<!-- ```{r prepping variables for later use, echo=FALSE, results='hide',message=FALSE} -->

<!-- locs <- c('A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', "Y", "Z") -->
<!-- objs_orientations<- c('A4', 'I2', 'K4', 'L2', 'N3', 'O2', 'P2', 'Y2', 'W4') -->
<!-- objects<-c('A', 'I', 'K', 'L', 'N', 'O', 'P', 'Y', 'W') -->
<!-- hallways <- c('B', 'C', 'D', 'E', 'F', 'G', 'H', 'J', 'M', 'Q', 'R', 'S', 'T', 'U', "V", 'X', "Z") -->

<!-- #A=guitar -->
<!-- #I=snowman -->
<!-- #L=spaceship -->
<!-- #K=lamp post -->
<!-- #N=chicken -->
<!-- #O=trophy -->
<!-- #P=chair -->
<!-- #Y=umbrella -->
<!-- #W=cuckoo clock -->

<!-- #ttest output colnames for data later  -->
<!-- #colttest <-  c("estimate","statistic", "p.value", "parameter"," conf.low"," conf.high"," method","alternative") -->
<!-- ``` -->

<!-- ```{r prepping dataframes for later use,echo=FALSE, results='hide',message=FALSE} -->

<!-- midlife_analysis<-mid_master_participant %>% dplyr::select(Subject,sex,age) %>% as.data.frame() %>% mutate(agegroup = as.factor("midlife"))     #creating master analysis data-frame to store all final exploration variable outputs into  -->

<!-- young_analysis<-yng_master_participant %>% dplyr::select(Subject,sex,age) %>% as.data.frame()    %>% mutate(agegroup = as.factor("young"))    #creating master analysis data-frame to store all final exploration variable outputs into  -->

<!-- ``` -->

<!-- <br><br><br> -->

<!-- # <span style="color: darkorange;">  Code for extracting exploration variables </span> {.tabset}  -->

<!-- ## Code overview -->

<!-- Select Tab for Midlife or Young  -->

<!-- <br><br><br><br><br><br><br><br> -->

<!-- ## Midlife preprocessing {.tabset .tabset-dropdown}  -->

<!-- ### cleaning exploration trials  -->
<!-- ```{r Little bit of preprocessing on the explore trials } -->

<!-- mid_explore_trials <- mid_master_trial %>% filter(is.na(accuracy) == TRUE) -->

<!-- #creating empty dataframe to store contents of for loop into  -->
<!-- mid_explore_df<- data.frame(matrix(nrow = nrow(mid_explore_trials))) -->

<!-- for (i in 1:nrow(mid_explore_trials)){ -->
<!--   e_string_orient<-as.list(strsplit(mid_explore_trials$e_paths[i],split=" "))  -->
<!--   e_string<-as.list(strsplit(mid_explore_trials$paths[i],split=" "))  -->
<!--   F3_index<-which(sapply(e_string_orient[[1]], FUN=function(X) "F3" %in% X))+1   -->
<!--   e_string[[1]][F3_index]<-"N" #replacing with N -->
<!--   V2_index<-which(sapply(e_string_orient[[1]], FUN=function(X) "V2" %in% X))+1 -->
<!--   e_string[[1]][V2_index]<-"Y" #replacing with Y -->
<!--   e_string<-paste(e_string[[1]], collapse = " ")  -->
<!--   mid_explore_df[i,1]<-e_string  -->
<!-- } -->

<!-- mid_explore_df$Subject<-mid_explore_trials$Subject -->
<!-- mid_explore_df <- mid_explore_df %>% rename(paths = matrix.nrow...nrow.mid_explore_trials..)  -->

<!-- ``` -->
<!-- ```{r midlife explore object processing } -->

<!-- mid_big_explore<-as.data.frame(str_split_fixed(mid_explore_df$paths," ",nrow(mid_explore_df))) -->
<!-- mid_big_explore <- mid_big_explore %>% mutate(subject = mid_explore_df$Subject)  -->
<!-- mid_big_explore <-mid_big_explore[,c(ncol(mid_big_explore), 1:(ncol(mid_big_explore)-1))]  -->

<!-- row_labels<-c(1:nrow(mid_big_explore)) -->
<!-- mid_big_explore<- split( mid_big_explore , f = row_labels) -->

<!-- #for loop to find consecutive location repeats, and remove them  -->
<!-- for (i in 1:length(mid_big_explore)){ -->
<!--   mid_big_explore[[i]]<-t(mid_big_explore[[i]]) -->
<!--   mid_big_explore[[i]][mid_big_explore[[i]] == ""] <- NA  -->
<!--   repeat_logical<-t(c(NA, mid_big_explore[[i]]) == c(mid_big_explore[[i]], NA))[1:length(mid_big_explore[[i]])] -->
<!--   repeats<- grep("TRUE",repeat_logical) -->
<!--   mid_big_explore[[i]][repeats,1]<-"repeats"   -->
<!--   mid_big_explore[[i]]<-t(mid_big_explore[[i]]) -->
<!--   mid_big_explore[[i]]<-as.data.frame(mid_big_explore[[i]])  -->
<!-- } -->

<!-- mid_big_explore<-unsplit(mid_big_explore,row_labels)#merging all chunks back into single dataframe  -->
<!-- mid_big_explore[is.na(mid_big_explore)]<-"none" #replacing all NAs with string, otherwise for loop below won't work  -->

<!-- #for loop to determine location counts  -->
<!-- mid_big_explore_counts <- data.frame(matrix(ncol = 0, nrow = nrow(mid_big_explore)))#creating dataframe to store counts into   -->

<!-- for (i in locs){ -->
<!--   mid_big_explore_counts$subject <- mid_big_explore$subject -->
<!--   d <- as.data.frame(apply(mid_big_explore,1,function(x) sum(x==i))) # not sure what this function is  -->
<!--   names(d) <- i -->
<!--   mid_big_explore_counts <- cbind(d, mid_big_explore_counts) -->
<!-- } -->


<!-- ``` -->

<!-- ### Object Visits -->
<!--   var output = midlife_analysis$TotalObjVisits  -->

<!-- ```{r mid Calculating Object visits} -->
<!-- #midlife  -->
<!-- midlife_obj_visits <- mid_big_explore_counts %>%transmute(subject,A, I, L, K, N, O, P, Y, W)  -->
<!-- cols_sum<-c(2:length(midlife_obj_visits)) -->
<!-- midlife_obj_visits$total= rowSums(midlife_obj_visits[,cols_sum]) -->
<!-- midObj_ave <-aggregate(midlife_obj_visits$total, list(midlife_obj_visits$subject), FUN=mean) -->
<!-- midlife_analysis$TotalObjVisits <- midObj_ave$x -->

<!-- ``` -->

<!-- ### Hallway Visits  -->
<!--   - var output = midlife_analysis$TotalHallwayVisits  -->
<!-- ```{r mid Calculating Hallway visits} -->
<!-- #midlife male -->
<!-- mid_hall_visits <- mid_big_explore_counts %>% transmute(subject,B, C, D, E, `F`,G, H, J, M, Q, R, S, `T`, U, V, X, Z) -->
<!-- cols_sum<-c(2:length(mid_hall_visits)) -->
<!-- mid_hall_visits$total<-rowSums(mid_hall_visits[,cols_sum])#finding total hallway counts for each subject for each session  -->
<!-- mid_hall_visits_mean<-aggregate(mid_hall_visits$total, list(mid_hall_visits$subject), FUN=mean) -->
<!-- midlife_analysis$TotalHallwayVisits<-mid_hall_visits_mean$x  -->

<!-- ``` -->

<!-- ### Evenness of Objects  -->
<!-- - var output = midlife_analysis$obj_evenness -->
<!-- ```{r mid Calculating evennes of evenness of object} -->
<!-- mid_spreadObjs <- -->
<!--   midlife_obj_visits %>% gather("location", "count", objects) %>% -->
<!--   pivot_wider( -->
<!--     id_cols = c("subject"), -->
<!--     names_from = location, -->
<!--     values_from = count, -->
<!--     values_fn = sum -->
<!--   ) -->
<!-- mid_spreadObjs <- -->
<!--   mid_spreadObjs %>% mutate(std = apply(mid_spreadObjs[objects], 1, sd)) -->

<!-- mid_flip_objs <- -->
<!--   mid_spreadObjs %>% gather("location", "count", objects) %>% pivot_wider( -->
<!--     id_cols = location, -->
<!--     names_from = subject, -->
<!--     values_from = count, -->
<!--     values_fn = sum -->
<!--   ) -->

<!-- mid_TotalVisits <- -->
<!--   as.data.frame(apply(mid_spreadObjs[objects], 2, sum)) %>% mutate(sd = apply(mid_spreadObjs[objects], 2, sd)) %>% mutate(location = mid_flip_objs$location) -->

<!-- midlife_analysis$obj_evenness <- mid_spreadObjs$std -->
<!-- ``` -->

<!-- ### Evenness of hallways  -->
<!--   - var output = midlife_analysis$HallEvenness -->
<!-- ```{r Mid life Evenness of hallways } -->

<!-- midlife_spreadHalls <- -->
<!--   mid_hall_visits %>% gather("location", "count",hallways) %>% -->
<!--   pivot_wider( -->
<!--     id_cols = c("subject"), -->
<!--     names_from = location, -->
<!--     values_from = count, -->
<!--     values_fn = sum -->
<!--   ) -->

<!-- midlife_spreadHalls <- -->
<!--   midlife_spreadHalls %>% mutate(std = apply(midlife_spreadHalls[hallways], 1, sd)) -->

<!-- mid_flip_halls <- -->
<!--   midlife_spreadHalls %>% gather("location", "count", hallways) %>% pivot_wider( -->
<!--     id_cols = location, -->
<!--     names_from = subject, -->
<!--     values_from = count, -->
<!--     values_fn = sum -->
<!--   ) -->

<!-- mid_totalhallvis <- -->
<!--   as.data.frame(apply(midlife_spreadHalls[hallways], 2, sum)) %>% mutate(sd = apply(midlife_spreadHalls[hallways], 2, sd)) %>% mutate(location = mid_flip_halls$location) -->

<!-- midlife_analysis$HallEvenness <- midlife_spreadHalls$std -->


<!-- ``` -->



<!-- ### Button Presses  -->
<!-- ```{r mid button presses} -->

<!-- mid_button_press_mean<-aggregate(mid_explore_trials$nodesturns_count, list(mid_explore_trials$Subject), FUN=mean) #calculating mean number of button presses -->

<!-- midlife_analysis$ButtonPress<-mid_button_press_mean$x  -->

<!-- ``` -->
<!-- ### Distance -->
<!-- ```{r} -->
<!-- midlife_analysis$Dist <- -->
<!--   mid_master_participant %>% pull(em_path_dist_trav) -->
<!-- ``` -->
<!-- ### Speed -->
<!-- ```{r} -->
<!-- midlife_analysis$speed<-mid_master_participant %>% dplyr::select(em_path_dist_trav) %>% .$em_path_dist_trav/480 -->
<!-- ``` -->

<!-- ```{r Midlife path roaming entropy processing} -->
<!-- #Path Roaming Entropy  -->
<!-- mid_exp_paths<-as.data.frame(mid_big_explore$subject) %>% `colnames<-`("subject") #building empty dataframe which we will populate with output from for loop below (part 1) -->
<!-- mid_exp_paths$paths<-rep("TBC",nrow(mid_exp_paths)) #adding TBCs for now, this will be replaced with output from for loop below  -->

<!-- #For loop to condense path trajectories from midlife_big_explore into single sequence, and remove "repeats" and "none" -->
<!-- for (i in 1:nrow(mid_big_explore)){ -->
<!--   cols<-2:length(mid_big_explore) #indexing columns to condense into single sequence  -->
<!--   mid_exp_paths[i,2]<-paste(mid_big_explore[i,cols], collapse = '') #combining all characters into single sequence  -->
<!--   mid_exp_paths[i,2]<-gsub('[repeatsnone]', '', mid_exp_paths[i,2])#removing strings "repeats" and "none" from sequence -->
<!-- } -->

<!-- #Combining each subject's exploration trajectories across both sessions into one exploration trajectory  -->
<!-- mid_exp_paths<- mid_exp_paths %>% group_by(subject) %>% mutate(newcol=paste(paths, collapse = '')) #combining trajectories for each subject -->
<!-- mid_exp_paths<- mid_exp_paths %>% filter (row_number() %% 2 !=0) #deletes even rows, which are duplicates with regards to combined trajectories  -->
<!-- names(mid_exp_paths)[names(mid_exp_paths) == 'newcol'] <- 'CombinedPaths' #renaming column  -->
<!-- mid_exp_paths<-as.data.frame(mid_exp_paths) #converting to df so that for loop below works  -->

<!-- #For loop to calculate path roaming entropies  -->
<!-- for (i in 1:nrow(mid_exp_paths)){ -->
<!--   y<-strsplit(mid_exp_paths[i,2],split = "") -->
<!--   y_counts_table<-table(y) -->
<!--   y_counts_vals<-as.numeric(y_counts_table) -->
<!--   y_entropy<-entropy(y_counts_vals,method = c("ML")) #calculate Shannon's Entropy  -->
<!--   mid_exp_paths$entropy[i]<-y_entropy -->
<!-- }  -->

<!-- midlife_analysis$entropy <- mid_exp_paths %>% .[,c("entropy")] -->

<!-- ``` -->

<!-- ### Turns Made -->
<!-- ```{r turns made mid} -->
<!-- midlife_analysis$turns <- mid_master_participant %>% pull(em_turns_count) -->
<!-- ``` -->
<!-- ### pause duration -->

<!-- ```{r paus dur} -->
<!-- midlife_analysis$pauses <- mid_master_participant %>% pull(em_average_RT) -->

<!-- ``` -->


<!-- ## Young Processing {.tabset .tabset-dropdown} -->

<!-- ### Cleaning exploration trials -->
<!-- ```{r explore trial young preprocessing } -->
<!-- yng_explore_trials <- yng_master_trial %>% filter(is.na(accuracy) == TRUE) -->
<!-- yng_explore_df<- data.frame(matrix(nrow = nrow(yng_explore_trials))) -->

<!-- for (i in 1:nrow(yng_explore_trials)){ -->
<!--   e_string_orient<-as.list(strsplit(yng_explore_trials$e_paths[i],split=" "))  -->
<!--   e_string<-as.list(strsplit(yng_explore_trials$paths[i],split=" "))  -->
<!--   F3_index<-which(sapply(e_string_orient[[1]], FUN=function(X) "F3" %in% X))+1   -->
<!--   e_string[[1]][F3_index]<-"N" #replacing with N -->
<!--   V2_index<-which(sapply(e_string_orient[[1]], FUN=function(X) "V2" %in% X))+1 -->
<!--   e_string[[1]][V2_index]<-"Y" #replacing with Y -->
<!--   e_string<-paste(e_string[[1]], collapse = " ")  -->
<!--   yng_explore_df[i,1]<-e_string  -->
<!-- } -->

<!-- yng_explore_df$Subject<-yng_explore_trials$Subject -->

<!-- yng_explore_df <- yng_explore_df %>% rename(paths = matrix.nrow...nrow.yng_explore_trials..)  -->

<!-- ``` -->

<!-- ```{r Young explore object and hallway processing } -->
<!-- #location visits -->
<!-- yng_big_explore<-as.data.frame(str_split_fixed(yng_explore_df$paths," ",nrow(yng_explore_df))) -->
<!-- yng_big_explore <- yng_big_explore %>% mutate(subject = yng_explore_df$Subject)  -->
<!-- yng_big_explore <-yng_big_explore[,c(ncol(yng_big_explore), 1:(ncol(yng_big_explore)-1))]  -->

<!-- row_labels<-c(1:nrow(yng_big_explore)) -->
<!-- yng_big_explore<- split( yng_big_explore , f = row_labels) -->

<!-- #for loop to find consecutive location repeats, and remove them  -->
<!-- for (i in 1:length(yng_big_explore)){ -->
<!--   yng_big_explore[[i]]<-t(yng_big_explore[[i]]) -->
<!--   yng_big_explore[[i]][yng_big_explore[[i]] == ""] <- NA  -->
<!--   repeat_logical<-t(c(NA, yng_big_explore[[i]]) == c(yng_big_explore[[i]], NA))[1:length(yng_big_explore[[i]])] -->
<!--   repeats<- grep("TRUE",repeat_logical) -->
<!--   yng_big_explore[[i]][repeats,1]<-"repeats"   -->
<!--   yng_big_explore[[i]]<-t(yng_big_explore[[i]]) -->
<!--   yng_big_explore[[i]]<-as.data.frame(yng_big_explore[[i]])  -->
<!-- } -->

<!-- yng_big_explore<-unsplit(yng_big_explore,row_labels)#merging all chunks back into single dataframe  -->
<!-- yng_big_explore[is.na(yng_big_explore)]<-"none" #replacing all NAs with string, otherwise for loop below won't work  -->

<!-- #for loop to determine location counts  -->
<!-- yng_big_explore_counts <- data.frame(matrix(ncol = 0, nrow = nrow(yng_big_explore)))#creating dataframe to store counts into   -->

<!-- for (i in locs){ -->
<!--   yng_big_explore_counts$subject <- yng_big_explore$subject -->
<!--   d <- as.data.frame(apply(yng_big_explore,1,function(x) sum(x==i))) # not sure what this function is -->
<!--   names(d) <- i -->
<!--   yng_big_explore_counts <- cbind(d, yng_big_explore_counts) -->
<!-- } -->

<!-- ``` -->
<!-- ### Object Visits -->
<!--   var output = midlife_analysis$TotalObjVisits  -->

<!-- ```{r Young Calculating Object visits} -->
<!-- #Young  -->
<!-- young_obj_visits <- yng_big_explore_counts %>%transmute(subject,A, I, L, K, N, O, P, Y, W)  -->
<!-- cols_sum<-c(2:length(young_obj_visits)) -->
<!-- yng_big_explore_counts$total= rowSums(yng_big_explore_counts[,cols_sum]) -->
<!-- yngObj_ave <-aggregate(yng_big_explore_counts$total, list(young_obj_visits$subject), FUN=mean) -->
<!-- young_analysis$TotalObjVisits <- yngObj_ave$x -->

<!-- ``` -->

<!-- ### Hallway Visits -->
<!-- ```{r Young Hallway visits} -->
<!-- #Young  -->
<!-- yng_hall_visits <- yng_big_explore_counts %>% transmute(subject,B, C, D, E, `F`,G, H, J, M, Q, R, S, `T`, U, V, X, Z) -->
<!-- cols_sum<-c(2:length(yng_hall_visits)) -->
<!-- yng_hall_visits$total<-rowSums(yng_hall_visits[,cols_sum])#finding total hallway counts for each subject for each session  -->
<!-- yng_hall_visits_mean<-aggregate(yng_hall_visits$total, list(yng_hall_visits$subject), FUN=mean) -->
<!-- young_analysis$TotalHallwayVisits<-yng_hall_visits_mean$x  -->

<!-- ``` -->
<!-- ### Evenness Objects -->
<!-- - var output = midlife_analysis$obj_evenness -->
<!-- ```{r Calculating evennes of evenness of object} -->
<!-- yng_spreadObjs <- -->
<!--   young_obj_visits %>% gather("location", "count", objects) %>% -->
<!--   pivot_wider( -->
<!--     id_cols = c("subject"), -->
<!--     names_from = location, -->
<!--     values_from = count, -->
<!--     values_fn = sum -->
<!--   ) -->
<!-- yng_spreadObjs <- -->
<!--   yng_spreadObjs %>% mutate(std = apply(yng_spreadObjs[objects], 1, sd)) -->

<!-- yng_flip_objs <- -->
<!--   yng_spreadObjs %>% gather("location", "count", objects) %>% pivot_wider( -->
<!--     id_cols = location, -->
<!--     names_from = subject, -->
<!--     values_from = count, -->
<!--     values_fn = sum -->
<!--   ) -->

<!-- yng_TotalVisits <- -->
<!--   as.data.frame(apply(yng_spreadObjs[objects], 2, sum)) %>% mutate(sd = apply(yng_spreadObjs[objects], 2, sd)) %>% mutate(location = yng_flip_objs$location) -->

<!-- young_analysis$obj_evenness <- yng_spreadObjs$std -->
<!-- ``` -->

<!-- ### Evenness hallways  -->
<!-- ```{r Evenness of hallways } -->

<!-- young_spreadHalls <- -->
<!--   yng_hall_visits %>% gather("location", "count",hallways) %>% -->
<!--   pivot_wider( -->
<!--     id_cols = c("subject"), -->
<!--     names_from = location, -->
<!--     values_from = count, -->
<!--     values_fn = sum -->
<!--   ) -->

<!-- young_spreadHalls <- -->
<!--   young_spreadHalls %>% mutate(std = apply(young_spreadHalls[hallways], 1, sd)) -->

<!-- yng_flip_halls <- -->
<!--   young_spreadHalls %>% gather("location", "count", hallways) %>% pivot_wider( -->
<!--     id_cols = location, -->
<!--     names_from = subject, -->
<!--     values_from = count, -->
<!--     values_fn = sum -->
<!--   ) -->

<!-- yng_totalhallvis <- -->
<!--   as.data.frame(apply(young_spreadHalls[hallways], 2, sum)) %>% mutate(sd = apply(young_spreadHalls[hallways], 2, sd)) %>% mutate(location = yng_flip_halls$location) -->

<!-- young_analysis$HallEvenness <- young_spreadHalls$std -->

<!-- ``` -->
<!-- ### Button Presses  -->
<!-- ```{r button presses} -->
<!-- yng_button_press_mean<-aggregate(yng_explore_trials$nodesturns_count, list(yng_explore_trials$Subject), FUN=mean) #calculating mean number of button presses -->

<!-- young_analysis$ButtonPress<-yng_button_press_mean$x  -->

<!-- ``` -->
<!-- ### Distance -->
<!-- ```{r} -->
<!-- young_analysis$Dist <- -->
<!--   yng_master_participant %>% pull(em_path_dist_trav) -->
<!-- ``` -->
<!-- ### Speed -->
<!-- ```{r} -->
<!-- young_analysis$speed<-yng_master_participant %>% dplyr::select(em_path_dist_trav) %>% .$em_path_dist_trav/480 -->
<!-- ``` -->

<!-- ### Entropy -->
<!-- ```{r Yng path roaming entropy processing} -->
<!-- #Path Roaming Entropy  -->
<!-- yng_exp_paths<-as.data.frame(yng_big_explore$subject) %>% `colnames<-`("subject") #building empty dataframe which we will populate with output from for loop below (part 1) -->
<!-- yng_exp_paths$paths<-rep("TBC",nrow(yng_exp_paths)) #adding TBCs for now, this will be replaced with output from for loop below  -->

<!-- #For loop to condense path trajectories from midlife_big_explore into single sequence, and remove "repeats" and "none" -->
<!-- for (i in 1:nrow(yng_big_explore)){ -->
<!--   cols<-2:length(yng_big_explore) #indexing columns to condense into single sequence  -->
<!--   yng_exp_paths[i,2]<-paste(yng_big_explore[i,cols], collapse = '') #combining all characters into single sequence  -->
<!--   yng_exp_paths[i,2]<-gsub('[repeatsnone]', '', yng_exp_paths[i,2])#removing strings "repeats" and "none" from sequence -->
<!-- } -->

<!-- #Combining each subject's exploration trajectories across both sessions into one exploration trajectory  -->
<!-- yng_exp_paths<- yng_exp_paths %>% group_by(subject) %>% mutate(newcol=paste(paths, collapse = '')) #combining trajectories for each subject -->
<!-- yng_exp_paths<- yng_exp_paths %>% filter (row_number() %% 2 !=0) #deletes even rows, which are duplicates with regards to combined trajectories  -->
<!-- names(yng_exp_paths)[names(yng_exp_paths) == 'newcol'] <- 'CombinedPaths' #renaming column  -->
<!-- yng_exp_paths<-as.data.frame(yng_exp_paths) #converting to df so that for loop below works  -->

<!-- #For loop to calculate path roaming entropies  -->
<!-- for (i in 1:nrow(yng_exp_paths)){ -->
<!--   y<-strsplit(yng_exp_paths[i,2],split = "") -->
<!--   y_counts_table<-table(y) -->
<!--   y_counts_vals<-as.numeric(y_counts_table) -->
<!--   y_entropy<-entropy(y_counts_vals,method = c("ML")) #calculate Shannon's Entropy  -->
<!--   yng_exp_paths$entropy[i]<-y_entropy -->
<!-- }  -->

<!-- young_analysis$entropy <- yng_exp_paths %>% .[,c("entropy")] -->

<!-- ``` -->


<!-- ### Turns made -->
<!-- ```{r turns made yng} -->

<!-- young_analysis$turns <- yng_master_participant %>% pull(em_turns_count) -->
<!-- ``` -->
<!-- ### Path duration -->

<!-- ```{r} -->
<!-- young_analysis$pauses <- yng_master_participant %>% pull(em_average_RT) -->

<!-- ``` -->


<!-- ### Export all vars -->
<!-- ```{r export CSVs so i dont need to run everything again} -->

<!-- write.csv(midlife_analysis, paste0(workdir,"Midlife_explorationVars.csv")) -->

<!-- write.csv(young_analysis, paste0(workdir,"young_explorationVars.csv")) -->
<!-- ``` -->



# <span style="color: pink;"> Sex differences analysis </span>  {.tabset}


```{r reading in our CSVs, echo=FALSE }
# for some reason there's a new column. Just ignore X
midlifeDF <- read.csv("/Users/danielacossio/Downloads/Midlife_explorationVars.csv")
youngDF <- read.csv("/Users/danielacossio/Downloads/young_explorationVars.csv") 

masterDF <- rbind(midlifeDF,youngDF)

mid_male <- midlifeDF %>% filter(sex=="Male")
mid_female <- midlifeDF %>% filter(sex=="Female")

yng_male <-youngDF %>% filter(sex=="Male")
yng_female <- youngDF %>% filter(sex=="Female")

``` 

## Summary Stats
<br>

<span style="color: black; font-size:18px; font-family:Arial; text-align:center">  Summary stats for midife males </span> 

```{r, echo=FALSE}
midlife_malestats<- get_summary_stats(mid_male[,6:length(mid_male)]) %>% select(variable,n,mean,sd,se) 

knitr::kable(midlife_malestats, row.names=F)%>%
  kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% scroll_box(width = "400px", height = "350")
```

<br><br>

<span style="color: black; font-size:18px; font-family:Arial; text-align:center">   Summary stats for midife females </span> 
```{r, echo=FALSE}
midlife_femalestats<- get_summary_stats(mid_female[,6:length(mid_female)]) %>% select(variable,n,mean,sd,se) 

knitr::kable(midlife_femalestats, row.names=F)%>%
  kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% scroll_box(width = "400px", height = "350")
```

<br><br>

<span style="color: black; font-size:18px; font-family:Arial; text-align:center"> Summary stats for young males </span> 
```{r, echo=FALSE}
yng_malestats<- get_summary_stats(yng_male[,6:length(yng_male)]) %>% select(variable,n,mean,sd,se) 

knitr::kable(yng_malestats, row.names=F)%>%
  kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% scroll_box(width = "400px", height = "350")
```
<br><br>

<span style="color: black; font-size:18px; font-family:Arial; text-align:center"> Summary stats for young female </span> 
```{r, echo=FALSE}
yng_femalestats<- get_summary_stats(yng_female[,6:length(yng_female)]) %>% select(variable,n,mean,sd,se) 

knitr::kable(yng_femalestats, row.names=F)%>%
  kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% scroll_box(width = "400px", height = "350")
```


## Object Visits {.tabset}

<span style="color: black; font-size:18px; font-family:Arial; text-align:center">  **Normality** </span>  

All groups data were normally distributed.

* **Midlife Males** : p = `r mid_male %>% .$TotalObjVisits %>% shapiro.test() %>% .[c("p.value")]`
  
* **Midlife females** : p = `r mid_female %>% .$TotalObjVisits %>% shapiro.test() %>% .[c("p.value")]`
  
* **Young males** : p = `r yng_male %>% .$TotalObjVisits %>% shapiro.test() %>% .[c("p.value")]` 

* **Young females** : p = `r yng_female %>% .$TotalObjVisits %>% shapiro.test() %>% .[c("p.value")]` 

<br><br>

<span style="color: black; font-size:18px; font-family:Arial; text-align:center"> **ANOVA and Effect Sizes** </span> 

Running a two factor anova with interactions. Main effect of sex and age but no interaction.
```{r Obj visit Anova}

Obj_aov <- aov(formula=TotalObjVisits ~ sex * agegroup, masterDF)
summary(Obj_aov)
```

<br>

Reporting effect sizes using eta squares
```{r Obj visit Effect sizes}
etaSquared(Obj_aov)
```

<br><br><br> 
<span style="color: black; font-size:18px; font-family:Arial; text-align:center"> **Post Hoc** </span>

Using Tukeys HSD
```{r}
TukeyHSD(Obj_aov)
```

<span style="color: black; font-size:18px; font-family:Arial; text-align:center"> **Plots** </span>
```{r}
masterDF %>% ggplot(aes(x=agegroup, y=TotalObjVisits, fill=sex)) +
  geom_boxplot() +
  scale_fill_manual(values=c("#CC79A7","#009E73"))

```







Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

## Hallway Visits {.tabset}

<span style="color: black; font-size:18px; font-family:Arial; text-align:center">  **Normality** </span>  

All groups data were normally distributed.

* **Midlife Males** : p = `r mid_male %>% .$TotalHallwayVisits %>% shapiro.test() %>% .[c("p.value")]`
  
* **Midlife females** : p = `r mid_female %>% .$TotalHallwayVisits %>% shapiro.test() %>% .[c("p.value")]`
  
* **Young males** : p = `r yng_male %>% .$TotalHallwayVisits %>% shapiro.test() %>% .[c("p.value")]` 

* **Young females** : p = `r yng_female %>% .$TotalHallwayVisits %>% shapiro.test() %>% .[c("p.value")]` 

<br><br>

<span style="color: black; font-size:18px; font-family:Arial; text-align:center"> **ANOVA and Effect Sizes** </span> 

Running a two factor anova with interactions. Main effect of age but not sex.
```{r hallway visit Anova}

Hallway_aov <- aov(formula=TotalHallwayVisits ~ sex * agegroup, masterDF)
summary(Hallway_aov)
```

<br>

Reporting effect sizes using eta squares
```{r hallway visit Effect sizes}
etaSquared(Hallway_aov)
```

<br><br><br> 
<span style="color: black; font-size:18px; font-family:Arial; text-align:center"> **Post Hoc** </span>

Using Tukeys HSD
```{r}
TukeyHSD(Hallway_aov)
```

<span style="color: black; font-size:18px; font-family:Arial; text-align:center"> **Plots** </span>
```{r}
masterDF %>% ggplot(aes(x=agegroup, y=TotalHallwayVisits, fill=sex)) +
  geom_boxplot() +
  scale_fill_manual(values=c("#CC79A7","#009E73"))
```

## Evenness of obj Visits {.tabset}

<span style="color: black; font-size:18px; font-family:Arial; text-align:center">  **Normality** </span>  

Midlife females were not normally distributed here.

* **Midlife Males** : p = `r mid_male %>% .$obj_evenness %>% shapiro.test() %>% .[c("p.value")]`
  
* **Midlife females** : p = `r mid_female %>% .$obj_evenness %>% shapiro.test() %>% .[c("p.value")]`
  
* **Young males** : p = `r yng_male %>% .$obj_evenness %>% shapiro.test() %>% .[c("p.value")]` 

* **Young females** : p = `r yng_female %>% .$obj_evenness %>% shapiro.test() %>% .[c("p.value")]` 

<br><br>

<span style="color: black; font-size:18px; font-family:Arial; text-align:center"> **ANOVA and Effect Sizes** </span> 

Running a two factor anova with interactions. Main effect of sex and age but no interaction
```{r obj_evenness_aov visit Anova}

obj_evenness_aov <- aov(formula=obj_evenness ~ sex * agegroup, masterDF)
summary(obj_evenness_aov)
```

<br>

Reporting effect sizes using eta squares
```{r obj_evenness visit Effect sizes}
etaSquared(obj_evenness_aov)
```

<br><br><br> 
<span style="color: black; font-size:18px; font-family:Arial; text-align:center"> **Post Hoc** </span>

Using Tukeys HSD
```{r}
 TukeyHSD(obj_evenness_aov)
```

<span style="color: black; font-size:18px; font-family:Arial; text-align:center"> **Plots** </span>
```{r}
masterDF %>% ggplot(aes(x=agegroup, y=obj_evenness, fill=sex)) +
  geom_boxplot() +
  scale_fill_manual(values=c("#CC79A7","#009E73"))
```


## Evenness of hallway Visits {.tabset}

<span style="color: black; font-size:18px; font-family:Arial; text-align:center">  **Normality** </span>  

Midlife females were not normally distributed here.

* **Midlife Males** : p = `r mid_male %>% .$HallEvenness %>% shapiro.test() %>% .[c("p.value")]`
  
* **Midlife females** : p = `r mid_female %>% .$HallEvenness %>% shapiro.test() %>% .[c("p.value")]`
  
* **Young males** : p = `r yng_male %>% .$HallEvenness %>% shapiro.test() %>% .[c("p.value")]` 

* **Young females** : p = `r yng_female %>% .$HallEvenness %>% shapiro.test() %>% .[c("p.value")]` 

<br><br>

<span style="color: black; font-size:18px; font-family:Arial; text-align:center"> **ANOVA and Effect Sizes** </span> 

Running a two factor anova with interactions. Main effect of age but not sex or any interactions
```{r hall_evenness_aov visit Anova}

hall_evenness_aov <- aov(formula=HallEvenness ~ sex * agegroup, masterDF)
summary(hall_evenness_aov)
```

<br>

Reporting effect sizes using eta squares
```{r HallEvenness visit Effect sizes}
etaSquared(hall_evenness_aov)
```

<br><br><br> 
<span style="color: black; font-size:18px; font-family:Arial; text-align:center"> **Post Hoc** </span>

Using Tukeys HSD
```{r}
 TukeyHSD(hall_evenness_aov)
```

<span style="color: black; font-size:18px; font-family:Arial; text-align:center"> **Plots** </span>
```{r}
masterDF %>% ggplot(aes(x=agegroup, y=HallEvenness, fill=sex)) +
  geom_boxplot() +
  scale_fill_manual(values=c("#CC79A7","#009E73"))
```

## Button Presses 

<span style="color: black; font-size:18px; font-family:Arial; text-align:center">  **Normality** </span>  

Midlife females and young females were not normally distributed here.


* **Midlife Males** : p = `r mid_male %>% .$ButtonPress %>% shapiro.test() %>% .[c("p.value")]`
  
* **Midlife females** : p = `r mid_female %>% .$ButtonPress %>% shapiro.test() %>% .[c("p.value")]`
  
* **Young males** : p = `r yng_male %>% .$ButtonPress %>% shapiro.test() %>% .[c("p.value")]` 

* **Young females** : p = `r yng_female %>% .$ButtonPress %>% shapiro.test() %>% .[c("p.value")]` 

<br><br>

<span style="color: black; font-size:18px; font-family:Arial; text-align:center"> **ANOVA and Effect Sizes** </span> 

Running a two factor anova with interactions. Main effect of age and sex.
```{r ButtonPress visit Anova}

ButtonPress_aov <- aov(formula=ButtonPress ~ sex * agegroup, masterDF)
summary(ButtonPress_aov)
```

<br>

Reporting effect sizes using eta squares
```{r button press visit Effect sizes}
etaSquared(ButtonPress_aov)
```

<br><br><br> 
<span style="color: black; font-size:18px; font-family:Arial; text-align:center"> **Post Hoc** </span>

Using Tukeys HSD
```{r}
 TukeyHSD(ButtonPress_aov)
```

<span style="color: black; font-size:18px; font-family:Arial; text-align:center"> **Plots** </span>
```{r}
masterDF %>% ggplot(aes(x=agegroup, y=ButtonPress, fill=sex)) +
  geom_boxplot() +
  scale_fill_manual(values=c("#CC79A7","#009E73"))
```

## distance
<span style="color: black; font-size:18px; font-family:Arial; text-align:center">  **Normality** </span>  

All groups except for midlife males were not normally distributed.


* **Midlife Males** : p = `r mid_male %>% .$Dist %>% shapiro.test() %>% .[c("p.value")]`
  
* **Midlife females** : p = `r mid_female %>% .$Dist %>% shapiro.test() %>% .[c("p.value")]`
  
* **Young males** : p = `r yng_male %>% .$Dist %>% shapiro.test() %>% .[c("p.value")]` 

* **Young females** : p = `r yng_female %>% .$Dist %>% shapiro.test() %>% .[c("p.value")]` 

<br><br>

<span style="color: black; font-size:18px; font-family:Arial; text-align:center"> **ANOVA and Effect Sizes** </span> 

Running a two factor anova with interactions. Main effect of age but not sex or any interactions
```{r Distance visit Anova}

Dist_aov <- aov(formula=Dist ~ sex * agegroup, masterDF)
summary(Dist_aov)
```

<br>

Reporting effect sizes using eta squares
```{r dist visit Effect sizes}
etaSquared(Dist_aov)
```

<br><br><br> 
<span style="color: black; font-size:18px; font-family:Arial; text-align:center"> **Post Hoc** </span>

Using Tukeys HSD
```{r}
 TukeyHSD(Dist_aov)
```

<span style="color: black; font-size:18px; font-family:Arial; text-align:center"> **Plots** </span>
```{r}
masterDF %>% ggplot(aes(x=agegroup, y=Dist, fill=sex)) +
  geom_boxplot() +
  scale_fill_manual(values=c("#CC79A7","#009E73"))
```

## speed

<span style="color: black; font-size:18px; font-family:Arial; text-align:center">  **Normality** </span>  

All groups data were normally distributed.

* **Midlife Males** : p = `r mid_male %>% .$speed %>% shapiro.test() %>% .[c("p.value")]`
  
* **Midlife females** : p = `r mid_female %>% .$speed %>% shapiro.test() %>% .[c("p.value")]`
  
* **Young males** : p = `r yng_male %>% .$speed %>% shapiro.test() %>% .[c("p.value")]` 

* **Young females** : p = `r yng_female %>% .$speed %>% shapiro.test() %>% .[c("p.value")]` 

<br><br>

<span style="color: black; font-size:18px; font-family:Arial; text-align:center"> **ANOVA and Effect Sizes** </span> 

Running a two factor anova with interactions. Main effect of age and sex but no interactions
```{r speed visit Anova}

speed_aov <- aov(formula=speed ~ sex * agegroup, masterDF)
summary(speed_aov)
```

<br>

Reporting effect sizes using eta squares
```{r speed visit Effect sizes}
etaSquared(speed_aov)
```

<br><br><br> 
<span style="color: black; font-size:18px; font-family:Arial; text-align:center"> **Post Hoc** </span>

Using Tukeys HSD
```{r}
 TukeyHSD(speed_aov)
```

<span style="color: black; font-size:18px; font-family:Arial; text-align:center"> **Plots** </span>
```{r}
masterDF %>% ggplot(aes(x=agegroup, y=speed, fill=sex)) +
  geom_boxplot() +
  scale_fill_manual(values=c("#CC79A7","#009E73"))
```

## Turns made 

<span style="color: black; font-size:18px; font-family:Arial; text-align:center">  **Normality** </span>  

All groups except for midlife males were not normally distributed.

* **Midlife Males** : p = `r mid_male %>% .$turns %>% shapiro.test() %>% .[c("p.value")]`
  
* **Midlife females** : p = `r mid_female %>% .$turns %>% shapiro.test() %>% .[c("p.value")]`
  
* **Young males** : p = `r yng_male %>% .$turns %>% shapiro.test() %>% .[c("p.value")]` 

* **Young females** : p = `r yng_female %>% .$turns %>% shapiro.test() %>% .[c("p.value")]` 

<br><br>

<span style="color: black; font-size:18px; font-family:Arial; text-align:center"> **ANOVA and Effect Sizes** </span> 

Running a two factor anova with interactions. No sex or age effects
```{r turns visit Anova}

turns_aov <- aov(formula=turns ~ sex * agegroup, masterDF)
summary(turns_aov)
```

<br>

Reporting effect sizes using eta squares
```{r turns visit Effect sizes}
etaSquared(turns_aov)
```

<br><br><br> 
<span style="color: black; font-size:18px; font-family:Arial; text-align:center"> **Post Hoc** </span>

Using Tukeys HSD
```{r}
 TukeyHSD(turns_aov)
```

<span style="color: black; font-size:18px; font-family:Arial; text-align:center"> **Plots** </span>
```{r}
masterDF %>% ggplot(aes(x=agegroup, y=turns, fill=sex)) +
  geom_boxplot() +
  scale_fill_manual(values=c("#CC79A7","#009E73"))
```

## Pause durations 

<span style="color: black; font-size:18px; font-family:Arial; text-align:center">  **Normality** </span>  

Only young females had normally distributed data.

* **Midlife Males** : p = `r mid_male %>% .$pauses %>% shapiro.test() %>% .[c("p.value")]`
  
* **Midlife females** : p = `r mid_female %>% .$pauses %>% shapiro.test() %>% .[c("p.value")]`
  
* **Young males** : p = `r yng_male %>% .$pauses %>% shapiro.test() %>% .[c("p.value")]` 

* **Young females** : p = `r yng_female %>% .$pauses %>% shapiro.test() %>% .[c("p.value")]` 

<br><br>

<span style="color: black; font-size:18px; font-family:Arial; text-align:center"> **ANOVA and Effect Sizes** </span> 

Running a two factor anova with interactions. Main effect of age but not sex
```{r pauses Anova}

pauses_aov <- aov(formula=pauses ~ sex * agegroup, masterDF)
summary(pauses_aov)
```

<br>

Reporting effect sizes using eta squares
```{r pause duration Effect sizes}
etaSquared(pauses_aov)
```

<br><br><br> 
<span style="color: black; font-size:18px; font-family:Arial; text-align:center"> **Post Hoc** </span>

Using Tukeys HSD
```{r}
 TukeyHSD(pauses_aov)
```

<span style="color: black; font-size:18px; font-family:Arial; text-align:center"> **Plots** </span>
```{r}
masterDF %>% ggplot(aes(x=agegroup, y=pauses, fill=sex)) +
  geom_boxplot() +
  scale_fill_manual(values=c("#CC79A7","#009E73"))
```

## entropy

<span style="color: black; font-size:18px; font-family:Arial; text-align:center">  **Normality** </span>  



* **Midlife Males** : p = `r mid_male %>% .$entropy %>% shapiro.test() %>% .[c("p.value")]`
  
* **Midlife females** : p = `r mid_female %>% .$entropy %>% shapiro.test() %>% .[c("p.value")]`
  
* **Young males** : p = `r yng_male %>% .$entropy %>% shapiro.test() %>% .[c("p.value")]` 

* **Young females** : p = `r yng_female %>% .$entropy %>% shapiro.test() %>% .[c("p.value")]` 

<br><br>

<span style="color: black; font-size:18px; font-family:Arial; text-align:center"> **ANOVA and Effect Sizes** </span> 

Running a two factor anova with interactions. Main effect of age but not sex
```{r entropy Anova}

entropy_aov <- aov(formula=entropy ~ sex * agegroup, masterDF)
summary(entropy_aov)
```

<br>

Reporting effect sizes using eta squares
```{r entropy duration Effect sizes}
etaSquared(entropy_aov)
```

<br><br><br> 
<span style="color: black; font-size:18px; font-family:Arial; text-align:center"> **Post Hoc** </span>

Using Tukeys HSD
```{r}
 TukeyHSD(entropy_aov)
```

<span style="color: black; font-size:18px; font-family:Arial; text-align:center"> **Plots** </span>
```{r}
masterDF %>% ggplot(aes(x=agegroup, y=entropy, fill=sex)) +
  geom_boxplot() +
  scale_fill_manual(values=c("#CC79A7","#009E73"))
```



