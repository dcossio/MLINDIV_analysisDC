for (i in 1:nrow(mid_explor)){
e_string_orient<-as.list(strsplit(mid_explor$e_paths[i],split=" "))
e_string<-as.list(strsplit(mid_explor$paths[i],split=" "))
F3_index<-which(sapply(e_string_orient[[1]], FUN=function(X) "F3" %in% X))+1
e_string[[1]][F3_index]<-"N" #replacing with N
V2_index<-which(sapply(e_string_orient[[1]], FUN=function(X) "V2" %in% X))+1
e_string[[1]][V2_index]<-"Y" #replacing with Y
e_string<-paste(e_string[[1]], collapse = " ")
mid_expl_df[i,1]<-e_string
}
mid_expl_df$Subject<-mid_explor$Subject
mid_expl_df <- mid_expl_df %>% rename(paths = matrix.nrow...nrow.mid_explor..)
mid_explr_Subinfo <- inner_join(mid_master_participant,mid_expl_df) %>% mutate(group = "midlife") %>% mutate(group=paste(sex,group))
yng_explor <- yng_master_trial %>% filter(is.na(accuracy) == TRUE)
yng_expl_df<- data.frame(matrix(nrow = nrow(yng_explor)))
for (i in 1:nrow(yng_explor)){
e_string_orient<-as.list(strsplit(yng_explor$e_paths[i],split=" "))
e_string<-as.list(strsplit(yng_explor$paths[i],split=" "))
F3_index<-which(sapply(e_string_orient[[1]], FUN=function(X) "F3" %in% X))+1
e_string[[1]][F3_index]<-"N" #replacing with N
V2_index<-which(sapply(e_string_orient[[1]], FUN=function(X) "V2" %in% X))+1
e_string[[1]][V2_index]<-"Y" #replacing with Y
e_string<-paste(e_string[[1]], collapse = " ")
yng_expl_df[i,1]<-e_string
}
yng_expl_df$Subject<-yng_explor$Subject
yng_expl_df <- yng_expl_df %>% rename(paths = matrix.nrow...nrow.yng_explor..)
yng_explr_Subinfo <- inner_join(yng_master_participant,yng_expl_df) %>% mutate(group = "young") %>% mutate(group=paste(sex,group))#same thing for young
#Let's look at the young men first
yng_male_analysis$Dist<- yng_master_participant %>% filter(sex == "Male") %>% pull(em_path_dist_trav)
shapiro.test(yng_male_analysis$Dist)  #not normal
# young female
yng_female_analysis$Dist<- yng_master_participant %>% filter(sex == "Female") %>% pull(em_path_dist_trav)
shapiro.test(yng_female_analysis$Dist) # not normal
# Lets do the young
wilcox.test(yng_female_analysis$Dist,yng_male_analysis$Dist) #no difference
# LEts do Midlife
mid_female_analysis$Dist<-mid_master_participant%>% filter(sex == "Female") %>% pull(em_path_dist_trav)
shapiro.test(mid_female_analysis$Dist)
#male
mid_male_analysis$Dist<-mid_master_participant%>% filter(sex == "Male") %>% pull(em_path_dist_trav)
shapiro.test(mid_male_analysis$Dist)
#Midlife women vs midlife men
wilcox.test(mid_female_analysis$Dist,mid_male_analysis$Dist) #0.03
# young female vs  midlife female
wilcox.test(mid_female_analysis$Dist,yng_female_analysis$Dist) # significant pvalue = 0.001139
#midlife women =217.6289
#yng=244.3077
# young men vs midlife men
wilcox.test(mid_male_analysis$Dist,yng_male_analysis$Dist) #not significantly different
# young men =248.3646
#midlife men = 233.9728
ym <- ggplot(yng_male_analysis, aes(x=Dist)) +
geom_histogram(bins=15)
yf <- ggplot(yng_female_analysis, aes(x=Dist)) +
geom_histogram(bins=15)
mm <- ggplot(mid_male_analysis,aes(x=Dist))+
geom_histogram(bins=15)
mf <- ggplot(mid_female_analysis, aes(x=Dist))+
geom_histogram(bins=15)
distance_distr <- ggarrange(ym,yf,mm,mf,
labels = c("Young Male", "Young Female", "Midlife Male","Midlife Female"),
font.label = list(size = 12, color = "red"),
vjust = 1.5,
ncol=2, nrow = 3)
annotate_figure(multi_plot,
top = text_grob("Visualizing mpg", color = "red", face = "bold", size = 14))
ym <- ggplot(yng_male_analysis, aes(x=Dist)) +
geom_histogram(bins=15)
yf <- ggplot(yng_female_analysis, aes(x=Dist)) +
geom_histogram(bins=15)
mm <- ggplot(mid_male_analysis,aes(x=Dist))+
geom_histogram(bins=15)
mf <- ggplot(mid_female_analysis, aes(x=Dist))+
geom_histogram(bins=15)
distance_distr <- ggarrange(ym,yf,mm,mf,
labels = c("Young Male", "Young Female", "Midlife Male","Midlife Female"),
font.label = list(size = 12, color = "red"),
vjust = 1.5,
ncol=2, nrow = 3)
annotate_figure(distance_distr,
top = text_grob("Visualizing mpg", color = "red", face = "bold", size = 14))
yng_male_analysis$Dist <- yng_master_participant %>% filter(sex == "Male") %>% pull(em_path_dist_trav)
yng_female_analysis$Dist<- yng_master_participant %>% filter(sex == "Female") %>% pull(em_path_dist_trav)
dist <- rbind(yng_male_analysis, yng_female_analysis)
#Midlife
mid_female_analysis$Dist<-mid_master_participant%>% filter(sex == "Female") %>% pull(em_path_dist_trav)
dist <- rbind(dist, mid_female_analysis)
#male
mid_male_analysis$Dist<-mid_master_participant%>% filter(sex == "Male") %>% pull(em_path_dist_trav)
dist <- rbind(dist, mid_male_analysis)
# Checking data distribution and normality
shapiro.test(yng_male_analysis$Dist)  # p-value = 0.04028
shapiro.test(yng_female_analysis$Dist) # p-value = 0.03625
shapiro.test(mid_female_analysis$Dist) # p-value = 0.01943
shapiro.test(mid_male_analysis$Dist) #p-value = 0.1104
# Plotting the distribution
ym <- ggplot(yng_male_analysis, aes(x=Dist)) +
geom_histogram(bins=10)
yf <- ggplot(yng_female_analysis, aes(x=Dist)) +
geom_histogram(bins=10)
mm <- ggplot(mid_male_analysis,aes(x=Dist))+
geom_histogram(bins=10)
mf <- ggplot(mid_female_analysis, aes(x=Dist))+
geom_histogram(bins=10)
distance_distr <- ggarrange(ym,yf,mm,mf,
labels = c("Young Male", "Young Female", "Midlife Male","Midlife Female"),
font.label = list(size = 12, color = "red"),
vjust = 1.5,
ncol=2, nrow = 3)
annotate_figure(distance_distr,
top = text_grob("Visualizing mpg", color = "red", face = "bold", size = 14))
#1) is to create a df with a column for sex, column for age and column for distance and run anova on that way
dist_aov <-  aov(formula=Dist ~ sex * age, dist)
summary(dist_aov)
pairwise.t.test(dist$Dist, dist$group, p.adj="bonferroni")
TukeyHSD(dist_aov)
View(mid_male_analysis)
yng_male_analysis$speed <-yng_master_participant %>% filter(sex == "Male") %>% select(em_path_dist_trav) %>% .$em_path_dist_trav/480
yng_female_analysis$speed<- yng_master_participant %>% filter(sex == "Female") %>% select(em_path_dist_trav) %>% .$em_path_dist_trav/480
Speed <- rbind(yng_female_analysis,  yng_male_analysis)
#Midlife
mid_female_analysis$speed<-mid_master_participant%>% filter(sex == "Female") %>% select(em_path_dist_trav) %>% .$em_path_dist_trav/480
Speed <- rbind(Speed, mid_female_analysis)
#male
mid_male_analysis$speed<-mid_master_participant%>% filter(sex == "Male") %>% select(em_path_dist_trav) %>% .$em_path_dist_trav/480
Speed <- rbind( Speed,  mid_male_analysis) %>% select(!(Dist))
#Normality test to assess whether samples are normally distributed
# Midlife
shapiro.test(mid_female_analysis$speed) #p=0.019
shapiro.test(mid_male_analysis$speed)# p =.1104
#young
shapiro.test(yng_female_analysis$speed) #p= 0.03
shapiro.test(yng_male_analysis$speed)# p = 0,.04
# Plotting the distribution
ym <- ggplot(yng_male_analysis, aes(x=speed)) +
geom_histogram(bins=15)
yf <- ggplot(yng_female_analysis, aes(x=speed)) +
geom_histogram(bins=15)
mm <- ggplot(mid_male_analysis,aes(x=speed))+
geom_histogram(bins=15)
mf <- ggplot(mid_female_analysis, aes(x=speed))+
geom_histogram(bins=15)
multi_plot <- ggarrange(ym,yf,mm,mf,
labels = c("Young Male", "Young Female", "Midlife Male","Midlife Female"),
font.label = list(size = 12, color = "red"),
vjust = 1.5,
ncol=2, nrow = 3)
annotate_figure(multi_plot,
top = text_grob("Visualizing mpg", color = "red", face = "bold", size = 14))
multi_plot
#does the plot have a common legend)
#1) is to create a df with a column for sex, column for age and column for distance and run anova on that way
speed_aov <-  aov(formula=speed ~ sex * age,Speed)
summary(speed_aov)
# not significant
pairwise.t.test(dist$Dist, dist$group, p.adj="bonferroni")
TukeyHSD(dist_aov)
summary(speed_aov)
pairwise.t.test(dist$Dist, dist$group, p.adj="bonferroni")
TukeyHSD(dist_aov)
mid_big_explore<-as.data.frame(str_split_fixed(mid_expl_df$paths," ",nrow(mid_expl_df)))
mid_big_explore <- mid_big_explore %>% mutate(subject = mid_expl_df$Subject)
mid_big_explore <-mid_big_explore[,c(ncol(mid_big_explore), 1:(ncol(mid_big_explore)-1))]
row_labels<-c(1:nrow(mid_big_explore))
mid_big_explore<- split( mid_big_explore , f = row_labels)
#for loop to find consecutive location repeats, and remove them
for (i in 1:length(mid_big_explore)){
mid_big_explore[[i]]<-t(mid_big_explore[[i]])
mid_big_explore[[i]][mid_big_explore[[i]] == ""] <- NA
repeat_logical<-t(c(NA, mid_big_explore[[i]]) == c(mid_big_explore[[i]], NA))[1:length(mid_big_explore[[i]])]
repeats<- grep("TRUE",repeat_logical)
mid_big_explore[[i]][repeats,1]<-"repeats"
mid_big_explore[[i]]<-t(mid_big_explore[[i]])
mid_big_explore[[i]]<-as.data.frame(mid_big_explore[[i]])
}
mid_big_explore<-unsplit(mid_big_explore,row_labels)#merging all chunks back into single dataframe
mid_big_explore[is.na(mid_big_explore)]<-"none" #replacing all NAs with string, otherwise for loop below won't work
mid_big_explore <-  mid_big_explore %>% mutate(sex = mid_explr_Subinfo$sex)
#for loop to determine location counts
mid_big_explore_counts <- data.frame(matrix(ncol = 0, nrow = nrow(mid_big_explore)))#creating dataframe to store counts into
for (i in locs){
mid_big_explore_counts$subject <- mid_big_explore$subject
d <- as.data.frame(apply(mid_big_explore,1,function(x) sum(x==i))) # not sure what this function is
names(d) <- i
mid_big_explore_counts <- cbind(d, mid_big_explore_counts)
}
mid_big_explore_counts <- mid_big_explore_counts %>% mutate(sex=mid_explr_Subinfo$sex) %>% mutate(group =mid_explr_Subinfo$group)
#location visits
yng_big_explore<-as.data.frame(str_split_fixed(yng_expl_df$paths," ",nrow(yng_expl_df)))
yng_big_explore <- yng_big_explore %>% mutate(subject = yng_expl_df$Subject)
yng_big_explore <-yng_big_explore[,c(ncol(yng_big_explore), 1:(ncol(yng_big_explore)-1))]
row_labels<-c(1:nrow(yng_big_explore))
yng_big_explore<- split( yng_big_explore , f = row_labels)
#for loop to find consecutive location repeats, and remove them
for (i in 1:length(yng_big_explore)){
yng_big_explore[[i]]<-t(yng_big_explore[[i]])
yng_big_explore[[i]][yng_big_explore[[i]] == ""] <- NA
repeat_logical<-t(c(NA, yng_big_explore[[i]]) == c(yng_big_explore[[i]], NA))[1:length(yng_big_explore[[i]])]
repeats<- grep("TRUE",repeat_logical)
yng_big_explore[[i]][repeats,1]<-"repeats"
yng_big_explore[[i]]<-t(yng_big_explore[[i]])
yng_big_explore[[i]]<-as.data.frame(yng_big_explore[[i]])
}
yng_big_explore<-unsplit(yng_big_explore,row_labels)#merging all chunks back into single dataframe
yng_big_explore[is.na(yng_big_explore)]<-"none" #replacing all NAs with string, otherwise for loop below won't work
yng_big_explore <-  yng_big_explore %>% mutate(sex = yng_explr_Subinfo$sex)
#for loop to determine location counts
yng_big_explore_counts <- data.frame(matrix(ncol = 0, nrow = nrow(yng_big_explore)))#creating dataframe to store counts into
for (i in locs){
yng_big_explore_counts$subject <- yng_big_explore$subject
d <- as.data.frame(apply(yng_big_explore,1,function(x) sum(x==i))) # not sure what this function is
names(d) <- i
yng_big_explore_counts <- cbind(d, yng_big_explore_counts)
}
yng_big_explore_counts <- yng_big_explore_counts %>% mutate(sex=yng_explr_Subinfo$sex) %>% mutate(group =yng_explr_Subinfo$group)
#midlife
male_obj_visits <- mid_big_explore_counts %>% filter(sex=="Male") %>%   transmute(subject,sex,group, A, I, L, K, N, O, P, Y, W)
cols_sum<-c(4:length(male_obj_visits))
male_obj_visits$total= rowSums(male_obj_visits[,cols_sum])
mObj_ave <-aggregate(male_obj_visits$total, list(male_obj_visits$subject), FUN=mean)
mid_male_analysis$TotalObjVisits <- mObj_ave$x
#females
female_obj_visits <- mid_big_explore_counts %>% filter(sex=="Female") %>%   transmute(subject,sex,group, A, I, L, K, N, O, P, Y, W)
cols_sum<-c(4:length(female_obj_visits))
female_obj_visits$total= rowSums(female_obj_visits[,cols_sum])
fObj_ave <- aggregate(female_obj_visits$total, list(female_obj_visits$subject), FUN=mean)
mid_female_analysis$TotalObjVisits<-fObj_ave$x
#Object Visits- Normality test to assess whether samples are normally distributed
shapiro.test(mid_male_analysis$TotalObjVisits) #normal
shapiro.test(mid_female_analysis$TotalObjVisits) # normal
ObjVisits <- rbind(mid_female_analysis,mid_male_analysis)
# GRabbing the young group
yng_male_obj_visits <- yng_big_explore_counts %>% filter(sex=="Male") %>%   transmute(subject,sex,group, A, I, L, K, N, O, P, Y, W)
cols_sum<-c(4:length(yng_male_obj_visits))
yng_male_obj_visits$total= rowSums(yng_male_obj_visits[,cols_sum])
yng_mObj_ave <-aggregate(yng_male_obj_visits$total, list(yng_male_obj_visits$subject), FUN=mean)
yng_male_analysis$TotalObjVisits <- yng_mObj_ave$x
ObjVisits <- rbind(ObjVisits,yng_male_analysis)
#females
yng_female_obj_visits <- yng_big_explore_counts %>% filter(sex=="Female") %>%   transmute(subject,sex, A, I, L, K, N, O, P, Y, W)
cols_sum<-c(3:length(yng_female_obj_visits))
yng_female_obj_visits$total= rowSums(yng_female_obj_visits[,cols_sum])
fObj_ave <- aggregate(yng_female_obj_visits$total, list(yng_female_obj_visits$subject), FUN=mean)
yng_female_analysis$TotalObjVisits<-fObj_ave$x
ObjVisits <- rbind(ObjVisits,yng_female_analysis) %>% select(!(Dist)) %>% select(!(speed))
shapiro.test(yng_male_analysis$TotalObjVisits) #normal
shapiro.test(yng_female_analysis$TotalObjVisits) # normal
# or do you do
Obj_aov <- aov(formula=TotalObjVisits ~ sex * age ,ObjVisits)
summary(Obj_aov)
#midlife
male_obj_visits <- mid_big_explore_counts %>% filter(sex=="Male") %>%   transmute(subject,sex,group, A, I, L, K, N, O, P, Y, W)
cols_sum<-c(4:length(male_obj_visits))
male_obj_visits$total= rowSums(male_obj_visits[,cols_sum])
mObj_ave <-aggregate(male_obj_visits$total, list(male_obj_visits$subject), FUN=mean)
mid_male_analysis$TotalObjVisits <- mObj_ave$x
#females
female_obj_visits <- mid_big_explore_counts %>% filter(sex=="Female") %>%   transmute(subject,sex,group, A, I, L, K, N, O, P, Y, W)
cols_sum<-c(4:length(female_obj_visits))
female_obj_visits$total= rowSums(female_obj_visits[,cols_sum])
fObj_ave <- aggregate(female_obj_visits$total, list(female_obj_visits$subject), FUN=mean)
mid_female_analysis$TotalObjVisits<-fObj_ave$x
ObjVisits <- rbind(mid_female_analysis,mid_male_analysis)
# GRabbing the young group
yng_male_obj_visits <- yng_big_explore_counts %>% filter(sex=="Male") %>%   transmute(subject,sex,group, A, I, L, K, N, O, P, Y, W)
cols_sum<-c(4:length(yng_male_obj_visits))
yng_male_obj_visits$total= rowSums(yng_male_obj_visits[,cols_sum])
yng_mObj_ave <-aggregate(yng_male_obj_visits$total, list(yng_male_obj_visits$subject), FUN=mean)
yng_male_analysis$TotalObjVisits <- yng_mObj_ave$x
ObjVisits <- rbind(ObjVisits,yng_male_analysis)
#females
yng_female_obj_visits <- yng_big_explore_counts %>% filter(sex=="Female") %>%   transmute(subject,sex, A, I, L, K, N, O, P, Y, W)
cols_sum<-c(3:length(yng_female_obj_visits))
yng_female_obj_visits$total= rowSums(yng_female_obj_visits[,cols_sum])
fObj_ave <- aggregate(yng_female_obj_visits$total, list(yng_female_obj_visits$subject), FUN=mean)
yng_female_analysis$TotalObjVisits<-fObj_ave$x
ObjVisits <- rbind(ObjVisits,yng_female_analysis) %>% select(!(Dist)) %>% select(!(speed))
# Data distribution and nromality
shapiro.test(mid_male_analysis$TotalObjVisits) #normal
shapiro.test(mid_female_analysis$TotalObjVisits) # normal
shapiro.test(yng_male_analysis$TotalObjVisits) #normal
shapiro.test(yng_female_analysis$TotalObjVisits) # normal
ym <- ggplot(yng_male_analysis, aes(x=TotalObjVisits)) +
geom_histogram(bins=15)
yf <- ggplot(yng_female_analysis, aes(x=TotalObjVisits)) +
geom_histogram(bins=15)
mm <- ggplot(mid_male_analysis,aes(x=TotalObjVisits))+
geom_histogram(bins=15)
mf <- ggplot(mid_female_analysis, aes(x=TotalObjVisits))+
geom_histogram(bins=15)
obj_distr <- ggarrange(ym,yf,mm,mf,
labels = c("Young Male", "Young Female", "Midlife Male","Midlife Female"),
font.label = list(size = 12, color = "red"),
vjust = 1.5,
ncol=2, nrow = 3)
annotate_figure(obj_distr,
top = text_grob("distribution", color = "red", face = "bold", size = 14))
#does the plot have a common legend)
# or do you do
Obj_aov <- aov(formula=TotalObjVisits ~ sex * age ,ObjVisits)
summary(Obj_aov)
#midlife
male_obj_visits <- mid_big_explore_counts %>% filter(sex=="Male") %>%   transmute(subject,sex,group, A, I, L, K, N, O, P, Y, W)
cols_sum<-c(4:length(male_obj_visits))
male_obj_visits$total= rowSums(male_obj_visits[,cols_sum])
mObj_ave <-aggregate(male_obj_visits$total, list(male_obj_visits$subject), FUN=mean)
mid_male_analysis$TotalObjVisits <- mObj_ave$x
#females
female_obj_visits <- mid_big_explore_counts %>% filter(sex=="Female") %>%   transmute(subject,sex,group, A, I, L, K, N, O, P, Y, W)
cols_sum<-c(4:length(female_obj_visits))
female_obj_visits$total= rowSums(female_obj_visits[,cols_sum])
fObj_ave <- aggregate(female_obj_visits$total, list(female_obj_visits$subject), FUN=mean)
mid_female_analysis$TotalObjVisits<-fObj_ave$x
ObjVisits <- rbind(mid_female_analysis,mid_male_analysis)
# GRabbing the young group
yng_male_obj_visits <- yng_big_explore_counts %>% filter(sex=="Male") %>%   transmute(subject,sex,group, A, I, L, K, N, O, P, Y, W)
cols_sum<-c(4:length(yng_male_obj_visits))
yng_male_obj_visits$total= rowSums(yng_male_obj_visits[,cols_sum])
yng_mObj_ave <-aggregate(yng_male_obj_visits$total, list(yng_male_obj_visits$subject), FUN=mean)
yng_male_analysis$TotalObjVisits <- yng_mObj_ave$x
ObjVisits <- rbind(ObjVisits,yng_male_analysis)
#females
yng_female_obj_visits <- yng_big_explore_counts %>% filter(sex=="Female") %>%   transmute(subject,sex, A, I, L, K, N, O, P, Y, W)
cols_sum<-c(3:length(yng_female_obj_visits))
yng_female_obj_visits$total= rowSums(yng_female_obj_visits[,cols_sum])
fObj_ave <- aggregate(yng_female_obj_visits$total, list(yng_female_obj_visits$subject), FUN=mean)
yng_female_analysis$TotalObjVisits<-fObj_ave$x
ObjVisits <- rbind(ObjVisits,yng_female_analysis) %>% select(!(Dist)) %>% select(!(speed))
# Data distribution and nromality
shapiro.test(mid_male_analysis$TotalObjVisits) #normal
shapiro.test(mid_female_analysis$TotalObjVisits) # normal
shapiro.test(yng_male_analysis$TotalObjVisits) #normal
shapiro.test(yng_female_analysis$TotalObjVisits) # normal
ym <- ggplot(yng_male_analysis, aes(x=TotalObjVisits)) +
geom_histogram(bins=5)
yf <- ggplot(yng_female_analysis, aes(x=TotalObjVisits)) +
geom_histogram(bins=5)
mm <- ggplot(mid_male_analysis,aes(x=TotalObjVisits))+
geom_histogram(bins=5)
mf <- ggplot(mid_female_analysis, aes(x=TotalObjVisits))+
geom_histogram(bins=5)
obj_distr <- ggarrange(ym,yf,mm,mf,
labels = c("Young Male", "Young Female", "Midlife Male","Midlife Female"),
font.label = list(size = 12, color = "red"),
vjust = 1.5,
ncol=2, nrow = 3)
annotate_figure(obj_distr,
top = text_grob("distribution", color = "red", face = "bold", size = 14))
#does the plot have a common legend)
# or do you do
Obj_aov <- aov(formula=TotalObjVisits ~ sex * age ,ObjVisits)
summary(Obj_aov)
#midlife male
mid_male_hall_visits <- mid_big_explore_counts %>% filter(sex =="Male") %>% transmute(subject,sex,group, B, C, D, E, `F`, G, H, J, M, Q, R, S, `T`, U, V, X, Z)
cols_sum<-c(4:length(mid_male_hall_visits))
mid_male_hall_visits$total<-rowSums(mid_male_hall_visits[,cols_sum])#finding total hallway counts for each subject for each session
mid_male_hall_visits_mean<-aggregate(mid_male_hall_visits$total, list(mid_male_hall_visits$subject), FUN=mean)
mid_male_analysis$TotalHallwayVisits<-mid_male_hall_visits_mean$x
# midlife female
mid_female_hall_visits <- mid_big_explore_counts %>% filter(sex =="Female") %>%   transmute(subject,sex,group, B, C, D, E, `F`, G, H, J, M, Q, R, S, `T`, U, V, X, Z)
cols_sum<-c(4:length(mid_female_hall_visits))
mid_female_hall_visits$total<-rowSums(mid_female_hall_visits[,cols_sum])#finding total hallway counts for each subject for each session
mid_female_hall_visits_mean<-aggregate(mid_female_hall_visits$total, list(mid_female_hall_visits$subject), FUN=mean)
mid_female_analysis$TotalHallwayVisits<-mid_female_hall_visits_mean$x
halls <- rbind(mid_female_analysis,mid_male_analysis)
#Young male
yng_male_hall_visits <- yng_big_explore_counts %>% filter(sex =="Male") %>%   transmute(subject,sex,group, B, C, D, E, `F`, G, H, J, M, Q, R, S, `T`, U, V, X, Z)
cols_sum<-c(4:length(yng_male_hall_visits))
yng_male_hall_visits$total<-rowSums(yng_male_hall_visits[,cols_sum])#finding total hallway counts for each subject for each session
yng_male_hall_visits_mean<-aggregate(yng_male_hall_visits$total, list(yng_male_hall_visits$subject), FUN=mean)
yng_male_analysis$TotalHallwayVisits<-yng_male_hall_visits_mean$x
halls <- rbind(halls,yng_male_analysis)
# ynglife female
yng_female_hall_visits <- yng_big_explore_counts %>% filter(sex =="Female") %>%   transmute(subject,sex,group, B, C, D, E, `F`, G, H, J, M, Q, R, S, `T`, U, V, X, Z)
cols_sum<-c(4:length(yng_female_hall_visits))
yng_female_hall_visits$total<-rowSums(yng_female_hall_visits[,cols_sum])#finding total hallway counts for each subject for each session
yng_female_hall_visits_mean<-aggregate(yng_female_hall_visits$total, list(yng_female_hall_visits$subject), FUN=mean)
yng_female_analysis$TotalHallwayVisits<-yng_female_hall_visits_mean$x
halls <- rbind(halls,yng_female_analysis) %>% select(sex,age,group,TotalHallwayVisits)
#normality distribution
shapiro.test(yng_male_analysis$TotalHallwayVisits) #normal
shapiro.test(yng_female_analysis$TotalHallwayVisits)
shapiro.test(mid_male_analysis$TotalHallwayVisits) #normal
shapiro.test(mid_female_analysis$TotalHallwayVisits)
ym <- ggplot(yng_male_analysis, aes(x=TotalHallwayVisits)) +
geom_histogram(bins=5)
yf <- ggplot(yng_female_analysis, aes(x=TotalHallwayVisits)) +
geom_histogram(bins=5)
mm <- ggplot(mid_male_analysis,aes(x=TotalHallwayVisits))+
geom_histogram(bins=5)
mf <- ggplot(mid_female_analysis, aes(x=TotalHallwayVisits))+
geom_histogram(bins=5)
hall_distr <- ggarrange(ym,yf,mm,mf,
labels = c("Young Male", "Young Female", "Midlife Male","Midlife Female"),
font.label = list(size = 12, color = "red"),
vjust = 1.5,
ncol=2, nrow = 3)
annotate_figure(obj_distr,
top = text_grob("distribution", color = "red", face = "bold", size = 14))
#does the plot have a common legend)
# analysis
hallvis_aov<- aov(formula=TotalHallwayVisits ~ sex*age ,halls)
summary(hallvis_aov)
View(yng_female_analysis)
yng_female_analysis$turns <- mid_master_participant %>% filter(sex == "Female") %>% select(em_turns_count)
yng_female_analysis$turns <- yng_master_participant %>% filter(sex == "Female") %>% select(em_turns_count)
yng_female_analysis$turns <- yng_master_participant %>% filter(sex == "Female") %>% pull(em_turns_count)
class(yng_female_analysis$turns)
yng_male_analysis$turns <- yng_master_participant %>% filter(sex == "Male") %>% pull(em_turns_count)
mid_female_analysis$turns <- mid_master_participant%>% filter(sex == "Female") %>% pull(em_turns_count)
#midlife male
mid_male_hall_visits <- mid_big_explore_counts %>% filter(sex =="Male") %>% transmute(subject,sex,group, B, C, D, E, `F`, G, H, J, M, Q, R, S, `T`, U, V, X, Z)
cols_sum<-c(4:length(mid_male_hall_visits))
mid_male_hall_visits$total<-rowSums(mid_male_hall_visits[,cols_sum])#finding total hallway counts for each subject for each session
mid_male_hall_visits_mean<-aggregate(mid_male_hall_visits$total, list(mid_male_hall_visits$subject), FUN=mean)
mid_male_analysis$TotalHallwayVisits<-mid_male_hall_visits_mean$x
# midlife female
mid_female_hall_visits <- mid_big_explore_counts %>% filter(sex =="Female") %>%   transmute(subject,sex,group, B, C, D, E, `F`, G, H, J, M, Q, R, S, `T`, U, V, X, Z)
cols_sum<-c(4:length(mid_female_hall_visits))
mid_female_hall_visits$total<-rowSums(mid_female_hall_visits[,cols_sum])#finding total hallway counts for each subject for each session
mid_female_hall_visits_mean<-aggregate(mid_female_hall_visits$total, list(mid_female_hall_visits$subject), FUN=mean)
mid_female_analysis$TotalHallwayVisits<-mid_female_hall_visits_mean$x
halls <- rbind(mid_female_analysis,mid_male_analysis)
yng_female_analysis$turns <- yng_master_participant %>% filter(sex == "Female") %>% pull(em_turns_count)
yng_male_analysis$turns <- yng_master_participant %>% filter(sex == "Male") %>% pull(em_turns_count)
# MIDLIFE
mid_male_analysis$turns <- mid_master_participant%>% filter(sex == "Male") %>% pull(em_turns_count)
mid_female_analysis$turns <- mid_master_participant%>% filter(sex == "Female") %>% pull(em_turns_count)
View(mid_male_analysis)
View(mid_female_analysis)
yng_female_analysis$turns <- yng_master_participant %>% filter(sex == "Female") %>% pull(em_turns_count)
yng_male_analysis$turns <- yng_master_participant %>% filter(sex == "Male") %>% pull(em_turns_count)
Turns <- rbind(yng_female_analysis,yng_male_analysis )
# MIDLIFE
mid_male_analysis$turns <- mid_master_participant%>% filter(sex == "Male") %>% pull(em_turns_count)
Turns <- rbind(turns,mid_male_analysis)
mid_male_analysis$turns <- mid_master_participant%>% filter(sex == "Male") %>% pull(em_turns_count)
View(mid_male_analysis)
yng_female_analysis$turns <- yng_master_participant %>% filter(sex == "Female") %>% pull(em_turns_count)
yng_male_analysis$turns <- yng_master_participant %>% filter(sex == "Male") %>% pull(em_turns_count)
Turns <- rbind(yng_female_analysis,yng_male_analysis )
# MIDLIFE
mid_male_analysis$turns <- mid_master_participant%>% filter(sex == "Male") %>% pull(em_turns_count)
Turns <- rbind(Turns,mid_male_analysis)
mid_female_analysis$turns <- mid_master_participant%>% filter(sex == "Female") %>% pull(em_turns_count)
Turns <- rbind(Turns,mid_female_analysis) %>% select(Subject,sex,age,group,turns)
#young MAle and Female
yng_female_analysis$turns <- yng_master_participant %>% filter(sex == "Female") %>% pull(em_turns_count)
yng_male_analysis$turns <- yng_master_participant %>% filter(sex == "Male") %>% pull(em_turns_count)
Turns <- rbind(yng_female_analysis,yng_male_analysis )
# MIDLIFE
mid_male_analysis$turns <- mid_master_participant%>% filter(sex == "Male") %>% pull(em_turns_count)
Turns <- rbind(Turns,mid_male_analysis)
mid_female_analysis$turns <- mid_master_participant%>% filter(sex == "Female") %>% pull(em_turns_count)
Turns <- rbind(Turns,mid_female_analysis) %>% select(Subject,sex,age,group,turns)
#Normality test to assess whether samples are normally distributed
shapiro.test(yng_female_analysis$turns)
shapiro.test(yng_male_analysis$turns)
shapiro.test(mid_female_analysis$turns)
shapiro.test(mid_male_analysis$turns)
ym <- ggplot(yng_male_analysis, aes(x=turns)) +
geom_histogram(bins=5)
yf <- ggplot(yng_female_analysis, aes(x=turns)) +
geom_histogram(bins=5)
mm <- ggplot(mid_male_analysis,aes(x=turns))+
geom_histogram(bins=5)
mf <- ggplot(mid_female_analysis, aes(x=turns))+
geom_histogram(bins=5)
turns_distr <- ggarrange(ym,yf,mm,mf,
labels = c("Young Male", "Young Female", "Midlife Male","Midlife Female"),
font.label = list(size = 12, color = "red"),
vjust = 1.5,
ncol=2, nrow = 3)
annotate_figure(turns_distr,
top = text_grob("distribution", color = "red", face = "bold", size = 14))
#does the plot have a common legend)
# analysis
turns_aov<- aov(formula=TotalHallwayVisits ~ sex*age ,Turns)
#young MAle and Female
yng_female_analysis$turns <- yng_master_participant %>% filter(sex == "Female") %>% pull(em_turns_count)
yng_male_analysis$turns <- yng_master_participant %>% filter(sex == "Male") %>% pull(em_turns_count)
Turns <- rbind(yng_female_analysis,yng_male_analysis )
# MIDLIFE
mid_male_analysis$turns <- mid_master_participant%>% filter(sex == "Male") %>% pull(em_turns_count)
Turns <- rbind(Turns,mid_male_analysis)
mid_female_analysis$turns <- mid_master_participant%>% filter(sex == "Female") %>% pull(em_turns_count)
Turns <- rbind(Turns,mid_female_analysis) %>% select(Subject,sex,age,group,turns)
#Normality test to assess whether samples are normally distributed
shapiro.test(yng_female_analysis$turns)
shapiro.test(yng_male_analysis$turns)
shapiro.test(mid_female_analysis$turns)
shapiro.test(mid_male_analysis$turns)
ym <- ggplot(yng_male_analysis, aes(x=turns)) +
geom_histogram(bins=5)
yf <- ggplot(yng_female_analysis, aes(x=turns)) +
geom_histogram(bins=5)
mm <- ggplot(mid_male_analysis,aes(x=turns))+
geom_histogram(bins=5)
mf <- ggplot(mid_female_analysis, aes(x=turns))+
geom_histogram(bins=5)
turns_distr <- ggarrange(ym,yf,mm,mf,
labels = c("Young Male", "Young Female", "Midlife Male","Midlife Female"),
font.label = list(size = 12, color = "red"),
vjust = 1.5,
ncol=2, nrow = 3)
annotate_figure(turns_distr,
top = text_grob("distribution", color = "red", face = "bold", size = 14))
#does the plot have a common legend)
# analysis
turns_aov<- aov(formula=turns ~ sex*age ,Turns)
summary(turns_aov)
