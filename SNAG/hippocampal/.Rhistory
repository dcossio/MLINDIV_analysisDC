"testosterone_scan_ng_dl",
"estradiol_spatial_pg_ml",
"progesterone_spatial_ng_ml",
"fsh_spatial_miu_ml",
"shbg_spatial_nmol_l",
"dheas_spatial_ug_dl",
"testosterone_spatial_ng_dl"
)
df <- read.csv("hippocampalsubs.csv") %>% select(columns2grab)
df <- filter(df, df$subject_id != 0)
#Create T2 total hipp and MTL, averaged and L/R
df <-
df %>%  mutate(
avg_total_hipp = t2hipp_vol_avg_ca1 + t2hipp_vol_avg_ca23 + t2hipp_vol_avg_dg + t2hipp_vol_avg_sub,
left_total_hipp = t2hipp_vol_left_ca1 + t2hipp_vol_left_ca23 + t2hipp_vol_left_dg + t2hipp_vol_left_sub,
right_total_hipp = t2hipp_vol_right_ca1 + t2hipp_vol_right_ca23 + t2hipp_vol_right_dg + t2hipp_vol_right_sub,
avg_mtl = t2hipp_vol_avg_ca1 + t2hipp_vol_avg_ca23 + t2hipp_vol_avg_dg + t2hipp_vol_avg_sub + t2hipp_vol_avg_erc + t2hipp_vol_avg_phc + t2hipp_vol_avg_prc,
left_mtl = t2hipp_vol_left_ca1 + t2hipp_vol_left_ca23 + t2hipp_vol_left_dg + t2hipp_vol_left_sub + t2hipp_vol_left_erc + t2hipp_vol_left_phc + t2hipp_vol_left_prc , #note that shuyings original code had left sub in this twice
right_mtl = t2hipp_vol_right_ca1 + t2hipp_vol_right_ca23 + t2hipp_vol_right_dg + t2hipp_vol_right_sub + t2hipp_vol_right_erc + t2hipp_vol_right_phc + t2hipp_vol_right_prc
)
View(df)
c1 <- ggscatter(df, x = "t2hipp_vol_avg_ca1", y = "loop_ae_avg_degree",
add = "reg.line",
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
conf.int = TRUE,
cor.method = "pearson",
cor.coeff.args = list(label.sep = "\n"),
xlab = "Averaged CA1 Subfield Volume", ylab = "Averaged \nAngular Error (m)", ) +
theme(legend.position = "top", legend.title=element_blank())
c1
c1a <- ggscatter(df, x = "t2hipp_vol_avg_ca1", y = "loop_ae_avg_degree", color = "sex",
add = "reg.line",
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
conf.int = TRUE,
cor.method = "pearson",
cor.coeff.args = list(label.sep = "\n"),
xlab = "Averaged CA1 Subfield Volume", ylab = "Averaged \nPosition Error (m)") +
facet_wrap(. ~ sex, scale = "free", ncol = 1) +
theme_bw() +
theme(legend.position = "none")
c1a
library(patchwork)
c1 + c1a
c1 <- ggscatter(df, x = "t2hipp_vol_avg_ca23", y = "loop_ae_avg_degree",
add = "reg.line",
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
conf.int = TRUE,
cor.method = "pearson",
cor.coeff.args = list(label.sep = "\n"),
xlab = "Averaged CA2 Subfield Volume", ylab = "Averaged \nAngular Error (m)", ) +
theme(legend.position = "top", legend.title=element_blank())
c2 <- ggscatter(df, x = "t2hipp_vol_avg_ca23", y = "loop_ae_avg_degree",
add = "reg.line",
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
conf.int = TRUE,
cor.method = "pearson",
cor.coeff.args = list(label.sep = "\n"),
xlab = "Averaged CA2 Subfield Volume", ylab = "Averaged \nAngular Error (m)", ) +
theme(legend.position = "top", legend.title=element_blank())
c2
install.packages("tinytex")
tinytex::install_tinytex()
unlink("hippocampal subfield_cache", recursive = TRUE)
knit_with_parameters("~/Desktop/Scripts/Projects/SNAG/hippocampal/hippocampal subfield.Rmd")
install.packages("tinytex")
install.packages("tinytex")
install.packages("tinytex")
c2
tinytex::tlmgr_install("pdfcrop")
ppcor::pcor(df$loop_ae_avg_degree,df$t2hipp_vol_avg_ca1,df[,c"sex"])
ppcor::pcor(df$loop_ae_avg_degree,df$t2hipp_vol_avg_ca1,df[,c("sex")])
ppcor::pcor.test(df$loop_ae_avg_degree,df$t2hipp_vol_avg_ca1,df[,c("sex")])
df$sex[,1]
df$sex
df$sex[1]
df[,df$sex=="Female"]
test <- > df[df$sex=="Female",]
test <-df[df$sex=="Female",]
View(test)
df[df$sex=="Female",] <- 0
df
View(df)
df[df$sex=="Male",] <- 1
ppcor::pcor.test(df$loop_ae_avg_degree,df$t2hipp_vol_avg_ca1,df[,c("sex")])
df[df$sex=="Female",] <- 0
pcor.test(df$loop_ae_avg_degree,df$t2hipp_vol_avg_ca1,df[,c("sex")])
pcor.test(df$loop_ae_avg_degree,df$t2hipp_vol_avg_ca1,df[,c("sex")])
ppcor::pcor.test(df$loop_ae_avg_degree,df$t2hipp_vol_avg_ca1,df[,c("sex")])
class(df$loop_de_avg_degree)
class(df$t2hipp_vol_avg_ca1)
class(df$sex)
as.numeric(df$sex)
class(df$sex)
df$sex <- as.numeric(df$sex)
ppcor::pcor.test(df$loop_ae_avg_degree,df$t2hipp_vol_avg_ca1,df[,c("sex")])
x <- ppcor::pcor.test(df$loop_ae_avg_degree,df$t2hipp_vol_avg_ca1,df[,c("sex")])
View(x)
summary(x)
View(x)
y <- lm(df$loop_ae_avg_degre ~ df$t2hipp_vol_avg_ca1 + df$sex)
summary(y)
working_dir <-getwd()
# Laptop path
columns2grab <-
c(
"subject_id",
"sex",
"age_group",
"age_spatial_years",
"age_scan_years",
"loop_pe_rad1_m",
"loop_pe_rad2_m",
"loop_pe_rad3_m",
"loop_pe_avg_m",
"loop_de_rad1_degree",
"loop_de_rad2_degree",
"loop_de_rad3_degree",
"loop_de_avg_degree",
"loop_ae_rad1_degree",
"loop_ae_rad2_degree",
"loop_ae_rad3_degree",
"loop_ae_avg_degree",
"t2hipp_vol_avg_ca1",
"t2hipp_vol_avg_ca23",
"t2hipp_vol_avg_dg",
"t2hipp_vol_avg_erc",
"t2hipp_vol_avg_phc",
"t2hipp_vol_avg_prc",
"t2hipp_vol_avg_sub",
"t2hipp_vol_left_ca1",
"t2hipp_vol_left_ca23",
"t2hipp_vol_left_dg",
"t2hipp_vol_left_erc",
"t2hipp_vol_left_phc",
"t2hipp_vol_left_prc",
"t2hipp_vol_left_sub",
"t2hipp_vol_right_ca1",
"t2hipp_vol_right_ca23",
"t2hipp_vol_right_dg",
"t2hipp_vol_right_erc",
"t2hipp_vol_right_phc",
"t2hipp_vol_right_prc",
"t2hipp_vol_right_sub",
"estradiol_scan_pg_ml",
"progesterone_scan_ng_ml",
"fsh_scan_miu_ml",
"shbg_scan_nmol_l",
"dheas_scan_ug_dl",
"testosterone_scan_ng_dl",
"estradiol_spatial_pg_ml",
"progesterone_spatial_ng_ml",
"fsh_spatial_miu_ml",
"shbg_spatial_nmol_l",
"dheas_spatial_ug_dl",
"testosterone_spatial_ng_dl"
)
df <- read.csv("hippocampalsubs.csv") %>% select(columns2grab)
library(ggplot2)
#(plyr)
library(tidyverse)
# library(dplyr)
# library(tidyr)
library(stringr)
library(kableExtra)
# library(data.table)
# library(network)
# library(tidygraph)
# library(ggraph)
# library(igraph)
# library(networkD3)
# library(CINNA)
# library(umap)
# library(plotly)
#library(factoextra)
#library(lsr)
# library(car)
library(ggpubr)
#library(entropy)
#library(ds4psy)
# library(pROC)
#library(devtools)
#library(BRRR)
#library(stats)
#library(afex)
library(knitr)
library(janitor)
library(car)
library(ggiraph)
library(ggiraphExtra)
library(moonBook)
library(nationalparkcolors)
library(gridExtra)
library(markdown)
library(patchwork)
working_dir <-getwd()
# Laptop path
columns2grab <-
c(
"subject_id",
"sex",
"age_group",
"age_spatial_years",
"age_scan_years",
"loop_pe_rad1_m",
"loop_pe_rad2_m",
"loop_pe_rad3_m",
"loop_pe_avg_m",
"loop_de_rad1_degree",
"loop_de_rad2_degree",
"loop_de_rad3_degree",
"loop_de_avg_degree",
"loop_ae_rad1_degree",
"loop_ae_rad2_degree",
"loop_ae_rad3_degree",
"loop_ae_avg_degree",
"t2hipp_vol_avg_ca1",
"t2hipp_vol_avg_ca23",
"t2hipp_vol_avg_dg",
"t2hipp_vol_avg_erc",
"t2hipp_vol_avg_phc",
"t2hipp_vol_avg_prc",
"t2hipp_vol_avg_sub",
"t2hipp_vol_left_ca1",
"t2hipp_vol_left_ca23",
"t2hipp_vol_left_dg",
"t2hipp_vol_left_erc",
"t2hipp_vol_left_phc",
"t2hipp_vol_left_prc",
"t2hipp_vol_left_sub",
"t2hipp_vol_right_ca1",
"t2hipp_vol_right_ca23",
"t2hipp_vol_right_dg",
"t2hipp_vol_right_erc",
"t2hipp_vol_right_phc",
"t2hipp_vol_right_prc",
"t2hipp_vol_right_sub",
"estradiol_scan_pg_ml",
"progesterone_scan_ng_ml",
"fsh_scan_miu_ml",
"shbg_scan_nmol_l",
"dheas_scan_ug_dl",
"testosterone_scan_ng_dl",
"estradiol_spatial_pg_ml",
"progesterone_spatial_ng_ml",
"fsh_spatial_miu_ml",
"shbg_spatial_nmol_l",
"dheas_spatial_ug_dl",
"testosterone_spatial_ng_dl"
)
df <- read.csv("hippocampalsubs.csv") %>% select(columns2grab)
df <- filter(df, df$subject_id != 0)
#Create T2 total hipp and MTL, averaged and L/R
df <-
df %>%  mutate(
avg_total_hipp = t2hipp_vol_avg_ca1 + t2hipp_vol_avg_ca23 + t2hipp_vol_avg_dg + t2hipp_vol_avg_sub,
left_total_hipp = t2hipp_vol_left_ca1 + t2hipp_vol_left_ca23 + t2hipp_vol_left_dg + t2hipp_vol_left_sub,
right_total_hipp = t2hipp_vol_right_ca1 + t2hipp_vol_right_ca23 + t2hipp_vol_right_dg + t2hipp_vol_right_sub,
avg_mtl = t2hipp_vol_avg_ca1 + t2hipp_vol_avg_ca23 + t2hipp_vol_avg_dg + t2hipp_vol_avg_sub + t2hipp_vol_avg_erc + t2hipp_vol_avg_phc + t2hipp_vol_avg_prc,
left_mtl = t2hipp_vol_left_ca1 + t2hipp_vol_left_ca23 + t2hipp_vol_left_dg + t2hipp_vol_left_sub + t2hipp_vol_left_erc + t2hipp_vol_left_phc + t2hipp_vol_left_prc , #note that shuyings original code had left sub in this twice
right_mtl = t2hipp_vol_right_ca1 + t2hipp_vol_right_ca23 + t2hipp_vol_right_dg + t2hipp_vol_right_sub + t2hipp_vol_right_erc + t2hipp_vol_right_phc + t2hipp_vol_right_prc
)
df$sexbinary[df$sex=="Male",] <- 1
View(df)
df$sexbinary <- df$sex
df$sexbinary[df$sexbinary=="Male",] <- 1
df$sexbinary <- df$sex
View(df)
df$sexbinary[df$sexbinary=="Male",]
df$sexbinary[df$sexbinary=="Male"]
df[df$sexbinary=="Male"] <- 1
View(df)
df$sexbinary <- df$sex
df[df$sexbinary=="Male"] <- 1
View(df)
df$sexbinary[df$sexbinary=="Male"] <- 1
View(df)
working_dir <-getwd()
# Laptop path
columns2grab <-
c(
"subject_id",
"sex",
"age_group",
"age_spatial_years",
"age_scan_years",
"loop_pe_rad1_m",
"loop_pe_rad2_m",
"loop_pe_rad3_m",
"loop_pe_avg_m",
"loop_de_rad1_degree",
"loop_de_rad2_degree",
"loop_de_rad3_degree",
"loop_de_avg_degree",
"loop_ae_rad1_degree",
"loop_ae_rad2_degree",
"loop_ae_rad3_degree",
"loop_ae_avg_degree",
"t2hipp_vol_avg_ca1",
"t2hipp_vol_avg_ca23",
"t2hipp_vol_avg_dg",
"t2hipp_vol_avg_erc",
"t2hipp_vol_avg_phc",
"t2hipp_vol_avg_prc",
"t2hipp_vol_avg_sub",
"t2hipp_vol_left_ca1",
"t2hipp_vol_left_ca23",
"t2hipp_vol_left_dg",
"t2hipp_vol_left_erc",
"t2hipp_vol_left_phc",
"t2hipp_vol_left_prc",
"t2hipp_vol_left_sub",
"t2hipp_vol_right_ca1",
"t2hipp_vol_right_ca23",
"t2hipp_vol_right_dg",
"t2hipp_vol_right_erc",
"t2hipp_vol_right_phc",
"t2hipp_vol_right_prc",
"t2hipp_vol_right_sub",
"estradiol_scan_pg_ml",
"progesterone_scan_ng_ml",
"fsh_scan_miu_ml",
"shbg_scan_nmol_l",
"dheas_scan_ug_dl",
"testosterone_scan_ng_dl",
"estradiol_spatial_pg_ml",
"progesterone_spatial_ng_ml",
"fsh_spatial_miu_ml",
"shbg_spatial_nmol_l",
"dheas_spatial_ug_dl",
"testosterone_spatial_ng_dl"
)
df <- read.csv("hippocampalsubs.csv") %>% select(columns2grab)
df <- filter(df, df$subject_id != 0)
#Create T2 total hipp and MTL, averaged and L/R
df <-
df %>%  mutate(
avg_total_hipp = t2hipp_vol_avg_ca1 + t2hipp_vol_avg_ca23 + t2hipp_vol_avg_dg + t2hipp_vol_avg_sub,
left_total_hipp = t2hipp_vol_left_ca1 + t2hipp_vol_left_ca23 + t2hipp_vol_left_dg + t2hipp_vol_left_sub,
right_total_hipp = t2hipp_vol_right_ca1 + t2hipp_vol_right_ca23 + t2hipp_vol_right_dg + t2hipp_vol_right_sub,
avg_mtl = t2hipp_vol_avg_ca1 + t2hipp_vol_avg_ca23 + t2hipp_vol_avg_dg + t2hipp_vol_avg_sub + t2hipp_vol_avg_erc + t2hipp_vol_avg_phc + t2hipp_vol_avg_prc,
left_mtl = t2hipp_vol_left_ca1 + t2hipp_vol_left_ca23 + t2hipp_vol_left_dg + t2hipp_vol_left_sub + t2hipp_vol_left_erc + t2hipp_vol_left_phc + t2hipp_vol_left_prc , #note that shuyings original code had left sub in this twice
right_mtl = t2hipp_vol_right_ca1 + t2hipp_vol_right_ca23 + t2hipp_vol_right_dg + t2hipp_vol_right_sub + t2hipp_vol_right_erc + t2hipp_vol_right_phc + t2hipp_vol_right_prc
)
df$sexbinary <- df$sex
df$sexbinary[df$sexbinary=="Male"] <- 1
df$sexbinary[df$sexbinary=="Female"] <- 0
df$sexbinary <- as.numeric(df$sexbinary)
y <- lm(df$loop_ae_avg_degre ~ df$t2hipp_vol_avg_ca1 + df$sex)
summary(y)
c1 <- ggscatter(df, x = "t2hipp_vol_avg_ca1", y = "loop_ae_avg_degree",
add = "reg.line",
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
conf.int = TRUE,
cor.method = "pearson",
cor.coeff.args = list(label.sep = "\n"),
xlab = "Averaged CA1 Subfield Volume", ylab = "Averaged \nAngular Error (m)", ) +
theme(legend.position = "top", legend.title=element_blank())
c1a <- ggscatter(df, x = "t2hipp_vol_avg_ca1", y = "loop_ae_avg_degree", color = "sex",
add = "reg.line",
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
conf.int = TRUE,
cor.method = "pearson",
cor.coeff.args = list(label.sep = "\n"),
xlab = "Averaged CA1 Subfield Volume", ylab = "Averaged \nPosition Error (m)") +
facet_wrap(. ~ sex, scale = "free", ncol = 1) +
theme_bw() +
theme(legend.position = "none")
library(patchwork)
c1 + c1a
y <- lm(df$loop_ae_avg_degre ~ df$t2hipp_vol_avg_ca1 + df$sexbinary)
summary(y)
y <- lm(df$loop_ae_avg_degree ~ df$t2hipp_vol_avg_ca1 + df$sexbinary)
summary(y)
c23a <- ggscatter(df, x = "t2hipp_vol_avg_ca23", y = "loop_ae_avg_degree", color = "sex",
add = "reg.line",
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
conf.int = TRUE,
cor.method = "pearson",
cor.coeff.args = list(label.sep = "\n"),
xlab = "Averaged CA1 Subfield Volume", ylab = "Averaged \nPosition Error (m)") +
facet_wrap(. ~ sex, scale = "free", ncol = 1) +
theme_bw() +
theme(legend.position = "none")
df_w <- df %>% filter(df$sex=="FEMALE")
library(ggplot2)
#(plyr)
library(tidyverse)
# library(dplyr)
# library(tidyr)
library(stringr)
library(kableExtra)
# library(data.table)
# library(network)
# library(tidygraph)
# library(ggraph)
# library(igraph)
# library(networkD3)
# library(CINNA)
# library(umap)
# library(plotly)
#library(factoextra)
#library(lsr)
# library(car)
library(ggpubr)
#library(entropy)
#library(ds4psy)
# library(pROC)
#library(devtools)
#library(BRRR)
#library(stats)
#library(afex)
library(knitr)
library(janitor)
library(car)
library(ggiraph)
library(ggiraphExtra)
library(moonBook)
library(nationalparkcolors)
library(gridExtra)
library(markdown)
library(patchwork)
working_dir <-getwd()
# Laptop path
columns2grab <-
c(
"subject_id",
"sex",
"age_group",
"age_spatial_years",
"age_scan_years",
"loop_pe_rad1_m",
"loop_pe_rad2_m",
"loop_pe_rad3_m",
"loop_pe_avg_m",
"loop_de_rad1_degree",
"loop_de_rad2_degree",
"loop_de_rad3_degree",
"loop_de_avg_degree",
"loop_ae_rad1_degree",
"loop_ae_rad2_degree",
"loop_ae_rad3_degree",
"loop_ae_avg_degree",
"t2hipp_vol_avg_ca1",
"t2hipp_vol_avg_ca23",
"t2hipp_vol_avg_dg",
"t2hipp_vol_avg_erc",
"t2hipp_vol_avg_phc",
"t2hipp_vol_avg_prc",
"t2hipp_vol_avg_sub",
"t2hipp_vol_left_ca1",
"t2hipp_vol_left_ca23",
"t2hipp_vol_left_dg",
"t2hipp_vol_left_erc",
"t2hipp_vol_left_phc",
"t2hipp_vol_left_prc",
"t2hipp_vol_left_sub",
"t2hipp_vol_right_ca1",
"t2hipp_vol_right_ca23",
"t2hipp_vol_right_dg",
"t2hipp_vol_right_erc",
"t2hipp_vol_right_phc",
"t2hipp_vol_right_prc",
"t2hipp_vol_right_sub",
"estradiol_scan_pg_ml",
"progesterone_scan_ng_ml",
"fsh_scan_miu_ml",
"shbg_scan_nmol_l",
"dheas_scan_ug_dl",
"testosterone_scan_ng_dl",
"estradiol_spatial_pg_ml",
"progesterone_spatial_ng_ml",
"fsh_spatial_miu_ml",
"shbg_spatial_nmol_l",
"dheas_spatial_ug_dl",
"testosterone_spatial_ng_dl"
)
df <- read.csv("hippocampalsubs.csv") %>% select(columns2grab)
df <- filter(df, df$subject_id != 0)
#Create T2 total hipp and MTL, averaged and L/R
df <-
df %>%  mutate(
avg_total_hipp = t2hipp_vol_avg_ca1 + t2hipp_vol_avg_ca23 + t2hipp_vol_avg_dg + t2hipp_vol_avg_sub,
left_total_hipp = t2hipp_vol_left_ca1 + t2hipp_vol_left_ca23 + t2hipp_vol_left_dg + t2hipp_vol_left_sub,
right_total_hipp = t2hipp_vol_right_ca1 + t2hipp_vol_right_ca23 + t2hipp_vol_right_dg + t2hipp_vol_right_sub,
avg_mtl = t2hipp_vol_avg_ca1 + t2hipp_vol_avg_ca23 + t2hipp_vol_avg_dg + t2hipp_vol_avg_sub + t2hipp_vol_avg_erc + t2hipp_vol_avg_phc + t2hipp_vol_avg_prc,
left_mtl = t2hipp_vol_left_ca1 + t2hipp_vol_left_ca23 + t2hipp_vol_left_dg + t2hipp_vol_left_sub + t2hipp_vol_left_erc + t2hipp_vol_left_phc + t2hipp_vol_left_prc , #note that shuyings original code had left sub in this twice
right_mtl = t2hipp_vol_right_ca1 + t2hipp_vol_right_ca23 + t2hipp_vol_right_dg + t2hipp_vol_right_sub + t2hipp_vol_right_erc + t2hipp_vol_right_phc + t2hipp_vol_right_prc
)
df$sexbinary <- df$sex
df$sexbinary[df$sexbinary=="Male"] <- 1
df$sexbinary[df$sexbinary=="Female"] <- 0
df$sexbinary <- as.numeric(df$sexbinary)
# Let's make sure we have some split by sex too
df_w <- df %>% filter(df$sex=="FEMALE")
View(df)
df_w <- df %>% filter(df$sex=="Female")
View(df_w)
df_m <- df %>% filter(df$sex=="Male")
View(c2)
View(df)
lm(df$t2hipp_vol_avg_ca23~df$loop_ae_avg_degree)
summary(lm(df$t2hipp_vol_avg_ca23~df$loop_ae_avg_degree))
View(df)
View(df_w)
View(df_m)
