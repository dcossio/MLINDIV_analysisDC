---
title: "SNAG Loop"
author: "Daniela Cossio"
date: "`r format(Sys.time(), '%d %B %Y')`"
output:
   html_document:
    toc: true
    toc_float: true
    toc_depth: 2
    classoption:
    - twocolumn
---


```{css, echo=FALSE}
TOC {
  color: #F6B2DB;
  font-family: Times;
  font-size: "16px"; 
  border-color: #F6B2DB;
}

h1.title {
  color: black ;
  font-family: Times;
  font-size: "72px";
  padding: "10px 0";
  background-color: #F6B2DB ;
  text-align: center;
}

h4.date {
  color: black ;
  font-family: Times;
  font-size: "34px";
  text-align: center;
}

h4.author {
  color: black;
  font-size: "34px";
  font-family: Times;
  text-align: center;
}


h2, h3, h4, h5 ,h6 {
  text-align: center;
  font-family: Times;
  
}

body, p, h2{
  color: black; 
  font-family: Times;
}

hr {
  height:5px;
  border-width:0;
  background-color: black ;
}



```

```{r set-options, echo=FALSE, cache=FALSE}
options(width = 100)
```

```{r adding libraries,echo=FALSE, results='hide',message=FALSE}
library(ggplot2)
#(plyr)
library(tidyverse)
# library(dplyr)
# library(tidyr)
library(stringr)
library(kableExtra)
# library(data.table)
# library(network)
# library(tidygraph)
# library(ggraph)
# library(igraph)
# library(networkD3)
# library(CINNA)
# library(umap)
# library(plotly)
#library(factoextra)
#library(lsr)
# library(car)
library(ggpubr)
#library(entropy)
#library(ds4psy)
# library(pROC)
#library(devtools)
#library(BRRR)
#library(stats)
#library(afex)
library(knitr)
library(janitor)
library(car)
library(ggiraph)
library(ggiraphExtra)
library(moonBook)
library(nationalparkcolors)
library(gridExtra)
library(markdown)
```

```{r reading in our CSVs, echo=FALSE, results='hide',message=FALSE}
working_dir <- "/Users/danielacossio/Documents/Chrastil_Lab/Projects/SNAG/DSI_rerun_data/"
#working_dir <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/Other computers/My iMac/Chrastil_Lab/Projects/SNAG/DSI_rerun_data/" # Laptop path

rows2grab <- c("Tract Name", "number of tracts","mean length(mm)","diameter(mm)", "volume(mm^3)")


 #sub_info <- read.csv("/Users/danielacossio/Documents/Chrastil_Lab/Projects/SNAG/DSI_rerun_data/subject_info.csv")

sub_info <- read.csv(paste0(working_dir,"subject_info.csv"))
```


```{r functions, echo=FALSE, results='hide',message=FALSE}

ReadingCSVFunc <- function(pathname){
  
  read.delim(paste0(working_dir, pathname), header=FALSE,sep = "\t")
  
}

CleanInput <- function(DF){
  

  DF <- DF %>% remove_empty("cols") 
  
  if(length(DF) < 3){
    DF <- DF %>% 
            filter(V1 %in% rows2grab) %>% 
              t() %>% 
                `colnames<-`(rows2grab) %>% 
                  as.data.frame() %>% 
                    `[`(-c(1),)
    
  } else{
    
    DF <- DF %>% 
      filter(V1 %in% rows2grab) %>% 
        t() %>% 
            `colnames<-`(rows2grab) %>% 
                `[`(-c(1),) %>% 
                    as.data.frame() 
  }
 
          
  return(DF)
}


Extract_raw_values <- function(DF,Metric) {
  # Purpose of this function is to clean the data without me having to copy and paste everything later. 
  
  # Data = raw unclean dataframe we want to clean up 
  # Metric will be either MD or QA
  # sex is either male or female
 
  
  # Let's read in our data frame 
  
     colNames <- DF  %>% remove_empty("cols") %>%
  filter(V1 == "Tract Name") %>% t() %>% `[`(-1) 
  
  
  # grab  ROIcolumn names 
 
  
  subinfo <- sub_info  %>% select(c("subject_id", "sex", "age_scan_years", "loop_pe_rad3_m", "loop_de_rad3_degree","REPO")) 
 
  # Let's grab our values 
  if (Metric == "MD"){
    Values <- DF %>% remove_empty("cols") %>% 
     filter(str_detect(V1, c("mean_md"))) %>%
   `colnames<-`(c("Subjects",colNames)) %>% filter(!str_detect(Subjects, c("sub-369"))) 
  }
  else{
    Values <- DF %>%
     remove_empty("cols") %>%
      filter(str_detect(V1, c("mean_qa"))) %>% 
  `colnames<-`(c("Subjects",colNames)) %>% filter(!str_detect(Subjects, c("sub-369"))) 

  }
  
  # now let's put this together 
  if (length(Values) < 3) {
    Values[,2] <- as.numeric(Values[,2])
  }else{
  ConvToNum <-  apply(Values[,2:length(Values)],2, as.numeric)
  Values[,2:length(Values)] <- ConvToNum
  }
  
  cleanedDF <- cbind(subinfo,Values) %>% na.omit() %>% select(-c("Subjects"))
  
  return (cleanedDF)
}


TableOutput <- function(df){
      knitr::kable(df, row.names=F) %>% kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% scroll_box(width = "600px", height = "300px")
    
  }


# TableOutput <- function(df, style, width, height, caption){
#  
#   if (style == "classic"){
#       knitr::kable(df, row.names=F) %>% kable_classic(full_width = F, html_font = "Cambria")
#   } else {
#       knitr::kable(df, row.names=F) %>% kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% scroll_box(width = paste0(width,"px"), height = paste0(height,"px")) 
#     
#   }
# 
# }

```
## Overview 
This is the analysis of white matter dsi studio connectometry for Maze and Loop 

<br><br><br>

<hr>

## Methods {.tabset .tabset-pills} 

### **Participants** 

  * Total number of scans = 120 (males and females)  
  
  * Total scans used in analysis= 118  
  * Excluded subs 329 and 372 from analyses due to bad behavior data and Subject 347 failed quality 
  control check in DSI
   * Several subjects removed because they did not have rad3 score  
<br><br>

<hr> 


### **Loop**


::::::{style="display: flex;"}

:::{.column width="50%"}
**Average** <br>
All subjects = 43 <br>
Men = 18 <br>
Women = 25 <br>
Pre = 11 <br>
Peri = 7 <br>
Post = 17 <br>
::: 
  
:::{ .column width="50%"}
  **rad3** <br>
    * All subjects = 39 <br>
    * Men = 15 <br>
    * Women = 24 <br>
    * Pre = 10 <br>
    * Peri = 7 <br>
    * Post = 7 <br>
:::
::::::

<br><br>
<hr> 




  
  
### **Scan parameters** 

  * Locations from UCSB and UCI
<br><br>

<hr> 





### **QSIprep** 

  * Version used: 0.16.0RC3

  * The following parameters were used
    * dwi_denoise_window **5** 
    * hmc_model **3dSHORE** 
    * hmc-transform **Rigid** 
    * shoreline_iters **2**
<br><br>

<hr> 

### **DSI Studio**

  * Version and tags used via singularity container: **chen-2022-07-31**
  
  * **Parameters** 
    * T-threshold = 2.5
    * Length = 25
    * Permutation = 4,000
    * pruning 4
    * non normalized QA

<hr>

<br><br><br><br><br>

 


### **Connectronomy analysis methods write up**
<br>

A diffusion spectrum imaging scheme was used, and a total of 128 diffusion sampling were acquired.  
The maximum b-value was 4990 s/mm². The in-plane resolution was 1.8 mm. The slice thickness wasc1.8 mm. The accuracy of b-table orientation was examined by comparing fiber orientations with those of a population-averaged template (Yeh et al. Neuroimage, 2018). The b-table was flipped by 
The diffusion data were reconstructed in the MNI space using q-space diffeomorphic reconstruction
(Yeh et al., Neuroimage, 58(1):91-9, 2011) to obtain the spin distribution function (Yeh et al., IEEE TMI, ;29(9):1626-35, 2010).  A diffusion sampling length ratio of 1.25 was used. The output resolution in diffeomorphic reconstruction was 1.8 mm isotropic. The tensor metrics were calculated using DWI with b-value lower than 1750 s/mm². The quantitative anisotropy was extracted as the local connectome fingerprint (LCF, Yeh et al. PLoS Comput Biol 12(11): e1005203) and used in the connectometry analysis.</p>
<br>

Diffusion MRI connectometry (Yeh et al. NeuroImage 125 (2016): 162-171) was used to derive the correlational tractography that has QA, MD, AD, and RD correlated with Maze Accuracy and path efficiency. A nonparametric Spearman partial correlation was used to derive the correlation, and the effect of sex, age_scan_years, and repo_status was removed using a multiple regression model. The total number of subjects varied on analysis (See Analyses and Final sample sizes above). A T-score threshold of 2.5 was assigned and tracked using a deterministic fiber tracking algorithm (Yeh et al. PLoS ONE 8(11): e80713, 2013) to obtain correlational tractography. A seeding region was placed at whole brain (39,49,29) .
<br>

 The tracks were filtered by topology-informed pruning (Yeh et al. Neurotherapeutics, 16(1), 52-58, 2019) with 4 iteration(s). A length threshold of 25 voxel distance was used to select tracks. To estimate the false discovery rate, a total of 4000 randomized permutations were applied to the group label to obtain the null distribution of the track length.</p>

<hr>

## **Results**  

<br>

### Behavior {.tabset .tabset-pills} 

#### Summary 
Let's double check for any sex differences in midlife adults here.

No sex differences for PE, or AE. Sex differences for degrees traveled with men undershooting and women overshooting. 

```{r, echo=FALSE, results='hide',message=FALSE}

# creating our separated databases

m_subinfo <- sub_info %>% filter(sex == "Male")
f_subinfo <- sub_info %>% filter(sex == "Female")
```

<br><br><br><br>

<hr>

#### Position Error

Males are normally distributed on PE

**Average**
```{r,echo=FALSE, warning='hide',message=FALSE}
p1 <- ggplot(m_subinfo, aes(x=loop_ae_avg_degree)) +geom_histogram(bins=10,fill="#028476") +labs(title="male")
shapiro.test(m_subinfo$loop_pe_avg_m) %>% broom::tidy() %>% knitr::kable() %>%  kable_styling()
```

**rad3**
```{r,echo=FALSE, warning='hide',message=FALSE}
p2 <- ggplot(m_subinfo, aes(x=loop_ae_rad3_degree)) +geom_histogram(bins=10,fill="#028476") +labs(title="male")
shapiro.test(m_subinfo$loop_pe_rad3_m)%>% broom::tidy() %>% knitr::kable() %>%  kable_styling()
```

```{r,  echo=FALSE, warning=FALSE,message=FALSE,out.width="50%"}
grid.arrange(p1, p2, nrow = 1)
```

<br>

**Average**
```{r,echo=FALSE, warning=FALSE,message=FALSE}
p3 <- ggplot(f_subinfo, aes(x=loop_pe_avg_m)) +geom_histogram(bins=10,fill="#FB6B90")+labs(title="female")
F_PE_avg_norm <- shapiro.test(f_subinfo$loop_pe_avg_m) %>% broom::tidy() %>% knitr::kable() %>%  kable_styling()
```

**rad3**
```{r, echo=FALSE, warning=FALSE,message=FALSE}
p4 <- ggplot(f_subinfo, aes(x=loop_pe_rad3_m)) +geom_histogram(bins=10,fill="#FB6B90")+labs(title="female")
F_PE_rad3_norm <- shapiro.test(f_subinfo$loop_pe_rad3_m)
```

```{r, message=FALSE,echo=FALSE, warning=FALSE,out.width="50%"}
grid.arrange(p3,p4, nrow = 1)

```

<br><br>

No sex differences for  average position error
```{r Sex differences, echo=FALSE,message=FALSE}
t.test(m_subinfo$loop_pe_avg_m,f_subinfo$loop_pe_avg_m) %>% broom::tidy() %>% knitr::kable() %>%  kable_styling(full_width = F)

```

No sex differences for  rad3 position error
```{r Sex differences rad3,warnings=FALSE, echo=FALSE,message=FALSE}
t.test(m_subinfo$loop_pe_rad3_m,f_subinfo$loop_pe_rad3_m) %>% broom::tidy() %>% knitr::kable() %>%  kable_styling(full_width = F)

```


<br><br>

<hr>


#### Angular Error

Both Avg and Rad3 are normally distributed  

**Avg**
```{r, echo=FALSE,message=FALSE}
# Let's check out normality 
shapiro.test(m_subinfo$loop_ae_avg_degree) %>% broom::tidy() %>% knitr::kable() %>%  kable_styling()
```

**Rad3**
```{r, echo=FALSE,message=FALSE}
shapiro.test(m_subinfo$loop_ae_rad3_degree)%>% broom::tidy() %>% knitr::kable() %>%  kable_styling()
```

```{r,  echo=FALSE, warning=FALSE,message=FALSE,out.width="50%"}
p1 <- ggplot(m_subinfo, aes(x=loop_ae_avg_degree)) +geom_histogram(bins=10,fill="#028476") +labs(title="male")
p2 <- ggplot(m_subinfo, aes(x=loop_ae_rad3_degree)) +geom_histogram(bins=10,fill="#028476") +labs(title="male")

grid.arrange(p1, p2, nrow = 1)
```

<br>

Average angular error for females is not normally distributed 
```{r, echo=FALSE,message=FALSE}
p3 <- ggplot(f_subinfo, aes(x=loop_ae_avg_degree)) +geom_histogram(bins=10,fill="#FB6B90")+labs(title="female")

shapiro.test(f_subinfo$loop_ae_avg_degree) %>% broom::tidy() %>% knitr::kable() %>%  kable_styling()
```

**rad3**
```{r, echo=FALSE,message=FALSE}
p4 <- ggplot(f_subinfo, aes(x=loop_ae_rad3_degree)) +geom_histogram(bins=10,fill="#FB6B90")+labs(title="female")

shapiro.test(f_subinfo$loop_ae_rad3_degree) %>% broom::tidy() %>% knitr::kable() %>%  kable_styling()
```

```{r,  echo=FALSE, warning=FALSE,message=FALSE,out.width="50%"}
grid.arrange(p3,p4, nrow = 1)
```


<br><br>

No sex differences for  average position error. Used wilcox test since females are not normally distributed
```{r , echo=FALSE,message=FALSE}
wilcox.test(m_subinfo$loop_ae_avg_degree,f_subinfo$loop_ae_avg_degree) %>% broom::tidy() %>% knitr::kable() %>%  kable_styling()

```

<br>
No sex differences for  rad3 position error
```{r ,warnings=FALSE, echo=FALSE,message=FALSE}
t.test(m_subinfo$loop_ae_rad3_degree,f_subinfo$loop_ae_rad3_degree) %>% broom::tidy() %>% knitr::kable() %>%  kable_styling(full_width = F)

```

<br><br>

<hr>

#### Degrees Traveled
 

**Avg**
```{r, echo=FALSE,message=FALSE}
# Let's check out normality 
p1 <- ggplot(m_subinfo, aes(x=loop_de_avg_degree)) +geom_histogram(bins=10,fill="#028476") +labs(title="male")

shapiro.test(m_subinfo$loop_de_avg_degree) %>% broom::tidy() %>% knitr::kable() %>%  kable_styling()
```

**Rad3**: Not normally distributed
```{r, echo=FALSE,message=FALSE}
p2 <- ggplot(m_subinfo, aes(x=loop_de_rad3_degree)) +geom_histogram(bins=10,fill="#028476") +labs(title="male")

shapiro.test(m_subinfo$loop_de_rad3_degree)%>% broom::tidy() %>% knitr::kable() %>%  kable_styling()
```

```{r,  echo=FALSE, warning=FALSE,message=FALSE, out.height="50%"}
grid.arrange( p1,p2, nrow = 1)
```

<br>

Average angular error for females is not normally distributed 
```{r, echo=FALSE,message=FALSE}
p3 <- ggplot(f_subinfo, aes(x=loop_de_avg_degree)) +geom_histogram(bins=10,fill="#FB6B90")+labs(title="female")

shapiro.test(f_subinfo$loop_de_avg_degree) %>% broom::tidy() %>% knitr::kable() %>%  kable_styling()
```

**rad3**
```{r, echo=FALSE,message=FALSE}
p4 <- ggplot(f_subinfo, aes(x=loop_de_rad3_degree)) +geom_histogram(bins=10,fill="#FB6B90")+labs(title="female")

shapiro.test(f_subinfo$loop_de_rad3_degree) %>% broom::tidy() %>% knitr::kable() %>%  kable_styling()
```

```{r,  echo=FALSE, warning=FALSE,message=FALSE, out.height="50%"}
grid.arrange( p3,p4, nrow = 1)
```


Sex differences in average degrees traveled. Males had an average of `r mean(m_subinfo$loop_de_avg_degree,na.rm = TRUE,trim = 0.3)` degrees traveled compared to females `r mean(f_subinfo$loop_de_avg_degree,na.rm = TRUE,trim = 0.3)` 

```{r , echo=FALSE,message=FALSE}
t.test(m_subinfo$loop_de_avg_degree,f_subinfo$loop_de_avg_degree) %>% broom::tidy() %>% knitr::kable() %>%  kable_styling(full_width = F)

```

Sex differences in rad3 degrees traveled. Males had an average of `r mean(m_subinfo$loop_de_rad3_degree,na.rm = TRUE,trim = 0.3)` degrees traveled compared to females `r mean(f_subinfo$loop_de_rad3_degree,na.rm = TRUE,trim = 0.3)`

```{r ,warnings=FALSE, echo=FALSE,message=FALSE}
wilcox.test(m_subinfo$loop_de_rad3_degree,f_subinfo$loop_de_rad3_degree) %>% broom::tidy() %>% knitr::kable() %>%  kable_styling(full_width = F)

```




### **Position Error**   {.tabset .tabset-dropdown} 

#### Rad3 {.tabset .tabset-pills}
##### Summary

::::::{style="display: flex;"}

:::{.column width="50%"}
**QA FDRs **     
All: **(<span style="color: LightSeaGreen;"> - </span>) 0.000760**   
Female: **(<span style="color: LightSeaGreen;"> - </span>) 0.029793** | **(+) 0.005420**    
Male: **(<span style="color: LightSeaGreen;"> - </span>) 0.040864** | (<span style="color: MediumOrchid;"> + </span>) 0.184615     
Pre : **(<span style="color: LightSeaGreen;"> - </span>) 0.020932** | (<span style="color: MediumOrchid;"> + </span>) 0.068586     
Peri: **(<span style="color: LightSeaGreen;"> - </span>) 0.048013**    
Post: No Significant Tracts
::: 
  
:::{ .column width="50%"}
  **MD FDRs **  
  All: (<span style="color: LightSeaGreen;"> - </span>) 0.111613   
  Female: **(<span style="color: LightSeaGreen;"> - </span>) 0.007040**     
  Male:  **(<span style="color: MediumOrchid;"> + </span>) 0.011441**    
  Pre : **(<span style="color: LightSeaGreen;"> - </span>) 0.046384**      
  Peri: **(<span style="color: LightSeaGreen;"> - </span>) 0.014336**    
  Post: (<span style="color: LightSeaGreen;"> - </span>) 0.064846
:::
::::::

<!-- Increased QA in many tracts outside of the limbic area are associated with a lower position error. Many regions involved in motor functions and movements showed negative associations with PE. Better white matter integrity in these regions corresponded to lower position error. In females, QA is negatively associated with tracts involved in motor/sensory input, corpus callosum body/tapetum and the cingulum frontal-parietal  bundle. The corpus callosum forceps (major and minor), and cingulum frontal parahippocampal appear to be positively associated with performance, greater QA values are associated with greater PE. suggesting that, reliance on the regions may lead to inefficient path integration. -->

<!-- in all subjects, MD is negatively associated with PE in limbic regions. Lower MD (better WM) is associated with higher MD. Suggesting that perhaps midlife adults are not relying on limbic regions to successfully navigate. In women, this relationship is maintained. Males display an opposite relationship with lower MD (better wm) being asscoaicted with lower PE (better performance ). Suggesting that in males, better WM in limbic regions is necessary for better path integration.  -->
<br><br>

<hr> 

<br><br>

##### QA {.tabset .tabset-pills}
###### All subject
<!-- <p style="text-align:center ; font-size: 24px" > <strong>Control for FNAME</strong> </p> -->

<!-- <span style="color: LightSeaGreen;font-size: 18px;background-color: Snow"> <strong>Negative  (FDR = 0.000407)</strong> </span> -->
<!-- ```{r, echo=FALSE,message=FALSE} -->
<!-- TableOutput(CleanInput(ReadingCSVFunc("Loop/QA/PE/fname_cov/all.loopPE.rad3.neg.csv"))) -->
<!-- ``` -->

<!-- <br> -->

<!-- <p style="text-align:center ; font-size: 24px" > <strong> No FNAME </strong> </p> -->

<span style="color: LightSeaGreen;font-size: 18px;background-color: Snow"> <strong>Negative  (FDR = 0.000760)</strong> </span>
```{r, echo=FALSE,message=FALSE}
TableOutput(CleanInput(ReadingCSVFunc("Loop/QA/PE/noFNAME/rad3pe.all.qa.neg.csv")))

```


<!-- Extracting figures for plots -->

```{r Extracting corticospinal tract R from QA and PE, echo=FALSE, results='hide',message=FALSE}

# First thing we need to do is read our CSV AND CLEAN AND ORGANIZE

QA_all_PE <- Extract_raw_values(ReadingCSVFunc("Loop/QA/PE/noFNAME/rad3pe.all.qa.neg.csv"), "QA")

#now lets create a scatter plot with no sex differences
pdf(file = paste0("/Users/danielacossio/Downloads/","CSTr_QA_PE.pdf"),width=12, height=8)
 ggplot(QA_all_PE, aes(x=Corticospinal_Tract_R, y=loop_pe_rad3_m)) +
   geom_point(color="#502E23", size=4) +
   geom_smooth(method="lm", level=0.95,color ="#E2929D", se=FALSE,linewidth=2) +
    theme_classic() +
   labs(x ="QA", y = "Position Error", title =  "Cortical Spinal Tract R") +
   theme( axis.title.x = element_text(vjust = -4,size = 16),
      axis.text.x = element_text(size = 25),
      axis.text.y = element_text(size = 25),
      axis.title.y = element_text(vjust = 4, size = 16),
      plot.title = element_text(hjust = 0.5 ,size=16),
      panel.border = element_rect(fill=NA,color = "#502E23"),
      panel.background =element_blank(), 
      strip.text.x = element_text(
        size = 16,
        color = "black",
        face = "bold.italic"
      ),
      legend.position = "right",
      legend.key.size = unit(2, 'cm'),
         legend.title = element_text(size=18), #change legend title font size
         legend.text = element_text(size=18),
      plot.margin = margin(2, 1, 2, 1, "cm")) +
   annotate("text", label = "FDR< 0.001", x = 0.43, y = 5, color="#E2929D", size=8)

   dev.off()
   
   
   
# Let's do one with the sex differences
   
   pdf(file = paste0("/Users/danielacossio/Downloads/","sex_diff_CSTr_QA_PE.pdf"),width=12, height=8)
 ggplot(QA_all_PE, aes(x=Corticospinal_Tract_R, y=loop_pe_rad3_m)) +
   geom_point(size=4, aes(color = factor(sex))) +
   geom_smooth(method="lm", level=0.95,  se=FALSE,linewidth=2, aes(color = factor(sex))) +
   scale_color_manual(values = c("#E2929D","#502E23"), name="Sex")+
   labs(x ="QA", y = "Position Error", title =  "Cortical Spinal Tract R") +
   theme( axis.title.x = element_text(vjust = -4,size = 16),
      axis.text.x = element_text(size = 20),
      axis.text.y = element_text(size = 20),
      axis.title.y = element_text(vjust = 4, size = 16),
      plot.title = element_text(hjust = 0.5 ,size=16),
      panel.border = element_rect(fill=NA,color = "#502E23"),
      panel.background =element_blank(), 
      strip.text.x = element_text(
        size = 16,
        color = "black",
        face = "bold.italic"
      ),
      legend.position = "right",
      legend.key.size = unit(2, 'cm'),
         legend.title = element_text(size=18), #change legend title font size
         legend.text = element_text(size=18),
      plot.margin = margin(2, 1, 2, 1, "cm")) +
   annotate("text", label = "FDR= 0.03", x = 0.43, y = 5, color="#E2929D", size=8) +
     annotate("text", label = "FDR= 0.04", x = 0.43 , y = 4.6, color="#502E23", size=8)

   dev.off()

```


<br>

<hr>
<br>

###### Females

<!-- <!------ fname --------->
<!-- <p style="text-align:center ; font-size: 24px" > <strong>Control for FNAME</strong> </p> -->

<!-- <span style="color: MediumOrchid;font-size: 18px;background-color: Snow"> <strong>Positive (FDR = 0.033223)</strong> </span> -->
<!-- ```{r,echo=FALSE,message=FALSE} -->
<!-- TableOutput(CleanInput(ReadingCSVFunc("Loop/QA/PE/fname_cov/females.loopPE.rad3.pos.csv"))) -->
<!-- ``` -->


<!-- <span style="color: LightSeaGreen;font-size: 18px;background-color: Snow"> <strong>Negative  (FDR = 0.014408)</strong> </span> -->
<!-- ```{r,echo=FALSE,message=FALSE} -->
<!-- TableOutput(CleanInput(ReadingCSVFunc("Loop/QA/PE/fname_cov/females.loopPE.rad3.neg.csv"))) -->
<!-- ``` -->

<!-- <br><br><br> -->

<!-- <p style="text-align:center ; font-size: 24px" > <strong> No FNAME</strong> </p> -->

<span style="color: MediumOrchid;font-size: 18px;background-color: Snow"> <strong>Positive (FDR = 0.005420)</strong> </span>
```{r,echo=FALSE,message=FALSE}
TableOutput(CleanInput(ReadingCSVFunc("Loop/QA/PE/noFNAME/rad3pe.fem.qa.pos.csv")))
```

<br>

<span style="color: LightSeaGreen;font-size: 18px;background-color: Snow"> <strong>Negative  (FDR = 0.029793)</strong> </span>
```{r,echo=FALSE,message=FALSE}
TableOutput(CleanInput(ReadingCSVFunc("Loop/QA/PE/noFNAME/rad3pe.fem.qa.neg.csv")))
```

<hr>

<br><br><br><br>

###### Males

<!-- <p style="text-align:center ; font-size: 24px" > <strong>Control for FNAME</strong> </p> -->

<!-- <br> -->

<!-- <span style="color: LightSeaGreen;font-size: 18px;background-color: Snow"> <strong>Negative  (FDR = 0.039893)</strong> </span> -->
<!-- ```{r,echo=FALSE,message=FALSE} -->

<!-- TableOutput(CleanInput(ReadingCSVFunc("Loop/QA/PE/fname_cov/males.loopPE.rad3.neg.csv"))) -->
<!-- ``` -->

<!-- <br><br><br> -->

<!-- <p style="text-align:center ; font-size: 24px" > <strong> No FNAME </strong> </p> -->

<span style="color: MediumOrchid;font-size: 18px;background-color: Snow"> <strong>Positive (FDR = 0.184615)</strong> </span>
```{r,echo=FALSE,message=FALSE}
TableOutput(CleanInput(ReadingCSVFunc("Loop/QA/PE/noFNAME/rad3pe.male.qa.pos.csv")))
```
<br>

<span style="color: LightSeaGreen;font-size: 18px;background-color: Snow"> <strong>Negative  (FDR = 0.040864)</strong> </span>
```{r,echo=FALSE,message=FALSE}

TableOutput(CleanInput(ReadingCSVFunc("Loop/QA/PE/noFNAME/rad3pe.male.qa.neg.csv")))
```

<hr>

<br><br><br><br>

###### pre

<!-- <p style="text-align:center ; font-size: 24px" > <strong>Control for FNAME</strong> </p> -->

<!-- <br> -->

<!-- <span style="color: LightSeaGreen;font-size: 18px;background-color: Snow"> <strong>Negative  (FDR = 0.088051)</strong> </span> -->
<!-- ```{r,echo=FALSE,message=FALSE} -->

<!-- TableOutput(CleanInput(ReadingCSVFunc("Loop/QA/PE/fname_cov/pre.loopPE.rad3.neg.csv"))) -->
<!-- ``` -->

<!-- <br><br><br> -->

<!-- <p style="text-align:center ; font-size: 24px" > <strong> No FNAME </strong> </p> -->

<span style="color: MediumOrchid;font-size: 18px;background-color: Snow"> <strong>Positive (FDR = 0.068586)</strong> </span>
```{r,echo=FALSE,message=FALSE}
TableOutput(CleanInput(ReadingCSVFunc("Loop/QA/PE/noFNAME/rad3pe.pre.qa.pos.csv")))
```
<br>

<span style="color: LightSeaGreen;font-size: 18px;background-color: Snow"> <strong>Negative  (FDR = 0.020932)</strong> </span>
```{r,echo=FALSE,message=FALSE}

TableOutput(CleanInput(ReadingCSVFunc("Loop/QA/PE/noFNAME/rad3pe.pre.qa.neg.csv")))
```

<hr>

<br><br><br><br>

###### Peri

<!-- <p style="text-align:center ; font-size: 24px" > <strong>Control for FNAME</strong> </p> -->

<!-- <br> -->

<!-- <span style="color: LightSeaGreen;font-size: 18px;background-color: Snow"> <strong>Negative  (FDR = )</strong> </span> -->
<!-- ```{r,echo=FALSE,message=FALSE} -->

<!-- # TableOutput(CleanInput(ReadingCSVFunc(""))) -->
<!-- ``` -->

<!-- <br><br><br> -->

<!-- <p style="text-align:center ; font-size: 24px" > <strong> No FNAME </strong> </p> -->
<!-- <br> -->

<span style="color: LightSeaGreen;font-size: 18px;background-color: Snow"> <strong>Negative  (FDR =  0.048013)</strong> </span>
```{r,echo=FALSE,message=FALSE}

TableOutput(CleanInput(ReadingCSVFunc("Loop/QA/PE/noFNAME/rad3pe.peri.qa.neg.csv")))
```

<hr>

<br><br><br><br>

###### post

<!-- <p style="text-align:center ; font-size: 24px" > <strong>Control for FNAME</strong> </p> -->

<!-- <br> -->

<!-- <span style="color: LightSeaGreen;font-size: 18px;background-color: Snow"> <strong>Negative  (FDR = )</strong> </span> -->
<!-- ```{r,echo=FALSE,message=FALSE} -->

<!-- # TableOutput(CleanInput(ReadingCSVFunc(""))) -->
<!-- ``` -->

<!-- <br><br><br> -->

<!-- <p style="text-align:center ; font-size: 24px" > <strong> No FNAME </strong> </p> -->

No significant results

<hr>

<br><br><br><br>

##### MD {.tabset .tabset-pills}
###### All subject

<!-- <p style="text-align:center ; font-size: 24px" > <strong>Control for FNAME</strong> </p> -->

<!-- <span style="color: LightSeaGreen;font-size: 18px;background-color: Snow"> <strong>Negative  (FDR = 0.086273)</strong> </span> -->
<!-- ```{r,echo=FALSE,message=FALSE} -->
<!-- TableOutput(CleanInput(ReadingCSVFunc("Loop/MD/fname/MD_loop_pe_rad3_all_neg.csv"))) -->
<!-- ``` -->

<!-- <br><br><br> -->

<!-- <p style="text-align:center ; font-size: 24px" > <strong>Previous run</strong> </p> -->

<span style="color: LightSeaGreen;font-size: 18px;background-color: Snow"> <strong>Negative  (FDR = 0.111613)</strong> </span>
```{r,echo=FALSE,message=FALSE}

TableOutput(CleanInput(ReadingCSVFunc("Loop/MD/nofname/PE/rad3pe.all.md.neg.csv")))
```

```{r Extracting fornix from MD and PE, echo=FALSE, results='hide',message=FALSE}

# First thing we need to do is read our CSV AND CLEAN AND ORGANIZE

MD_all_PE <- Extract_raw_values(ReadingCSVFunc("Loop/MD/nofname/PE/rad3pe.all.md.neg.csv"), "MD")

#now lets create a scatter plot with no sex differences
pdf(file = paste0("/Users/danielacossio/Downloads/","fornix_MD_PE.pdf"),width=12, height=8)
 ggplot(MD_all_PE, aes(x=Fornix_L, y=loop_pe_rad3_m)) +
   geom_point(color="#502E23", size=4) +
   geom_smooth(method="lm", level=0.95,color ="#E2929D", se=FALSE,linewidth=2) +
    theme_classic() +
   labs(x ="MD", y = "Position Error", title =  "Fornix L") +
   theme( axis.title.x = element_text(vjust = -4,size = 16),
      axis.text.x = element_text(size = 20),
      axis.text.y = element_text(size = 20),
      axis.title.y = element_text(vjust = 4, size = 16),
      plot.title = element_text(hjust = 0.5 ,size=16),
      panel.border = element_rect(fill=NA,color = "#502E23"),
      panel.background =element_blank(), 
      strip.text.x = element_text(
        size = 16,
        color = "black",
        face = "bold.italic"
      ),
      legend.position = "right",
      legend.key.size = unit(2, 'cm'),
         legend.title = element_text(size=18), #change legend title font size
         legend.text = element_text(size=18),
      plot.margin = margin(2, 1, 2, 1, "cm")) +
   annotate("text", label = "FDR=0.11", x = 2.0, y = 5, color="#E2929D", size=8)

   dev.off()
   
   
   
# Let's do one with the sex differences
   
   

```

<hr>
<br><br><br><br>

###### Females
<!-- <p style="text-align:center ; font-size: 24px" > <strong>Control for FNAME</strong> </p> -->

<!-- <span style="color: LightSeaGreen;font-size: 18px;background-color: Snow"> <strong>Negative  (FDR = 0.000221)</strong> </span> -->
<!-- ```{r,echo=FALSE,message=FALSE} -->
<!-- TableOutput(CleanInput(ReadingCSVFunc("Loop/MD/fname/MD_loop_pe_rad3_fem_neg.csv"))) -->
<!-- ``` -->

<!-- <br><br><br> -->

<!-- <p style="text-align:center ; font-size: 24px" > <strong> no fname </strong> </p> -->

<span style="color: LightSeaGreen;font-size: 18px;background-color: Snow"> <strong>Negative  (FDR = 0.007040)</strong> </span>
```{r,echo=FALSE,message=FALSE}

TableOutput(CleanInput(ReadingCSVFunc("Loop/MD/nofname/PE/rad3pe.fem.md.neg.csv")))
```

<hr>
<br><br><br><br>

###### Males
<!-- <p style="text-align:center ; font-size: 24px" > <strong>Control for FNAME</strong> </p> -->

<!-- <span style="color: MediumOrchid;font-size: 18px;background-color: Snow"> <strong>Positive (FDR = 0.101287)</strong> </span> -->
<!-- ```{r,echo=FALSE,message=FALSE} -->

<!-- TableOutput(CleanInput(ReadingCSVFunc("Loop/MD/fname/MD_loop_pe_rad3_male_pos.csv"))) -->
<!-- ``` -->


<!-- <br><br><br> -->

<!-- <p style="text-align:center ; font-size: 24px" > <strong>No FNAME</strong> </p> -->

<span style="color: MediumOrchid;font-size: 18px;background-color: Snow"> <strong>Positive (FDR = 0.011441)</strong> </span>
```{r,echo=FALSE,message=FALSE}

TableOutput(CleanInput(ReadingCSVFunc("/Loop/MD/nofname/PE/rad3pe.male.md.pos.csv")))
```



```{r sex differences MD and PE,echo=FALSE, results='hide',message=FALSE }
MD_male_PE <- Extract_raw_values(ReadingCSVFunc("/Loop/MD/nofname/PE/rad3pe.male.md.pos.csv"), "MD") %>% select(c("subject_id", "sex", "age_scan_years", "loop_pe_rad3_m", "loop_de_rad3_degree","REPO", "Fornix_L", "Fornix_R")) 

MD_female_PE <- Extract_raw_values(ReadingCSVFunc("Loop/MD/nofname/PE/rad3pe.fem.md.neg.csv"), "MD") %>% select(c("subject_id", "sex", "age_scan_years", "loop_pe_rad3_m", "loop_de_rad3_degree","REPO", "Fornix_L", "Fornix_R")) 

MD_sexdiff_PE <- rbind(MD_female_PE,MD_male_PE)


pdf(file = paste0("/Users/danielacossio/Downloads/","sex_diff_fornix_MD_PE.pdf"),width=12, height=8)
 ggplot(MD_sexdiff_PE, aes(x=Fornix_L, y=loop_pe_rad3_m)) +
   geom_point(size=4, aes(color = factor(sex))) +
   geom_smooth(method="lm", level=0.95,  se=FALSE,linewidth=2, aes(color = factor(sex))) +
   scale_color_manual(values = c("#E2929D","#502E23"), name="Sex")+
   labs(x ="MD", y = "Position Error", title =  "Fornix L") +
   theme( axis.title.x = element_text(vjust = -4,size = 16),
      axis.text.x = element_text(size = 20),
      axis.text.y = element_text(size = 20),
      axis.title.y = element_text(vjust = 4, size = 16),
      plot.title = element_text(hjust = 0.5 ,size=16),
      panel.border = element_rect(fill=NA,color = "#502E23"),
      panel.background =element_blank(), 
      strip.text.x = element_text(
        size = 16,
        color = "black",
        face = "bold.italic"
      ),
      legend.position = "right",
      legend.key.size = unit(2, 'cm'),
         legend.title = element_text(size=18), #change legend title font size
         legend.text = element_text(size=18),
      plot.margin = margin(2, 1, 2, 1, "cm")) +
   annotate("text", label = "FDR< 0.01", x = 2.0, y = 5, color="#E2929D", size=8) +
     annotate("text", label = "FDR= 0.01", x = 2.0 , y = 4.6, color="#502E23", size=8)

   dev.off()
   
   
   
#Box plots 
  #  
  # ggplot(MD_sexdiff_PE, aes(x=sex, y=Fornix_R, group=sex)) +
  #     geom_boxplot(outlier.shape = NA,width =0.5,fill= c("#CF92BF", "#D1E7E6")) +
  #     geom_jitter(color="black",size=0.8,alpha=0.9,width = 0.2)+
  #   stat_summary(fun.y="mean")
```



<hr>
<br><br><br><br>

###### Pre

<span style="color: LightSeaGreen;font-size: 18px;background-color: Snow"> <strong>Negative  (FDR = 0.046384)</strong> </span>
```{r,echo=FALSE,message=FALSE}

TableOutput(CleanInput(ReadingCSVFunc("Loop/MD/nofname/PE/rad3pe.pre.md.neg.csv")))
```
<hr>
<br><br><br><br>

###### Peri
<span style="color: LightSeaGreen;font-size: 18px;background-color: Snow"> <strong>Negative  (FDR = 0.014336)</strong> </span>
```{r,echo=FALSE,message=FALSE}

TableOutput(CleanInput(ReadingCSVFunc("Loop/MD/nofname/PE/rad3pe.peri.md.neg.csv")))
```

<hr>
<br><br><br><br>

###### Post

<span style="color: LightSeaGreen;font-size: 18px;background-color: Snow"> <strong>Negative  (FDR = 0.064846)</strong> </span>
```{r,echo=FALSE,message=FALSE}

TableOutput(CleanInput(ReadingCSVFunc("Loop/MD/nofname/PE/rad3pe.post.md.neg.csv")))
```
<hr>
<br><br><br><br>

#### Average {.tabset .tabset-pills}

##### Summary 
::::::{style="display: flex;"}

:::{.column width="50%"}
**QA FDRs **  
All: (<span style="color: LightSeaGreen;"> - </span>) 0.067564 | **(<span style="color: MediumOrchid;"> + </span>) 0.015957**       
Female: **(<span style="color: LightSeaGreen;"> - </span>) 0.001030** | **(<span style="color: MediumOrchid;"> + </span>) 0.002551**    
Male: **(<span style="color: LightSeaGreen;"> - </span>) 0.017570**   
Pre : **(<span style="color: LightSeaGreen;"> - </span>) 0.037464** | (<span style="color: MediumOrchid;"> + </span>) 0.163683   
Peri: **(<span style="color: LightSeaGreen;"> - </span>) 0.034684**  
Post:  (<span style="color: LightSeaGreen;"> - </span>) 0.145591  
::: 
  
:::{ .column width="50%"}
  **MD FDRs **  
  All: **(<span style="color: LightSeaGreen;"> - </span>) 0.000150**
  Female: **(<span style="color: LightSeaGreen;"> - </span>) 0.000147**     
  Male:  **(<span style="color: MediumOrchid;"> + </span>) 0.006360**    
  Pre : **(<span style="color: LightSeaGreen;"> - </span>) 0.032327**      
  Peri: **(<span style="color: LightSeaGreen;"> - </span>) 0.018830**    
  Post: (<span style="color: LightSeaGreen;"> - </span>) 0.088732
:::
::::::

<br><br>

<hr> 

<br><br> 


##### QA {.tabset .tabset-pills}
###### All subject
<!-- <p style="text-align:center ; font-size: 24px" > <strong>Control for FNAME</strong> </p> -->

<!-- <span style="color: LightSeaGreen;font-size: 18px;background-color: Snow"> <strong>Negative  (FDR = 0.002682)</strong> </span> -->
<!-- ```{r,echo=FALSE,message=FALSE} -->
<!-- TableOutput(CleanInput(ReadingCSVFunc("Loop/QA/PE/fname_cov/all.loopPE.average.neg.csv"))) -->
<!-- ``` -->

<!-- <br><br><br> -->

<!-- <p style="text-align:center ; font-size: 24px" > <strong>No FNAME</strong> </p> -->

<span style="color: MediumOrchid;font-size: 18px;background-color: Snow"> <strong>Positive (FDR = 0.015957)</strong> </span>
```{r,echo=FALSE,message=FALSE}
TableOutput(CleanInput(ReadingCSVFunc("Loop/QA/PE/noFNAME/avgpe.all.qa.pos.csv")))
```

<br>

<span style="color: LightSeaGreen;font-size: 18px;background-color: Snow"> <strong>Negative  (FDR = 0.067564)</strong> </span>
```{r,echo=FALSE,message=FALSE}
TableOutput(CleanInput(ReadingCSVFunc("Loop/QA/PE/noFNAME/avgpe.all.qa.neg.csv")))
```

<hr>
<br><br><br><br>

###### Females
<!-- <p style="text-align:center ; font-size: 24px" > <strong>Control for FNAME</strong> </p> -->

<!-- <span style="color: MediumOrchid;font-size: 18px;background-color: Snow"> <strong>Positive (FDR =  0.001412)</strong> </span> -->
<!-- ```{r,echo=FALSE,message=FALSE} -->
<!-- TableOutput(CleanInput(ReadingCSVFunc("Loop/QA/PE/fname_cov/female.loopPE.average.pos.csv"))) -->
<!-- ``` -->


<!-- <span style="color: LightSeaGreen;font-size: 18px;background-color: Snow"> <strong>Negative  (FDR = 0.003136)</strong> </span> -->
<!-- ```{r,echo=FALSE,message=FALSE} -->
<!-- TableOutput(CleanInput(ReadingCSVFunc("Loop/QA/PE/fname_cov/female.loopPE.average.neg.csv"))) -->
<!-- ``` -->

<!-- <br><br><br> -->

<!-- <p style="text-align:center ; font-size: 24px" > <strong>No FNAME</strong> </p> -->

<span style="color: MediumOrchid;font-size: 18px;background-color: Snow"> <strong>Positive (FDR =  0.002551)</strong> </span>
```{r,echo=FALSE,message=FALSE}
TableOutput(CleanInput(ReadingCSVFunc("Loop/QA/PE/noFNAME/avgpe.fem.qa.pos.csv")))
```
<br>

<span style="color: LightSeaGreen;font-size: 18px;background-color: Snow"> <strong>Negative  (FDR = 0.001030)</strong> </span>
```{r,echo=FALSE,message=FALSE}
TableOutput(CleanInput(ReadingCSVFunc("Loop/QA/PE/noFNAME/avgpe.fem.qa.neg.csv")))
```

<hr>
<br><br><br><br>

###### Males
<!-- <p style="text-align:center ; font-size: 24px" > <strong>Control for FNAME</strong> </p> -->

<!-- <span style="color: LightSeaGreen;font-size: 18px;background-color: Snow"> <strong>Negative  (FDR = 0.015386)</strong> </span> -->
<!-- ```{r,echo=FALSE,message=FALSE} -->
<!-- TableOutput(CleanInput(ReadingCSVFunc("Loop/QA/PE/fname_cov/males.loopPE.average.neg.csv"))) -->
<!-- ``` -->

<!-- <br><br><br> -->

<!-- <p style="text-align:center ; font-size: 24px" > <strong>No FNAME</strong> </p> -->
<span style="color: LightSeaGreen;font-size: 18px;background-color: Snow"> <strong>Negative  (FDR = 0.017570)</strong> </span>
```{r,echo=FALSE,message=FALSE}
TableOutput(CleanInput(ReadingCSVFunc("Loop/QA/PE/noFNAME/avgpe.male.qa.neg.csv")))
```

<hr>
<br><br><br><br>


###### Pre
<!-- <p style="text-align:center ; font-size: 24px" > <strong>Control for FNAME</strong> </p> -->

<!-- <span style="color: LightSeaGreen;font-size: 18px;background-color: Snow"> <strong>Negative  (FDR = 0.051982)</strong> </span> -->
<!-- ```{r,echo=FALSE,message=FALSE} -->
<!-- TableOutput(CleanInput(ReadingCSVFunc("Loop/QA/PE/fname_cov/pre.LoopPE.ave.neg.csv"))) -->
<!-- ``` -->

<!-- <br><br> -->

<!-- <p style="text-align:center ; font-size: 24px" > <strong>No FNAME</strong> </p> -->

<span style="color: MediumOrchid;font-size: 18px;background-color: Snow"> <strong>Positive (FDR =  0.163683)</strong> </span>
```{r,echo=FALSE,message=FALSE}
TableOutput(CleanInput(ReadingCSVFunc("Loop/QA/PE/noFNAME/avgpe.pre.qa.pos.csv")))
```
<br>

<span style="color: LightSeaGreen;font-size: 18px;background-color: Snow"> <strong>Negative  (FDR = 0.037464)</strong> </span>
```{r,echo=FALSE,message=FALSE}
TableOutput(CleanInput(ReadingCSVFunc("Loop/QA/PE/noFNAME/avgpe.pre.qa.neg.csv")))
```

<hr>
<br><br><br><br>

###### Peri
<!-- <p style="text-align:center ; font-size: 24px" > <strong>Control for FNAME</strong> </p> -->

<!-- <br><br> -->

<!-- <p style="text-align:center ; font-size: 24px" > <strong>No FNAME</strong> </p> -->

<span style="color: LightSeaGreen;font-size: 18px;background-color: Snow"> <strong>Negative  (FDR = 0.034684)</strong> </span>
```{r,echo=FALSE,message=FALSE}
TableOutput(CleanInput(ReadingCSVFunc("Loop/QA/PE/noFNAME/avgpe.peri.qa.neg.csv")))
```
<hr>
<br><br><br><br>

###### post
<!-- <p style="text-align:center ; font-size: 24px" > <strong>Control for FNAME</strong> </p> -->
<!-- did not run  -->
<!-- <br><br> -->

<!-- <p style="text-align:center ; font-size: 24px" > <strong>No FNAME</strong> </p> -->

<span style="color: LightSeaGreen;font-size: 18px;background-color: Snow"> <strong>Negative  (FDR = 0.145591)</strong> </span>
```{r,echo=FALSE,message=FALSE}
TableOutput(CleanInput(ReadingCSVFunc("Loop/QA/PE/noFNAME/avgpe.post.qa.neg.csv")))
```

<hr>
<br><br><br><br>

##### MD{.tabset .tabset-pills}
###### All subject

<span style="color: LightSeaGreen;font-size: 18px;background-color: Snow"> <strong>Negative  (FDR = 0.000150)</strong> </span>
```{r,echo=FALSE,message=FALSE}

TableOutput(CleanInput(ReadingCSVFunc("Loop/MD/nofname/PE/avepe.all.md.neg.csv")))
```
<hr>
<br><br><br><br>

###### Females
<span style="color: LightSeaGreen;font-size: 18px;background-color: Snow"> <strong>Negative  (FDR = 0.000147)</strong> </span>
```{r,echo=FALSE,message=FALSE}

TableOutput(CleanInput(ReadingCSVFunc("Loop/MD/nofname/PE/avgpe.fem.md.neg.csv")))
```
<hr>
<br><br><br><br>

###### Males
<span style="color: MediumOrchid;font-size: 18px;background-color: Snow"> <strong>Positive (FDR = 0.006360)</strong> </span>
```{r,echo=FALSE,message=FALSE}

TableOutput(CleanInput(ReadingCSVFunc("/Loop/MD/nofname/PE/avgpe.male.md.pos.csv")))
```
<hr>
<br><br><br><br>

###### Pre
<span style="color: LightSeaGreen;font-size: 18px;background-color: Snow"> <strong>Negative  (FDR = 0.032327)</strong> </span>
```{r,echo=FALSE,message=FALSE}

TableOutput(CleanInput(ReadingCSVFunc("Loop/MD/nofname/PE/avgpe.pre.md.neg.csv")))
```
<hr>
<br><br><br><br>

###### Peri
<span style="color: MediumOrchid;font-size: 18px;background-color: Snow"> <strong>Positive (FDR = 0.018830)</strong> </span>
```{r,echo=FALSE,message=FALSE}

TableOutput(CleanInput(ReadingCSVFunc("/Loop/MD/nofname/PE/avgpe.peri.md.neg.csv")))
```

<hr>
<br><br><br><br>

###### Post
<span style="color: MediumOrchid;font-size: 18px;background-color: Snow"> <strong>Positive (FDR = 0.088732)</strong> </span>
```{r,echo=FALSE,message=FALSE}

TableOutput(CleanInput(ReadingCSVFunc("/Loop/MD/nofname/PE/avgpe.post.md.neg.csv")))
```
<hr>
<br><br><br><br>


### **Degrees Traveled** {.tabset .tabset-dropdown} 
#### Rad3 {.tabset .tabset-pills}
##### summary

::::::{style="display: flex;"}

:::{.column width="50%"}

**QA FDRs **  
All: **(<span style="color: MediumOrchid;"> + </span>) 0.000549**         
Female: **(<span style="color: MediumOrchid;"> + </span>) 0.000189**     
Male: (<span style="color: MediumOrchid;"> + </span>) 0.082808   
Pre : **(<span style="color: LightSeaGreen;"> - </span>) 0.007108**  | (<span style="color: MediumOrchid;"> + </span>) 0.077631        
Peri: (<span style="color: LightSeaGreen;"> - </span>) 0.068688     
Post: No significant Results
::: 
  
:::{ .column width="50%"}

  **MD FDRs **  
  All: **(<span style="color: MediumOrchid;"> + </span>) 0.019884**         
  Female: No significant Tracts     
  Male: No significant Tracts    
  Pre : (<span style="color: MediumOrchid;"> + </span>) 0.135399        
  Peri: **(<span style="color: LightSeaGreen;"> - </span>) 0.023040**     
  Post: **(<span style="color: LightSeaGreen;"> - </span>) 0.035402**
:::
::::::

<br><br>

<hr> 

<br><br> 

##### QA {.tabset .tabset-pills}
###### All subject

<!-- <p style="text-align:center ; font-size: 24px" > <strong>Control for FNAME</strong> </p> -->

<!-- <span style="color: MediumOrchid;font-size: 18px;background-color: Snow"> <strong>Positive (FDR = 0.000183)</strong> </span> -->
<!-- ```{r,echo=FALSE,message=FALSE} -->
<!-- TableOutput(CleanInput(ReadingCSVFunc("Loop/QA/DE/fname/all.loopDE.rad3.pos.csv"))) -->
<!-- ``` -->

<!-- <br><br> -->

<!-- <p style="text-align:center ; font-size: 24px" > <strong> No FNAME </strong> </p> -->

<span style="color: MediumOrchid;font-size: 18px;background-color: Snow"> <strong>Positive (FDR =  0.000549)</strong> </span>
```{r,echo=FALSE,message=FALSE}
TableOutput(CleanInput(ReadingCSVFunc("Loop/QA/DE/nofname/rad3de.all.qa.pos.csv")))
```

```{r Extracting corticospinal tract R from QA and DE, echo=FALSE, results='hide',message=FALSE}

# First thing we need to do is read our CSV AND CLEAN AND ORGANIZE

QA_all_DE <- Extract_raw_values(ReadingCSVFunc("Loop/QA/DE/nofname/rad3de.all.qa.pos.csv"), "QA")

#now lets create a scatter plot with no sex differences
pdf(file = paste0("/Users/danielacossio/Downloads/","CSTr_QA_DE.pdf"),width=12, height=8)
 ggplot(QA_all_DE, aes(x=Corticospinal_Tract_R, y=loop_de_rad3_degree)) +
   geom_point(color="#502E23", size=4) +
   geom_smooth(method="lm", level=0.95,color ="#E2929D", se=FALSE,linewidth=2) +
    theme_classic() +
   labs(x ="QA", y = "Degrees Traveled", title =  "Cortical Spinal Tract R") +
   theme( axis.title.x = element_text(vjust = -4,size = 16),
      axis.text.x = element_text(size = 25),
      axis.text.y = element_text(size = 25),
      axis.title.y = element_text(vjust = 4, size = 16),
      plot.title = element_text(hjust = 0.5 ,size=16),
      panel.border = element_rect(fill=NA,color = "#502E23"),
      panel.background =element_blank(), 
      strip.text.x = element_text(
        size = 16,
        color = "black",
        face = "bold.italic"
      ),
      legend.position = "right",
      legend.key.size = unit(2, 'cm'),
         legend.title = element_text(size=18), #change legend title font size
         legend.text = element_text(size=18),
      plot.margin = margin(2, 1, 2, 1, "cm")) +
   annotate("text", label = "FDR< 0.001", x = 0.3, y = 550, color="#E2929D", size=8)

   dev.off()
   
   
```

<hr>
<br><br><br><br>

###### Females
<!-- <p style="text-align:center ; font-size: 24px" > <strong>Control for FNAME</strong> </p> -->

<!-- <span style="color: MediumOrchid;font-size: 18px;background-color: Snow"> <strong>Positive (FDR =  0.000076)</strong> </span> -->
<!-- ```{r,echo=FALSE,message=FALSE} -->
<!-- TableOutput(CleanInput(ReadingCSVFunc("/Loop/QA/DE/fname/female.loopDE.rad3.pos.csv"))) -->
<!-- ``` -->

<!-- <br> -->

<!-- <span style="color: LightSeaGreen;font-size: 18px;background-color: Snow"> <strong>Negative  (FDR = 0.062500)</strong> </span> -->
<!-- ```{r,echo=FALSE,message=FALSE} -->

<!-- TableOutput(CleanInput(ReadingCSVFunc("Loop/QA/DE/fname/female.loopDE.rad3.neg.csv"))) -->
<!-- ``` -->

<!-- <br><br><br> -->

<!-- <p style="text-align:center ; font-size: 24px" > <strong> No FNAME</strong> </p> -->


<span style="color: MediumOrchid;font-size: 18px;background-color: Snow"> <strong>Positive (FDR =  0.000189)</strong> </span>
```{r,echo=FALSE,message=FALSE}

TableOutput(CleanInput(ReadingCSVFunc("Loop/QA/DE/nofname/rad3de.fem.qa.pos.csv")))
```

<hr>
<br><br><br><br>


###### Males
<!-- <p style="text-align:center ; font-size: 24px" > <strong>Control for FNAME</strong> </p> -->

<!-- <span style="color: MediumOrchid;font-size: 18px;background-color: Snow"> <strong>Positive (FDR =  0.178310)</strong> </span> -->
<!-- ```{r,echo=FALSE,message=FALSE} -->
<!-- TableOutput(CleanInput(ReadingCSVFunc("/Loop/QA/DE/fname/males.loopDE.rad3.pos.csv"))) -->
<!-- ``` -->

<!-- <br><br><br> -->

<!-- <p style="text-align:center ; font-size: 24px" > <strong> No FNAME </strong> </p> -->

<span style="color: MediumOrchid;font-size: 18px;background-color: Snow"> <strong>Positive (FDR =  0.082808)</strong> </span>
```{r,echo=FALSE,message=FALSE}
TableOutput(CleanInput(ReadingCSVFunc("Loop/QA/DE/nofname/rad3de.male.qa.pos.csv")))
```

<hr>
<br><br><br><br>


###### Pre
<!-- <p style="text-align:center ; font-size: 24px" > <strong>Control for FNAME</strong> </p> -->

<!-- no significant results -->
<!-- <br> -->

<!-- <p style="text-align:center ; font-size: 24px" > <strong> No FNAME</strong> </p> -->

<span style="color: MediumOrchid;font-size: 18px;background-color: Snow"> <strong>Positive (FDR =  0.077631)</strong> </span>

```{r,echo=FALSE,message=FALSE}

TableOutput(CleanInput(ReadingCSVFunc("Loop/QA/DE/nofname/rad3de.pre.qa.pos.csv")))
```
<br>

<span style="color: LightSeaGreen;font-size: 18px;background-color: Snow"> <strong>Negative  (FDR = 0.007108)</strong> </span>

```{r,echo=FALSE,message=FALSE}
TableOutput(CleanInput(ReadingCSVFunc("Loop/QA/DE/nofname/rad3de.pre.qa.neg.csv")))
```

<hr>
<br><br><br><br>

###### Peri
<!-- <p style="text-align:center ; font-size: 24px" > <strong>Control for FNAME</strong> </p> -->
<!-- did not run -->

<!-- <p style="text-align:center ; font-size: 24px" > <strong> No FNAME</strong> </p> -->


<span style="color: LightSeaGreen;font-size: 18px;background-color: Snow"> <strong>Negative  (FDR = 0.068688)</strong> </span>

```{r,echo=FALSE,message=FALSE}

TableOutput(CleanInput(ReadingCSVFunc("Loop/QA/DE/nofname/rad3de.peri.qa.neg.csv")))
```

<hr>

<br><br><br><br>


###### Post

No significant results

<br><br><br><br>

<hr>
<br>

##### MD {.tabset .tabset-pills}
###### All subject
<!-- <p style="text-align:center ; font-size: 24px" > <strong>Control for FNAME</strong> </p> -->

<!-- <span style="color: MediumOrchid;font-size: 18px;background-color: Snow"> <strong>Positive (FDR =  0.042231)</strong> </span> -->
<!-- ```{r,echo=FALSE,message=FALSE} -->
<!-- rad3DE_pos_MD_all <- CleanInput(ReadingCSVFunc("/Loop/MD/fname/MD_loop_DE_rad3_all_pos.csv")) -->

<!-- TableOutput(rad3DE_pos_MD_all, "Table 1.Tracts with MD positively associated with loop Degrees Traveled") -->
<!-- ``` -->

<!-- <br><br><br> -->

<!-- <p style="text-align:center ; font-size: 24px" > <strong>Previous run</strong> </p> -->
<span style="color: MediumOrchid;font-size: 18px;background-color: Snow"> <strong>Positive (FDR =  0.019884)</strong> </span>
```{r,echo=FALSE,message=FALSE}
TableOutput(CleanInput(ReadingCSVFunc("Loop/MD/nofname/DE/rad3de.all.md.pos.csv")))
```


```{r Extracting Fornix R tract R from MD and DE, echo=FALSE, results='hide',message=FALSE}

# First thing we need to do is read our CSV AND CLEAN AND ORGANIZE

MD_all_DE <- Extract_raw_values(ReadingCSVFunc("Loop/MD/nofname/DE/rad3de.all.md.pos.csv"), "MD")

#now lets create a scatter plot with no sex differences
pdf(file = paste0("/Users/danielacossio/Downloads/","fornix_MD_DE.pdf"),width=12, height=8)
 ggplot(MD_all_DE, aes(x=Fornix_L, y=loop_de_rad3_degree)) +
   geom_point(color="#502E23", size=4) +
   geom_smooth(method="lm", level=0.95,color ="#E2929D", se=FALSE,linewidth=2) +
    theme_classic() +
   labs(x ="MD", y = "Degrees Traveled", title =  "Fornix L") +
   theme( axis.title.x = element_text(vjust = -4,size = 16),
      axis.text.x = element_text(size = 20),
      axis.text.y = element_text(size = 20),
      axis.title.y = element_text(vjust = 4, size = 16),
      plot.title = element_text(hjust = 0.5 ,size=16),
      panel.border = element_rect(fill=NA,color = "#502E23"),
      panel.background =element_blank(), 
      strip.text.x = element_text(
        size = 16,
        color = "black",
        face = "bold.italic"
      ),
      legend.position = "right",
      legend.key.size = unit(2, 'cm'),
         legend.title = element_text(size=18), #change legend title font size
         legend.text = element_text(size=18),
      plot.margin = margin(2, 1, 2, 1, "cm")) +
   annotate("text", label = "FDR< 0.001", x = 1.6, y = 550, color="#E2929D", size=8)

   dev.off()
   
   
```
<hr>
<br><br><br><br>

###### Females

No results

<br><br><br>

<!-- <p style="text-align:center ; font-size: 24px" > <strong>Control for FNAME</strong> </p> -->
<!-- <span style="color: MediumOrchid;font-size: 18px;background-color: Snow"> <strong>Positive (FDR =  0.100772)</strong> </span> -->
<!-- ```{r,echo=FALSE,message=FALSE} -->
<!-- TableOutput(CleanInput(ReadingCSVFunc("Loop/MD/fname/MD_loop_De_rad3_fem_pos.csv")), "Table 1.Tracts with MD positively associated with loop Degrees Traveled") -->
<!-- ``` -->

<!-- <br> -->

<!-- <span style="color: LightSeaGreen;font-size: 18px;background-color: Snow"> <strong>Negative  (FDR = 0.023033)</strong> </span> -->
<!-- ```{r,echo=FALSE,message=FALSE} -->
<!-- TableOutput(CleanInput(ReadingCSVFunc("Loop/MD/fname/MD_loop_De_rad3_fem_neg.csv")), "Table 1.Tracts with MD negatively associated with loop PE") -->
<!-- ``` -->
<!-- <br><br><br> -->

<!-- <p style="text-align:center ; font-size: 24px" > <strong>Previous run</strong> </p> -->

<hr>
<br><br><br><br>


###### Males

No results

<br><br><br>

<hr>

###### Pre

<span style="color: MediumOrchid;font-size: 18px;background-color: Snow"> <strong>Positive (FDR = 0.135399 )</strong> </span>
```{r,echo=FALSE,message=FALSE}
TableOutput(CleanInput(ReadingCSVFunc("Loop/MD/nofname/DE/rad3de.pre.md.pos.csv")))
```

<br><br>

<hr>

<br><br>

###### Peri

<span style="color: LightSeaGreen;font-size: 18px;background-color: Snow"> <strong>Negative  (FDR =0.023040)</strong> </span>

```{r,echo=FALSE,message=FALSE}
TableOutput(CleanInput(ReadingCSVFunc("Loop/MD/nofname/DE/rad3de.peri.md.neg.csv")))
```

<br><br><br><br>

<hr>

###### Post

<span style="color: LightSeaGreen;font-size: 18px;background-color: Snow"> <strong>Negative  (FDR =0.035402)</strong> </span>

```{r,echo=FALSE,message=FALSE}
TableOutput(CleanInput(ReadingCSVFunc("Loop/MD/nofname/DE/rad3de.post.neg.csv")))
```

<br><br><br><br>

<hr>


#### average {.tabset .tabset-pills}
##### Summary 
::::::{style="display: flex;"}

:::{.column width="50%"}
**QA FDRs **  
All: **(<span style="color: MediumOrchid;"> + </span>) 0.000385**         
Female: **(<span style="color: MediumOrchid;"> + </span>) 0.000577**     
Male: (<span style="color: LightSeaGreen;"> - </span>) 0.149973  | **(<span style="color: MediumOrchid;"> + </span>) 0.013758**    
Pre : **(<span style="color: LightSeaGreen;"> - </span>) 0.006990**  | **(<span style="color: MediumOrchid;"> + </span>) 0.017587**        
Peri: No significant Results    
Post: No significant Results
::: 
  
:::{ .column width="50%"}
  **MD FDRs **  
  All: **(<span style="color: MediumOrchid;"> + </span>) 0.000194**         
  Female: **(<span style="color: MediumOrchid;"> + </span>) 0.006897**     
  Male: **(<span style="color: MediumOrchid;"> + </span>) 0.036723**    
  Pre : (<span style="color: MediumOrchid;"> + </span>) 0.140900        
  Peri: (<span style="color: LightSeaGreen;"> - </span>) 0.080523     
  Post: (<span style="color: LightSeaGreen;"> - </span>) 0.087945
:::
::::::

<br><br>

<hr>

<br><br>

##### QA {.tabset .tabset-pills}
###### all subs
<!-- <p style="text-align:center ; font-size: 24px" > <strong>Control for FNAME</strong> </p> -->

<!-- <span style="color: MediumOrchid;font-size: 18px;background-color: Snow"> <strong>Positive (FDR = 0.000163 )</strong> </span> -->
<!-- ```{r,echo=FALSE,message=FALSE} -->
<!-- TableOutput(CleanInput(ReadingCSVFunc("Loop/QA/DE/fname/all.loopDE.ave.pos.csv"))) -->
<!-- ``` -->

<!-- <br><br> -->

<!-- <p style="text-align:center ; font-size: 24px" > <strong> No FNAME </strong> </p> -->

<span style="color: MediumOrchid;font-size: 18px;background-color: Snow"> <strong>Positive (FDR = 0.000385 )</strong> </span>

```{r,echo=FALSE,message=FALSE}
TableOutput(CleanInput(ReadingCSVFunc("Loop/QA/DE/nofname/avgde.all.qa.pos.csv")))
```
<br><br><br><br>

<hr>

###### males
<!-- <p style="text-align:center ; font-size: 24px" > <strong>Control for FNAME</strong> </p> -->

<!-- <span style="color: MediumOrchid;font-size: 18px;background-color: Snow"> <strong>Positive (FDR = 0.008738 )</strong> </span> -->
<!-- ```{r,echo=FALSE,message=FALSE} -->
<!-- TableOutput(CleanInput(ReadingCSVFunc("Loop/QA/DE/fname/male.loopDE.ave.pos.csv"))) -->
<!-- ``` -->

<!-- <span style="color: LightSeaGreen;font-size: 18px;background-color: Snow"> <strong>Negative  (FDR = 0.098032 )</strong> </span> -->
<!-- ```{r,echo=FALSE,message=FALSE} -->
<!-- TableOutput(CleanInput(ReadingCSVFunc("Loop/QA/DE/fname/male.loopDE.ave.neg.csv"))) -->
<!-- ``` -->

<!-- <br><br> -->

<!-- <p style="text-align:center ; font-size: 24px" > <strong> No FNAME </strong> </p> -->

<span style="color: MediumOrchid;font-size: 18px;background-color: Snow"> <strong>Positive (FDR = 0.013758)</strong> </span>
```{r,echo=FALSE,message=FALSE}
TableOutput(CleanInput(ReadingCSVFunc("Loop/QA/DE/nofname/avgde.male.qa.pos.csv")))
```

<br>

<span style="color: LightSeaGreen;font-size: 18px;background-color: Snow"> <strong>Negative  (FDR =0.149973)</strong> </span>
```{r,echo=FALSE,message=FALSE}
TableOutput(CleanInput(ReadingCSVFunc("Loop/QA/DE/nofname/avgde.male.qa.neg.csv")))
```
<br><br><br><br>

<hr>

###### females
<!-- <p style="text-align:center ; font-size: 24px" > <strong>Control for FNAME</strong> </p> -->

<!-- <span style="color: MediumOrchid;font-size: 18px;background-color: Snow"> <strong>Positive (FDR = 0.000274)</strong> </span> -->
<!-- ```{r,echo=FALSE,message=FALSE} -->
<!-- TableOutput(CleanInput(ReadingCSVFunc("Loop/QA/DE/fname/female.loopDE.ave.pos.csv"))) -->
<!-- ``` -->

<!-- <br><br> -->

<!-- <p style="text-align:center ; font-size: 24px" > <strong> No FNAME </strong> </p> -->

<span style="color: MediumOrchid;font-size: 18px;background-color: Snow"> <strong>Positive (FDR = 0.000577)</strong> </span>
```{r,echo=FALSE,message=FALSE}
TableOutput(CleanInput(ReadingCSVFunc("Loop/QA/DE/nofname/avgde.fem.qa.pos.csv")))
```

<br><br><br><br>

<hr>

###### pre
<!-- <p style="text-align:center ; font-size: 24px" > <strong>Control for FNAME</strong> </p> -->

<!-- No results  -->

<!-- <br><br> -->

<!-- <p style="text-align:center ; font-size: 24px" > <strong> No FNAME </strong> </p> -->

<span style="color: MediumOrchid;font-size: 18px;background-color: Snow"> <strong>Positive (FDR = 0.017587)</strong> </span>
```{r,echo=FALSE,message=FALSE}
TableOutput(CleanInput(ReadingCSVFunc("Loop/QA/DE/nofname/avgde.pre.qa.pos.csv")))
```
<br>

<span style="color: LightSeaGreen;font-size: 18px;background-color: Snow"> <strong>Negative  (FDR = 0.006990)</strong> </span>
```{r,echo=FALSE,message=FALSE}
TableOutput(CleanInput(ReadingCSVFunc("Loop/QA/DE/nofname/avgde.pre.qa.neg.csv")))
```
<br><br><br><br>

<hr>

###### peri

<br><br><br><br>

<hr>


###### post

<br><br><br><br>

<hr>


##### MD {.tabset .tabset-pills}
###### all subs
<span style="color: MediumOrchid;font-size: 18px;background-color: Snow"> <strong>Positive (FDR =  0.000194)</strong> </span>
```{r,echo=FALSE,message=FALSE}
TableOutput(CleanInput(ReadingCSVFunc("Loop/MD/nofname/DE/avgde.all.md.pos.csv")))
```

<br><br><br><br>

<hr>

###### males

<span style="color: MediumOrchid;font-size: 18px;background-color: Snow"> <strong>Positive (FDR =  0.036723)</strong> </span>

```{r,echo=FALSE,message=FALSE}
TableOutput(CleanInput(ReadingCSVFunc("Loop/MD/nofname/DE/avgde.male.md.pos.csv")))
```

<br><br><br><br>

<hr>

###### females


<span style="color: MediumOrchid;font-size: 18px;background-color: Snow"> <strong>Positive (FDR =  0.006897)</strong> </span>

```{r,echo=FALSE,message=FALSE}
TableOutput(CleanInput(ReadingCSVFunc("Loop/MD/nofname/DE/avgde.fem.md.pos.csv")))
```

<br><br><br><br>

<hr>

###### pre

<span style="color: MediumOrchid;font-size: 18px;background-color: Snow"> <strong>Positive (FDR =  0.140900)</strong> </span>

```{r,echo=FALSE,message=FALSE}
TableOutput(CleanInput(ReadingCSVFunc("Loop/MD/nofname/DE/avgde.pre.md.pos.csv")))
```

<br><br><br><br>

<hr>

###### peri

<span style="color: LightSeaGreen;font-size: 18px;background-color: Snow"> <strong>Negative  (FDR = 0.080523)</strong> </span>
```{r,echo=FALSE,message=FALSE}
TableOutput(CleanInput(ReadingCSVFunc("Loop/MD/nofname/DE/avgde.peri.md.neg.csv")))
```
<br><br><br><br>

<hr>

###### post

<span style="color: LightSeaGreen;font-size: 18px;background-color: Snow"> <strong> Negative  (FDR = 0.087945)</strong> </span>

```{r,echo=FALSE,message=FALSE}
TableOutput(CleanInput(ReadingCSVFunc("Loop/MD/nofname/DE/avgde.post.md.neg.csv")))
```

<br><br><br><br>

<hr>

### **Angular Error** {.tabset .tabset-dropdown}
#### Rad3 {.tabset .tabset-pills}
##### Summary 

::::::{style="display: flex;"}

:::{.column width="50%"} 
**QA FDRs **  
All: **(<span style="color: LightSeaGreen;"> - </span>) 0.000151**         
Female: **(<span style="color: LightSeaGreen;"> - </span>) 0.009456**  | **(<span style="color: MediumOrchid;"> + </span>) 0.007463**    
Male: **(<span style="color: LightSeaGreen;"> - </span>) 0.015257**  | (<span style="color: MediumOrchid;"> + </span>) 0.198113    
Pre : **(<span style="color: LightSeaGreen;"> - </span>) 0.027984**  | (<span style="color: MediumOrchid;"> + </span>) 0.087579     
Peri: **(<span style="color: LightSeaGreen;"> - </span>) 0.029396**    
Post: No significant Results
::: 
  
:::{ .column width="50%"}
  **MD FDRs **  
  All: **(<span style="color: LightSeaGreen;"> - </span>) 0.057542**         
  Female: **(<span style="color: LightSeaGreen;"> - </span>) 0.001810**     
  Male: **(<span style="color: MediumOrchid;"> + </span>) 0.027344**    
  Pre : **(<span style="color: LightSeaGreen;"> - </span>) 0.035685**      
  Peri: **(<span style="color: LightSeaGreen;"> - </span>) 0.017843**     
  Post: No significant Results
:::
::::::


<br><br>

<hr>

<br><br>

##### QA {.tabset .tabset-pills}
###### all subs

<!-- <p style="text-align:center ; font-size: 24px" > <strong>Control for FNAME</strong> </p> -->

<!-- <span style="color: LightSeaGreen;font-size: 18px;background-color: Snow"> <strong>Negative  (FDR = 0.000188)</strong> </span> -->
<!-- ```{r, echo=FALSE,message=FALSE} -->
<!-- TableOutput(CleanInput(ReadingCSVFunc("Loop/QA/AE/fname/all.loopAE.rad3.neg.csv"))) -->
<!-- ``` -->

<!-- <br> -->

<!-- <p style="text-align:center ; font-size: 24px" > <strong> No FNAME</strong> </p> -->

<span style="color: LightSeaGreen;font-size: 18px;background-color: Snow"> <strong>Negative  (FDR = 0.000151)</strong> </span>
```{r, echo=FALSE,message=FALSE}
TableOutput(CleanInput(ReadingCSVFunc("Loop/QA/AE/nofname/rad3ae.all.qa.neg.csv")))
```

<br><br><br><br>


###### males
<!-- <p style="text-align:center ; font-size: 24px" > <strong>Control for FNAME</strong> </p> -->

<!-- <span style="color: LightSeaGreen;font-size: 18px;background-color: Snow"> <strong>Negative  (FDR = 0.026294)</strong> </span> -->
<!-- ```{r, echo=FALSE,message=FALSE} -->
<!-- TableOutput(CleanInput(ReadingCSVFunc("Loop/QA/AE/fname/male.loopAE.rad3.neg.csv"))) -->
<!-- ``` -->

<!-- <br><br> -->

<!-- <p style="text-align:center ; font-size: 24px" > <strong>No FNAME</strong> </p> -->

<span style="color: MediumOrchid;font-size: 18px;background-color: Snow"> <strong>Positive (FDR = 0.198113)</strong> </span>
```{r,echo=FALSE,message=FALSE}
TableOutput(CleanInput(ReadingCSVFunc("Loop/QA/AE/nofname/rad3ae.male.qa.pos.csv")))
```
<br>

<span style="color: LightSeaGreen;font-size: 18px;background-color: Snow"> <strong>Negative  (FDR = 0.015257)</strong> </span>
```{r, echo=FALSE,message=FALSE}
TableOutput(CleanInput(ReadingCSVFunc("Loop/QA/AE/nofname/rad3ae.male.qa.neg.csv")))
```
<br><br><br><br>

###### females
<!-- <p style="text-align:center ; font-size: 24px" > <strong>Control for FNAME</strong> </p> -->

<!-- <span style="color: MediumOrchid;font-size: 18px;background-color: Snow"> <strong>Positive (FDR = 0.077778)</strong> </span> -->
<!-- ```{r,echo=FALSE,message=FALSE} -->
<!-- TableOutput(CleanInput(ReadingCSVFunc("Loop/QA/AE/fname/female.loopAE.rad3.pos.csv"))) -->
<!-- ``` -->

<!-- <span style="color: LightSeaGreen;font-size: 18px;background-color: Snow"> <strong>Negative  (FDR = 0.006016)</strong> </span> -->
<!-- ```{r, echo=FALSE,message=FALSE} -->
<!-- TableOutput(CleanInput(ReadingCSVFunc("Loop/QA/AE/fname/female.loopAE.rad3.neg.csv"))) -->
<!-- ``` -->

<!-- <p style="text-align:center ; font-size: 24px" > <strong>No FNAME</strong> </p> -->

<span style="color: MediumOrchid;font-size: 18px;background-color: Snow"> <strong>Positive (FDR = 0.007463)</strong> </span>
```{r,echo=FALSE,message=FALSE}
TableOutput(CleanInput(ReadingCSVFunc("Loop/QA/AE/nofname/rad3ae.fem.qa.pos.csv")))
```
<br>

<span style="color: LightSeaGreen;font-size: 18px;background-color: Snow"> <strong>Negative  (FDR = 0.009456)</strong> </span>
```{r, echo=FALSE,message=FALSE}
TableOutput(CleanInput(ReadingCSVFunc("Loop/QA/AE/nofname/rad3ae.fem.qa.neg.csv")))
```

<br><br><br><br>

###### pre
<!-- <p style="text-align:center ; font-size: 24px" > <strong>Control for FNAME</strong> </p> -->

<!-- <p style="text-align:center ; font-size: 24px" > <strong>No FNAME</strong> </p> -->

<span style="color: MediumOrchid;font-size: 18px;background-color: Snow"> <strong>Positive (FDR = 0.087579)</strong> </span>
```{r,echo=FALSE,message=FALSE}
TableOutput(CleanInput(ReadingCSVFunc("Loop/QA/AE/nofname/rad3ae.pre.qa.pos.csv")))
```
<br>

<span style="color: LightSeaGreen;font-size: 18px;background-color: Snow"> <strong>Negative  (FDR = 0.027984)</strong> </span>
```{r, echo=FALSE,message=FALSE}
TableOutput(CleanInput(ReadingCSVFunc("Loop/QA/AE/nofname/rad3ae.pre.qa.neg.csv")))
```

<br><br><br><br>

###### peri

<!-- <p style="text-align:center ; font-size: 24px" > <strong>No FNAME</strong> </p> -->

<span style="color: LightSeaGreen;font-size: 18px;background-color: Snow"> <strong>Negative  (FDR = 0.029396)</strong> </span>
```{r, echo=FALSE,message=FALSE}
TableOutput(CleanInput(ReadingCSVFunc("Loop/QA/AE/nofname/rad3ae.peri.qa.neg.csv")))
```

<br><br><br><br>

<hr>

###### post

<span style="color: LightSeaGreen;font-size: 18px;background-color: Snow"> <strong>Negative  (FDR = 0.041597)</strong> </span>
```{r, echo=FALSE,message=FALSE}
TableOutput(CleanInput(ReadingCSVFunc("Loop/QA/AE/nofname/rad3ae.peri.qa.neg.csv")))
```

<br><br><br><br>

<hr>


##### MD {.tabset .tabset-pills}
###### all subs

<span style="color: LightSeaGreen;font-size: 18px;background-color: Snow"> <strong>Negative  (FDR =  0.057542)</strong> </span>
```{r, echo=FALSE,message=FALSE}
TableOutput(CleanInput(ReadingCSVFunc("Loop/MD/nofname/AE/rad3ae.all.md.neg.csv")))
```

<br><br><br><br>

<hr>

###### males

<span style="color: MediumOrchid;font-size: 18px;background-color: Snow"> <strong>Positive (FDR =  0.027344)</strong> </span>

```{r, echo=FALSE,message=FALSE}
TableOutput(CleanInput(ReadingCSVFunc("Loop/MD/nofname/AE/rad3ae.male.md.pos.csv")))
```

<br><br><br><br>

<hr>

###### females
<span style="color: LightSeaGreen;font-size: 18px;background-color: Snow"> <strong>Negative  (FDR =  0.001810)</strong> </span>
```{r, echo=FALSE,message=FALSE}
TableOutput(CleanInput(ReadingCSVFunc("Loop/MD/nofname/AE/rad3ae.fem.all.neg.csv")))
```

<br><br><br><br>

<hr>

###### pre
<span style="color: LightSeaGreen;font-size: 18px;background-color: Snow"> <strong>Negative  (FDR =  0.035685)</strong> </span>
```{r, echo=FALSE,message=FALSE}
TableOutput(CleanInput(ReadingCSVFunc("Loop/MD/nofname/AE/rad3ae.pre.md.neg.csv")))
```

<br><br><br><br>

<hr>

###### peri

<span style="color: LightSeaGreen;font-size: 18px;background-color: Snow"> <strong>Negative  (FDR =  0.017843)</strong> </span>
```{r, echo=FALSE,message=FALSE}
TableOutput(CleanInput(ReadingCSVFunc("Loop/MD/nofname/AE/rad3ae.peri.md.neg.csv")))
```

<br><br><br><br>

<hr>

###### post

No results

<br><br><br><br>

<hr>


#### Average {.tabset .tabset-pills}
##### Summary 


::::::{style="display: flex;"}

:::{.column width="50%"}
**QA FDRs **  
All: **(<span style="color: LightSeaGreen;"> - </span>) 0.000151**         
Female: **(<span style="color: LightSeaGreen;"> - </span>) 0.009456**  | **(<span style="color: MediumOrchid;"> + </span>)  0.007463**    
Male: **(<span style="color: LightSeaGreen;"> - </span>) 0.015257**  | (<span style="color: MediumOrchid;"> + </span>)  0.198113    
Pre : **(<span style="color: LightSeaGreen;"> - </span>) 0.027984**  | (<span style="color: MediumOrchid;"> + </span>)  0.087579     
Peri: **(<span style="color: LightSeaGreen;"> - </span>) 0.029396**    
Post: No significant Results
::: 
  
:::{ .column width="50%"}
  **MD FDRs **  
  All: **(<span style="color: LightSeaGreen;"> - </span>) 0.002809** | (<span style="color: MediumOrchid;"> + </span>)  0.079505        
  Female: **(<span style="color: LightSeaGreen;"> - </span>) 0.007988** | (<span style="color: MediumOrchid;"> + </span>)   0.176768     
  Male: **(<span style="color: MediumOrchid;"> + </span>)  0.036479**    
  Pre : (<span style="color: LightSeaGreen;"> - </span>) 0.055238      
  Peri: **(<span style="color: LightSeaGreen;"> - </span>) 0.004026**     
  Post: **(<span style="color: LightSeaGreen;"> - </span>) 0.041597**  
:::
::::::

<br><br>

<hr>

<br><br>

##### QA {.tabset .tabset-pills}

###### all subs
<!-- <p style="text-align:center ; font-size: 24px" > <strong>Control for FNAME</strong> </p> -->

<!-- <span style="color: MediumOrchid;font-size: 18px;background-color: Snow"> <strong>Positive (FDR = 0.012195)</strong> </span> -->
<!-- ```{r,echo=FALSE,message=FALSE} -->
<!-- TableOutput(CleanInput(ReadingCSVFunc("Loop/QA/AE/fname/all.loopAE.ave.pos.csv"))) -->
<!-- ``` -->

<!-- <span style="color: LightSeaGreen;font-size: 18px;background-color: Snow"> <strong>Negative  (FDR = 0.000355)</strong> </span> -->
<!-- ```{r, echo=FALSE,message=FALSE} -->
<!-- TableOutput(CleanInput(ReadingCSVFunc("Loop/QA/AE/fname/all.loopAE.ave.neg.csv"))) -->
<!-- ``` -->

<!-- <p style="text-align:center ; font-size: 24px" > <strong>No FNAME</strong> </p> -->

<span style="color: MediumOrchid;font-size: 18px;background-color: Snow"> <strong>Positive (FDR = 0.064935)</strong> </span>
```{r,echo=FALSE,message=FALSE}
TableOutput(CleanInput(ReadingCSVFunc("Loop/QA/AE/nofname/avgae.all.qa.pos.csv")))
```
<br>

<span style="color: LightSeaGreen;font-size: 18px;background-color: Snow"> <strong>Negative  (FDR = 0.033989)</strong> </span>
```{r, echo=FALSE,message=FALSE}
TableOutput(CleanInput(ReadingCSVFunc("Loop/QA/AE/nofname/avgae.all.qa.neg.csv")))
```

<br><br><br><br>

###### males
<!-- <p style="text-align:center ; font-size: 24px" > <strong>Control for FNAME</strong> </p> -->

<!-- <span style="color: LightSeaGreen;font-size: 18px;background-color: Snow"> <strong>Negative  (FDR = 0.014851)</strong> </span> -->
<!-- ```{r, echo=FALSE,message=FALSE} -->
<!-- TableOutput(CleanInput(ReadingCSVFunc("Loop/QA/AE/fname/male.loopAE.ave.neg.csv"))) -->
<!-- ``` -->
<!-- <br><br> -->

<!-- <p style="text-align:center ; font-size: 24px" > <strong>No FNAME</strong> </p> -->

<span style="color: LightSeaGreen;font-size: 18px;background-color: Snow"> <strong>Negative  (FDR = 0.003413)</strong> </span>
```{r, echo=FALSE,message=FALSE}
TableOutput(CleanInput(ReadingCSVFunc("Loop/QA/AE/nofname/avgae.male.qa.neg.csv")))
```

<br><br><br><br>

###### females
<!-- <p style="text-align:center ; font-size: 24px" > <strong>Control for FNAME</strong> </p> -->

<!-- <span style="color: MediumOrchid;font-size: 18px;background-color: Snow"> <strong>Positive (FDR = 0.004950)</strong> </span> -->
<!-- ```{r,echo=FALSE,message=FALSE} -->
<!-- TableOutput(CleanInput(ReadingCSVFunc("Loop/QA/AE/fname/female.loopAe.ave.pos.csv"))) -->
<!-- ``` -->

<!-- <span style="color: LightSeaGreen;font-size: 18px;background-color: Snow"> <strong>Negative  (FDR = 0.000126)</strong> </span> -->
<!-- ```{r, echo=FALSE,message=FALSE} -->
<!-- TableOutput(CleanInput(ReadingCSVFunc("Loop/QA/AE/fname/female.loopAe.ave.neg.csv"))) -->
<!-- ``` -->

<!-- <p style="text-align:center ; font-size: 24px" > <strong>No FNAME</strong> </p> -->

<span style="color: MediumOrchid;font-size: 18px;background-color: Snow"> <strong>Positive (FDR = 0.007326)</strong> </span>
```{r,echo=FALSE,message=FALSE}
TableOutput(CleanInput(ReadingCSVFunc("Loop/QA/AE/nofname/avgae.fem.qa.pos.csv")))
```

<span style="color: LightSeaGreen;font-size: 18px;background-color: Snow"> <strong>Negative  (FDR = 0.000339)</strong> </span>
```{r, echo=FALSE,message=FALSE}
TableOutput(CleanInput(ReadingCSVFunc("Loop/QA/AE/nofname/avgae.fem.qa.neg.csv")))
```

<br><br><br><br>

###### pre

<!-- <p style="text-align:center ; font-size: 24px" > <strong>No FNAME</strong> </p> -->

<span style="color: LightSeaGreen;font-size: 18px;background-color: Snow"> <strong>Negative  (FDR = 0.087757)</strong> </span>
```{r, echo=FALSE,message=FALSE}
TableOutput(CleanInput(ReadingCSVFunc("Loop/QA/AE/nofname/avgae.pre.qa.neg.csv")))
```

<br><br><br><br>

###### peri

<!-- <p style="text-align:center ; font-size: 24px" > <strong>No FNAME</strong> </p> -->

<span style="color: LightSeaGreen;font-size: 18px;background-color: Snow"> <strong>Negative  (FDR = 0.023132)</strong> </span>
```{r, echo=FALSE,message=FALSE}
TableOutput(CleanInput(ReadingCSVFunc("Loop/QA/AE/nofname/avgae.peri.qa.neg.csv")))
```

<br><br><br><br>

###### post

<!-- <p style="text-align:center ; font-size: 24px" > <strong>No FNAME</strong> </p> -->

<span style="color: LightSeaGreen;font-size: 18px;background-color: Snow"> <strong>Negative  (FDR = 0.080115)</strong> </span>
```{r, echo=FALSE,message=FALSE}
TableOutput(CleanInput(ReadingCSVFunc("Loop/QA/AE/nofname/avgae.post.qa.neg.csv")))
```

<br><br><br><br>


##### MD {.tabset .tabset-pills}
###### all subs
<span style="color: MediumOrchid;font-size: 18px;background-color: Snow"> <strong>Positive (FDR =  0.079505)</strong> </span>

```{r,echo=FALSE,message=FALSE}
TableOutput(CleanInput(ReadingCSVFunc("Loop/MD/nofname/AE/aveae.all.md.pos.csv")))
```

<br><br>

<span style="color: LightSeaGreen;font-size: 18px;background-color: Snow"> <strong>Negative  (FDR =  0.002809)</strong> </span>
```{r, echo=FALSE,message=FALSE}
TableOutput(CleanInput(ReadingCSVFunc("Loop/MD/nofname/AE/aveae.all.md.neg.csv")))
```

<br><br><br><br>

<hr>

###### males
<span style="color: MediumOrchid;font-size: 18px;background-color: Snow"> <strong>Positive (FDR =  0.036479)</strong> </span>

```{r,echo=FALSE,message=FALSE}
TableOutput(CleanInput(ReadingCSVFunc("Loop/MD/nofname/AE/aveae.male.md.pos.csv")))
```

<br><br><br><br>

<hr>

###### females

<span style="color: MediumOrchid;font-size: 18px;background-color: Snow"> <strong>Positive (FDR =  0.079505)</strong> </span>

```{r,echo=FALSE,message=FALSE}
TableOutput(CleanInput(ReadingCSVFunc("Loop/MD/nofname/AE/aveae.fem.md.pos.csv")))
```

<br><br>

<span style="color: LightSeaGreen;font-size: 18px;background-color: Snow"> <strong>Negative  (FDR =  0.007988)</strong> </span>
```{r, echo=FALSE,message=FALSE}
TableOutput(CleanInput(ReadingCSVFunc("Loop/MD/nofname/AE/avgae.fem.md.neg.csv")))
```

<br><br><br><br>

<hr>

###### Pre

<span style="color: LightSeaGreen;font-size: 18px;background-color: Snow"> <strong>Negative  (FDR =  0.055238)</strong> </span>
```{r, echo=FALSE,message=FALSE}
TableOutput(CleanInput(ReadingCSVFunc("Loop/MD/nofname/AE/aveae.pre.md.neg.csv")))
```

<br><br><br><br>

<hr>

###### Peri

<span style="color: LightSeaGreen;font-size: 18px;background-color: Snow"> <strong>Negative  (FDR =  0.004026)</strong> </span>
```{r, echo=FALSE,message=FALSE}
TableOutput(CleanInput(ReadingCSVFunc("Loop/MD/nofname/AE/aveae.peri.md.neg.csv")))
```

<br><br><br><br>

<hr>

###### Post
<span style="color: LightSeaGreen;font-size: 18px;background-color: Snow"> <strong>Negative  (FDR =  0.041597)</strong> </span>
```{r, echo=FALSE,message=FALSE}
TableOutput(CleanInput(ReadingCSVFunc("Loop/MD/nofname/AE/aveae.post.md.neg.csv")))
```

<br><br><br><br>

<hr>



## ROIs 

### Arcuate Fasciculus (frontal)
  Anatomy   
  - Connects temporal cortex and inferior parietal to frontal lobe  
  -  Critical for verbal language mostly   
  - ties to motor training  
  Links to papers 
  
  https://www.frontiersin.org/articles/10.3389/fnhum.2021.672665/full#B69  
  https://onlinelibrary.wiley.com/doi/full/10.1002/brb3.3107  
  https://pubmed.ncbi.nlm.nih.gov/29355798/  
  https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5479403/#b0335  
  https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2141547/  
  
### Corpus Callosum 

  Anatomy   
  - tapetum  
         The tapetum is another fiber tract arising from the body and splenium of the corpus callosum. The tapetum projects laterally to form the roof and lateral walls of the atrium, temporal and occipital horns, where it is the fiber tract closest to the dependably of the ventricle. Connects temporal lobes.  
  
  -Forcep Minor: anterior portion of CC. connectects to frontal lobes  
    https://radiopaedia.org/articles/forceps-minor?lang=us
    Tied to executive funtioning skill  
      https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5811666/
    Motor control  
      https://pubmed.ncbi.nlm.nih.gov/19850077/
    Poorer gait velocity in older adults  
      https://www.ajnr.org/content/38/3/500#ref-43
    
    
    
  
  -forcep major: Posterior portion of CC: connecting Occipital lobes
  Interestingly this proesses vision but has direct connections to RSC 
  Pops up with men  
    https://radiopaedia.org/articles/forceps-major?lang=us   

  https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0039804  
  https://www.mdpi.com/2077-0383/10/14/3158
  https://www.kenhub.com/en/library/anatomy/corpus-callosum
  https://onlinelibrary.wiley.com/doi/full/10.1002/hbm.23339
  https://www.sciencedirect.com/science/article/pii/B9780128117835000057
  chrome-extension://efaidnbmnnnibpcajpcglclefindmkaj/https://content.iospress.com/download/journal-of-alzheimers-disease/jad01370?id=journal-of-alzheimers-disease%2Fjad01370
  https://link.springer.com/article/10.1007/s11682-023-00814-1#Sec15
  https://www.ncbi.nlm.nih.gov/books/NBK448209/
  https://www.sciencedirect.com/science/article/pii/S0010945210001942?via%3Dihub  
  https://link.springer.com/article/10.1007/s11682-018-0010-2  
  https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4925207/
  https://www.sciencedirect.com/science/article/pii/S0920121108001356?via%3Dihub  

https://scholar.google.com/scholar_lookup?author=T.+Schulte&author=E.+M.+M%C3%BCller-Oehring&publication_year=2010&title=Contribution+of+callosal+connections+to+the+interhemispheric+integration+of+visuomotor+and+cognitive+processes&journal=Neuropsychol.+Rev.&volume=20&pages=174-190

### COrtico Striatal

- MAy be tied to visual spatial processing  
https://journals.sagepub.com/doi/10.1177/1073858413494269#bibr51-1073858413494269  

### SLF

SLF II has more right lateralization but can tie to ventral visual processing  
https://www.nature.com/articles/nn.2905

https://academic.oup.com/cercor/article/20/1/121/416448

### Inferior Fronto Occipital Fasciculus
connects the occipital and parietal lobes to frontal. May be important for visual attention. visuospatial

Goal orientated behavior
https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5280002/  
https://www.frontiersin.org/articles/10.3389/fnana.2016.00088/full#B4
https://www.neurology.org/doi/10.1212/WNL.0b013e31822313dc
https://kclpure.kcl.ac.uk/portal/en/publications/a-lateralized-brain-network-for-visuospatial-attention-2
https://pubmed.ncbi.nlm.nih.gov/28180079/ 


