---
title: "SNAG Cortical Thickness"
author: "Daniela Cossio"
date: "`r format(Sys.time(), '%d %B %Y')`"
output:
   html_document:
    toc: true
    toc_float: true
    toc_depth: 2
    classoption:
    - twocolumn
---

```{css, echo=FALSE}
TOC {
  color: #F6B2DB;
  font-family: Times;
  font-size: "16px"; 
  border-color: #F6B2DB;
}

h1.title {
  color: black ;
  font-family: Times;
  font-size: "72px";
  padding: "10px 0";
  background-color: #F6B2DB ;
  text-align: center;
}

h4.date {
  color: black ;
  font-family: Times;
  font-size: "34px";
  text-align: center;
}

h4.author {
  color: black;
  font-size: "34px";
  font-family: Times;
  text-align: center;
}


h1,h2, h3, h4, h5 ,h6 {
  text-align: center;
  font-family: Times;
  
}

body, p, h2{
  color: black; 
  font-family: Times;
}

hr {
  height:5px;
  border-width:0;
  background-color: black ;
}



```

```{r set-options, echo=FALSE, cache=FALSE}
options(width = 100)
```

```{r adding libraries,echo=FALSE, results='hide',message=FALSE}
library(ggplot2)
#(plyr)
library(ppcor)
library(tidyverse)
# library(dplyr)
# library(tidyr)
library(stringr)
library(kableExtra)
# library(data.table)
# library(network)
# library(tidygraph)
# library(ggraph)
# library(igraph)
# library(networkD3)
# library(CINNA)
# library(umap)
# library(plotly)
#library(factoextra)
#library(lsr)
# library(car)
library(ggpubr)
#library(entropy)
#library(ds4psy)
# library(pROC)
#library(devtools)
#library(BRRR)
#library(stats)
#library(afex)
library(knitr)
library(janitor)
library(car)
library(ggiraph)
library(ggiraphExtra)
library(moonBook)
library(nationalparkcolors)
library(gridExtra)
library(markdown)
```

```{r, Functions, echo=FALSE, results='hide',message=FALSE}
# Here i have created a bunch of functions for things actions that i will be using repetitively.

ReadingCSVFunc <- function(pathname){
  
   #' @description: purpose of this is to read in CSVs and clean them up 
  #' @return: DF
  
  read.csv(paste0(working_dir, pathname), header=TRUE)

}

TableOutput <- function(df){
      knitr::kable(df, row.names=F) %>% kable_styling(bootstrap_options =  c("striped", "hover", "condensed"),position = "center") %>% scroll_box(width = "600px", height = "300px") 
    
  }

CleanDF <- function(DF,Variable){
  
  DF <- DF %>% select(-c("subject_id"))
  
  subinfo <- sub_info  %>% select(c("subject_id", "sex", "age_scan_years","repo_status",Variable))
  
  cleanedDF <- cbind(subinfo, DF) %>% drop_na(Variable) 
  
  cleanedDF$sex[cleanedDF$sex=="Male"] <- 1 
  cleanedDF$sex[cleanedDF$sex=="Female"] <- 0
  cleanedDF$sex <- as.numeric(cleanedDF$sex)
  
    return (cleanedDF)
}


SelectAtlas <- function(Parcel,NetworkNum){
  #' @description: purpose of this is to read in and extract the ROIs from schaefer atlas you choose
  #' @return: A list of all the ROIs
  
  atlas_path <- ReadingCSVFunc(paste0("Schaefer2018_",Parcel,"Parcels_",NetworkNum, "Networks_order_FSLMNI152_1mm.Centroid_RAS.csv"))
  atlas_path$ROI.Name <- str_remove(atlas_path$ROI.Name,paste0(NetworkNum,"Networks_"))
  col_names <-c("subject_id",atlas_path$ROI.Name)
  
  return(col_names)
}

Combine_ROIs <- function(DF,labels) {
  #' @description: purpose of this is to read in and extract the ROIs from schaefer atlas you choose.
  #' The Networks labels is the dataframe with all of the labels
  dataframe <-
    as.data.frame(DF$subject_id) %>% `colnames<-`("subject_id")
      for (label in labels) {
        temp <-
          DF %>% select(matches(label)) %>% rowMeans() %>% as.data.frame() %>% `colnames<-`(label)
        
        dataframe <- cbind(dataframe, temp)
      }
      
  return(dataframe)
}


# PartialCorrelationAnalysis <- function(DF,Parcellation,NetworkNum,Variable){
#   
#   df <-CleanDF(DF,Variable)
#   ROIs<- SelectAtlas(Parcellation,NetworkNum) %>% .[-1] 
#   cor_results <-data.frame(matrix(nrow=0,ncol=NetworkNum)) %>%   `colnames<-`(c("roi", "estimate","p.value","statistic","n","gp","Method"))
#   pcorlist <- list()
#    
#   for (ROI in ROIs) {
#     pcorlist[[ROI]] <-
#       pcor.test(x = df[Variable], y = df[[ROI]], z = df[, c("age_scan_years", "sex")])
#     temp <- cbind(ROI, pcorlist[[ROI]])
#     cor_results <- rbind(cor_results, temp)
#   }
#   
#     cor_results$adj.pval <- 
#       p.adjust(cor_results$p.value, method = "BH", n=length(cor_results$p.value))
# 
#   return(cor_results)
# }



```

```{r reading in our CSVs, echo=FALSE, results='hide',message=FALSE, warning=FALSE}

working_dir <- "/Users/danielacossio/Documents/Chrastil_Lab/Projects/SNAG/Cortical_thickness/"
#working_dir <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/Other computers/My iMac/Chrastil_Lab/Projects/SNAG/Cortical_thickness/" # Laptop path

sub_info <- ReadingCSVFunc("subject_info.csv")%>% filter(!(subject_id %in% c("309", "341")))

LabelNames <- read_delim("/Users/danielacossio/Documents/Chrastil_Lab/Projects/SNAG/Cortical_thickness/Yeo2011_17networks_N1000.split_components.glossary.csv") %>% .[-1,] %>% select("Label Name")  
  
LabelNames <- str_remove(LabelNames$`Label Name`,paste0(17,"Networks_"))

NetworkNames <- c(
          "LH_VisCent",
          "LH_VisPeri",
          "LH_SomMotA",
          "LH_SomMotB",
          "LH_DorsAttnA",
          "LH_DorsAttnB",
          "LH_SalVentAttnA",
          "LH_SalVentAttnB",
          "LH_LimbicA",
          "LH_LimbicB",
          "LH_ContA",
          "LH_ContB",
          "LH_ContC",
          "LH_DefaultA",
          "LH_DefaultB",
          "LH_DefaultC",
          "LH_TempPar",
          "RH_VisCent",
          "RH_VisPeri",
          "RH_SomMotA",
          "RH_SomMotB",
          "RH_DorsAttnA",
          "RH_DorsAttnB",
          "RH_SalVentAttnA",
          "RH_SalVentAttnB",
          "RH_LimbicA",
          "RH_LimbicB",
          "RH_ContA",
          "RH_ContB",
          "RH_ContC",
          "RH_DefaultA",
          "RH_DefaultB",
          "RH_DefaultC",
          "RH_TempPar"
        )

CT_17 <- ReadingCSVFunc("master_CT400_parces17_networks.csv") %>% `colnames<-`(SelectAtlas(400,17)) %>% arrange(subject_id) 
CT_17net_ROImerged <- Combine_ROIs(CT_17,LabelNames)
CT_17net_merged <- Combine_ROIs(CT_17,NetworkNames)


```

<hr>

# Overview and Hypothesis 
My general hypothesis is going to be focused on general somatosensory regions and the dorsal attention network.

General approach : for the Schaefar atlas is to take the average for each ROI network and not do each individual parcellation. 

Do correlation between each parcellation and variable and then average by network. 

<hr>

```{r, setting up our apriori, echo=FALSE, results='hide',message=FALSE, warning=FALSE}
apriori_labelnames <-
  c(
    "LH_SomMotA",
    "LH_SomMotB_Cent",
    "LH_SomMotB_S2",
    "LH_SomMotB_Ins",
    "LH_SomMotB_Aud",
    "LH_DorsAttnA_TempOcc",
    "LH_DorsAttnA_ParOcc",
    "LH_DorsAttnA_SPL",
    "LH_DorsAttnB_PostC",
    "LH_DorsAttnB_FEF",
    "LH_DorsAttnB_PrCv",
    "LH_ContA_Temp",
    "LH_ContA_IPS",
    "LH_ContA_PFCd",
    "LH_ContA_PFCl",
    "LH_ContA_PFClv",
    "LH_ContA_Cingm",
    "LH_ContC_pCun",
    "LH_ContC_Cingp",
    "LH_DefaultA_IPL",
    "LH_DefaultA_PFCd",
    "LH_DefaultA_pCunPCC",
    "LH_DefaultA_PFCm",
    "LH_DefaultC_IPL",
    "LH_DefaultC_Rsp",
    "LH_DefaultC_PHC",
    "RH_SomMotA",
    "RH_SomMotB_Cent",
    "RH_SomMotB_S2",
    "RH_SomMotB_Ins",
    "RH_SomMotB_Aud",
    "RH_DorsAttnA_TempOcc",
    "RH_DorsAttnA_ParOcc",
    "RH_DorsAttnA_SPL",
    "RH_DorsAttnB_TempOcc",
    "RH_DorsAttnB_PostC",
    "RH_DorsAttnB_FEF",
    "RH_ContA_Temp" ,
    "RH_ContA_IPS",
    "RH_ContA_PFCd",
    "RH_ContA_PFCl",
    "RH_ContA_Cingm",
    "RH_ContC_pCun",
    "RH_ContC_Cingp",
    "RH_DefaultA_Temp",
    "RH_DefaultA_IPL",
    "RH_DefaultA_PFCd",
    "RH_DefaultA_pCunPCC",
    "RH_DefaultA_PFCm",
    "RH_DefaultC_Rsp",
    "RH_DefaultC_PHC"
  )

apriori_networknames <-
  c(
    "LH_SomMotA",
    "LH_SomMotB",
    "LH_DorsAttnA",
    "LH_DorsAttnB",
    "LH_ContA",
    "LH_ContC",
    "LH_DefaultA",
    "LH_DefaultC",
    "RH_SomMotA",
    "RH_SomMotB",
    "RH_DorsAttnA",
    "RH_DorsAttnB",
    "RH_ContA",
    "RH_ContC",
    "RH_DefaultA",
    "RH_DefaultC"
  )

```

# Degrees Traveled {.tabset .tabset-dropdown} 
## Average {.tabset .tabset-pills} 

### All {.tabset .tabset-pills} 

#### parcellation (apriori)

Here we are doing a partial correlation using the parcellations of only apriori regions.

```{r, all DT Ave 400 parcs + Partial correlations, echo=FALSE, results='hide',message=FALSE,warning=FALSE}

df <- CleanDF(CT_17, "loop_de_avg_degree")

ROIs <- CT_17 %>% select(matches(apriori_networknames)) %>% colnames()

cor_results <-
  data.frame(matrix(nrow = 0, ncol = 17)) %>%   `colnames<-`(c("roi", "estimate", "p.value", "statistic", "n", "gp", "Method"))

pcorlist <- list()

for (ROI in ROIs) {
  pcorlist[[ROI]] <-
    pcor.test(x = df["loop_de_avg_degree"], y = df[[ROI]], z = df[, c("age_scan_years", "sex")])
  temp <- cbind(ROI, pcorlist[[ROI]])
  cor_results <- rbind(cor_results, temp)
}

cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "BH", n = length(cor_results$p.value))

cor_results <- arrange(cor_results,p.value)

```

```{r,echo=FALSE,message=FALSE}
TableOutput(cor_results)
```

<br>

<hr>

<br>

#### network names (apriori)
```{r, all  DT Ave 17 network  + Partial correlations, echo=FALSE, results='hide',message=FALSE,warning=FALSE}

df <- CleanDF(CT_17net_merged, "loop_de_avg_degree")

ROIs <- CT_17net_merged %>% select(matches(apriori_networknames)) %>% colnames()

cor_results <-
  data.frame(matrix(nrow = 0, ncol = 17)) %>%   `colnames<-`(c("roi", "estimate", "p.value", "statistic", "n", "gp", "Method"))

pcorlist <- list()

for (ROI in ROIs) {
  
  if(!is.na(sum(df[[ROI]])) == FALSE){
    
    pcorlist[[ROI]] <- NA
    
  }else{
  pcorlist[[ROI]] <-
    pcor.test(x = df["loop_de_avg_degree"], y = df[[ROI]], z = df[, c("age_scan_years", "sex")])
  temp <- cbind(ROI, pcorlist[[ROI]])
  cor_results <- rbind(cor_results, temp)
  }
}

cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "BH", n = length(cor_results$p.value))

cor_results <- arrange(cor_results,p.value)

```

```{r,echo=FALSE,message=FALSE}
TableOutput(cor_results)
```

<br>

<hr>

<br>

#### label names (apriori)

```{r, all  DT Ave label  + Partial correlations, echo=FALSE, results='hide',message=FALSE,warning=FALSE}

df <- CleanDF(CT_17net_ROImerged, "loop_de_avg_degree")

ROIs <- CT_17net_ROImerged %>% select(matches(apriori_labelnames)) %>% colnames()

cor_results <-
  data.frame(matrix(nrow = 0, ncol = 17)) %>%   `colnames<-`(c("roi", "estimate", "p.value", "statistic", "n", "gp", "Method"))

pcorlist <- list()

for (ROI in ROIs) {
  
  if(!is.na(sum(df[[ROI]])) == FALSE){
    
    pcorlist[[ROI]] <- NA
    
  } else{
 pcorlist[[ROI]] <-
    pcor.test(x = df["loop_de_avg_degree"], y = df[[ROI]], z = df[, c("age_scan_years", "sex")])
  temp <- cbind(ROI, pcorlist[[ROI]])
  cor_results <- rbind(cor_results, temp)
  }
}

cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "BH", n = length(cor_results$p.value))

cor_results <- arrange(cor_results,p.value)

```

```{r,echo=FALSE,message=FALSE}
TableOutput(cor_results)
```

<br>

<hr>

<br>


### female {.tabset .tabset-pills}
#### parcellation (apriori)

```{r, female DT Ave 400 parcs + Partial correlations, echo=FALSE, results='hide',message=FALSE,warning=FALSE}

df <- CleanDF(CT_17, "loop_de_avg_degree") %>% filter(sex==0)

ROIs <- CT_17 %>% select(matches(apriori_networknames)) %>% colnames()

cor_results <-
  data.frame(matrix(nrow = 0, ncol = 17)) %>%   `colnames<-`(c("roi", "estimate", "p.value", "statistic", "n", "gp", "Method"))

pcorlist <- list()

for (ROI in ROIs) {
  pcorlist[[ROI]] <-
    pcor.test(x = df["loop_de_avg_degree"], y = df[[ROI]], z = df[, c("age_scan_years")])
  temp <- cbind(ROI, pcorlist[[ROI]])
  cor_results <- rbind(cor_results, temp)
}

cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "BH",  n = length(cor_results$p.value))
```


```{r,echo=FALSE,message=FALSE}
TableOutput(cor_results)
```

<br>

<hr>

<br>

#### Network (apriori)

```{r, female DT Ave 17 network  + Partial correlations, echo=FALSE, results='hide',message=FALSE,warning=FALSE}

df <- CleanDF(CT_17net_merged, "loop_de_avg_degree") %>% filter(sex==0)

ROIs <- CT_17net_merged %>% select(matches(apriori_networknames)) %>% colnames()

cor_results <-
  data.frame(matrix(nrow = 0, ncol = 17)) %>%   `colnames<-`(c("roi", "estimate", "p.value", "statistic", "n", "gp", "Method"))

pcorlist <- list()

for (ROI in ROIs) {
  
  if(!is.na(sum(df[[ROI]])) == FALSE){
    
    pcorlist[[ROI]] <- NA
    
  }else{
  pcorlist[[ROI]] <-
    pcor.test(x = df["loop_de_avg_degree"], y = df[[ROI]], z = df[, c("age_scan_years")])
  temp <- cbind(ROI, pcorlist[[ROI]])
  cor_results <- rbind(cor_results, temp)
  }
}

cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "BH", n = length(cor_results$p.value))
cor_results <- arrange(cor_results,p.value)


```

```{r,echo=FALSE,message=FALSE}
TableOutput(cor_results)
```

<br>

<hr>

<br>

#### Label (apriori)
```{r, female  DT Ave label  + Partial correlations, echo=FALSE, results='hide',message=FALSE,warning=FALSE}

df <- CleanDF(CT_17net_ROImerged, "loop_de_avg_degree") %>% filter(sex==0)

ROIs <- CT_17net_ROImerged %>% select(matches(apriori_labelnames)) %>% colnames()

cor_results <-
  data.frame(matrix(nrow = 0, ncol = 17)) %>%   `colnames<-`(c("roi", "estimate", "p.value", "statistic", "n", "gp", "Method"))

pcorlist <- list()

for (ROI in ROIs) {
  
  if(!is.na(sum(df[[ROI]])) == FALSE){
    
    pcorlist[[ROI]] <- NA
    
  } else{
 pcorlist[[ROI]] <-
    pcor.test(x = df["loop_de_avg_degree"], y = df[[ROI]], z = df[, c("age_scan_years")])
  temp <- cbind(ROI, pcorlist[[ROI]])
  cor_results <- rbind(cor_results, temp)
  }
}

cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "BH", n = length(cor_results$p.value))

cor_results <- arrange(cor_results,p.value)

```

```{r,echo=FALSE,message=FALSE}
TableOutput(cor_results)
```

<br>

<hr>
<br>

### Male {.tabset .tabset-pills}

#### parcellation (apriori)

```{r, male DT Ave 400 parcs + Partial correlations , echo=FALSE, results='hide',message=FALSE,warning=FALSE}

df <- CleanDF(CT_17, "loop_de_avg_degree") %>% filter(sex==1)

ROIs <- CT_17 %>% select(matches(apriori_networknames)) %>% colnames()

cor_results <-
  data.frame(matrix(nrow = 0, ncol = 17)) %>%   `colnames<-`(c("roi", "estimate", "p.value", "statistic", "n", "gp", "Method"))

pcorlist <- list()

for (ROI in ROIs) {
  pcorlist[[ROI]] <-
    pcor.test(x = df["loop_de_avg_degree"], y = df[[ROI]], z = df[, c("age_scan_years")])
  temp <- cbind(ROI, pcorlist[[ROI]])
  cor_results <- rbind(cor_results, temp)
}

cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "BH",  n = length(cor_results$p.value))

cor_results <- arrange(cor_results,p.value)

```


```{r,echo=FALSE,message=FALSE}
TableOutput(cor_results)
```

<br>

<hr>

<br>

#### Network (apriori)

```{r, male DT Ave 17 network  + Partial correlations, echo=FALSE, results='hide',message=FALSE,warning=FALSE}

df <- CleanDF(CT_17net_merged, "loop_de_avg_degree") %>% filter(sex==1)

ROIs <- CT_17net_merged %>% select(matches(apriori_networknames)) %>% colnames()

cor_results <-
  data.frame(matrix(nrow = 0, ncol = 17)) %>%   `colnames<-`(c("roi", "estimate", "p.value", "statistic", "n", "gp", "Method"))

pcorlist <- list()

for (ROI in ROIs) {
  
  if(!is.na(sum(df[[ROI]])) == FALSE){
    
    pcorlist[[ROI]] <- NA
    
  }else{
  pcorlist[[ROI]] <-
    pcor.test(x = df["loop_de_avg_degree"], y = df[[ROI]], z = df[, c("age_scan_years")])
  temp <- cbind(ROI, pcorlist[[ROI]])
  cor_results <- rbind(cor_results, temp)
  }
}

cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "BH", n = length(cor_results$p.value))

cor_results <- arrange(cor_results,p.value)


```

```{r,echo=FALSE,message=FALSE}
TableOutput(cor_results)
```

<br>

<hr>

<br>

#### Label (apriori)
```{r, male DT Ave label  + Partial correlations, echo=FALSE, results='hide',message=FALSE,warning=FALSE}

df <- CleanDF(CT_17net_ROImerged, "loop_de_avg_degree")

ROIs <- CT_17net_ROImerged %>% select(matches(apriori_labelnames)) %>% colnames()

cor_results <-
  data.frame(matrix(nrow = 0, ncol = 17)) %>%   `colnames<-`(c("roi", "estimate", "p.value", "statistic", "n", "gp", "Method"))

pcorlist <- list()

for (ROI in ROIs) {
  
  if(!is.na(sum(df[[ROI]])) == FALSE){
    
    pcorlist[[ROI]] <- NA
    
  } else{
 pcorlist[[ROI]] <-
    pcor.test(x = df["loop_de_avg_degree"], y = df[[ROI]], z = df[, c("age_scan_years")])
  temp <- cbind(ROI, pcorlist[[ROI]])
  cor_results <- rbind(cor_results, temp)
  }
}

cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "BH", n = length(cor_results$p.value))

cor_results <- arrange(cor_results,p.value)

```

```{r,echo=FALSE,message=FALSE}
TableOutput(cor_results)
```

<br>

<hr>

<br>

## Radius 3 {.tabset .tabset-pills}

### All {.tabset .tabset-pills}
#### Parcellation (apriori)

```{r, all DT rad3 400 parcs + Partial correlations, echo=FALSE, results='hide',message=FALSE,warning=FALSE}

df <- CleanDF(CT_17, "loop_de_rad3_degree")

ROIs <- CT_17 %>% select(matches(apriori_networknames)) %>% colnames()

cor_results <-
  data.frame(matrix(nrow = 0, ncol = 17)) %>%   `colnames<-`(c("roi", "estimate", "p.value", "statistic", "n", "gp", "Method"))

pcorlist <- list()

for (ROI in ROIs) {
  pcorlist[[ROI]] <-
    pcor.test(x = df["loop_de_rad3_degree"], y = df[[ROI]], z = df[, c("age_scan_years", "sex")])
  temp <- cbind(ROI, pcorlist[[ROI]])
  cor_results <- rbind(cor_results, temp)
}

cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "BH",  n = length(cor_results$p.value))

cor_results <- arrange(cor_results,p.value)


```


```{r,echo=FALSE,message=FALSE}
TableOutput(cor_results)
```

<br>

<hr>

<br>

#### Network (apriori)

```{r, all DT rad3 17 network  + Partial correlations, echo=FALSE, results='hide',message=FALSE,warning=FALSE}

df <- CleanDF(CT_17net_merged, "loop_de_rad3_degree") 

ROIs <- CT_17net_merged %>% select(matches(apriori_networknames)) %>% colnames()

cor_results <-
  data.frame(matrix(nrow = 0, ncol = 17)) %>%   `colnames<-`(c("roi", "estimate", "p.value", "statistic", "n", "gp", "Method"))

pcorlist <- list()

for (ROI in ROIs) {
  
  if(!is.na(sum(df[[ROI]])) == FALSE){
    
    pcorlist[[ROI]] <- NA
    
  }else{
  pcorlist[[ROI]] <-
    pcor.test(x = df["loop_de_rad3_degree"], y = df[[ROI]], z = df[, c("age_scan_years", "sex")])
  temp <- cbind(ROI, pcorlist[[ROI]])
  cor_results <- rbind(cor_results, temp)
  }
}

cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "BH", n = length(cor_results$p.value))

cor_results <- arrange(cor_results,p.value)

```

```{r,echo=FALSE,message=FALSE}
TableOutput(cor_results)
```

<br>

<hr>

<br>

#### Label (apriori)

```{r, all DT rad3 label  + Partial correlations, echo=FALSE, results='hide',message=FALSE,warning=FALSE}

df <- CleanDF(CT_17net_ROImerged, "loop_de_rad3_degree") 

ROIs <- CT_17net_ROImerged %>% select(matches(apriori_labelnames)) %>% colnames()

cor_results <-
  data.frame(matrix(nrow = 0, ncol = 17)) %>%   `colnames<-`(c("roi", "estimate", "p.value", "statistic", "n", "gp", "Method"))

pcorlist <- list()

for (ROI in ROIs) {
  
  if(!is.na(sum(df[[ROI]])) == FALSE){
    
    pcorlist[[ROI]] <- NA
    
  } else{
 pcorlist[[ROI]] <-
    pcor.test(x = df["loop_de_rad3_degree"], y = df[[ROI]], z = df[, c("age_scan_years", "sex")])
  temp <- cbind(ROI, pcorlist[[ROI]])
  cor_results <- rbind(cor_results, temp)
  }
}

cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "BH", n = length(cor_results$p.value))

cor_results <- arrange(cor_results,p.value)

```

```{r,echo=FALSE,message=FALSE}
TableOutput(cor_results)
```

<br>

<hr>

<br>


### Female {.tabset .tabset-pills}

#### parcellation (apriori)

```{r, female DT rad3 400 parcs + Partial correlations, echo=FALSE, results='hide',message=FALSE,warning=FALSE}

df <- CleanDF(CT_17, "loop_de_rad3_degree") %>% filter(sex==0)

ROIs <- CT_17 %>% select(matches(apriori_networknames)) %>% colnames()

cor_results <-
  data.frame(matrix(nrow = 0, ncol = 17)) %>%   `colnames<-`(c("roi", "estimate", "p.value", "statistic", "n", "gp", "Method"))

pcorlist <- list()

for (ROI in ROIs) {
  pcorlist[[ROI]] <-
    pcor.test(x = df["loop_de_rad3_degree"], y = df[[ROI]], z = df[, c("age_scan_years")])
  temp <- cbind(ROI, pcorlist[[ROI]])
  cor_results <- rbind(cor_results, temp)
}

cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "BH",  n = length(cor_results$p.value))

cor_results <- arrange(cor_results,p.value)

```


```{r,echo=FALSE,message=FALSE}
TableOutput(cor_results) 
```

<br>

<hr>

<br>

#### Network (apriori)

```{r, female DT rad3 17 network + Partial correlations, echo=FALSE, results='hide',message=FALSE,warning=FALSE}

df <- CleanDF(CT_17net_merged, "loop_de_rad3_degree") %>% filter(sex==0)

ROIs <- CT_17net_merged %>% select(matches(apriori_networknames)) %>% colnames()

cor_results <-
  data.frame(matrix(nrow = 0, ncol = 17)) %>%   `colnames<-`(c("roi", "estimate", "p.value", "statistic", "n", "gp", "Method"))

pcorlist <- list()

for (ROI in ROIs) {
  
  if(!is.na(sum(df[[ROI]])) == FALSE){
    
    pcorlist[[ROI]] <- NA
    
  }else{
  pcorlist[[ROI]] <-
    pcor.test(x = df["loop_de_rad3_degree"], y = df[[ROI]], z = df[, c("age_scan_years")])
  temp <- cbind(ROI, pcorlist[[ROI]])
  cor_results <- rbind(cor_results, temp)
  }
}

cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "BH", n = length(cor_results$p.value))

cor_results <- arrange(cor_results,p.value)

```

```{r,echo=FALSE,message=FALSE}
TableOutput(cor_results)
```

<br>

<hr>

<br>

#### Label (apriori)
```{r, female DT rad3 label + Partial correlations, echo=FALSE, results='hide',message=FALSE,warning=FALSE}

df <- CleanDF(CT_17net_ROImerged, "loop_de_rad3_degree") %>% filter(sex==0)

ROIs <- CT_17net_ROImerged %>% select(matches(apriori_labelnames)) %>% colnames()

cor_results <-
  data.frame(matrix(nrow = 0, ncol = 17)) %>%   `colnames<-`(c("roi", "estimate", "p.value", "statistic", "n", "gp", "Method"))

pcorlist <- list()

for (ROI in ROIs) {
  
  if(!is.na(sum(df[[ROI]])) == FALSE){
    
    pcorlist[[ROI]] <- NA
    
  } else{
 pcorlist[[ROI]] <-
    pcor.test(x = df["loop_de_rad3_degree"], y = df[[ROI]], z = df[, c("age_scan_years")])
  temp <- cbind(ROI, pcorlist[[ROI]])
  cor_results <- rbind(cor_results, temp)
  }
}

cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "BH", n = length(cor_results$p.value))

cor_results <- arrange(cor_results,p.value)

```

```{r,echo=FALSE,message=FALSE}
TableOutput(cor_results)
```

<br>

<hr>

<br>

### Male {.tabset .tabset-pills}

#### parcellation (apriori)

```{r, male DT rad3 400 parcs + Partial correlations, echo=FALSE, results='hide',message=FALSE,warning=FALSE}

df <- CleanDF(CT_17, "loop_de_rad3_degree") %>% filter(sex==1)

ROIs <- CT_17 %>% select(matches(apriori_networknames)) %>% colnames()

cor_results <-
  data.frame(matrix(nrow = 0, ncol = 17)) %>%   `colnames<-`(c("roi", "estimate", "p.value", "statistic", "n", "gp", "Method"))

pcorlist <- list()

for (ROI in ROIs) {
  pcorlist[[ROI]] <-
    pcor.test(x = df["loop_de_rad3_degree"], y = df[[ROI]], z = df[, c("age_scan_years")])
  temp <- cbind(ROI, pcorlist[[ROI]])
  cor_results <- rbind(cor_results, temp)
}

cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "BH",  n = length(cor_results$p.value))

cor_results <- arrange(cor_results,p.value)

```


```{r,echo=FALSE,message=FALSE}
TableOutput(cor_results) 
```

<br>

<hr>

<br>

#### Network (apriori)

```{r, male DT rad3 17 network  + Partial correlations, echo=FALSE, results='hide',message=FALSE,warning=FALSE}

df <- CleanDF(CT_17net_merged, "loop_de_rad3_degree") %>% filter(sex==1)

ROIs <- CT_17net_merged %>% select(matches(apriori_networknames)) %>% colnames()

cor_results <-
  data.frame(matrix(nrow = 0, ncol = 17)) %>%   `colnames<-`(c("roi", "estimate", "p.value", "statistic", "n", "gp", "Method"))

pcorlist <- list()

for (ROI in ROIs) {
  
  if(!is.na(sum(df[[ROI]])) == FALSE){
    
    pcorlist[[ROI]] <- NA
    
  }else{
  pcorlist[[ROI]] <-
    pcor.test(x = df["loop_de_rad3_degree"], y = df[[ROI]], z = df[, c("age_scan_years")])
  temp <- cbind(ROI, pcorlist[[ROI]])
  cor_results <- rbind(cor_results, temp)
  }
}

cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "BH", n = length(cor_results$p.value))

cor_results <- arrange(cor_results,p.value)


```

```{r,echo=FALSE,message=FALSE}
TableOutput(cor_results)
```

<br>

<hr>

<br>

#### Label (apriori)
```{r, male DT rad3 label + Partial correlations, echo=FALSE, results='hide',message=FALSE,warning=FALSE}

df <- CleanDF(CT_17net_ROImerged, "loop_de_rad3_degree") %>% filter(sex==1)

ROIs <- CT_17net_ROImerged %>% select(matches(apriori_labelnames)) %>% colnames()

cor_results <-
  data.frame(matrix(nrow = 0, ncol = 17)) %>%   `colnames<-`(c("roi", "estimate", "p.value", "statistic", "n", "gp", "Method"))

pcorlist <- list()

for (ROI in ROIs) {
  
  if(!is.na(sum(df[[ROI]])) == FALSE){
    
    pcorlist[[ROI]] <- NA
    
  } else{
 pcorlist[[ROI]] <-
    pcor.test(x = df["loop_de_rad3_degree"], y = df[[ROI]], z = df[, c("age_scan_years")])
  temp <- cbind(ROI, pcorlist[[ROI]])
  cor_results <- rbind(cor_results, temp)
  }
}

cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "BH", n = length(cor_results$p.value))

cor_results <- arrange(cor_results,p.value)

```

```{r,echo=FALSE,message=FALSE}
TableOutput(cor_results)
```

<br>

<hr>

<br>

# Angular error {.tabset .tabset-dropdown} 
## Average {.tabset .tabset-pills} 
### All {.tabset .tabset-pills} 
#### Parcellation (apriori)


```{r, all AE AVE 400 parcs + Partial correlations, echo=FALSE, results='hide',message=FALSE,warning=FALSE}

df <- CleanDF(CT_17, "loop_ae_avg_degree")

ROIs <- CT_17 %>% select(matches(apriori_networknames)) %>% colnames()

cor_results <-
  data.frame(matrix(nrow = 0, ncol = 17)) %>%   `colnames<-`(c("roi", "estimate", "p.value", "statistic", "n", "gp", "Method"))

pcorlist <- list()

for (ROI in ROIs) {
  pcorlist[[ROI]] <-
    pcor.test(x = df["loop_ae_avg_degree"], y = df[[ROI]], z = df[, c("age_scan_years", "sex")])
  temp <- cbind(ROI, pcorlist[[ROI]])
  cor_results <- rbind(cor_results, temp)
}

cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "BH",  n = length(cor_results$p.value))

cor_results <- arrange(cor_results,p.value)

```


```{r,echo=FALSE,message=FALSE}
TableOutput(cor_results)
```

<br>

<hr>

<br>

#### Network (apriori)

```{r, all AE AVE 17 network  + Partial correlations, echo=FALSE, results='hide',message=FALSE,warning=FALSE}

df <- CleanDF(CT_17net_merged, "loop_ae_avg_degree") 

ROIs <- CT_17net_merged %>% select(matches(apriori_networknames)) %>% colnames()

cor_results <-
  data.frame(matrix(nrow = 0, ncol = 17)) %>%   `colnames<-`(c("roi", "estimate", "p.value", "statistic", "n", "gp", "Method"))

pcorlist <- list()

for (ROI in ROIs) {
  
  if(!is.na(sum(df[[ROI]])) == FALSE){
    
    pcorlist[[ROI]] <- NA
    
  }else{
  pcorlist[[ROI]] <-
    pcor.test(x = df["loop_ae_avg_degree"], y = df[[ROI]], z = df[, c("age_scan_years", "sex")])
  temp <- cbind(ROI, pcorlist[[ROI]])
  cor_results <- rbind(cor_results, temp)
  }
}

cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "BH", n = length(cor_results$p.value))

cor_results <- arrange(cor_results,p.value)

```

```{r,echo=FALSE,message=FALSE}
TableOutput(cor_results)
```

<br>

<hr>

<br>

#### Label (apriori)


```{r, all AE AVE label  + Partial correlations, echo=FALSE, results='hide',message=FALSE,warning=FALSE}

df <- CleanDF(CT_17net_ROImerged, "loop_ae_avg_degree") 

ROIs <- CT_17net_ROImerged %>% select(matches(apriori_labelnames)) %>% colnames()

cor_results <-
  data.frame(matrix(nrow = 0, ncol = 17)) %>%   `colnames<-`(c("roi", "estimate", "p.value", "statistic", "n", "gp", "Method"))

pcorlist <- list()

for (ROI in ROIs) {
  
  if(!is.na(sum(df[[ROI]])) == FALSE){
    
    pcorlist[[ROI]] <- NA
    
  } else{
 pcorlist[[ROI]] <-
    pcor.test(x = df["loop_ae_avg_degree"], y = df[[ROI]], z = df[, c("age_scan_years", "sex")])
  temp <- cbind(ROI, pcorlist[[ROI]])
  cor_results <- rbind(cor_results, temp)
  }
}

cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "BH", n = length(cor_results$p.value))

cor_results <- arrange(cor_results,p.value)

```

```{r,echo=FALSE,message=FALSE}
TableOutput(cor_results)
```

<br>

<hr>

<br>

### Female {.tabset .tabset-pills} 

#### Parcellation (apriori)
#### Network (apriori)
#### Label (apriori)
### Male {.tabset .tabset-pills} 
#### Parcellation (apriori)
#### Network (apriori)
#### Label (apriori)

## Radius 3 {.tabset .tabset-pills}
### All{.tabset .tabset-pills}
#### Parcellation (apriori)
#### Network (apriori)
#### Label (apriori)

### female {.tabset .tabset-pills}
#### Parcellation (apriori)
#### Network (apriori)
#### Label (apriori)

### male {.tabset .tabset-pills}
#### Parcellation (apriori)
#### Network (apriori)
#### Label (apriori)


<br>

<hr>


# Position Error {.tabset .tabset-dropdown} 
## Average {.tabset .tabset-pills}
### All {.tabset .tabset-pills}
#### Parcellation (apriori)
#### Network (apriori)
#### Label (apriori)
### Female {.tabset .tabset-pills}
#### Parcellation (apriori)
#### Network (apriori)
#### Label (apriori)
### male {.tabset .tabset-pills}
#### Parcellation (apriori)
#### Network (apriori)
#### Label (apriori)

## Radius 3 {.tabset .tabset-pills}
### All{.tabset .tabset-pills}
#### Parcellation (apriori)
#### Network (apriori)
#### Label (apriori)
### Female {.tabset .tabset-pills}
#### Parcellation (apriori)
#### Network (apriori)
#### Label (apriori)
### male {.tabset .tabset-pills}
#### Parcellation (apriori)
#### Network (apriori)
#### Label (apriori)

