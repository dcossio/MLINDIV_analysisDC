ReadingCSVFunc <- function(pathname){
#' @description: purpose of this is to read in CSVs and clean them up
#' @return: DF
read.csv(paste0(working_dir, pathname), header=TRUE)
}
CleanDF <- function(DF,Variable){
DF <- DF %>% select(-c("subject_id"))
subinfo <- sub_info  %>% select(c("subject_id", "sex", "age_scan_years","repo_status",Variable))
cleanedDF <- cbind(subinfo, DF) %>% drop_na()
cleanedDF$sex[cleanedDF$sex=="Male"] <- 1
cleanedDF$sex[cleanedDF$sex=="Female"] <- 0
cleanedDF$sex <- as.numeric(cleanedDF$sex)
return (cleanedDF)
}
SelectAtlas <- function(Parcel,NetworkNum){
#' @description: purpose of this is to read in and extract the ROIs from schaefer atlas you choose
#' @return: A list of all the ROIs
atlas_path <- ReadingCSVFunc(paste0("Schaefer2018_",Parcel,"Parcels_",NetworkNum, "Networks_order_FSLMNI152_1mm.Centroid_RAS.csv"))
atlas_path$ROI.Name <- str_remove(atlas_path$ROI.Name,paste0(NetworkNum,"Networks_"))
col_names <-c("subject_id",atlas_path$ROI.Name)
return(col_names)
}
grid.arrange(plotlist[[1]],plotlist[[2]],plotlist[[3]], plotlist[[4]], plotlist[[5]],plotlist[[6]], plotlist[[7]], plotlist[[8]],plotlist[[9]],plotlist[[10]],plotlist[[11]],plotlist[[12]],plotlist[[13]],plotlist[[14]],plotlist[[15]],plotlist[[16]],plotlist[[17]],plotlist[[18]], nrow=9, widths=c(1,1))
ROIs<- c(sigWB_17network400parc$ROI)  # removing sibject ID
plotlist <- list()
for (ROI in ROIs) {
print(ROI)
plotlist[[ROI]] <- ggplot(df, aes(x=loop_ae_avg_degree, y=.data[[ROI]]))  +
geom_point(color="#502E23", size=4) +
geom_smooth(method="lm", level=0.95,color ="#E2929D", se=FALSE,linewidth=2) +
theme_classic() +
labs(x ="Cortical Thickness", y = "Position Error", title = ROI) +
theme( axis.title.x = element_text(vjust = -4),
plot.margin = margin(1, 1, 1, 1, "cm")) +
#    axis.text.x = element_text(size = 25),
#    axis.text.y = element_text(size = 25),
#    axis.title.y = element_text(vjust = 4, size = 16),
#    plot.title = element_text(hjust = 0.5 ,size=16),
#    panel.border = element_rect(fill=NA,color = "#502E23"),
#    panel.background =element_blank(),
#    strip.text.x = element_text(
#      size = 16,
#      color = "black",
#      face = "bold.italic"
#    ),
# legend.position = "right")+
stat_cor( method = "pearson")
#legend.key.size = unit(2, 'cm'),
#legend.title = element_text(size=18), #change legend title font size
#legend.text = element_text(size=18),
#png(file = CleanCSVsfigpath,ROI,"_sexdiff_QA.png"))  #,".png"))
#print(plotlist[[ROI]] )
#dev.off()
}
sigWB_7network400parc
ReadingCSVFunc <- function(pathname){
#' @description: purpose of this is to read in CSVs and clean them up
#' @return: DF
read.csv(paste0(working_dir, pathname), header=TRUE)
}
TableOutput <- function(df){
knitr::kable(df, row.names=F) %>% kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% scroll_box(width = "600px", height = "300px")
}
CleanDF <- function(DF,Variable){
DF <- DF %>% select(-c("subject_id"))
subinfo <- sub_info  %>% select(c("subject_id", "sex", "age_scan_years","repo_status",Variable))
cleanedDF <- cbind(subinfo, DF) %>% drop_na()
cleanedDF$sex[cleanedDF$sex=="Male"] <- 1
cleanedDF$sex[cleanedDF$sex=="Female"] <- 0
cleanedDF$sex <- as.numeric(cleanedDF$sex)
return (cleanedDF)
}
SelectAtlas <- function(Parcel,NetworkNum){
#' @description: purpose of this is to read in and extract the ROIs from schaefer atlas you choose
#' @return: A list of all the ROIs
atlas_path <- ReadingCSVFunc(paste0("Schaefer2018_",Parcel,"Parcels_",NetworkNum, "Networks_order_FSLMNI152_1mm.Centroid_RAS.csv"))
atlas_path$ROI.Name <- str_remove(atlas_path$ROI.Name,paste0(NetworkNum,"Networks_"))
col_names <-c("subject_id",atlas_path$ROI.Name)
return(col_names)
}
<br>
igWB_7network400parc$ROI
sigWB_7network400parc$ROI
ggplot(df, aes(x=loop_ae_avg_degree, y=.data[[ROI]]))  +
geom_point(color="#502E23", size=4) +
geom_smooth(method="lm", level=0.95,color ="#E2929D", se=FALSE,linewidth=2) +
theme_classic() +
labs(x ="Cortical Thickness", y = "Position Error", title = ROI) +
theme( axis.title.x = element_text(vjust = -4),
plot.margin = margin(1, 1, 1, 1, "cm")) +
#    axis.text.x = element_text(size = 25),
#    axis.text.y = element_text(size = 25),
#    axis.title.y = element_text(vjust = 4, size = 16),
#    plot.title = element_text(hjust = 0.5 ,size=16),
#    panel.border = element_rect(fill=NA,color = "#502E23"),
#    panel.background =element_blank(),
#    strip.text.x = element_text(
#      size = 16,
#      color = "black",
#      face = "bold.italic"
#    ),
# legend.position = "right")+
stat_cor( method = "pearson", label.x.npc = "center",
label.y.npc = "top")
ROIs<- c(sigWB_7network400parc$ROI)  # removing sibject ID
plotlist <- list()
for (ROI in ROIs) {
print(ROI)
plotlist[[ROI]] <- ggplot(df, aes(x=loop_ae_avg_degree, y=.data[[ROI]]))  +
geom_point(color="#502E23", size=4) +
geom_smooth(method="lm", level=0.95,color ="#E2929D", se=FALSE,linewidth=2) +
theme_classic() +
labs(x ="Cortical Thickness", y = "Position Error", title = ROI) +
theme( axis.title.x = element_text(vjust = -4),
plot.margin = margin(1, 1, 1, 1, "cm")) +
#    axis.text.x = element_text(size = 25),
#    axis.text.y = element_text(size = 25),
#    axis.title.y = element_text(vjust = 4, size = 16),
#    plot.title = element_text(hjust = 0.5 ,size=16),
#    panel.border = element_rect(fill=NA,color = "#502E23"),
#    panel.background =element_blank(),
#    strip.text.x = element_text(
#      size = 16,
#      color = "black",
#      face = "bold.italic"
#    ),
# legend.position = "right")+
stat_cor( method = "pearson", label.x.npc = "center",
label.y.npc = "top")
#legend.key.size = unit(2, 'cm'),
#legend.title = element_text(size=18), #change legend title font size
#legend.text = element_text(size=18),
#png(file = CleanCSVsfigpath,ROI,"_sexdiff_QA.png"))  #,".png"))
#print(plotlist[[ROI]] )
#dev.off()
}
ROIs<- c(sigWB_7network400parc$ROI)  # removing sibject ID
plotlist <- list()
for (ROI in ROIs) {
print(ROI)
plotlist[[ROI]] <- ggplot(AE_ave_df, aes(x=loop_ae_avg_degree, y=.data[[ROI]]))  +
geom_point(color="#502E23", size=4) +
geom_smooth(method="lm", level=0.95,color ="#E2929D", se=FALSE,linewidth=2) +
theme_classic() +
labs(x ="Cortical Thickness", y = "Position Error", title = ROI) +
theme( axis.title.x = element_text(vjust = -4),
plot.margin = margin(1, 1, 1, 1, "cm")) +
#    axis.text.x = element_text(size = 25),
#    axis.text.y = element_text(size = 25),
#    axis.title.y = element_text(vjust = 4, size = 16),
#    plot.title = element_text(hjust = 0.5 ,size=16),
#    panel.border = element_rect(fill=NA,color = "#502E23"),
#    panel.background =element_blank(),
#    strip.text.x = element_text(
#      size = 16,
#      color = "black",
#      face = "bold.italic"
#    ),
# legend.position = "right")+
stat_cor( method = "pearson", label.x.npc = "center",
label.y.npc = "top")
#legend.key.size = unit(2, 'cm'),
#legend.title = element_text(size=18), #change legend title font size
#legend.text = element_text(size=18),
#png(file = CleanCSVsfigpath,ROI,"_sexdiff_QA.png"))  #,".png"))
#print(plotlist[[ROI]] )
#dev.off()
}
library(ggplot2)
#(plyr)
library(ppcor)
library(tidyverse)
# library(dplyr)
# library(tidyr)
library(stringr)
library(kableExtra)
# library(data.table)
# library(network)
# library(tidygraph)
# library(ggraph)
# library(igraph)
# library(networkD3)
# library(CINNA)
# library(umap)
# library(plotly)
#library(factoextra)
#library(lsr)
# library(car)
library(ggpubr)
#library(entropy)
#library(ds4psy)
# library(pROC)
#library(devtools)
#library(BRRR)
#library(stats)
#library(afex)
library(knitr)
library(janitor)
library(car)
library(ggiraph)
library(ggiraphExtra)
library(moonBook)
library(nationalparkcolors)
library(gridExtra)
library(markdown)
ReadingCSVFunc <- function(pathname){
#' @description: purpose of this is to read in CSVs and clean them up
#' @return: DF
read.csv(paste0(working_dir, pathname), header=TRUE)
}
TableOutput <- function(df){
knitr::kable(df, row.names=F) %>% kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% scroll_box(width = "600px", height = "300px")
}
CleanDF <- function(DF,Variable){
DF <- DF %>% select(-c("subject_id"))
subinfo <- sub_info  %>% select(c("subject_id", "sex", "age_scan_years","repo_status",Variable))
cleanedDF <- cbind(subinfo, DF) %>% drop_na()
cleanedDF$sex[cleanedDF$sex=="Male"] <- 1
cleanedDF$sex[cleanedDF$sex=="Female"] <- 0
cleanedDF$sex <- as.numeric(cleanedDF$sex)
return (cleanedDF)
}
SelectAtlas <- function(Parcel,NetworkNum){
#' @description: purpose of this is to read in and extract the ROIs from schaefer atlas you choose
#' @return: A list of all the ROIs
atlas_path <- ReadingCSVFunc(paste0("Schaefer2018_",Parcel,"Parcels_",NetworkNum, "Networks_order_FSLMNI152_1mm.Centroid_RAS.csv"))
atlas_path$ROI.Name <- str_remove(atlas_path$ROI.Name,paste0(NetworkNum,"Networks_"))
col_names <-c("subject_id",atlas_path$ROI.Name)
return(col_names)
}
#working_dir <- "/Users/danielacossio/Documents/Chrastil_Lab/Projects/SNAG/Cortical_thickness/"
working_dir <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/Other computers/My iMac/Chrastil_Lab/Projects/SNAG/Cortical_thickness/" # Laptop path
sub_info <- ReadingCSVFunc("subject_info.csv")%>% filter(!(subject_id %in% c("309", "341")))
CT_7network <- ReadingCSVFunc("master_CT400_parces7_networks.csv") %>% `colnames<-`(SelectAtlas(400,7)) %>%  arrange(subject_id)
CT_17network <- ReadingCSVFunc("master_CT400_parces17_networks.csv") %>% `colnames<-`(SelectAtlas(400,17)) %>%  arrange(subject_id)
df <- CleanDF(CT_7network,"loop_ae_avg_degree") %>% filter(sex==0)
ROIs<- SelectAtlas(400,7) %>% .[-1]
fem_7network400parc <- list()
cols <-
sigWB_7network400parc <-data.frame(matrix(nrow=0,ncol=7)) %>% `colnames<-`(c("roi", "estimate" ,"p.value","statistic","n","gp","Method"))
for (ROI in ROIs) {
WholeBrain_7network400parc[[ROI]] <- pcor.test(x=df["loop_ae_avg_degree"],y=df[[ROI]],z= df[,c("age_scan_years", "sex")])
if (WholeBrain_7network400parc[[ROI]][["p.value"]] < 0.05){
temp <-cbind(ROI,WholeBrain_7network400parc[[ROI]])
sigWB_7network400parc <- rbind(sigWB_7network400parc,temp)
}
}
df <- CleanDF(CT_7network,"loop_ae_avg_degree") %>% filter(sex==0)
ROIs<- SelectAtlas(400,7) %>% .[-1]
fem_7network400parc <- list()
df <- CleanDF(CT_7network,"loop_ae_avg_degree") %>% filter(sex==0)
ROIs<- SelectAtlas(400,7) %>% .[-1]
fem_7network400parc <- list()
sigfem_7network400parc <-data.frame(matrix(nrow=0,ncol=7)) %>% `colnames<-`(c("roi", "estimate" ,"p.value","statistic","n","gp","Method"))
for (ROI in ROIs) {
fem_7network400parc[[ROI]] <- pcor.test(x=df["loop_ae_avg_degree"],y=df[[ROI]],z= df[,c("age_scan_years", "sex")])
if (fem_7network400parc[[ROI]][["p.value"]] < 0.05){
temp <-cbind(ROI,fem_7network400parc[[ROI]])
sigfem_7network400parc <- rbind(sigfem_7network400parc,temp)
}
}
df <- CleanDF(CT_7network,"loop_ae_avg_degree") %>% filter(sex==0)
ROIs<- SelectAtlas(400,7) %>% .[-1]
fem_7network400parc <- list()
sigfem_7network400parc <-data.frame(matrix(nrow=0,ncol=7)) %>% `colnames<-`(c("roi", "estimate" ,"p.value","statistic","n","gp","Method"))
View(df)
View(sigfem_7network400parc)
pcor.test(x=df["loop_ae_avg_degree"],y=df[[ROI]],z= df[,c("age_scan_years", "sex")])
pcor.test(x=df["loop_ae_avg_degree"],y=df[[ROI]],z= df[,c("age_scan_years")])
fem_7network400parc[[ROI]][["p.value"]]
fem_7network400parc[[ROI]][["p.value"]]
fem_7network400parc[[ROI]] <- pcor.test(x=df["loop_ae_avg_degree"],y=df[[ROI]],z= df[,c("age_scan_years")])
View(fem_7network400parc)
fem_7network400parc[[ROI]][["p.value"]]
for (ROI in ROIs) {
fem_7network400parc[[ROI]] <- pcor.test(x=df["loop_ae_avg_degree"],y=df[[ROI]],z= df[,c("age_scan_years")])
if (fem_7network400parc[[ROI]][["p.value"]] < 0.05){
temp <-cbind(ROI,fem_7network400parc[[ROI]])
sigfem_7network400parc <- rbind(sigfem_7network400parc,temp)
}
}
View(sigfem_7network400parc)
var <- "loop_ae_avg_degree"
df <-CleanDF(CT_7network,var)
View(df)
df <-CleanDF(CT_7network,"loop_ae_avg_degree")
ROIs<- SelectAtlas(400,7) %>% .[-1]
plist <- list()
sig_corrs <-data.frame(matrix(nrow=0,ncol=7)) %>% `colnames<-`(c("roi", "estimate" ,"p.value","statistic","n","gp","Method"))
for (ROI in ROIs) {
plist[[ROI]] <- pcor.test(x=df["loop_ae_avg_degree"],y=df[[ROI]],z= df[,c("age_scan_years", "sex")])
if (plist[[ROI]][["p.value"]] < 0.05){
temp <-cbind(ROI,plist[[ROI]])
sig_corrs <- rbind(sig_corrs,temp)
}
}
write.csv(sig_corrs, paste0(working_dir,"aveAE.sig.ROIs.csv"), row.names = FALSE)
paste0(working_dir,"aveAE.sig.ROIs.csv")
ROIs<- c(sig_corrs$ROI)
grid.arrange(plist[[1]],plist[[2]],plist[[3]], plist[[4]], plist[[5]],plist[[6]], plist[[7]], plist[[8]],plist[[9]],plist[[10]],plist[[11]],plist[[12]],plist[[13]],plist[[14]],plist[[15]],plist[[16]],plist[[17]],plist[[18]],nrow=6)
grid.arrange(plist[[1]],plist[[2]],plist[[3]], plist[[4]], plist[[5]],plist[[6]], plist[[7]], plist[[8]],plist[[9]],plist[[10]],plist[[11]],plist[[12]],plist[[13]],plist[[14]],plist[[15]],plist[[16]],plist[[17]],plist[[18]],nrow=6)
grid.arrange(plist[[1]],plist[[2]],plist[[3]], plist[[4]], plist[[5]],plist[[6]], plist[[7]], plist[[8]],plist[[9]],plist[[10]],plist[[11]],plist[[12]],plist[[13]],plist[[14]],plist[[15]],plist[[16]],plist[[17]],plist[[18]],nrow=6, top="idk")
grid.arrange(grobs=list(plist[[1]],plist[[2]],plist[[3]], plist[[4]], plist[[5]],plist[[6]], plist[[7]], plist[[8]],plist[[9]],plist[[10]],plist[[11]],plist[[12]],plist[[13]],plist[[14]],plist[[15]],plist[[16]],plist[[17]],plist[[18]]),nrow=6)
grid.arrange()
help("grid.arrange")
grid.arrange(plist[[1]],plist[[2]],plist[[3]], plist[[4]], plist[[5]],plist[[6]], plist[[7]], plist[[8]],plist[[9]],plist[[10]],plist[[11]],plist[[12]],plist[[13]],plist[[14]],plist[[15]],plist[[16]],plist[[17]],plist[[18]],nrow=6)
list(plist[[1]],plist[[2]],plist[[3]], plist[[4]], plist[[5]],plist[[6]], plist[[7]], plist[[8]],plist[[9]],plist[[10]],plist[[11]],plist[[12]],plist[[13]],plist[[14]],plist[[15]],plist[[16]],plist[[17]],plist[[18]])
ROIs<- c(sig_corrs$ROI)  # removing sibject ID
plist <- list()
for (ROI in ROIs) {
print(ROI)
plist[[ROI]] <- ggplot(df, aes(x=loop_ae_avg_degree, y=.data[[ROI]]))  +
geom_point(color="#502E23", size=4) +
geom_smooth(method="lm", level=0.95,color ="#E2929D", se=FALSE,linewidth=2) +
theme_classic() +
labs(x ="Cortical Thickness", y = "Angular Error", title = ROI) +
theme( axis.title.x = element_text(vjust = -4),
plot.margin = margin(1, 1, 1, 1, "cm")) +
#    axis.text.x = element_text(size = 25),
#    axis.text.y = element_text(size = 25),
#    axis.title.y = element_text(vjust = 4, size = 16),
#    plot.title = element_text(hjust = 0.5 ,size=16),
#    panel.border = element_rect(fill=NA,color = "#502E23"),
#    panel.background =element_blank(),
#    strip.text.x = element_text(
#      size = 16,
#      color = "black",
#      face = "bold.italic"
#    ),
# legend.position = "right")+
stat_cor( method = "pearson", label.x.npc = "center",
label.y.npc = "top")
#legend.key.size = unit(2, 'cm'),
#legend.title = element_text(size=18), #change legend title font size
#legend.text = element_text(size=18),
#png(file = CleanCSVsfigpath,ROI,"_sexdiff_QA.png"))  #,".png"))
#print(plist[[ROI]] )
#dev.off()
}
grid.arrange(grobs =list(plist[[1]],plist[[2]],plist[[3]], plist[[4]], plist[[5]],plist[[6]], plist[[7]], plist[[8]],plist[[9]],plist[[10]],plist[[11]],plist[[12]],plist[[13]],plist[[14]],plist[[15]],plist[[16]],plist[[17]],plist[[18]]),nrow=6)
grid.arrange(grob= list(plist[[1]],plist[[2]],plist[[3]], plist[[4]], plist[[5]],plist[[6]], plist[[7]], plist[[8]],plist[[9]],plist[[10]],plist[[11]],plist[[12]],plist[[13]],plist[[14]],plist[[15]],plist[[16]],plist[[17]],plist[[18]]),nrow=6)
df <- CleanDF(CT_7network,"loop_ae_avg_degree") %>% filter(sex==0)
ROIs<- SelectAtlas(400,7) %>% .[-1]
plist <- list()
sig_corrs <-data.frame(matrix(nrow=0,ncol=7)) %>% `colnames<-`(c("roi", "estimate" ,"p.value","statistic","n","gp","Method"))
for (ROI in ROIs) {
plist[[ROI]] <- pcor.test(x=df["loop_ae_avg_degree"],y=df[[ROI]],z= df[,c("age_scan_years")])
if (plist[[ROI]][["p.value"]] < 0.05){
temp <-cbind(ROI,plist[[ROI]])
sig_corrs <- rbind(sig_corrs,temp)
}
}
write.csv(sig_corrs, paste0(working_dir,"female.7net400par.aveAE.sigROIs.csv"), row.names = FALSE)
df <- CleanDF(CT_7network,"loop_ae_avg_degree") %>% filter(sex==0)
ROIs<- SelectAtlas(400,7) %>% .[-1]
plist <- list()
sig_corrs <-data.frame(matrix(nrow=0,ncol=7)) %>% `colnames<-`(c("roi", "estimate" ,"p.value","statistic","n","gp","Method"))
for (ROI in ROIs) {
plist[[ROI]] <- pcor.test(x=df["loop_ae_avg_degree"],y=df[[ROI]],z= df[,c("age_scan_years")])
if (plist[[ROI]][["p.value"]] < 0.05){
temp <-cbind(ROI,plist[[ROI]])
sig_corrs <- rbind(sig_corrs,temp)
}
}
write.csv(sig_corrs, paste0(working_dir,"female.7net400par.aveAE.sigROIs.csv"), row.names = FALSE)
ROIs<- c(sig_corrs$ROI)  # removing sibject ID
plist <- list()
for (ROI in ROIs) {
print(ROI)
plist[[ROI]] <- ggplot(df, aes(x=loop_ae_avg_degree, y=.data[[ROI]]))  +
geom_point(color="#502E23", size=4) +
geom_smooth(method="lm", level=0.95,color ="#E2929D", se=FALSE,linewidth=2) +
theme_classic() +
labs(x ="Cortical Thickness", y = "Angular Error", title = ROI) +
theme( axis.title.x = element_text(vjust = -4),
plot.margin = margin(1, 1, 1, 1, "cm")) +
#    axis.text.x = element_text(size = 25),
#    axis.text.y = element_text(size = 25),
#    axis.title.y = element_text(vjust = 4, size = 16),
#    plot.title = element_text(hjust = 0.5 ,size=16),
#    panel.border = element_rect(fill=NA,color = "#502E23"),
#    panel.background =element_blank(),
#    strip.text.x = element_text(
#      size = 16,
#      color = "black",
#      face = "bold.italic"
#    ),
# legend.position = "right")+
stat_cor( method = "pearson", label.x.npc = "center",
label.y.npc = "top")
#legend.key.size = unit(2, 'cm'),
#legend.title = element_text(size=18), #change legend title font size
#legend.text = element_text(size=18),
#png(file = CleanCSVsfigpath,ROI,"_sexdiff_QA.png"))  #,".png"))
#print(plist[[ROI]] )
#dev.off()
}
plist[[ROI]]
View(sig_corrs)
View(sig_corrs)
grid.arrange(grob= list(plist[[1]],plist[[2]],plist[[3]], plist[[4]], plist[[5]],plist[[6]], plist[[7]], plist[[8]],plist[[9]],plist[[10]],plist[[11]],plist[[12]],plist[[13]],plist[[14]],plist[[15]],plist[[16]],plist[[17]],plist[[18]],plist[[19]],plist[[20]]),nrow=6)
grid.arrange(grobs= list(plist[[1]],plist[[2]],plist[[3]], plist[[4]], plist[[5]],plist[[6]], plist[[7]], plist[[8]],plist[[9]],plist[[10]],plist[[11]],plist[[12]],plist[[13]],plist[[14]],plist[[15]],plist[[16]],plist[[17]],plist[[18]],plist[[19]],plist[[20]]),nrow=6)
png(file = paste0(working_dir,"female.7net400par.aveAE.sigROIs.png"))
grid.arrange(grobs= list(plist[[1]],plist[[2]],plist[[3]], plist[[4]], plist[[5]],plist[[6]], plist[[7]], plist[[8]],plist[[9]],plist[[10]],plist[[11]],plist[[12]],plist[[13]],plist[[14]],plist[[15]],plist[[16]],plist[[17]],plist[[18]],plist[[19]],plist[[20]]),nrow=6)
dev.off()
pdf(file = paste0(working_dir,"female.7net400par.aveAE.sigROIs.pdf"))
grid.arrange(grobs= list(plist[[1]],plist[[2]],plist[[3]], plist[[4]], plist[[5]],plist[[6]], plist[[7]], plist[[8]],plist[[9]],plist[[10]],plist[[11]],plist[[12]],plist[[13]],plist[[14]],plist[[15]],plist[[16]],plist[[17]],plist[[18]],plist[[19]],plist[[20]]),nrow=6)
dev.off()
df <- CleanDF(CT_17network,"loop_ae_avg_degree") %>% filter(sex==0)
ROIs<- SelectAtlas(400,17) %>% .[-1]
pcorlist <- list()
sig_corrs <-data.frame(matrix(nrow=0,ncol=7)) %>% `colnames<-`(c("roi", "estimate" ,"p.value","statistic","n","gp","Method"))
for (ROI in ROIs) {
pcorlist[[ROI]] <- pcor.test(x=df["loop_ae_avg_degree"],y=df[[ROI]],z= df[,c("age_scan_years")])
if (pcorlist[[ROI]][["p.value"]] < 0.05){
temp <-cbind(ROI,pcorlist[[ROI]])
sig_corrs <- rbind(sig_corrs,temp)
}
}
write.csv(sig_corrs, paste0(working_dir,"female.17net400par.aveAE.sigROIs.csv"), row.names = FALSE)
TableOutput(sig_corrs)
View(sig_corrs)
grid.arrange(grobs=list(plist[[1]],plist[[2]],plist[[3]], plist[[4]], plist[[5]],plist[[6]], plist[[7]], plist[[8]],plist[[9]],plist[[10]],plist[[11]],plist[[12]],plist[[13]],plist[[14]],plist[[15]],plist[[16]],plist[[17]],plist[[18]]),nrow=6)
df <- CleanDF(CT_7network,"loop_ae_avg_degree") %>% filter(sex==1)
ROIs<- SelectAtlas(400,7) %>% .[-1]
pcorlist <- list()
sig_corrs <-data.frame(matrix(nrow=0,ncol=7)) %>% `colnames<-`(c("roi", "estimate" ,"p.value","statistic","n","gp","Method"))
for (ROI in ROIs) {
pcorlist[[ROI]] <- pcor.test(x=df["loop_ae_avg_degree"],y=df[[ROI]],z= df[,c("age_scan_years")])
if (pcorlist[[ROI]][["p.value"]] < 0.05){
temp <-cbind(ROI,pcorlist[[ROI]])
sig_corrs <- rbind(sig_corrs,temp)
}
}
write.csv(sig_corrs, paste0(working_dir,"male.7net400par.aveAE.sigROIs.csv"), row.names = FALSE)
View(sig_corrs)
df <-CleanDF(CT_7network,"loop_de_avg_degree")
ROIs<- SelectAtlas(400,7) %>% .[-1]
pcorlist <- list()
sig_corrs <-data.frame(matrix(nrow=0,ncol=7)) %>% `colnames<-`(c("roi", "estimate" ,"p.value","statistic","n","gp","Method"))
for (ROI in ROIs) {
pcorlist[[ROI]] <- pcor.test(x=df["loop_de_avg_degree"],y=df[[ROI]],z= df[,c("age_scan_years", "sex")])
if (pcorlist[[ROI]][["p.value"]] < 0.05){
temp <-cbind(ROI,pcorlist[[ROI]])
sig_corrs <- rbind(sig_corrs,temp)
}
}
write.csv(sig_corrs, paste0(working_dir,"all.7net400par.aveDT.sigROIs.csv"), row.names = FALSE)
View(sig_corrs)
df <-CleanDF(CT_17network,"loop_de_avg_degree")
ROIs<- SelectAtlas(400,17) %>% .[-1]
pcorlist <- list()
sig_corrs <-data.frame(matrix(nrow=0,ncol=7)) %>% `colnames<-`(c("roi", "estimate" ,"p.value","statistic","n","gp","Method"))
for (ROI in ROIs) {
pcorlist[[ROI]] <- pcor.test(x=df["loop_de_avg_degree"],y=df[[ROI]],z= df[,c("age_scan_years", "sex")])
if (pcorlist[[ROI]][["p.value"]] < 0.05){
temp <-cbind(ROI,pcorlist[[ROI]])
sig_corrs <- rbind(sig_corrs,temp)
}
}
write.csv(sig_corrs, paste0(working_dir,"all.17net400par.aveDT.sigROIs.csv"), row.names = FALSE)
View(sig_corrs)
df <-CleanDF(CT_7network,"loop_de_avg_degree")  %>% filter(sex==0)
ROIs<- SelectAtlas(400,7) %>% .[-1]
pcorlist <- list()
sig_corrs <-data.frame(matrix(nrow=0,ncol=7)) %>% `colnames<-`(c("roi", "estimate" ,"p.value","statistic","n","gp","Method"))
for (ROI in ROIs) {
pcorlist[[ROI]] <- pcor.test(x=df["loop_de_avg_degree"],y=df[[ROI]],z= df[,c("age_scan_years")])
if (pcorlist[[ROI]][["p.value"]] < 0.05){
temp <-cbind(ROI,pcorlist[[ROI]])
sig_corrs <- rbind(sig_corrs,temp)
}
}
write.csv(sig_corrs, paste0(working_dir,"female.7net400par.aveDT.sigROIs.csv"), row.names = FALSE)
View(sig_corrs)
ROIs<- c(sig_corrs$ROI)  # removing sibject ID
plist <- list()
for (ROI in ROIs) {
print(ROI)
plist[[ROI]] <- ggplot(df, aes(x=loop_de_avg_degree, y=.data[[ROI]]))  +
geom_point(color="#502E23", size=4) +
geom_smooth(method="lm", level=0.95,color ="#E2929D", se=FALSE,linewidth=2) +
theme_classic() +
labs(x ="Cortical Thickness", y = "Degree Traveled", title = ROI) +
theme( axis.title.x = element_text(vjust = -4),
plot.margin = margin(1, 1, 1, 1, "cm")) +
#    axis.text.x = element_text(size = 25),
#    axis.text.y = element_text(size = 25),
#    axis.title.y = element_text(vjust = 4, size = 16),
#    plot.title = element_text(hjust = 0.5 ,size=16),
#    panel.border = element_rect(fill=NA,color = "#502E23"),
#    panel.background =element_blank(),
#    strip.text.x = element_text(
#      size = 16,
#      color = "black",
#      face = "bold.italic"
#    ),
# legend.position = "right")+
stat_cor( method = "pearson", label.x.npc = "center",
label.y.npc = "top")
#legend.key.size = unit(2, 'cm'),
#legend.title = element_text(size=18), #change legend title font size
#legend.text = element_text(size=18),
#png(file = CleanCSVsfigpath,ROI,"_sexdiff_QA.png"))  #,".png"))
#print(plist[[ROI]] )
#dev.off()
}
grid.arrange(grobs=list(plist[[1]],plist[[2]],plist[[3]], plist[[4]], plist[[5]],plist[[6]], plist[[7]], plist[[8]]), plist[[9]],plist[[10]],plist[[11]],plist[[12]],plist[[13]],plist[[14]],plist[[15]],plist[[16]],plist[[17]],nrow=6)
grid.arrange(grobs=list(plist[[1]],plist[[2]],plist[[3]], plist[[4]], plist[[5]],plist[[6]], plist[[7]], plist[[8]]), plist[[9]],plist[[10]],plist[[11]],plist[[12]],plist[[13]],plist[[14]],plist[[15]],plist[[16]],plist[[17]],nrow=6)
plist[[16]]
plist[[16]]
grid.arrange(grobs=list(plist[[1]],plist[[2]],plist[[3]], plist[[4]], plist[[5]],plist[[6]], plist[[7]], plist[[8]], plist[[9]],plist[[10]],plist[[11]],plist[[12]],plist[[13]],plist[[14]],plist[[15]],plist[[16]],plist[[17]]),nrow=6)
