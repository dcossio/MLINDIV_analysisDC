panel.background =element_blank(),
axis.line = element_line(colour = "black"))
fit.1 <- lm(loop_ae_avg_degree ~ sex + age_scan_years + EstimatedTotalIntraCranialVol , data=df)
df$residual1 <- residuals(fit.1)
fit.2 <- lm(lh_superiorparietal ~ sex + age_scan_years +EstimatedTotalIntraCranialVol, data=df)
df$residual2 <- residuals(fit.2)
ggplot(df, aes(x=residual1, y=residual2)) +
geom_point(color="#F8B2AC") +
stat_smooth(method="lm",se=FALSE, color="#F8B2AC")+
stat_cor() +
labs(
x = "lh_superiorparietal",
y = "loop_ae_avg_degree") +
theme(legend.position = "right",
axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
panel.background =element_blank(),
axis.line = element_line(colour = "black"))
fit.1 <- lm(loop_ae_avg_degree ~ sex + age_scan_years + EstimatedTotalIntraCranialVol , data=df)
df$residual1 <- residuals(fit.1)
fit.2 <- lm(lh_superiorparietal ~ sex + age_scan_years +EstimatedTotalIntraCranialVol, data=df)
df$residual2 <- residuals(fit.2)
ggplot(df, aes(x=residual1, y=residual2)) +
geom_point(color="#F8B2AC") +
stat_smooth(method="lm",se=FALSE, color="#F8B2AC")+
stat_cor() +
xlim(min(df$loop_de_avg_degree),max(df$loop_de_avg_degree))+
ylim(min(df$lh_superiorparietal),max(df$lh_superiorparietal))+
labs(
x = "lh_superiorparietal",
y = "loop_ae_avg_degree") +
theme(legend.position = "right",
axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
panel.background =element_blank(),
axis.line = element_line(colour = "black"))
fit.1 <- lm(loop_ae_avg_degree ~ sex + age_scan_years + EstimatedTotalIntraCranialVol , data=df)
df$residual1 <- residuals(fit.1)
fit.2 <- lm(lh_superiorparietal ~ sex + age_scan_years +EstimatedTotalIntraCranialVol, data=df)
df$residual2 <- residuals(fit.2)
ggplot(df, aes(x=residual1, y=residual2)) +
geom_point(color="#F8B2AC") +
stat_smooth(method="lm",se=FALSE, color="#F8B2AC")+
stat_cor() +
labs(
x = "lh_superiorparietal",
y = "loop_ae_avg_degree") +
theme(legend.position = "right",
axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
panel.background =element_blank(),
axis.line = element_line(colour = "black"))
fit.1 <- lm(loop_ae_avg_degree ~ sex + age_scan_years + EstimatedTotalIntraCranialVol , data=df)
df$residual1 <- residuals(fit.1)
fit.2 <- lm(lh_superiorparietal ~ sex + age_scan_years +EstimatedTotalIntraCranialVol, data=df)
df$residual2 <- residuals(fit.2)
ggplot(df, aes(x=residual2, y=residual1)) +
geom_point(color="#F8B2AC") +
stat_smooth(method="lm",se=FALSE, color="#F8B2AC")+
stat_cor() +
labs(
x = "loop_ae_avg_degree",
y = "lh_superiorparietal") +
theme(legend.position = "right",
axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
panel.background =element_blank(),
axis.line = element_line(colour = "black"))
fit.1 <- lm(loop_ae_avg_degree ~ sex + age_scan_years + EstimatedTotalIntraCranialVol , data=df)
df$residual1 <- residuals(fit.1)
fit.2 <- lm(lh_superiorparietal ~ sex + age_scan_years +EstimatedTotalIntraCranialVol, data=df)
df$residual2 <- residuals(fit.2)
ggplot(df, aes(x=residual2, y=residual1)) +
geom_point(color="#F8B2AC") +
stat_smooth(method="lm",se=FALSE, color="#F8B2AC")+
stat_cor() +
labs(
x = "loop_ae_avg_degree",
y = "lh_superiorparietal") +
theme(legend.position = "right",
axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
panel.background =element_blank(),
axis.line = element_line(colour = "black"))
fit.1 <- lm(loop_ae_avg_degree ~ sex + age_scan_years + EstimatedTotalIntraCranialVol , data=df)
df$residual1 <- residuals(fit.1)
fit.2 <- lm(lh_superiorparietal ~ sex + age_scan_years +EstimatedTotalIntraCranialVol, data=df)
df$residual2 <- residuals(fit.2)
ggplot(df, aes(x=residual2, y=residual1)) +
geom_point(color="#F8B2AC") +
stat_smooth(method="lm",se=FALSE, color="#F8B2AC")+
stat_cor(label.x.npc = "right") +
labs(
x = "loop_ae_avg_degree",
y = "lh_superiorparietal") +
theme(legend.position = "right",
axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
panel.background =element_blank(),
axis.line = element_line(colour = "black"))
fit.1 <- lm(loop_ae_avg_degree ~ sex + age_scan_years + EstimatedTotalIntraCranialVol , data=df)
df$residual1 <- residuals(fit.1)
fit.2 <- lm(rh_superiorparietal ~ sex + age_scan_years +EstimatedTotalIntraCranialVol, data=df)
df$residual2 <- residuals(fit.2)
ggplot(df, aes(x=residual2, y=residual1)) +
geom_point(color="#F8B2AC") +
stat_smooth(method="lm",se=FALSE, color="#F8B2AC")+
stat_cor(label.x.npc = "right") +
labs(
x = "loop_ae_avg_degree",
y = "rh_superiorparietal") +
theme(legend.position = "right",
axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
panel.background =element_blank(),
axis.line = element_line(colour = "black"))
fit.1 <- lm(loop_ae_avg_degree ~ sex + age_scan_years + EstimatedTotalIntraCranialVol , data=df)
df$residual1 <- residuals(fit.1)
fit.2 <- lm(rh_superiorparietal ~ sex + age_scan_years +EstimatedTotalIntraCranialVol, data=df)
df$residual2 <- residuals(fit.2)
ggplot(df, aes(x=residual2, y=residual1)) +
geom_point(color="#F8B2AC") +
stat_smooth(method="lm",se=FALSE, color="#F8B2AC")+
stat_cor() +
labs(
x = "loop_ae_avg_degree",
y = "rh_superiorparietal") +
theme(legend.position = "right",
axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
panel.background =element_blank(),
axis.line = element_line(colour = "black"))
fit.1 <- lm(loop_ae_avg_degree ~ sex + age_scan_years + EstimatedTotalIntraCranialVol , data=df)
df$residual1 <- residuals(fit.1)
fit.2 <- lm(lh_superiorparietal ~ sex + age_scan_years +EstimatedTotalIntraCranialVol, data=df)
df$residual2 <- residuals(fit.2)
ggplot(df, aes(x=residual2, y=residual1)) +
geom_point(color="#F8B2AC") +
stat_smooth(method="lm",se=FALSE, color="#F8B2AC")+
stat_cor(label.x.npc = "right") +
labs(
x = "loop_ae_avg_degree",
y = "lh_superiorparietal") +
theme(legend.position = "center",
axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
panel.background =element_blank(),
axis.line = element_line(colour = "black"))
fit.1 <- lm(loop_ae_avg_degree ~ sex + age_scan_years + EstimatedTotalIntraCranialVol , data=df)
df$residual1 <- residuals(fit.1)
fit.2 <- lm(lh_superiorparietal ~ sex + age_scan_years +EstimatedTotalIntraCranialVol, data=df)
df$residual2 <- residuals(fit.2)
ggplot(df, aes(x=residual2, y=residual1)) +
geom_point(color="#F8B2AC") +
stat_smooth(method="lm",se=FALSE, color="#F8B2AC")+
stat_cor(label.x.npc = 0.1) +
labs(
x = "loop_ae_avg_degree",
y = "lh_superiorparietal") +
theme(legend.position = "center",
axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
panel.background =element_blank(),
axis.line = element_line(colour = "black"))
fit.1 <- lm(loop_ae_avg_degree ~ sex + age_scan_years + EstimatedTotalIntraCranialVol , data=df)
df$residual1 <- residuals(fit.1)
fit.2 <- lm(lh_superiorparietal ~ sex + age_scan_years +EstimatedTotalIntraCranialVol, data=df)
df$residual2 <- residuals(fit.2)
ggplot(df, aes(x=residual2, y=residual1)) +
geom_point(color="#F8B2AC") +
stat_smooth(method="lm",se=FALSE, color="#F8B2AC")+
stat_cor(label.x.npc = 0.2) +
labs(
x = "loop_ae_avg_degree",
y = "lh_superiorparietal") +
theme(legend.position = "center",
axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
panel.background =element_blank(),
axis.line = element_line(colour = "black"))
fit.1 <- lm(loop_ae_avg_degree ~ sex + age_scan_years + EstimatedTotalIntraCranialVol , data=df)
df$residual1 <- residuals(fit.1)
fit.2 <- lm(lh_superiorparietal ~ sex + age_scan_years +EstimatedTotalIntraCranialVol, data=df)
df$residual2 <- residuals(fit.2)
ggplot(df, aes(x=residual2, y=residual1)) +
geom_point(color="#F8B2AC") +
stat_smooth(method="lm",se=FALSE, color="#F8B2AC")+
stat_cor(label.x.npc = 0.5) +
labs(
x = "loop_ae_avg_degree",
y = "lh_superiorparietal") +
theme(legend.position = "center",
axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
panel.background =element_blank(),
axis.line = element_line(colour = "black"))
fit.1 <- lm(loop_ae_avg_degree ~ sex + age_scan_years + EstimatedTotalIntraCranialVol , data=df)
df$residual1 <- residuals(fit.1)
fit.2 <- lm(rh_superiorparietal ~ sex + age_scan_years +EstimatedTotalIntraCranialVol, data=df)
df$residual2 <- residuals(fit.2)
ggplot(df, aes(x=residual2, y=residual1)) +
geom_point(color="#F8B2AC") +
stat_smooth(method="lm",se=FALSE, color="#F8B2AC")+
stat_cor(label.x.npc = 0.5) +
labs(
x = "loop_ae_avg_degree",
y = "rh_superiorparietal") +
theme(legend.position = "right",
axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
panel.background =element_blank(),
axis.line = element_line(colour = "black"))
fit.1 <- lm(loop_ae_avg_degree ~ sex + age_scan_years + EstimatedTotalIntraCranialVol , data=df)
df$residual1 <- residuals(fit.1)
fit.2 <- lm(lh_postcentral ~ sex + age_scan_years +EstimatedTotalIntraCranialVol, data=df)
df$residual2 <- residuals(fit.2)
ggplot(df, aes(x=residual2, y=residual1)) +
geom_point(color="#F8B2AC") +
stat_smooth(method="lm",se=FALSE, color="#F8B2AC")+
stat_cor(label.x.npc = 0.5) +
labs(
x = "loop_ae_avg_degree",
y = "lh_postcentral") +
theme(legend.position = "right",
axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
panel.background =element_blank(),
axis.line = element_line(colour = "black"))
fit.1 <- lm(loop_ae_avg_degree ~ age_scan_years + EstimatedTotalIntraCranialVol , data=df)
df$residual1 <- residuals(fit.1)
fit.2 <- lm(lh_postcentral ~ age_scan_years +EstimatedTotalIntraCranialVol, data=df)
df$residual2 <- residuals(fit.2)
ggplot(df, aes(x=residual2, y=residual1)) +
geom_point(color="#F8B2AC") +
stat_smooth(method="lm",se=FALSE, color="#F8B2AC")+
stat_cor(label.x.npc = 0.5) +
labs(
x = "loop_ae_avg_degree",
y = "lh_postcentral") +
theme(legend.position = "right",
axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
panel.background =element_blank(),
axis.line = element_line(colour = "black"))
df <- all_rois %>% filter(loop_ae_avg_degree != "NA") %>% filter(sex==0)
cor_results <-
data.frame(matrix(nrow = 0, ncol = 7)) %>%   `colnames<-`(c("roi", "estimate", "p.value", "statistic", "n", "gp", "Method"))
pcorlist <- list()
for (ROI in all_apriori) {
print(ROI)
if(!is.na(sum(df[[ROI]])) == FALSE){
pcorlist[[ROI]] <- NA
}else{
pcorlist[[ROI]] <-
pcor.test(x = df[["loop_ae_avg_degree"]], y = df[[ROI]], z = df[, c("age_scan_years","EstimatedTotalIntraCranialVol")])
temp <- cbind(ROI, pcorlist[[ROI]])
cor_results <- rbind(cor_results, temp)
}
}
cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "bonferroni", n = length(cor_results$p.value))
cor_results <- arrange(cor_results,p.value)
fit.1 <- lm(loop_ae_avg_degree ~ age_scan_years + EstimatedTotalIntraCranialVol , data=df)
df$residual1 <- residuals(fit.1)
fit.2 <- lm(lh_postcentral ~ age_scan_years +EstimatedTotalIntraCranialVol, data=df)
df$residual2 <- residuals(fit.2)
ggplot(df, aes(x=residual2, y=residual1)) +
geom_point(color="#F8B2AC") +
stat_smooth(method="lm",se=FALSE, color="#F8B2AC")+
stat_cor(label.x.npc = 0.5) +
labs(
x = "loop_ae_avg_degree",
y = "lh_postcentral") +
theme(legend.position = "right",
axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
panel.background =element_blank(),
axis.line = element_line(colour = "black"))
fit.1 <- lm(loop_ae_avg_degree ~ sex + age_scan_years + EstimatedTotalIntraCranialVol , data=df)
df$residual1 <- residuals(fit.1)
fit.2 <- lm(rh_superiorparietal ~ sex + age_scan_years +EstimatedTotalIntraCranialVol, data=df)
df$residual2 <- residuals(fit.2)
ggplot(df, aes(x=residual2, y=residual1)) +
geom_point(color="#243D25") +
stat_smooth(method="lm",se=FALSE, color="#243D25")+
stat_cor(label.x.npc = 0.5) +
labs(
x = "loop_ae_avg_degree",
y = "rh_superiorparietal") +
theme(legend.position = "right",
axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
panel.background =element_blank(),
axis.line = element_line(colour = "black"))
df <- all_rois %>% filter(loop_ae_avg_degree != "NA")
cor_results <-
data.frame(matrix(nrow = 0, ncol = 7)) %>%   `colnames<-`(c("roi", "estimate", "p.value", "statistic", "n", "gp", "Method"))
pcorlist <- list()
for (ROI in all_apriori) {
print(ROI)
if(!is.na(sum(df[[ROI]])) == FALSE){
pcorlist[[ROI]] <- NA
}else{
pcorlist[[ROI]] <-
pcor.test(x = df[["loop_ae_avg_degree"]], y = df[[ROI]], z = df[, c("age_scan_years","sex","EstimatedTotalIntraCranialVol")])
temp <- cbind(ROI, pcorlist[[ROI]])
cor_results <- rbind(cor_results, temp)
}
}
cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "bonferroni", n = length(cor_results$p.value))
cor_results <- arrange(cor_results,p.value)
fit.1 <- lm(loop_ae_avg_degree ~ sex + age_scan_years + EstimatedTotalIntraCranialVol , data=df)
df$residual1 <- residuals(fit.1)
fit.2 <- lm(lh_superiorparietal ~ sex + age_scan_years +EstimatedTotalIntraCranialVol, data=df)
df$residual2 <- residuals(fit.2)
ggplot(df, aes(x=residual2, y=residual1)) +
geom_point(color="#243D25") +
stat_smooth(method="lm",se=FALSE, color="#243D25")+
stat_cor(label.x.npc = 0.5) +
labs(
x = "loop_ae_avg_degree",
y = "lh_superiorparietal") +
theme(legend.position = "center",
axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
panel.background =element_blank(),
axis.line = element_line(colour = "black"))
fit.1 <- lm(loop_ae_avg_degree ~ sex + age_scan_years + EstimatedTotalIntraCranialVol , data=df)
df$residual1 <- residuals(fit.1)
fit.2 <- lm(rh_superiorparietal ~ sex + age_scan_years +EstimatedTotalIntraCranialVol, data=df)
df$residual2 <- residuals(fit.2)
ggplot(df, aes(x=residual2, y=residual1)) +
geom_point(color="#243D25") +
stat_smooth(method="lm",se=FALSE, color="#243D25")+
stat_cor(label.x.npc = 0.5) +
labs(
x = "loop_ae_avg_degree",
y = "rh_superiorparietal") +
theme(legend.position = "right",
axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
panel.background =element_blank(),
axis.line = element_line(colour = "black"))
df <- all_rois %>% filter(loop_ae_avg_degree != "NA") %>% filter(sex==0)
cor_results <-
data.frame(matrix(nrow = 0, ncol = 7)) %>%   `colnames<-`(c("roi", "estimate", "p.value", "statistic", "n", "gp", "Method"))
pcorlist <- list()
for (ROI in all_apriori) {
print(ROI)
if(!is.na(sum(df[[ROI]])) == FALSE){
pcorlist[[ROI]] <- NA
}else{
pcorlist[[ROI]] <-
pcor.test(x = df[["loop_ae_avg_degree"]], y = df[[ROI]], z = df[, c("age_scan_years","EstimatedTotalIntraCranialVol")])
temp <- cbind(ROI, pcorlist[[ROI]])
cor_results <- rbind(cor_results, temp)
}
}
cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "bonferroni", n = length(cor_results$p.value))
cor_results <- arrange(cor_results,p.value)
fit.1 <- lm(loop_ae_avg_degree ~ age_scan_years + EstimatedTotalIntraCranialVol , data=df)
df$residual1 <- residuals(fit.1)
fit.2 <- lm(lh_postcentral ~ age_scan_years +EstimatedTotalIntraCranialVol, data=df)
df$residual2 <- residuals(fit.2)
ggplot(df, aes(x=residual2, y=residual1)) +
geom_point(color="#F8B2AC") +
stat_smooth(method="lm",se=FALSE, color="#F8B2AC")+
stat_cor(label.x.npc = 0.5) +
labs(
x = "loop_ae_avg_degree",
y = "lh_postcentral") +
theme(legend.position = "right",
axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
panel.background =element_blank(),
axis.line = element_line(colour = "black"))
df <- all_rois %>% filter(loop_ae_avg_degree != "NA") %>% filter(sex==1)
cor_results <-
data.frame(matrix(nrow = 0, ncol = 7)) %>%   `colnames<-`(c("roi", "estimate", "p.value", "statistic", "n", "gp", "Method"))
pcorlist <- list()
for (ROI in all_apriori) {
print(ROI)
if(!is.na(sum(df[[ROI]])) == FALSE){
pcorlist[[ROI]] <- NA
}else{
pcorlist[[ROI]] <-
pcor.test(x = df[["loop_ae_avg_degree"]], y = df[[ROI]], z = df[, c("age_scan_years","EstimatedTotalIntraCranialVol")])
temp <- cbind(ROI, pcorlist[[ROI]])
cor_results <- rbind(cor_results, temp)
}
}
cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "bonferroni", n = length(cor_results$p.value))
cor_results <- arrange(cor_results,p.value)
fit.1 <- lm(loop_ae_avg_degree ~ age_scan_years + EstimatedTotalIntraCranialVol , data=df)
df$residual1 <- residuals(fit.1)
fit.2 <- lm(rh_precuneus ~ age_scan_years +EstimatedTotalIntraCranialVol, data=df)
df$residual2 <- residuals(fit.2)
ggplot(df, aes(x=residual2, y=residual1)) +
geom_point(color="#1E4273") +
stat_smooth(method="lm",se=FALSE, color="#1E4273")+
stat_cor(label.x.npc = 0.5) +
labs(
x = "loop_ae_avg_degree",
y = "rh_precuneus") +
theme(legend.position = "right",
axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
panel.background =element_blank(),
axis.line = element_line(colour = "black"))
df <- all_rois %>% filter(loop_ae_avg_degree != "NA") %>% filter(sex==1)
cor_results <-
data.frame(matrix(nrow = 0, ncol = 7)) %>%   `colnames<-`(c("roi", "estimate", "p.value", "statistic", "n", "gp", "Method"))
pcorlist <- list()
for (ROI in all_apriori) {
print(ROI)
if(!is.na(sum(df[[ROI]])) == FALSE){
pcorlist[[ROI]] <- NA
}else{
pcorlist[[ROI]] <-
pcor.test(x = df[["loop_ae_avg_degree"]], y = df[[ROI]], z = df[, c("age_scan_years","EstimatedTotalIntraCranialVol")])
temp <- cbind(ROI, pcorlist[[ROI]])
cor_results <- rbind(cor_results, temp)
}
}
cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "bonferroni", n = length(cor_results$p.value))
cor_results <- arrange(cor_results,p.value)
fit.1 <- lm(loop_ae_avg_degree ~ age_scan_years + EstimatedTotalIntraCranialVol , data=df)
df$residual1 <- residuals(fit.1)
fit.2 <- lm(rh_precuneus ~ age_scan_years +EstimatedTotalIntraCranialVol, data=df)
df$residual2 <- residuals(fit.2)
ggplot(df, aes(x=residual2, y=residual1)) +
geom_point(color="#1E4273") +
stat_smooth(method="lm",se=FALSE, color="#1E4273")+
stat_cor(label.x.npc = 0.5) +
labs(
x = "loop_ae_avg_degree",
y = "rh_precuneus") +
theme(legend.position = "right",
axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
panel.background =element_blank(),
axis.line = element_line(colour = "black"))
fit.1 <- lm(loop_ae_avg_degree ~ age_scan_years + EstimatedTotalIntraCranialVol , data=df)
df$residual1 <- residuals(fit.1)
fit.2 <- lm(rh_cuneus ~ age_scan_years +EstimatedTotalIntraCranialVol, data=df)
df$residual2 <- residuals(fit.2)
ggplot(df, aes(x=residual2, y=residual1)) +
geom_point(color="#1E4273") +
stat_smooth(method="lm",se=FALSE, color="#1E4273")+
stat_cor(label.x.npc = 0.5) +
labs(
x = "loop_ae_avg_degree",
y = "rh_cuneus") +
theme(legend.position = "right",
axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
panel.background =element_blank(),
axis.line = element_line(colour = "black"))
df <- all_rois %>% filter(loop_ae_avg_degree != "NA") %>% filter(sex==1)
cor_results <-
data.frame(matrix(nrow = 0, ncol = 7)) %>%   `colnames<-`(c("roi", "estimate", "p.value", "statistic", "n", "gp", "Method"))
pcorlist <- list()
for (ROI in all_apriori) {
print(ROI)
if(!is.na(sum(df[[ROI]])) == FALSE){
pcorlist[[ROI]] <- NA
}else{
pcorlist[[ROI]] <-
pcor.test(x = df[["loop_ae_avg_degree"]], y = df[[ROI]], z = df[, c("age_scan_years","EstimatedTotalIntraCranialVol")])
temp <- cbind(ROI, pcorlist[[ROI]])
cor_results <- rbind(cor_results, temp)
}
}
cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "bonferroni", n = length(cor_results$p.value))
cor_results <- arrange(cor_results,p.value)
View(pcorlist)
pcorlist[["lh_cuneus"]]
pcorlist[["rh_cuneus"]]
df <- all_rois %>% filter(loop_ae_avg_degree != "NA") %>% filter(sex==1)
cor_results <-
data.frame(matrix(nrow = 0, ncol = 7)) %>%   `colnames<-`(c("roi", "estimate", "p.value", "statistic", "n", "gp", "Method"))
pcorlist <- list()
for (ROI in all_apriori) {
print(ROI)
if(!is.na(sum(df[[ROI]])) == FALSE){
pcorlist[[ROI]] <- NA
}else{
pcorlist[[ROI]] <-
pcor.test(x = df[["loop_ae_avg_degree"]], y = df[[ROI]], z = df[, c("age_scan_years","EstimatedTotalIntraCranialVol")])
temp <- cbind(ROI, pcorlist[[ROI]])
cor_results <- rbind(cor_results, temp)
}
}
cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "bonferroni", n = length(cor_results$p.value))
cor_results <- arrange(cor_results,p.value)
View(cor_results)
View(cor_results)
fit.1 <- lm(loop_de_avg_degree ~ age_scan_years + EstimatedTotalIntraCranialVol , data=df)
df$residual1 <- residuals(fit.1)
fit.2 <- lm(rh_cuneus ~ age_scan_years +EstimatedTotalIntraCranialVol, data=df)
df$residual2 <- residuals(fit.2)
ggplot(df, aes(x=residual2, y=residual1)) +
geom_point(color="#1E4273") +
stat_smooth(method="lm",se=FALSE, color="#1E4273")+
stat_cor(label.x.npc = 0.5) +
labs(
x = "loop_de_avg_degree",
y = "rh_cuneus") +
theme(legend.position = "right",
axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
panel.background =element_blank(),
axis.line = element_line(colour = "black"))
