#legend.title = element_text(size=18), #change legend title font size
#legend.text = element_text(size=18),
#plot.margin = margin(1, 1, 1, 1, "cm"))
#png(file = CleanCSVsfigpath,ROI,"_sexdiff_QA.png"))  #,".png"))
print(plist[[ROI]] )
#dev.off()
}
View(plist)
View(AE_ave_df)
pcor.test(x=AE_ave_df["loop_ae_avg_degree"],y=AE_ave_df[[ROI]],z= AE_ave_df[,c("age_scan_years", "sex")])
pcor.test(x=AE_ave_df["loop_ae_avg_degree"],y=AE_ave_df[[ROI]],z= AE_ave_df[,c("age_scan_years", "sex")]) %>% broom::tidy()
x <- pcor.test(x=AE_ave_df["loop_ae_avg_degree"],y=AE_ave_df[[ROI]],z= AE_ave_df[,c("age_scan_years", "sex")])
View(x)
x$p.value
WholeBrain_7network400parc[[ROI]] <- pcor.test(x=AE_ave_df["loop_ae_avg_degree"],y=AE_ave_df[[ROI]],z= AE_ave_df[,c("age_scan_years", "sex")])
WholeBrain_7network400parc <- list()
WholeBrain_7network400parc[[ROI]] <- pcor.test(x=AE_ave_df["loop_ae_avg_degree"],y=AE_ave_df[[ROI]],z= AE_ave_df[,c("age_scan_years", "sex")])
WholeBrain_7network400parc[[ROI]][["p.value"]]
WholeBrain_7network400parc[[ROI]]
colnames(WholeBrain_7network400parc[[ROI]])
sigWB_7network400parc <-data.frame(matrix(nrow=0,ncol=7)) %>% `colnames<-`(c("roi", "estimate" ,"p.value","statistic","n","gp","Method"))
rbind(sigWB_7network400parc,WholeBrain_7network400parc[[ROI]])
View(sigWB_7network400parc)
sigWB_7network400parc <- rbind(sigWB_7network400parc,WholeBrain_7network400parc[[ROI]])
View(sigWB_7network400parc)
sigWB_7network400parc <- rbind(sigWB_7network400parc,WholeBrain_7network400parc[[ROI]])
View(sigWB_7network400parc)
WholeBrain_7network400parc <- list()
cols <-
sigWB_7network400parc <-data.frame(matrix(nrow=0,ncol=7)) %>% `colnames<-`(c("roi", "estimate" ,"p.value","statistic","n","gp","Method"))
for (ROI in ROIs) {
WholeBrain_7network400parc[[ROI]] <- pcor.test(x=AE_ave_df["loop_ae_avg_degree"],y=AE_ave_df[[ROI]],z= AE_ave_df[,c("age_scan_years", "sex")])
if (WholeBrain_7network400parc[[ROI]][["p.value"]] < 0.05){
sigWB_7network400parc <- rbind(sigWB_7network400parc,WholeBrain_7network400parc[[ROI]])
}
}
View(sigWB_7network400parc)
WholeBrain_7network400parc[[ROI]]
temp <-cbind(ROI,WholeBrain_7network400parc[[ROI]])
View(temp)
WholeBrain_7network400parc <- list()
cols <-
sigWB_7network400parc <-data.frame(matrix(nrow=0,ncol=7)) %>% `colnames<-`(c("roi", "estimate" ,"p.value","statistic","n","gp","Method"))
for (ROI in ROIs) {
WholeBrain_7network400parc[[ROI]] <- pcor.test(x=AE_ave_df["loop_ae_avg_degree"],y=AE_ave_df[[ROI]],z= AE_ave_df[,c("age_scan_years", "sex")])
if (WholeBrain_7network400parc[[ROI]][["p.value"]] < 0.05){
temp <-cbind(ROI,WholeBrain_7network400parc[[ROI]])
sigWB_7network400parc <- rbind(sigWB_7network400parc,temp)
}
}
View(sigWB_7network400parc)
p.adjust(sigWB_7network400parc$p.value, method = "fdr")
p.adjust(sigWB_7network400parc$p.value, method = "fdr", n=length(sigWB_7network400parc))
p.adjust(sigWB_7network400parc$p.value, method = "fdr", n=length(sigWB_7network400parc))
length(sigWB_7network400parc$p.value)
length(sigWB_7network400parc)
p.adjust(sigWB_7network400parc$p.value, method = "fdr", n=length(sigWB_7network400parc$p.value))
WholeBrain_77network400parc <- list()
cols <-
sigWB_17network400parc <-data.frame(matrix(nrow=0,ncol=7)) %>% `colnames<-`(c("roi", "estimate" ,"p.value","statistic","n","gp","Method"))
df <-CleanDF(CT_17network,"loop_ae_avg_degree")
for (ROI in ROIs) {
WholeBrain_17network400parc[[ROI]] <- pcor.test(x=df["loop_ae_avg_degree"],y=df[[ROI]],z= df[,c("age_scan_years", "sex")])
if (WholeBrain_17network400parc[[ROI]][["p.value"]] < 0.05){
temp <-cbind(ROI,WholeBrain_17network400parc[[ROI]])
sigWB_17network400parc <- rbind(sigWB_17network400parc,temp)
}
}
View(CT_17network)
df <-CleanDF(CT_17network,"loop_ae_avg_degree")
View(DF)
View(df)
WholeBrain_17network400parc[[ROI]] <- pcor.test(x=df["loop_ae_avg_degree"],y=df[[ROI]],z= df[,c("age_scan_years", "sex")])
df[[ROI]]
WholeBrain_77network400parc <- list()
ROIs<- SelectAtlas(400,17) %>% .[-1]
cols <-
sigWB_17network400parc <-data.frame(matrix(nrow=0,ncol=7)) %>% `colnames<-`(c("roi", "estimate" ,"p.value","statistic","n","gp","Method"))
df <-CleanDF(CT_17network,"loop_ae_avg_degree")
for (ROI in ROIs) {
WholeBrain_17network400parc[[ROI]] <- pcor.test(x=df["loop_ae_avg_degree"],y=df[[ROI]],z= df[,c("age_scan_years", "sex")])
if (WholeBrain_17network400parc[[ROI]][["p.value"]] < 0.05){
temp <-cbind(ROI,WholeBrain_17network400parc[[ROI]])
sigWB_17network400parc <- rbind(sigWB_17network400parc,temp)
}
}
WholeBrain_17network400parc <- list()
ROIs<- SelectAtlas(400,17) %>% .[-1]
cols <-
sigWB_17network400parc <-data.frame(matrix(nrow=0,ncol=7)) %>% `colnames<-`(c("roi", "estimate" ,"p.value","statistic","n","gp","Method"))
df <-CleanDF(CT_17network,"loop_ae_avg_degree")
for (ROI in ROIs) {
WholeBrain_17network400parc[[ROI]] <- pcor.test(x=df["loop_ae_avg_degree"],y=df[[ROI]],z= df[,c("age_scan_years", "sex")])
if (WholeBrain_17network400parc[[ROI]][["p.value"]] < 0.05){
temp <-cbind(ROI,WholeBrain_17network400parc[[ROI]])
sigWB_17network400parc <- rbind(sigWB_17network400parc,temp)
}
}
View(sigWB_17network400parc)
sigWB_17network400parc$ROI
ROIs<- c(sigWB_17network400parc$ROI)
ROIs<- c(sigWB_17network400parc$ROI)  # removing sibject ID
plotlist <- list()
for (ROI in ROIs) {
print(ROI)
plist[[ROI]] <- ggplot(AE_ave_df, aes(x=loop_ae_avg_degree, y=.data[[ROI]]))  +
geom_point(color="#502E23", size=4) +
geom_smooth(method="lm", level=0.95,color ="#E2929D", se=FALSE,linewidth=2) +
theme_classic() +
labs(x ="Cortical Thickness", y = "Position Error", title = ROI) +
theme( axis.title.x = element_text(vjust = -4,size = 16),
axis.text.x = element_text(size = 25),
axis.text.y = element_text(size = 25),
axis.title.y = element_text(vjust = 4, size = 16),
plot.title = element_text(hjust = 0.5 ,size=16),
panel.border = element_rect(fill=NA,color = "#502E23"),
panel.background =element_blank(),
strip.text.x = element_text(
size = 16,
color = "black",
face = "bold.italic"
),
legend.position = "right")
#legend.key.size = unit(2, 'cm'),
#legend.title = element_text(size=18), #change legend title font size
#legend.text = element_text(size=18),
#plot.margin = margin(1, 1, 1, 1, "cm"))
#png(file = CleanCSVsfigpath,ROI,"_sexdiff_QA.png"))  #,".png"))
print(plotlist[[ROI]] )
#dev.off()
}
View(plist)
ROIs<- c(sigWB_17network400parc$ROI)  # removing sibject ID
plotlist <- list()
for (ROI in ROIs) {
print(ROI)
plotlist[[ROI]] <- ggplot(AE_ave_df, aes(x=loop_ae_avg_degree, y=.data[[ROI]]))  +
geom_point(color="#502E23", size=4) +
geom_smooth(method="lm", level=0.95,color ="#E2929D", se=FALSE,linewidth=2) +
theme_classic() +
labs(x ="Cortical Thickness", y = "Position Error", title = ROI) +
theme( axis.title.x = element_text(vjust = -4,size = 16),
axis.text.x = element_text(size = 25),
axis.text.y = element_text(size = 25),
axis.title.y = element_text(vjust = 4, size = 16),
plot.title = element_text(hjust = 0.5 ,size=16),
panel.border = element_rect(fill=NA,color = "#502E23"),
panel.background =element_blank(),
strip.text.x = element_text(
size = 16,
color = "black",
face = "bold.italic"
),
legend.position = "right")
#legend.key.size = unit(2, 'cm'),
#legend.title = element_text(size=18), #change legend title font size
#legend.text = element_text(size=18),
#plot.margin = margin(1, 1, 1, 1, "cm"))
#png(file = CleanCSVsfigpath,ROI,"_sexdiff_QA.png"))  #,".png"))
print(plotlist[[ROI]] )
#dev.off()
}
ROIs<- c(sigWB_17network400parc$ROI)  # removing sibject ID
plotlist <- list()
for (ROI in ROIs) {
print(ROI)
plotlist[[ROI]] <- ggplot(df, aes(x=loop_ae_avg_degree, y=.data[[ROI]]))  +
geom_point(color="#502E23", size=4) +
geom_smooth(method="lm", level=0.95,color ="#E2929D", se=FALSE,linewidth=2) +
theme_classic() +
labs(x ="Cortical Thickness", y = "Position Error", title = ROI) +
theme( axis.title.x = element_text(vjust = -4,size = 16),
axis.text.x = element_text(size = 25),
axis.text.y = element_text(size = 25),
axis.title.y = element_text(vjust = 4, size = 16),
plot.title = element_text(hjust = 0.5 ,size=16),
panel.border = element_rect(fill=NA,color = "#502E23"),
panel.background =element_blank(),
strip.text.x = element_text(
size = 16,
color = "black",
face = "bold.italic"
),
legend.position = "right")
#legend.key.size = unit(2, 'cm'),
#legend.title = element_text(size=18), #change legend title font size
#legend.text = element_text(size=18),
#plot.margin = margin(1, 1, 1, 1, "cm"))
#png(file = CleanCSVsfigpath,ROI,"_sexdiff_QA.png"))  #,".png"))
print(plotlist[[ROI]] )
#dev.off()
}
ggplot(df, aes(x=loop_ae_avg_degree, y=.data[[ROI]]))  +
geom_point(color="#502E23", size=4) +
geom_smooth(method="lm", level=0.95,color ="#E2929D", se=FALSE,linewidth=2) +
theme_classic() +
labs(x ="Cortical Thickness", y = "Position Error", title = ROI) +
theme( axis.title.x = element_text(vjust = -4,size = 16),
axis.text.x = element_text(size = 25),
axis.text.y = element_text(size = 25),
axis.title.y = element_text(vjust = 4, size = 16),
plot.title = element_text(hjust = 0.5 ,size=16),
panel.border = element_rect(fill=NA,color = "#502E23"),
panel.background =element_blank(),
strip.text.x = element_text(
size = 16,
color = "black",
face = "bold.italic"
),
legend.position = "right")+
stat_cor( method = "pearson")
ROIs<- c(sigWB_17network400parc$ROI)  # removing sibject ID
plotlist <- list()
for (ROI in ROIs) {
print(ROI)
plotlist[[ROI]] <- ggplot(df, aes(x=loop_ae_avg_degree, y=.data[[ROI]]))  +
geom_point(color="#502E23", size=4) +
geom_smooth(method="lm", level=0.95,color ="#E2929D", se=FALSE,linewidth=2) +
theme_classic() +
labs(x ="Cortical Thickness", y = "Position Error", title = ROI) +
theme( axis.title.x = element_text(vjust = -4,size = 16),
axis.text.x = element_text(size = 25),
axis.text.y = element_text(size = 25),
axis.title.y = element_text(vjust = 4, size = 16),
plot.title = element_text(hjust = 0.5 ,size=16),
panel.border = element_rect(fill=NA,color = "#502E23"),
panel.background =element_blank(),
strip.text.x = element_text(
size = 16,
color = "black",
face = "bold.italic"
),
legend.position = "right")+
stat_cor( method = "pearson")
#legend.key.size = unit(2, 'cm'),
#legend.title = element_text(size=18), #change legend title font size
#legend.text = element_text(size=18),
#plot.margin = margin(1, 1, 1, 1, "cm"))
#png(file = CleanCSVsfigpath,ROI,"_sexdiff_QA.png"))  #,".png"))
print(plotlist[[ROI]] )
#dev.off()
}
View(WholeBrain_17network400parc)
WholeBrain_17network400parc[["17Networks_LH_VisCent_ExStr_4"]]
library(ggplot2)
#(plyr)
library(ppcor)
library(tidyverse)
# library(dplyr)
# library(tidyr)
library(stringr)
library(kableExtra)
# library(data.table)
# library(network)
# library(tidygraph)
# library(ggraph)
# library(igraph)
# library(networkD3)
# library(CINNA)
# library(umap)
# library(plotly)
#library(factoextra)
#library(lsr)
# library(car)
library(ggpubr)
#library(entropy)
#library(ds4psy)
# library(pROC)
#library(devtools)
#library(BRRR)
#library(stats)
#library(afex)
library(knitr)
library(janitor)
library(car)
library(ggiraph)
library(ggiraphExtra)
library(moonBook)
library(nationalparkcolors)
library(gridExtra)
library(markdown)
ReadingCSVFunc <- function(pathname){
#' @description: purpose of this is to read in CSVs and clean them up
#' @return: DF
read.csv(paste0(working_dir, pathname), header=TRUE)
}
CleanDF <- function(DF,Variable){
DF <- DF %>% select(-c("subject_id"))
subinfo <- sub_info  %>% select(c("subject_id", "sex", "age_scan_years","repo_status",Variable))
cleanedDF <- cbind(subinfo, DF) %>% drop_na()
cleanedDF$sex[cleanedDF$sex=="Male"] <- 1
cleanedDF$sex[cleanedDF$sex=="Female"] <- 0
cleanedDF$sex <- as.numeric(cleanedDF$sex)
return (cleanedDF)
}
SelectAtlas <- function(Parcel,NetworkNum){
#' @description: purpose of this is to read in and extract the ROIs from schaefer atlas you choose
#' @return: A list of all the ROIs
atlas_path <- ReadingCSVFunc(paste0("Schaefer2018_",Parcel,"Parcels_",NetworkNum, "Networks_order_FSLMNI152_1mm.Centroid_RAS.csv"))
col_names <-c("subject_id",atlas_path$ROI.Name)
return(col_names)
}
ggplot(df, aes(x=loop_ae_avg_degree, y=.data[[ROI]]))  +
geom_point(color="#502E23", size=4) +
geom_smooth(method="lm", level=0.95,color ="#E2929D", se=FALSE,linewidth=2) +
theme_classic() +
labs(x ="Cortical Thickness", y = "Position Error", title = ROI) +
theme( axis.title.x = element_text(vjust = -4,size = 16),
axis.text.x = element_text(size = 25),
axis.text.y = element_text(size = 25),
axis.title.y = element_text(vjust = 4, size = 16),
plot.title = element_text(hjust = 0.5 ,size=16),
panel.border = element_rect(fill=NA,color = "#502E23"),
panel.background =element_blank(),
strip.text.x = element_text(
size = 16,
color = "black",
face = "bold.italic"
),
legend.position = "right")+
stat_cor( method = "pearson")
plotlist[[1]]
grid.arrange(plotlist[[1]],plotlist[[2]],plotlist[[3]], plotlist[[4]], plotlist[[5]],plotlist[[6]], plotlist[[7]], plotlist[[8]], nrow=2)
grid.arrange(plotlist[[1]],plotlist[[2]],plotlist[[3]], plotlist[[4]], plotlist[[5]],plotlist[[6]], plotlist[[7]], plotlist[[8]], nrow=4, widths=c(1,1))
grid.arrange(plotlist[[1]],plotlist[[2]],plotlist[[3]], plotlist[[4]], plotlist[[5]],plotlist[[6]], plotlist[[7]], plotlist[[8]], nrow=4, widths=c(2,2))
grid.arrange(plotlist[[1]],plotlist[[2]],plotlist[[3]], plotlist[[4]], plotlist[[5]],plotlist[[6]], plotlist[[7]], plotlist[[8]],plotlist[[9]],plotlist[[10]],plotlist[[11]],plotlist[[12]],plotlist[[13]],plotlist[[14]],plotlist[[15]],plotlist[[16]],plotlist[[17]],plotlist[[18]], nrow=6)
View(CT_7network)
View(CT_17network)
Parcel <- 17
NetworkNum <- 400
atlas_path <- ReadingCSVFunc(paste0("Schaefer2018_",Parcel,"Parcels_",NetworkNum, "Networks_order_FSLMNI152_1mm.Centroid_RAS.csv"))
Parcel <- 400
NetworkNum <- 17
atlas_path <- ReadingCSVFunc(paste0("Schaefer2018_",Parcel,"Parcels_",NetworkNum, "Networks_order_FSLMNI152_1mm.Centroid_RAS.csv"))
atlas_path$ROI.Name
str_sub(atlas_path$ROI.Name,1,11)
str_sub(atlas_path$ROI.Name,-1,11)
str_sub(atlas_path$ROI.Name,-11,-1)
str_remove(atlas_path$ROI.Name,-1,11)
str_remove(atlas_path$ROI.Name,paste0(NetowrkNum,"Networks_"))
str_remove(atlas_path$ROI.Name,paste0(NetworkNum,"Networks_"))
atlas_path <- ReadingCSVFunc(paste0("Schaefer2018_",Parcel,"Parcels_",NetworkNum, "Networks_order_FSLMNI152_1mm.Centroid_RAS.csv"))
atlas_path$ROI.Name <- str_remove(atlas_path$ROI.Name,paste0(NetworkNum,"Networks_"))
View(atlas_path)
ReadingCSVFunc <- function(pathname){
#' @description: purpose of this is to read in CSVs and clean them up
#' @return: DF
read.csv(paste0(working_dir, pathname), header=TRUE)
}
CleanDF <- function(DF,Variable){
DF <- DF %>% select(-c("subject_id"))
subinfo <- sub_info  %>% select(c("subject_id", "sex", "age_scan_years","repo_status",Variable))
cleanedDF <- cbind(subinfo, DF) %>% drop_na()
cleanedDF$sex[cleanedDF$sex=="Male"] <- 1
cleanedDF$sex[cleanedDF$sex=="Female"] <- 0
cleanedDF$sex <- as.numeric(cleanedDF$sex)
return (cleanedDF)
}
SelectAtlas <- function(Parcel,NetworkNum){
#' @description: purpose of this is to read in and extract the ROIs from schaefer atlas you choose
#' @return: A list of all the ROIs
atlas_path <- ReadingCSVFunc(paste0("Schaefer2018_",Parcel,"Parcels_",NetworkNum, "Networks_order_FSLMNI152_1mm.Centroid_RAS.csv"))
atlas_path$ROI.Name <- str_remove(atlas_path$ROI.Name,paste0(NetworkNum,"Networks_"))
col_names <-c("subject_id",atlas_path$ROI.Name)
return(col_names)
}
grid.arrange(plotlist[[1]],plotlist[[2]],plotlist[[3]], plotlist[[4]], plotlist[[5]],plotlist[[6]], plotlist[[7]], plotlist[[8]],plotlist[[9]],plotlist[[10]],plotlist[[11]],plotlist[[12]],plotlist[[13]],plotlist[[14]],plotlist[[15]],plotlist[[16]],plotlist[[17]],plotlist[[18]], nrow=9, widths=c(1,1))
ROIs<- c(sigWB_17network400parc$ROI)  # removing sibject ID
plotlist <- list()
for (ROI in ROIs) {
print(ROI)
plotlist[[ROI]] <- ggplot(df, aes(x=loop_ae_avg_degree, y=.data[[ROI]]))  +
geom_point(color="#502E23", size=4) +
geom_smooth(method="lm", level=0.95,color ="#E2929D", se=FALSE,linewidth=2) +
theme_classic() +
labs(x ="Cortical Thickness", y = "Position Error", title = ROI) +
theme( axis.title.x = element_text(vjust = -4),
plot.margin = margin(1, 1, 1, 1, "cm")) +
#    axis.text.x = element_text(size = 25),
#    axis.text.y = element_text(size = 25),
#    axis.title.y = element_text(vjust = 4, size = 16),
#    plot.title = element_text(hjust = 0.5 ,size=16),
#    panel.border = element_rect(fill=NA,color = "#502E23"),
#    panel.background =element_blank(),
#    strip.text.x = element_text(
#      size = 16,
#      color = "black",
#      face = "bold.italic"
#    ),
# legend.position = "right")+
stat_cor( method = "pearson")
#legend.key.size = unit(2, 'cm'),
#legend.title = element_text(size=18), #change legend title font size
#legend.text = element_text(size=18),
#png(file = CleanCSVsfigpath,ROI,"_sexdiff_QA.png"))  #,".png"))
#print(plotlist[[ROI]] )
#dev.off()
}
sigWB_7network400parc
ReadingCSVFunc <- function(pathname){
#' @description: purpose of this is to read in CSVs and clean them up
#' @return: DF
read.csv(paste0(working_dir, pathname), header=TRUE)
}
TableOutput <- function(df){
knitr::kable(df, row.names=F) %>% kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% scroll_box(width = "600px", height = "300px")
}
CleanDF <- function(DF,Variable){
DF <- DF %>% select(-c("subject_id"))
subinfo <- sub_info  %>% select(c("subject_id", "sex", "age_scan_years","repo_status",Variable))
cleanedDF <- cbind(subinfo, DF) %>% drop_na()
cleanedDF$sex[cleanedDF$sex=="Male"] <- 1
cleanedDF$sex[cleanedDF$sex=="Female"] <- 0
cleanedDF$sex <- as.numeric(cleanedDF$sex)
return (cleanedDF)
}
SelectAtlas <- function(Parcel,NetworkNum){
#' @description: purpose of this is to read in and extract the ROIs from schaefer atlas you choose
#' @return: A list of all the ROIs
atlas_path <- ReadingCSVFunc(paste0("Schaefer2018_",Parcel,"Parcels_",NetworkNum, "Networks_order_FSLMNI152_1mm.Centroid_RAS.csv"))
atlas_path$ROI.Name <- str_remove(atlas_path$ROI.Name,paste0(NetworkNum,"Networks_"))
col_names <-c("subject_id",atlas_path$ROI.Name)
return(col_names)
}
<br>
igWB_7network400parc$ROI
sigWB_7network400parc$ROI
ggplot(df, aes(x=loop_ae_avg_degree, y=.data[[ROI]]))  +
geom_point(color="#502E23", size=4) +
geom_smooth(method="lm", level=0.95,color ="#E2929D", se=FALSE,linewidth=2) +
theme_classic() +
labs(x ="Cortical Thickness", y = "Position Error", title = ROI) +
theme( axis.title.x = element_text(vjust = -4),
plot.margin = margin(1, 1, 1, 1, "cm")) +
#    axis.text.x = element_text(size = 25),
#    axis.text.y = element_text(size = 25),
#    axis.title.y = element_text(vjust = 4, size = 16),
#    plot.title = element_text(hjust = 0.5 ,size=16),
#    panel.border = element_rect(fill=NA,color = "#502E23"),
#    panel.background =element_blank(),
#    strip.text.x = element_text(
#      size = 16,
#      color = "black",
#      face = "bold.italic"
#    ),
# legend.position = "right")+
stat_cor( method = "pearson", label.x.npc = "center",
label.y.npc = "top")
ROIs<- c(sigWB_7network400parc$ROI)  # removing sibject ID
plotlist <- list()
for (ROI in ROIs) {
print(ROI)
plotlist[[ROI]] <- ggplot(df, aes(x=loop_ae_avg_degree, y=.data[[ROI]]))  +
geom_point(color="#502E23", size=4) +
geom_smooth(method="lm", level=0.95,color ="#E2929D", se=FALSE,linewidth=2) +
theme_classic() +
labs(x ="Cortical Thickness", y = "Position Error", title = ROI) +
theme( axis.title.x = element_text(vjust = -4),
plot.margin = margin(1, 1, 1, 1, "cm")) +
#    axis.text.x = element_text(size = 25),
#    axis.text.y = element_text(size = 25),
#    axis.title.y = element_text(vjust = 4, size = 16),
#    plot.title = element_text(hjust = 0.5 ,size=16),
#    panel.border = element_rect(fill=NA,color = "#502E23"),
#    panel.background =element_blank(),
#    strip.text.x = element_text(
#      size = 16,
#      color = "black",
#      face = "bold.italic"
#    ),
# legend.position = "right")+
stat_cor( method = "pearson", label.x.npc = "center",
label.y.npc = "top")
#legend.key.size = unit(2, 'cm'),
#legend.title = element_text(size=18), #change legend title font size
#legend.text = element_text(size=18),
#png(file = CleanCSVsfigpath,ROI,"_sexdiff_QA.png"))  #,".png"))
#print(plotlist[[ROI]] )
#dev.off()
}
ROIs<- c(sigWB_7network400parc$ROI)  # removing sibject ID
plotlist <- list()
for (ROI in ROIs) {
print(ROI)
plotlist[[ROI]] <- ggplot(AE_ave_df, aes(x=loop_ae_avg_degree, y=.data[[ROI]]))  +
geom_point(color="#502E23", size=4) +
geom_smooth(method="lm", level=0.95,color ="#E2929D", se=FALSE,linewidth=2) +
theme_classic() +
labs(x ="Cortical Thickness", y = "Position Error", title = ROI) +
theme( axis.title.x = element_text(vjust = -4),
plot.margin = margin(1, 1, 1, 1, "cm")) +
#    axis.text.x = element_text(size = 25),
#    axis.text.y = element_text(size = 25),
#    axis.title.y = element_text(vjust = 4, size = 16),
#    plot.title = element_text(hjust = 0.5 ,size=16),
#    panel.border = element_rect(fill=NA,color = "#502E23"),
#    panel.background =element_blank(),
#    strip.text.x = element_text(
#      size = 16,
#      color = "black",
#      face = "bold.italic"
#    ),
# legend.position = "right")+
stat_cor( method = "pearson", label.x.npc = "center",
label.y.npc = "top")
#legend.key.size = unit(2, 'cm'),
#legend.title = element_text(size=18), #change legend title font size
#legend.text = element_text(size=18),
#png(file = CleanCSVsfigpath,ROI,"_sexdiff_QA.png"))  #,".png"))
#print(plotlist[[ROI]] )
#dev.off()
}
