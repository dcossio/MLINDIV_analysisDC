LabelNames <- str_remove(LabelNames$`Label Name`,paste0(17,"Networks_"))
NetworkNames <- c(
"LH_VisCent",
"LH_VisPeri",
"LH_SomMotA",
"LH_SomMotB",
"LH_DorsAttnA",
"LH_DorsAttnB",
"LH_SalVentAttnA",
"LH_SalVentAttnB",
"LH_LimbicA",
"LH_LimbicB",
"LH_ContA",
"LH_ContB",
"LH_ContC",
"LH_DefaultA",
"LH_DefaultB",
"LH_DefaultC",
"LH_TempPar",
"RH_VisCent",
"RH_VisPeri",
"RH_SomMotA",
"RH_SomMotB",
"RH_DorsAttnA",
"RH_DorsAttnB",
"RH_SalVentAttnA",
"RH_SalVentAttnB",
"RH_LimbicA",
"RH_LimbicB",
"RH_ContA",
"RH_ContB",
"RH_ContC",
"RH_DefaultA",
"RH_DefaultB",
"RH_DefaultC",
"RH_TempPar"
)
CT_17 <- ReadingCSVFunc("master_CT400_parces17_networks.csv") %>% `colnames<-`(SelectAtlas(400,17)) %>% arrange(subject_id)
CT_17net_ROImerged <- Combine_ROIs(CT_17,LabelNames)
CT_17net_merged <- Combine_ROIs(CT_17,NetworkNames)
df <- CleanDF(CT_17, "loop_de_avg_degree")
ROIs <- CT_17 %>% select(matches(apriori_networknames)) %>% colnames()
cor_results <-
data.frame(matrix(nrow = 0, ncol = 17)) %>%   `colnames<-`(c("roi", "estimate", "p.value", "statistic", "n", "gp", "Method"))
pcorlist <- list()
for (ROI in ROIs) {
pcorlist[[ROI]] <-
pcor.test(x = df["loop_de_avg_degree"], y = df[[ROI]], z = df[, c("age_scan_years", "sex")])
temp <- cbind(ROI, pcorlist[[ROI]])
cor_results <- rbind(cor_results, temp)
}
cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "BH", n = length(cor_results$p.value))
df <- CleanDF(CT_17, "loop_de_avg_degree") %>% filter(sex==0)
View(df)
ROIs <- CT_17 %>% select(matches(apriori_networknames)) %>% colnames()
df <- CleanDF(CT_17, "loop_de_avg_degree") %>% filter(sex==0)
ROIs <- CT_17 %>% select(matches(apriori_networknames)) %>% colnames()
cor_results <-
data.frame(matrix(nrow = 0, ncol = 17)) %>%   `colnames<-`(c("roi", "estimate", "p.value", "statistic", "n", "gp", "Method"))
pcorlist <- list()
for (ROI in ROIs) {
pcorlist[[ROI]] <-
pcor.test(x = df["loop_de_avg_degree"], y = df[[ROI]], z = df[, c("age_scan_years")])
temp <- cbind(ROI, pcorlist[[ROI]])
cor_results <- rbind(cor_results, temp)
}
cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "BH", n = length(cor_results$p.value))
TableOutput(cor_results)
View(cor_results)
length(cor_results$p.value)
cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "BH")
View(cor_results)
cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "BY",  n = length(cor_results$p.value))
View(cor_results)
cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "bonferroni",  n = length(cor_results$p.value))
cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "fdr",  n = length(cor_results$p.value))
View(cor_results)
cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "BH",  n = length(cor_results$p.value))
View(CT_17net_merged)
df <- CleanDF(CT_17net_merged, "loop_de_avg_degree") %>% filter(sex==0)
ROIs <- CT_17net_merged %>% select(matches(apriori_networknames)) %>% colnames()
cor_results <-
data.frame(matrix(nrow = 0, ncol = 17)) %>%   `colnames<-`(c("roi", "estimate", "p.value", "statistic", "n", "gp", "Method"))
pcorlist <- list()
for (ROI in ROIs) {
if(!is.na(sum(df[[ROI]])) == FALSE){
pcorlist[[ROI]] <- NA
}else{
pcorlist[[ROI]] <-
pcor.test(x = df["loop_de_avg_degree"], y = df[[ROI]], z = df[, c("age_scan_years")])
temp <- cbind(ROI, pcorlist[[ROI]])
cor_results <- rbind(cor_results, temp)
}
}
cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "BH", n = length(cor_results$p.value))
TableOutput(cor_results)
View(cor_results)
df <- CleanDF(CT_17net_ROImerged, "loop_de_avg_degree")
ROIs <- CT_17net_ROImerged %>% select(matches(apriori_labelnames)) %>% colnames()
cor_results <-
data.frame(matrix(nrow = 0, ncol = 17)) %>%   `colnames<-`(c("roi", "estimate", "p.value", "statistic", "n", "gp", "Method"))
pcorlist <- list()
for (ROI in ROIs) {
if(!is.na(sum(df[[ROI]])) == FALSE){
pcorlist[[ROI]] <- NA
} else{
pcorlist[[ROI]] <-
pcor.test(x = df["loop_de_avg_degree"], y = df[[ROI]], z = df[, c("age_scan_years", "sex")])
temp <- cbind(ROI, pcorlist[[ROI]])
cor_results <- rbind(cor_results, temp)
}
}
cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "BH", n = length(cor_results$p.value))
TableOutput(cor_results)
View(cor_results)
df <- CleanDF(CT_17net_ROImerged, "loop_de_avg_degree")
ROIs <- CT_17net_ROImerged %>% select(matches(apriori_labelnames)) %>% colnames()
cor_results <-
data.frame(matrix(nrow = 0, ncol = 17)) %>%   `colnames<-`(c("roi", "estimate", "p.value", "statistic", "n", "gp", "Method"))
pcorlist <- list()
for (ROI in ROIs) {
if(!is.na(sum(df[[ROI]])) == FALSE){
pcorlist[[ROI]] <- NA
} else{
pcorlist[[ROI]] <-
pcor.test(x = df["loop_de_avg_degree"], y = df[[ROI]], z = df[, c("age_scan_years")])
temp <- cbind(ROI, pcorlist[[ROI]])
cor_results <- rbind(cor_results, temp)
}
}
cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "BH", n = length(cor_results$p.value))
View(cor_results)
cor_results$p.value
length(cor_results$p.value)
df <- CleanDF(CT_17, "loop_de_avg_degree") %>% filter(sex==1)
ROIs <- CT_17 %>% select(matches(apriori_networknames)) %>% colnames()
cor_results <-
data.frame(matrix(nrow = 0, ncol = 17)) %>%   `colnames<-`(c("roi", "estimate", "p.value", "statistic", "n", "gp", "Method"))
pcorlist <- list()
for (ROI in ROIs) {
pcorlist[[ROI]] <-
pcor.test(x = df["loop_de_avg_degree"], y = df[[ROI]], z = df[, c("age_scan_years")])
temp <- cbind(ROI, pcorlist[[ROI]])
cor_results <- rbind(cor_results, temp)
}
cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "BH",  n = length(cor_results$p.value))
TableOutput(cor_results)
View(cor_results)
df <- CleanDF(CT_17net_ROImerged, "loop_de_avg_degree")
ROIs <- CT_17net_ROImerged %>% select(matches(apriori_labelnames)) %>% colnames()
cor_results <-
data.frame(matrix(nrow = 0, ncol = 17)) %>%   `colnames<-`(c("roi", "estimate", "p.value", "statistic", "n", "gp", "Method"))
pcorlist <- list()
for (ROI in ROIs) {
if(!is.na(sum(df[[ROI]])) == FALSE){
pcorlist[[ROI]] <- NA
} else{
pcorlist[[ROI]] <-
pcor.test(x = df["loop_de_avg_degree"], y = df[[ROI]], z = df[, c("age_scan_years")])
temp <- cbind(ROI, pcorlist[[ROI]])
cor_results <- rbind(cor_results, temp)
}
}
cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "BH", n = length(cor_results$p.value))
TableOutput(cor_results)
df <- CleanDF(CT_17net_merged, "loop_de_avg_degree") %>% filter(sex==1)
ROIs <- CT_17net_merged %>% select(matches(apriori_networknames)) %>% colnames()
cor_results <-
data.frame(matrix(nrow = 0, ncol = 17)) %>%   `colnames<-`(c("roi", "estimate", "p.value", "statistic", "n", "gp", "Method"))
pcorlist <- list()
for (ROI in ROIs) {
if(!is.na(sum(df[[ROI]])) == FALSE){
pcorlist[[ROI]] <- NA
}else{
pcorlist[[ROI]] <-
pcor.test(x = df["loop_de_avg_degree"], y = df[[ROI]], z = df[, c("age_scan_years")])
temp <- cbind(ROI, pcorlist[[ROI]])
cor_results <- rbind(cor_results, temp)
}
}
cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "BH", n = length(cor_results$p.value))
View(cor_results)
df <- CleanDF(CT_17net_merged, "loop_de_avg_degree") %>% filter(sex==1)
ROIs <- CT_17net_merged %>% select(matches(apriori_networknames)) %>% colnames()
cor_results <-
data.frame(matrix(nrow = 0, ncol = 17)) %>%   `colnames<-`(c("roi", "estimate", "p.value", "statistic", "n", "gp", "Method"))
pcorlist <- list()
for (ROI in ROIs) {
if(!is.na(sum(df[[ROI]])) == FALSE){
pcorlist[[ROI]] <- NA
}else{
pcorlist[[ROI]] <-
pcor.test(x = df["loop_de_avg_degree"], y = df[[ROI]], z = df[, c("age_scan_years")])
temp <- cbind(ROI, pcorlist[[ROI]])
cor_results <- rbind(cor_results, temp)
}
}
cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "BH", n = length(cor_results$p.value))
TableOutput(cor_results)
df <- CleanDF(CT_17net_ROImerged, "loop_de_avg_degree") %>% filter(sex==0)
ROIs <- CT_17net_ROImerged %>% select(matches(apriori_labelnames)) %>% colnames()
cor_results <-
data.frame(matrix(nrow = 0, ncol = 17)) %>%   `colnames<-`(c("roi", "estimate", "p.value", "statistic", "n", "gp", "Method"))
pcorlist <- list()
for (ROI in ROIs) {
if(!is.na(sum(df[[ROI]])) == FALSE){
pcorlist[[ROI]] <- NA
} else{
pcorlist[[ROI]] <-
pcor.test(x = df["loop_de_avg_degree"], y = df[[ROI]], z = df[, c("age_scan_years")])
temp <- cbind(ROI, pcorlist[[ROI]])
cor_results <- rbind(cor_results, temp)
}
}
cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "BH", n = length(cor_results$p.value))
TableOutput(cor_results)
View(cor_results)
TableOutput <- function(df){
knitr::kable(df, row.names=F) %>% kable_styling(bootstrap_options =  c("striped", "hover", "condensed"),position = "center") %>% scroll_box(width = "600px", height = "300px") %>% row_spec(which(df$adj.pval< 0.1), color = white, background = "pink") %>% row_spec(which(df$adj.pval< 0.05), color = white, background = "red")
}
df <- CleanDF(CT_17net_ROImerged, "loop_de_avg_degree") %>% filter(sex==0)
ROIs <- CT_17net_ROImerged %>% select(matches(apriori_labelnames)) %>% colnames()
cor_results <-
data.frame(matrix(nrow = 0, ncol = 17)) %>%   `colnames<-`(c("roi", "estimate", "p.value", "statistic", "n", "gp", "Method"))
pcorlist <- list()
for (ROI in ROIs) {
if(!is.na(sum(df[[ROI]])) == FALSE){
pcorlist[[ROI]] <- NA
} else{
pcorlist[[ROI]] <-
pcor.test(x = df["loop_de_avg_degree"], y = df[[ROI]], z = df[, c("age_scan_years")])
temp <- cbind(ROI, pcorlist[[ROI]])
cor_results <- rbind(cor_results, temp)
}
}
cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "BH", n = length(cor_results$p.value))
TableOutput(cor_results)
TableOutput <- function(df){
knitr::kable(df, row.names=F) %>% kable_styling(bootstrap_options =  c("striped", "hover", "condensed"),position = "center") %>% scroll_box(width = "600px", height = "300px")
}
df <- CleanDF(CT_17net_ROImerged, "loop_de_avg_degree") %>% filter(sex==0)
ROIs <- CT_17net_ROImerged %>% select(matches(apriori_labelnames)) %>% colnames()
cor_results <-
data.frame(matrix(nrow = 0, ncol = 17)) %>%   `colnames<-`(c("roi", "estimate", "p.value", "statistic", "n", "gp", "Method"))
pcorlist <- list()
for (ROI in ROIs) {
if(!is.na(sum(df[[ROI]])) == FALSE){
pcorlist[[ROI]] <- NA
} else{
pcorlist[[ROI]] <-
pcor.test(x = df["loop_de_avg_degree"], y = df[[ROI]], z = df[, c("age_scan_years")])
temp <- cbind(ROI, pcorlist[[ROI]])
cor_results <- rbind(cor_results, temp)
}
}
cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "BH", n = length(cor_results$p.value))
TableOutput(cor_results)
View(cor_results)
df <- CleanDF(CT_17net_ROImerged, "loop_de_avg_degree")
ROIs <- CT_17net_ROImerged %>% select(matches(apriori_labelnames)) %>% colnames()
cor_results <-
data.frame(matrix(nrow = 0, ncol = 17)) %>%   `colnames<-`(c("roi", "estimate", "p.value", "statistic", "n", "gp", "Method"))
pcorlist <- list()
for (ROI in ROIs) {
if(!is.na(sum(df[[ROI]])) == FALSE){
pcorlist[[ROI]] <- NA
} else{
pcorlist[[ROI]] <-
pcor.test(x = df["loop_de_avg_degree"], y = df[[ROI]], z = df[, c("age_scan_years")])
temp <- cbind(ROI, pcorlist[[ROI]])
cor_results <- rbind(cor_results, temp)
}
}
cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "BH", n = length(cor_results$p.value))
TableOutput(cor_results)
df <- CleanDF(CT_17, "loop_de_rad3_degree")
ROIs <- CT_17 %>% select(matches(apriori_networknames)) %>% colnames()
cor_results <-
data.frame(matrix(nrow = 0, ncol = 17)) %>%   `colnames<-`(c("roi", "estimate", "p.value", "statistic", "n", "gp", "Method"))
pcorlist <- list()
for (ROI in ROIs) {
pcorlist[[ROI]] <-
pcor.test(x = df["loop_de_rad3_degree"], y = df[[ROI]], z = df[, c("age_scan_years", "sex")])
temp <- cbind(ROI, pcorlist[[ROI]])
cor_results <- rbind(cor_results, temp)
}
cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "BH",  n = length(cor_results$p.value))
TableOutput(cor_results)
View(cor_results)
df <- CleanDF(CT_17net_merged, "loop_de_rad3_degree")
ROIs <- CT_17net_merged %>% select(matches(apriori_networknames)) %>% colnames()
cor_results <-
data.frame(matrix(nrow = 0, ncol = 17)) %>%   `colnames<-`(c("roi", "estimate", "p.value", "statistic", "n", "gp", "Method"))
pcorlist <- list()
for (ROI in ROIs) {
if(!is.na(sum(df[[ROI]])) == FALSE){
pcorlist[[ROI]] <- NA
}else{
pcorlist[[ROI]] <-
pcor.test(x = df["loop_de_rad3_degree"], y = df[[ROI]], z = df[, c("age_scan_years", "sex")])
temp <- cbind(ROI, pcorlist[[ROI]])
cor_results <- rbind(cor_results, temp)
}
}
cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "BH", n = length(cor_results$p.value))
TableOutput(cor_results)
View(cor_results)
df <- CleanDF(CT_17net_ROImerged, "loop_de_rad3_degree")
ROIs <- CT_17net_ROImerged %>% select(matches(apriori_labelnames)) %>% colnames()
cor_results <-
data.frame(matrix(nrow = 0, ncol = 17)) %>%   `colnames<-`(c("roi", "estimate", "p.value", "statistic", "n", "gp", "Method"))
pcorlist <- list()
for (ROI in ROIs) {
if(!is.na(sum(df[[ROI]])) == FALSE){
pcorlist[[ROI]] <- NA
} else{
pcorlist[[ROI]] <-
pcor.test(x = df["loop_de_rad3_degree"], y = df[[ROI]], z = df[, c("age_scan_years", "sex")])
temp <- cbind(ROI, pcorlist[[ROI]])
cor_results <- rbind(cor_results, temp)
}
}
cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "BH", n = length(cor_results$p.value))
TableOutput(cor_results)
View(cor_results)
df <- CleanDF(CT_17, "loop_de_rad3_degree") %>% filter(sex==0)
ROIs <- CT_17 %>% select(matches(apriori_networknames)) %>% colnames()
cor_results <-
data.frame(matrix(nrow = 0, ncol = 17)) %>%   `colnames<-`(c("roi", "estimate", "p.value", "statistic", "n", "gp", "Method"))
pcorlist <- list()
for (ROI in ROIs) {
pcorlist[[ROI]] <-
pcor.test(x = df["loop_de_rad3_degree"], y = df[[ROI]], z = df[, c("age_scan_years")])
temp <- cbind(ROI, pcorlist[[ROI]])
cor_results <- rbind(cor_results, temp)
}
cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "BH",  n = length(cor_results$p.value))
TableOutput(cor_results)
View(cor_results)
TableOutput(cor_results) %>% row_spec(which(cor_results$adj.pval<0.1))
class(cor_results$adj.pval)
which(cor_results$adj.pval< 0.1)
TableOutput(cor_results) %>% row_spec(which(cor_results$adj.pval< 0.1),color = "white", background = "red")
TableOutput(cor_results) %>% row_spec(which(.$adj.pval< 0.1),color = "white", background = "red")
TableOutput(cor_results) %>% row_spec(which(cor_results$adj.pval< 0.1),color = "white", background = "red")
TableOutput(cor_results) %>% row_spec(., which(cor_results$adj.pval< 0.1),color = "white", background = "red")
TableOutput(cor_results)
View(cor_results)
df <- CleanDF(CT_17net_merged, "loop_de_rad3_degree") %>% filter(sex==0)
ROIs <- CT_17net_merged %>% select(matches(apriori_networknames)) %>% colnames()
cor_results <-
data.frame(matrix(nrow = 0, ncol = 17)) %>%   `colnames<-`(c("roi", "estimate", "p.value", "statistic", "n", "gp", "Method"))
pcorlist <- list()
for (ROI in ROIs) {
if(!is.na(sum(df[[ROI]])) == FALSE){
pcorlist[[ROI]] <- NA
}else{
pcorlist[[ROI]] <-
pcor.test(x = df["loop_de_rad3_degree"], y = df[[ROI]], z = df[, c("age_scan_years")])
temp <- cbind(ROI, pcorlist[[ROI]])
cor_results <- rbind(cor_results, temp)
}
}
cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "BH", n = length(cor_results$p.value))
TableOutput(cor_results)
View(cor_results)
df <- CleanDF(CT_17net_ROImerged, "loop_de_rad3_degree") %>% filter(sex==0)
ROIs <- CT_17net_ROImerged %>% select(matches(apriori_labelnames)) %>% colnames()
cor_results <-
data.frame(matrix(nrow = 0, ncol = 17)) %>%   `colnames<-`(c("roi", "estimate", "p.value", "statistic", "n", "gp", "Method"))
pcorlist <- list()
for (ROI in ROIs) {
if(!is.na(sum(df[[ROI]])) == FALSE){
pcorlist[[ROI]] <- NA
} else{
pcorlist[[ROI]] <-
pcor.test(x = df["loop_de_rad3_degree"], y = df[[ROI]], z = df[, c("age_scan_years")])
temp <- cbind(ROI, pcorlist[[ROI]])
cor_results <- rbind(cor_results, temp)
}
}
cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "BH", n = length(cor_results$p.value))
TableOutput(cor_results)
View(cor_results)
df <- CleanDF(CT_17, "loop_de_rad3_degree") %>% filter(sex==1)
ROIs <- CT_17 %>% select(matches(apriori_networknames)) %>% colnames()
cor_results <-
data.frame(matrix(nrow = 0, ncol = 17)) %>%   `colnames<-`(c("roi", "estimate", "p.value", "statistic", "n", "gp", "Method"))
pcorlist <- list()
for (ROI in ROIs) {
pcorlist[[ROI]] <-
pcor.test(x = df["loop_de_rad3_degree"], y = df[[ROI]], z = df[, c("age_scan_years")])
temp <- cbind(ROI, pcorlist[[ROI]])
cor_results <- rbind(cor_results, temp)
}
cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "BH",  n = length(cor_results$p.value))
TableOutput(cor_results)
View(cor_results)
df <- CleanDF(CT_17net_merged, "loop_de_rad3_degree") %>% filter(sex==1)
ROIs <- CT_17net_merged %>% select(matches(apriori_networknames)) %>% colnames()
cor_results <-
data.frame(matrix(nrow = 0, ncol = 17)) %>%   `colnames<-`(c("roi", "estimate", "p.value", "statistic", "n", "gp", "Method"))
pcorlist <- list()
for (ROI in ROIs) {
if(!is.na(sum(df[[ROI]])) == FALSE){
pcorlist[[ROI]] <- NA
}else{
pcorlist[[ROI]] <-
pcor.test(x = df["loop_de_rad3_degree"], y = df[[ROI]], z = df[, c("age_scan_years")])
temp <- cbind(ROI, pcorlist[[ROI]])
cor_results <- rbind(cor_results, temp)
}
}
cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "BH", n = length(cor_results$p.value))
TableOutput(cor_results)
View(cor_results)
df <- CleanDF(CT_17net_ROImerged, "loop_de_rad3_degree") %>% filter(sex==1)
ROIs <- CT_17net_ROImerged %>% select(matches(apriori_labelnames)) %>% colnames()
cor_results <-
data.frame(matrix(nrow = 0, ncol = 17)) %>%   `colnames<-`(c("roi", "estimate", "p.value", "statistic", "n", "gp", "Method"))
pcorlist <- list()
for (ROI in ROIs) {
if(!is.na(sum(df[[ROI]])) == FALSE){
pcorlist[[ROI]] <- NA
} else{
pcorlist[[ROI]] <-
pcor.test(x = df["loop_de_rad3_degree"], y = df[[ROI]], z = df[, c("age_scan_years")])
temp <- cbind(ROI, pcorlist[[ROI]])
cor_results <- rbind(cor_results, temp)
}
}
cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "BH", n = length(cor_results$p.value))
TableOutput(cor_results)
View(cor_results)
cor_results <- arrange(cor_results)
View(cor_results)
cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "BH", n = length(cor_results$p.value))
cor_results <- arrange(cor_results,adj.pval)
df <- CleanDF(CT_17, "loop_de_avg_degree")
ROIs <- CT_17 %>% select(matches(apriori_networknames)) %>% colnames()
cor_results <-
data.frame(matrix(nrow = 0, ncol = 17)) %>%   `colnames<-`(c("roi", "estimate", "p.value", "statistic", "n", "gp", "Method"))
pcorlist <- list()
for (ROI in ROIs) {
pcorlist[[ROI]] <-
pcor.test(x = df["loop_de_avg_degree"], y = df[[ROI]], z = df[, c("age_scan_years", "sex")])
temp <- cbind(ROI, pcorlist[[ROI]])
cor_results <- rbind(cor_results, temp)
}
cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "BH", n = length(cor_results$p.value))
cor_results <- arrange(cor_results,adj.pval)
View(cor_results)
df <- CleanDF(CT_17, "loop_de_avg_degree")
ROIs <- CT_17 %>% select(matches(apriori_networknames)) %>% colnames()
cor_results <-
data.frame(matrix(nrow = 0, ncol = 17)) %>%   `colnames<-`(c("roi", "estimate", "p.value", "statistic", "n", "gp", "Method"))
pcorlist <- list()
for (ROI in ROIs) {
pcorlist[[ROI]] <-
pcor.test(x = df["loop_de_avg_degree"], y = df[[ROI]], z = df[, c("age_scan_years", "sex")])
temp <- cbind(ROI, pcorlist[[ROI]])
cor_results <- rbind(cor_results, temp)
}
cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "BH", n = length(cor_results$p.value))
cor_results <- arrange(cor_results,p.value)
View(cor_results)
df <- CleanDF(CT_17, "loop_ae_avg_degree")
ROIs <- CT_17 %>% select(matches(apriori_networknames)) %>% colnames()
cor_results <-
data.frame(matrix(nrow = 0, ncol = 17)) %>%   `colnames<-`(c("roi", "estimate", "p.value", "statistic", "n", "gp", "Method"))
pcorlist <- list()
for (ROI in ROIs) {
pcorlist[[ROI]] <-
pcor.test(x = df["loop_ae_avg_degree"], y = df[[ROI]], z = df[, c("age_scan_years", "sex")])
temp <- cbind(ROI, pcorlist[[ROI]])
cor_results <- rbind(cor_results, temp)
}
cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "BH",  n = length(cor_results$p.value))
TableOutput(cor_results)
View(cor_results)
df <- CleanDF(CT_17, "loop_ae_avg_degree")
ROIs <- CT_17 %>% select(matches(apriori_networknames)) %>% colnames()
cor_results <-
data.frame(matrix(nrow = 0, ncol = 17)) %>%   `colnames<-`(c("roi", "estimate", "p.value", "statistic", "n", "gp", "Method"))
pcorlist <- list()
for (ROI in ROIs) {
pcorlist[[ROI]] <-
pcor.test(x = df["loop_ae_avg_degree"], y = df[[ROI]], z = df[, c("age_scan_years", "sex")])
temp <- cbind(ROI, pcorlist[[ROI]])
cor_results <- rbind(cor_results, temp)
}
cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "BH",  n = length(cor_results$p.value))
cor_results <- arrange(cor_results,p.value)
TableOutput(cor_results)
df <- CleanDF(CT_17net_merged, "loop_ae_avg_degree")
ROIs <- CT_17net_merged %>% select(matches(apriori_networknames)) %>% colnames()
cor_results <-
data.frame(matrix(nrow = 0, ncol = 17)) %>%   `colnames<-`(c("roi", "estimate", "p.value", "statistic", "n", "gp", "Method"))
pcorlist <- list()
for (ROI in ROIs) {
if(!is.na(sum(df[[ROI]])) == FALSE){
pcorlist[[ROI]] <- NA
}else{
pcorlist[[ROI]] <-
pcor.test(x = df["loop_ae_avg_degree"], y = df[[ROI]], z = df[, c("age_scan_years", "sex")])
temp <- cbind(ROI, pcorlist[[ROI]])
cor_results <- rbind(cor_results, temp)
}
}
cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "BH", n = length(cor_results$p.value))
cor_results <- arrange(cor_results,p.value)
TableOutput(cor_results)
